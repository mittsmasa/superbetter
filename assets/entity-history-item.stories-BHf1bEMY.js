const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-BsuW_iby.js","./iframe-Blnp8no9.js","./preload-helper-PPVm8Dsz.js","./iframe-CaK4m0pQ.css","./index-BA3gWW2X.js","./index-DVbHOe5M.js","./index-Cqdy8P7H.js","./date-CyM_0PVW.js","./index-B7pu2orT.js","./proxy-C4BJpDFQ.js","./cx-BFURdk0p.js","./pixel-border-Bk6KHzdu.js","./index-BmDXe60s.js","./bun-sqlite-dialect-DaKWH3r2.js","./node-sqlite-dialect-C8f5Xdyd.js"])))=>i.map(i=>d[i]);
import{e as ON,f as ry,g as ny,h as iy,i as Zl,k as DN,l as Gl,n as RN,o as UN,p as CN,q as PN,t as hd,r as Ts,j as ar,c as Do}from"./iframe-Blnp8no9.js";import{a as LN,I as zN}from"./index-BA3gWW2X.js";import{a as jN,T as MN}from"./index-Cqdy8P7H.js";import{count as qN,desc as pd,asc as WN,inArray as Ho,notInArray as md,like as Cr,lt as gd,lte as yd,ne as wd,gt as Zo,gte as vd,eq as K,and as rt,or as FN,sql as We}from"drizzle-orm";import{b as bd}from"./date-CyM_0PVW.js";import{drizzle as BN}from"drizzle-orm/mysql2";import{createPool as VN}from"mysql2/promise";import{_ as Wi}from"./preload-helper-PPVm8Dsz.js";import{E as KN}from"./index-B7pu2orT.js";import{c as JN}from"./cx-BFURdk0p.js";import{p as HN}from"./pixel-border-Bk6KHzdu.js";import{m as ZN}from"./proxy-C4BJpDFQ.js";const{fn:co}=__STORYBOOK_MODULE_TEST__;var Fi=co().mockName("next/cache::revalidatePath");co().mockName("next/cache::revalidateTag");co().mockName("next/cache::updateTag");co().mockName("next/cache::unstable_cache").mockImplementation(e=>e);co().mockName("next/cache::unstable_noStore");co().mockName("next/cache::refresh");const Ql=e=>{const t=new Date,r=bd(t),i=bd(new Date(t.getTime()-1440*60*1e3)),n=bd(e);return n.start>=r.start&&n.end<=r.end||n.start>=i.start&&n.end<=i.end};var _d={},Sd={},am;function oy(){return am||(am=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"createDedupedByCallsiteServerErrorLoggerDev",{enumerable:!0,get:function(){return s}});const t=i(ON());function r(c){if(typeof WeakMap!="function")return null;var u=new WeakMap,d=new WeakMap;return(r=function(l){return l?d:u})(c)}function i(c,u){if(c&&c.__esModule)return c;if(c===null||typeof c!="object"&&typeof c!="function")return{default:c};var d=r(u);if(d&&d.has(c))return d.get(c);var l={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in c)if(h!=="default"&&Object.prototype.hasOwnProperty.call(c,h)){var g=f?Object.getOwnPropertyDescriptor(c,h):null;g&&(g.get||g.set)?Object.defineProperty(l,h,g):l[h]=c[h]}return l.default=c,d&&d.set(c,l),l}const n={current:null},o=typeof t.cache=="function"?t.cache:c=>c,a=console.warn;o(c=>{try{a(n.current)}finally{n.current=null}});function s(c){return function(...d){const l=c(...d);a(l)}}})(Sd)),Sd}var kd={},sm;function ay(){return sm||(sm=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"ReflectAdapter",{enumerable:!0,get:function(){return t}});class t{static get(i,n,o){const a=Reflect.get(i,n,o);return typeof a=="function"?a.bind(i):a}static set(i,n,o,a){return Reflect.set(i,n,o,a)}static has(i,n){return Reflect.has(i,n)}static deleteProperty(i,n){return Reflect.deleteProperty(i,n)}}})(kd)),kd}var cm;function GN(){return cm||(cm=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"draftMode",{enumerable:!0,get:function(){return c}});const t=ry(),r=ny(),i=iy(),n=oy(),o=Zl(),a=DN(),s=Gl();ay();function c(){const m="draftMode",v=r.workAsyncStorage.getStore(),b=t.workUnitAsyncStorage.getStore();switch((!v||!b)&&(0,t.throwForMissingRequestStore)(m),b.type){case"prerender-runtime":return(0,i.delayUntilRuntimeStage)(b,u(b.draftMode));case"request":return u(b.draftMode);case"cache":case"private-cache":case"unstable-cache":const I=(0,t.getDraftModeProviderForCacheScope)(v,b);if(I)return u(I);case"prerender":case"prerender-client":case"prerender-ppr":case"prerender-legacy":return u(null);default:return b}}function u(m,v){const b=m??d,I=l.get(b);return I||Promise.resolve(new f(m))}const d={},l=new WeakMap;class f{constructor(v){this._provider=v}get isEnabled(){return this._provider!==null?this._provider.isEnabled:!1}enable(){g("draftMode().enable()",this.enable),this._provider!==null&&this._provider.enable()}disable(){g("draftMode().disable()",this.disable),this._provider!==null&&this._provider.disable()}}(0,n.createDedupedByCallsiteServerErrorLoggerDev)(h);function h(m,v){const b=m?`Route "${m}" `:"This route ";return Object.defineProperty(new Error(`${b}used ${v}. \`draftMode()\` returns a Promise and must be unwrapped with \`await\` or \`React.use()\` before accessing its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`),"__NEXT_ERROR_CODE",{value:"E835",enumerable:!1,configurable:!0})}function g(m,v){const b=r.workAsyncStorage.getStore(),I=t.workUnitAsyncStorage.getStore();if(b){if(I?.phase==="after")throw Object.defineProperty(new Error(`Route ${b.route} used "${m}" inside \`after()\`. The enabled status of \`draftMode()\` can be read inside \`after()\` but you cannot enable or disable \`draftMode()\`. See more info here: https://nextjs.org/docs/app/api-reference/functions/after`),"__NEXT_ERROR_CODE",{value:"E845",enumerable:!1,configurable:!0});if(b.dynamicShouldError)throw Object.defineProperty(new o.StaticGenBailoutError(`Route ${b.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`${m}\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E553",enumerable:!1,configurable:!0});if(I)switch(I.type){case"cache":case"private-cache":{const y=Object.defineProperty(new Error(`Route ${b.route} used "${m}" inside "use cache". The enabled status of \`draftMode()\` can be read in caches but you must not enable or disable \`draftMode()\` inside a cache. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E829",enumerable:!1,configurable:!0});throw Error.captureStackTrace(y,v),b.invalidDynamicUsageError??=y,y}case"unstable-cache":throw Object.defineProperty(new Error(`Route ${b.route} used "${m}" inside a function cached with \`unstable_cache()\`. The enabled status of \`draftMode()\` can be read in caches but you must not enable or disable \`draftMode()\` inside a cache. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`),"__NEXT_ERROR_CODE",{value:"E844",enumerable:!1,configurable:!0});case"prerender":case"prerender-runtime":{const y=Object.defineProperty(new Error(`Route ${b.route} used ${m} without first calling \`await connection()\`. See more info here: https://nextjs.org/docs/messages/next-prerender-sync-headers`),"__NEXT_ERROR_CODE",{value:"E126",enumerable:!1,configurable:!0});return(0,i.abortAndThrowOnSynchronousRequestDataAccess)(b.route,m,y,I)}case"prerender-client":const x="`draftMode`";throw Object.defineProperty(new s.InvariantError(`${x} must not be used within a Client Component. Next.js should be preventing ${x} from being included in Client Components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E832",enumerable:!1,configurable:!0});case"prerender-ppr":return(0,i.postponeWithTracking)(b.route,m,I.dynamicTracking);case"prerender-legacy":I.revalidate=0;const N=Object.defineProperty(new a.DynamicServerError(`Route ${b.route} couldn't be rendered statically because it used \`${m}\`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`),"__NEXT_ERROR_CODE",{value:"E558",enumerable:!1,configurable:!0});throw b.dynamicUsageDescription=m,b.dynamicUsageStack=N.stack,N;case"request":(0,i.trackDynamicDataInDynamicRender)(I);break}}}})(_d)),_d}var QN=GN(),Nd={},$d={},um;function sy(){return um||(um=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0});function t(o,a){for(var s in a)Object.defineProperty(o,s,{enumerable:!0,get:a[s]})}t(e,{HeadersAdapter:function(){return n},ReadonlyHeadersError:function(){return i}});const r=ay();class i extends Error{constructor(){super("Headers cannot be modified. Read more: https://nextjs.org/docs/app/api-reference/functions/headers")}static callable(){throw new i}}class n extends Headers{constructor(a){super(),this.headers=new Proxy(a,{get(s,c,u){if(typeof c=="symbol")return r.ReflectAdapter.get(s,c,u);const d=c.toLowerCase(),l=Object.keys(a).find(f=>f.toLowerCase()===d);if(!(typeof l>"u"))return r.ReflectAdapter.get(s,l,u)},set(s,c,u,d){if(typeof c=="symbol")return r.ReflectAdapter.set(s,c,u,d);const l=c.toLowerCase(),f=Object.keys(a).find(h=>h.toLowerCase()===l);return r.ReflectAdapter.set(s,f??c,u,d)},has(s,c){if(typeof c=="symbol")return r.ReflectAdapter.has(s,c);const u=c.toLowerCase(),d=Object.keys(a).find(l=>l.toLowerCase()===u);return typeof d>"u"?!1:r.ReflectAdapter.has(s,d)},deleteProperty(s,c){if(typeof c=="symbol")return r.ReflectAdapter.deleteProperty(s,c);const u=c.toLowerCase(),d=Object.keys(a).find(l=>l.toLowerCase()===u);return typeof d>"u"?!0:r.ReflectAdapter.deleteProperty(s,d)}})}static seal(a){return new Proxy(a,{get(s,c,u){switch(c){case"append":case"delete":case"set":return i.callable;default:return r.ReflectAdapter.get(s,c,u)}}})}merge(a){return Array.isArray(a)?a.join(", "):a}static from(a){return a instanceof Headers?a:new n(a)}append(a,s){const c=this.headers[a];typeof c=="string"?this.headers[a]=[c,s]:Array.isArray(c)?c.push(s):this.headers[a]=s}delete(a){delete this.headers[a]}get(a){const s=this.headers[a];return typeof s<"u"?this.merge(s):null}has(a){return typeof this.headers[a]<"u"}set(a,s){this.headers[a]=s}forEach(a,s){for(const[c,u]of this.entries())a.call(s,u,c,this)}*entries(){for(const a of Object.keys(this.headers)){const s=a.toLowerCase(),c=this.get(s);yield[s,c]}}*keys(){for(const a of Object.keys(this.headers))yield a.toLowerCase()}*values(){for(const a of Object.keys(this.headers))yield this.get(a)}[Symbol.iterator](){return this.entries()}}})($d)),$d}var Ed={},Ad={},Id={},dm;function YN(){return dm||(dm=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"afterTaskAsyncStorageInstance",{enumerable:!0,get:function(){return r}});const r=(0,RN().createAsyncLocalStorage)()})(Id)),Id}var lm;function XN(){return lm||(lm=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"afterTaskAsyncStorage",{enumerable:!0,get:function(){return t.afterTaskAsyncStorageInstance}});const t=YN()})(Ad)),Ad}var fm;function e$(){return fm||(fm=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0});function t(s,c){for(var u in c)Object.defineProperty(s,u,{enumerable:!0,get:c[u]})}t(e,{isRequestAPICallableInsideAfter:function(){return a},throwForSearchParamsAccessInUseCache:function(){return o},throwWithStaticGenerationBailoutErrorWithDynamicError:function(){return n}});const r=Zl(),i=XN();function n(s,c){throw Object.defineProperty(new r.StaticGenBailoutError(`Route ${s} with \`dynamic = "error"\` couldn't be rendered statically because it used ${c}. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E543",enumerable:!1,configurable:!0})}function o(s,c){const u=Object.defineProperty(new Error(`Route ${s.route} used \`searchParams\` inside "use cache". Accessing dynamic request data inside a cache scope is not supported. If you need some search params inside a cached function await \`searchParams\` outside of the cached function and pass only the required search params as arguments to the cached function. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E842",enumerable:!1,configurable:!0});throw Error.captureStackTrace(u,c),s.invalidDynamicUsageError??=u,u}function a(){const s=i.afterTaskAsyncStorage.getStore();return s?.rootTaskSpawnPhase==="action"}})(Ed)),Ed}var Td={},xd={},hm;function t$(){return hm||(hm=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"createPromiseWithResolvers",{enumerable:!0,get:function(){return t}});function t(){let r,i;const n=new Promise((o,a)=>{r=o,i=a});return{resolve:r,reject:i,promise:n}}})(xd)),xd}var pm;function r$(){return pm||(pm=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0});function t(c,u){for(var d in u)Object.defineProperty(c,d,{enumerable:!0,get:u[d]})}t(e,{RenderStage:function(){return n},StagedRenderingController:function(){return o}});const r=Gl(),i=t$();var n=(function(c){return c[c.Before=1]="Before",c[c.Static=2]="Static",c[c.Runtime=3]="Runtime",c[c.Dynamic=4]="Dynamic",c[c.Abandoned=5]="Abandoned",c})({});class o{constructor(u=null,d){this.abortSignal=u,this.hasRuntimePrefetch=d,this.currentStage=1,this.staticInterruptReason=null,this.runtimeInterruptReason=null,this.staticStageEndTime=1/0,this.runtimeStageEndTime=1/0,this.runtimeStageListeners=[],this.dynamicStageListeners=[],this.runtimeStagePromise=(0,i.createPromiseWithResolvers)(),this.dynamicStagePromise=(0,i.createPromiseWithResolvers)(),this.mayAbandon=!1,u&&(u.addEventListener("abort",()=>{const{reason:l}=u;this.currentStage<3&&(this.runtimeStagePromise.promise.catch(a),this.runtimeStagePromise.reject(l)),(this.currentStage<4||this.currentStage===5)&&(this.dynamicStagePromise.promise.catch(a),this.dynamicStagePromise.reject(l))},{once:!0}),this.mayAbandon=!0)}onStage(u,d){if(this.currentStage>=u)d();else if(u===3)this.runtimeStageListeners.push(d);else if(u===4)this.dynamicStageListeners.push(d);else throw Object.defineProperty(new r.InvariantError(`Invalid render stage: ${u}`),"__NEXT_ERROR_CODE",{value:"E881",enumerable:!1,configurable:!0})}canSyncInterrupt(){if(this.currentStage===1)return!1;const u=this.hasRuntimePrefetch?4:3;return this.currentStage<u}syncInterruptCurrentStageWithReason(u){if(this.currentStage!==1){if(this.mayAbandon)return this.abandonRenderImpl();switch(this.currentStage){case 2:{this.staticInterruptReason=u,this.advanceStage(4);return}case 3:{this.hasRuntimePrefetch&&(this.runtimeInterruptReason=u,this.advanceStage(4));return}}}}getStaticInterruptReason(){return this.staticInterruptReason}getRuntimeInterruptReason(){return this.runtimeInterruptReason}getStaticStageEndTime(){return this.staticStageEndTime}getRuntimeStageEndTime(){return this.runtimeStageEndTime}abandonRender(){if(!this.mayAbandon)throw Object.defineProperty(new r.InvariantError("`abandonRender` called on a stage controller that cannot be abandoned."),"__NEXT_ERROR_CODE",{value:"E938",enumerable:!1,configurable:!0});this.abandonRenderImpl()}abandonRenderImpl(){const{currentStage:u}=this;switch(u){case 2:{this.currentStage=5,this.resolveRuntimeStage();return}case 3:{this.currentStage=5;return}}}advanceStage(u){if(u<=this.currentStage)return;let d=this.currentStage;if(this.currentStage=u,d<3&&u>=3&&(this.staticStageEndTime=performance.now()+performance.timeOrigin,this.resolveRuntimeStage()),d<4&&u>=4){this.runtimeStageEndTime=performance.now()+performance.timeOrigin,this.resolveDynamicStage();return}}resolveRuntimeStage(){const u=this.runtimeStageListeners;for(let d=0;d<u.length;d++)u[d]();u.length=0,this.runtimeStagePromise.resolve()}resolveDynamicStage(){const u=this.dynamicStageListeners;for(let d=0;d<u.length;d++)u[d]();u.length=0,this.dynamicStagePromise.resolve()}getStagePromise(u){switch(u){case 3:return this.runtimeStagePromise.promise;case 4:return this.dynamicStagePromise.promise;default:throw Object.defineProperty(new r.InvariantError(`Invalid render stage: ${u}`),"__NEXT_ERROR_CODE",{value:"E881",enumerable:!1,configurable:!0})}}waitForStage(u){return this.getStagePromise(u)}delayUntilStage(u,d,l){const f=this.getStagePromise(u),h=s(f,d,l);return this.abortSignal&&h.catch(a),h}}function a(){}function s(c,u,d){const l=new Promise((f,h)=>{c.then(f.bind(null,d),h)});return u!==void 0&&(l.displayName=u),l}})(Td)),Td}var mm;function n$(){return mm||(mm=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"headers",{enumerable:!0,get:function(){return d}});const t=sy(),r=ny(),i=ry(),n=iy(),o=Zl(),a=UN(),s=oy(),c=e$(),u=Gl();r$();function d(){const m="headers",v=r.workAsyncStorage.getStore(),b=i.workUnitAsyncStorage.getStore();if(v){if(b&&b.phase==="after"&&!(0,c.isRequestAPICallableInsideAfter)())throw Object.defineProperty(new Error(`Route ${v.route} used \`headers()\` inside \`after()\`. This is not supported. If you need this data inside an \`after()\` callback, use \`headers()\` outside of the callback. See more info here: https://nextjs.org/docs/canary/app/api-reference/functions/after`),"__NEXT_ERROR_CODE",{value:"E839",enumerable:!1,configurable:!0});if(v.forceStatic){const I=t.HeadersAdapter.seal(new Headers({}));return h(I)}if(b)switch(b.type){case"cache":{const I=Object.defineProperty(new Error(`Route ${v.route} used \`headers()\` inside "use cache". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \`headers()\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E833",enumerable:!1,configurable:!0});throw Error.captureStackTrace(I,d),v.invalidDynamicUsageError??=I,I}case"unstable-cache":throw Object.defineProperty(new Error(`Route ${v.route} used \`headers()\` inside a function cached with \`unstable_cache()\`. Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \`headers()\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`),"__NEXT_ERROR_CODE",{value:"E838",enumerable:!1,configurable:!0})}if(v.dynamicShouldError)throw Object.defineProperty(new o.StaticGenBailoutError(`Route ${v.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`headers()\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E828",enumerable:!1,configurable:!0});if(b)switch(b.type){case"prerender":return f(v,b);case"prerender-client":const I="`headers`";throw Object.defineProperty(new u.InvariantError(`${I} must not be used within a client component. Next.js should be preventing ${I} from being included in client components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E693",enumerable:!1,configurable:!0});case"prerender-ppr":return(0,n.postponeWithTracking)(v.route,m,b.dynamicTracking);case"prerender-legacy":return(0,n.throwToInterruptStaticGeneration)(m,v,b);case"prerender-runtime":return(0,n.delayUntilRuntimeStage)(b,h(b.headers));case"private-cache":return h(b.headers);case"request":return(0,n.trackDynamicDataInDynamicRender)(b),h(b.headers)}}(0,i.throwForMissingRequestStore)(m)}const l=new WeakMap;function f(m,v){const b=l.get(v);if(b)return b;const I=(0,a.makeHangingPromise)(v.renderSignal,m.route,"`headers()`");return l.set(v,I),I}function h(m){const v=l.get(m);if(v)return v;const b=Promise.resolve(m);return l.set(m,b),b}(0,s.createDedupedByCallsiteServerErrorLoggerDev)(g);function g(m,v){const b=m?`Route "${m}" `:"This route ";return Object.defineProperty(new Error(`${b}used ${v}. \`headers()\` returns a Promise and must be unwrapped with \`await\` or \`React.use()\` before accessing its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`),"__NEXT_ERROR_CODE",{value:"E836",enumerable:!1,configurable:!0})}})(Nd)),Nd}var i$=n$(),o$=sy(),Od,gm;function a$(){if(gm)return Od;gm=1;var e=Object.defineProperty,t=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyNames,i=Object.prototype.hasOwnProperty,n=(y,w)=>{for(var _ in w)e(y,_,{get:w[_],enumerable:!0})},o=(y,w,_,S)=>{if(w&&typeof w=="object"||typeof w=="function")for(let E of r(w))!i.call(y,E)&&E!==_&&e(y,E,{get:()=>w[E],enumerable:!(S=t(w,E))||S.enumerable});return y},a=y=>o(e({},"__esModule",{value:!0}),y),s={};n(s,{RequestCookies:()=>b,ResponseCookies:()=>I,parseCookie:()=>u,parseSetCookie:()=>d,stringifyCookie:()=>c}),Od=a(s);function c(y){var w;const _=["path"in y&&y.path&&`Path=${y.path}`,"expires"in y&&(y.expires||y.expires===0)&&`Expires=${(typeof y.expires=="number"?new Date(y.expires):y.expires).toUTCString()}`,"maxAge"in y&&typeof y.maxAge=="number"&&`Max-Age=${y.maxAge}`,"domain"in y&&y.domain&&`Domain=${y.domain}`,"secure"in y&&y.secure&&"Secure","httpOnly"in y&&y.httpOnly&&"HttpOnly","sameSite"in y&&y.sameSite&&`SameSite=${y.sameSite}`,"partitioned"in y&&y.partitioned&&"Partitioned","priority"in y&&y.priority&&`Priority=${y.priority}`].filter(Boolean),S=`${y.name}=${encodeURIComponent((w=y.value)!=null?w:"")}`;return _.length===0?S:`${S}; ${_.join("; ")}`}function u(y){const w=new Map;for(const _ of y.split(/; */)){if(!_)continue;const S=_.indexOf("=");if(S===-1){w.set(_,"true");continue}const[E,k]=[_.slice(0,S),_.slice(S+1)];try{w.set(E,decodeURIComponent(k??"true"))}catch{}}return w}function d(y){if(!y)return;const[[w,_],...S]=u(y),{domain:E,expires:k,httponly:U,maxage:P,path:T,samesite:A,secure:O,partitioned:R,priority:W}=Object.fromEntries(S.map(([C,B])=>[C.toLowerCase().replace(/-/g,""),B])),z={name:w,value:decodeURIComponent(_),domain:E,...k&&{expires:new Date(k)},...U&&{httpOnly:!0},...typeof P=="string"&&{maxAge:Number(P)},path:T,...A&&{sameSite:h(A)},...O&&{secure:!0},...W&&{priority:m(W)},...R&&{partitioned:!0}};return l(z)}function l(y){const w={};for(const _ in y)y[_]&&(w[_]=y[_]);return w}var f=["strict","lax","none"];function h(y){return y=y.toLowerCase(),f.includes(y)?y:void 0}var g=["low","medium","high"];function m(y){return y=y.toLowerCase(),g.includes(y)?y:void 0}function v(y){if(!y)return[];var w=[],_=0,S,E,k,U,P;function T(){for(;_<y.length&&/\s/.test(y.charAt(_));)_+=1;return _<y.length}function A(){return E=y.charAt(_),E!=="="&&E!==";"&&E!==","}for(;_<y.length;){for(S=_,P=!1;T();)if(E=y.charAt(_),E===","){for(k=_,_+=1,T(),U=_;_<y.length&&A();)_+=1;_<y.length&&y.charAt(_)==="="?(P=!0,_=U,w.push(y.substring(S,k)),S=_):_=k+1}else _+=1;(!P||_>=y.length)&&w.push(y.substring(S,y.length))}return w}var b=class{constructor(y){this._parsed=new Map,this._headers=y;const w=y.get("cookie");if(w){const _=u(w);for(const[S,E]of _)this._parsed.set(S,{name:S,value:E})}}[Symbol.iterator](){return this._parsed[Symbol.iterator]()}get size(){return this._parsed.size}get(...y){const w=typeof y[0]=="string"?y[0]:y[0].name;return this._parsed.get(w)}getAll(...y){var w;const _=Array.from(this._parsed);if(!y.length)return _.map(([E,k])=>k);const S=typeof y[0]=="string"?y[0]:(w=y[0])==null?void 0:w.name;return _.filter(([E])=>E===S).map(([E,k])=>k)}has(y){return this._parsed.has(y)}set(...y){const[w,_]=y.length===1?[y[0].name,y[0].value]:y,S=this._parsed;return S.set(w,{name:w,value:_}),this._headers.set("cookie",Array.from(S).map(([E,k])=>c(k)).join("; ")),this}delete(y){const w=this._parsed,_=Array.isArray(y)?y.map(S=>w.delete(S)):w.delete(y);return this._headers.set("cookie",Array.from(w).map(([S,E])=>c(E)).join("; ")),_}clear(){return this.delete(Array.from(this._parsed.keys())),this}[Symbol.for("edge-runtime.inspect.custom")](){return`RequestCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(y=>`${y.name}=${encodeURIComponent(y.value)}`).join("; ")}},I=class{constructor(y){this._parsed=new Map;var w,_,S;this._headers=y;const E=(S=(_=(w=y.getSetCookie)==null?void 0:w.call(y))!=null?_:y.get("set-cookie"))!=null?S:[],k=Array.isArray(E)?E:v(E);for(const U of k){const P=d(U);P&&this._parsed.set(P.name,P)}}get(...y){const w=typeof y[0]=="string"?y[0]:y[0].name;return this._parsed.get(w)}getAll(...y){var w;const _=Array.from(this._parsed.values());if(!y.length)return _;const S=typeof y[0]=="string"?y[0]:(w=y[0])==null?void 0:w.name;return _.filter(E=>E.name===S)}has(y){return this._parsed.has(y)}set(...y){const[w,_,S]=y.length===1?[y[0].name,y[0].value,y[0]]:y,E=this._parsed;return E.set(w,N({name:w,value:_,...S})),x(E,this._headers),this}delete(...y){const[w,_]=typeof y[0]=="string"?[y[0]]:[y[0].name,y[0]];return this.set({..._,name:w,value:"",expires:new Date(0)})}[Symbol.for("edge-runtime.inspect.custom")](){return`ResponseCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(c).join("; ")}};function x(y,w){w.delete("set-cookie");for(const[,_]of y){const S=c(_);w.append("set-cookie",S)}}function N(y={name:"",value:""}){return typeof y.expires=="number"&&(y.expires=new Date(y.expires)),y.maxAge&&(y.expires=new Date(Date.now()+y.maxAge*1e3)),(y.path===null||y.path===void 0)&&(y.path="/"),y}return Od}var s$=a$();const{fn:vt}=__STORYBOOK_MODULE_TEST__;var cy=class extends o$.HeadersAdapter{constructor(){super({}),this.append=vt(super.append.bind(this)).mockName("next/headers::headers().append"),this.delete=vt(super.delete.bind(this)).mockName("next/headers::headers().delete"),this.get=vt(super.get.bind(this)).mockName("next/headers::headers().get"),this.has=vt(super.has.bind(this)).mockName("next/headers::headers().has"),this.set=vt(super.set.bind(this)).mockName("next/headers::headers().set"),this.forEach=vt(super.forEach.bind(this)).mockName("next/headers::headers().forEach"),this.entries=vt(super.entries.bind(this)).mockName("next/headers::headers().entries"),this.keys=vt(super.keys.bind(this)).mockName("next/headers::headers().keys"),this.values=vt(super.values.bind(this)).mockName("next/headers::headers().values")}},Ws,Bi=()=>(Ws||(Ws=new cy),Ws);Bi.mockRestore=()=>{Ws=new cy};var uy=class extends s$.RequestCookies{constructor(){super(...arguments),this.get=vt(super.get.bind(this)).mockName("next/headers::cookies().get"),this.getAll=vt(super.getAll.bind(this)).mockName("next/headers::cookies().getAll"),this.has=vt(super.has.bind(this)).mockName("next/headers::cookies().has"),this.set=vt(super.set.bind(this)).mockName("next/headers::cookies().set"),this.delete=vt(super.delete.bind(this)).mockName("next/headers::cookies().delete")}},Fs,Yl=vt(()=>(Fs||(Fs=new uy(Bi())),Fs)).mockName("next/headers::cookies()"),c$=Yl.mockRestore.bind(null);Yl.mockRestore=()=>{c$(),Bi.mockRestore(),Fs=new uy(Bi())};vt(QN.draftMode??i$.draftMode).mockName("draftMode");const u$=Object.freeze(Object.defineProperty({__proto__:null,cookies:Yl,headers:Bi},Symbol.toStringTag,{value:"Module"}));var Dd={exports:{}};const d$={},l$=Object.freeze(Object.defineProperty({__proto__:null,default:d$},Symbol.toStringTag,{value:"Module"})),xs=CN(l$);var ym;function f$(){if(ym)return Dd.exports;ym=1;var e={};return(()=>{var t={383:o=>{function a(d,l){const f=Array.from(d.matchAll(l));return f.length>0?f.slice(-1)[0].index:-1}function s(d,l,f){const h=a(d,new RegExp("(?!(?<=\\\\))\\$","g"));if(h===-1)return d;const g=d.slice(h),m=new RegExp("((?!(?<=\\\\))\\${?([\\w]+)(?::-([^}\\\\]*))?}?)"),v=g.match(m);if(v!=null){const[,b,I,x]=v;return s(d.replace(b,l[I]||x||f.parsed[I]||""),l,f)}return d}function c(d){return d.replace(/\\\$/g,"$")}function u(d){const l=d.ignoreProcessEnv?{}:e;for(const f in d.parsed){const h=Object.prototype.hasOwnProperty.call(l,f)?l[f]:d.parsed[f];d.parsed[f]=c(s(h,l,d))}for(const f in d.parsed)l[f]=d.parsed[f];return d}o.exports.j=u},234:(o,a,s)=>{const c=s(147),u=s(17),d=s(37),l=s(113),h=s(803).version,g=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/gm;function m(A){const O={};let R=A.toString();R=R.replace(/\r\n?/gm,`
`);let W;for(;(W=g.exec(R))!=null;){const z=W[1];let C=W[2]||"";C=C.trim();const B=C[0];C=C.replace(/^(['"`])([\s\S]*)\1$/gm,"$2"),B==='"'&&(C=C.replace(/\\n/g,`
`),C=C.replace(/\\r/g,"\r")),O[z]=C}return O}function v(A){const O=w(A),R=T.configDotenv({path:O});if(!R.parsed)throw new Error(`MISSING_DATA: Cannot parse ${O} for an unknown reason`);const W=N(A).split(","),z=W.length;let C;for(let B=0;B<z;B++)try{const Z=W[B].trim(),se=y(R,Z);C=T.decrypt(se.ciphertext,se.key);break}catch(Z){if(B+1>=z)throw Z}return T.parse(C)}function b(A){console.log(`[dotenv@${h}][INFO] ${A}`)}function I(A){console.log(`[dotenv@${h}][WARN] ${A}`)}function x(A){console.log(`[dotenv@${h}][DEBUG] ${A}`)}function N(A){return A&&A.DOTENV_KEY&&A.DOTENV_KEY.length>0?A.DOTENV_KEY:e.DOTENV_KEY&&e.DOTENV_KEY.length>0?e.DOTENV_KEY:""}function y(A,O){let R;try{R=new URL(O)}catch(Z){throw Z.code==="ERR_INVALID_URL"?new Error("INVALID_DOTENV_KEY: Wrong format. Must be in valid uri format like dotenv://:key_1234@dotenv.org/vault/.env.vault?environment=development"):Z}const W=R.password;if(!W)throw new Error("INVALID_DOTENV_KEY: Missing key part");const z=R.searchParams.get("environment");if(!z)throw new Error("INVALID_DOTENV_KEY: Missing environment part");const C=`DOTENV_VAULT_${z.toUpperCase()}`,B=A.parsed[C];if(!B)throw new Error(`NOT_FOUND_DOTENV_ENVIRONMENT: Cannot locate environment ${C} in your .env.vault file.`);return{ciphertext:B,key:W}}function w(A){let O=u.resolve(process.cwd(),".env");return A&&A.path&&A.path.length>0&&(O=A.path),O.endsWith(".vault")?O:`${O}.vault`}function _(A){return A[0]==="~"?u.join(d.homedir(),A.slice(1)):A}function S(A){b("Loading env from encrypted .env.vault");const O=T._parseVault(A);let R=e;return A&&A.processEnv!=null&&(R=A.processEnv),T.populate(R,O,A),{parsed:O}}function E(A){let O=u.resolve(process.cwd(),".env"),R="utf8";const W=!!(A&&A.debug);A&&(A.path!=null&&(O=_(A.path)),A.encoding!=null&&(R=A.encoding));try{const z=T.parse(c.readFileSync(O,{encoding:R}));let C=e;return A&&A.processEnv!=null&&(C=A.processEnv),T.populate(C,z,A),{parsed:z}}catch(z){return W&&x(`Failed to load ${O} ${z.message}`),{error:z}}}function k(A){const O=w(A);return N(A).length===0?T.configDotenv(A):c.existsSync(O)?T._configVault(A):(I(`You set DOTENV_KEY but you are missing a .env.vault file at ${O}. Did you forget to build it?`),T.configDotenv(A))}function U(A,O){const R=Buffer.from(O.slice(-64),"hex");let W=Buffer.from(A,"base64");const z=W.slice(0,12),C=W.slice(-16);W=W.slice(12,-16);try{const B=l.createDecipheriv("aes-256-gcm",R,z);return B.setAuthTag(C),`${B.update(W)}${B.final()}`}catch(B){const Z=B instanceof RangeError,se=B.message==="Invalid key length",ue=B.message==="Unsupported state or unable to authenticate data";if(Z||se){const Qe="INVALID_DOTENV_KEY: It must be 64 characters long (or more)";throw new Error(Qe)}else if(ue){const Qe="DECRYPTION_FAILED: Please check your DOTENV_KEY";throw new Error(Qe)}else throw console.error("Error: ",B.code),console.error("Error: ",B.message),B}}function P(A,O,R={}){const W=!!(R&&R.debug),z=!!(R&&R.override);if(typeof O!="object")throw new Error("OBJECT_REQUIRED: Please check the processEnv argument being passed to populate");for(const C of Object.keys(O))Object.prototype.hasOwnProperty.call(A,C)?(z===!0&&(A[C]=O[C]),W&&x(z===!0?`"${C}" is already defined and WAS overwritten`:`"${C}" is already defined and was NOT overwritten`)):A[C]=O[C]}const T={configDotenv:E,_configVault:S,_parseVault:v,config:k,decrypt:U,parse:m,populate:P};o.exports.configDotenv=T.configDotenv,o.exports._configVault=T._configVault,o.exports._parseVault=T._parseVault,o.exports.config=T.config,o.exports.decrypt=T.decrypt,o.exports.parse=T.parse,o.exports.populate=T.populate,o.exports=T},113:o=>{o.exports=xs},147:o=>{o.exports=xs},37:o=>{o.exports=xs},17:o=>{o.exports=xs},803:o=>{o.exports=JSON.parse('{"name":"dotenv","version":"16.3.1","description":"Loads environment variables from .env file","main":"lib/main.js","types":"lib/main.d.ts","exports":{".":{"types":"./lib/main.d.ts","require":"./lib/main.js","default":"./lib/main.js"},"./config":"./config.js","./config.js":"./config.js","./lib/env-options":"./lib/env-options.js","./lib/env-options.js":"./lib/env-options.js","./lib/cli-options":"./lib/cli-options.js","./lib/cli-options.js":"./lib/cli-options.js","./package.json":"./package.json"},"scripts":{"dts-check":"tsc --project tests/types/tsconfig.json","lint":"standard","lint-readme":"standard-markdown","pretest":"npm run lint && npm run dts-check","test":"tap tests/*.js --100 -Rspec","prerelease":"npm test","release":"standard-version"},"repository":{"type":"git","url":"git://github.com/motdotla/dotenv.git"},"funding":"https://github.com/motdotla/dotenv?sponsor=1","keywords":["dotenv","env",".env","environment","variables","config","settings"],"readmeFilename":"README.md","license":"BSD-2-Clause","devDependencies":{"@definitelytyped/dtslint":"^0.0.133","@types/node":"^18.11.3","decache":"^4.6.1","sinon":"^14.0.1","standard":"^17.0.0","standard-markdown":"^7.1.0","standard-version":"^9.5.0","tap":"^16.3.0","tar":"^6.1.11","typescript":"^4.8.4"},"engines":{"node":">=12"},"browser":{"fs":false}}')}},r={};function i(o){var a=r[o];if(a!==void 0)return a.exports;var s=r[o]={exports:{}},c=!0;try{t[o](s,s.exports,i),c=!1}finally{c&&delete r[o]}return s.exports}i.n=o=>{var a=o&&o.__esModule?()=>o.default:()=>o;return i.d(a,{a}),a},i.d=(o,a)=>{for(var s in a)i.o(a,s)&&!i.o(o,s)&&Object.defineProperty(o,s,{enumerable:!0,get:a[s]})},i.o=(o,a)=>Object.prototype.hasOwnProperty.call(o,a),i.r=o=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},typeof i<"u"&&(i.ab=__dirname+"/");var n={};(()=>{i.r(n),i.d(n,{initialEnv:()=>u,updateInitialEnv:()=>g,processEnv:()=>v,resetEnv:()=>b,loadEnvConfig:()=>I});var o=i(147);i.n(o);var a=i(17);i.n(a);var s=i(234);i.n(s);var c=i(383);let u,d,l,f=[],h=[];function g(x){Object.assign(u||{},x)}function m(x){Object.keys(e).forEach((N=>{N.startsWith("__NEXT_PRIVATE")||(x[N]===void 0||x[N]==="")&&delete e[N]})),Object.entries(x).forEach((([N,y])=>{e[N]=y}))}function v(x,N,y=console,w=!1,_){var S;if(u||(u=Object.assign({},e)),!w&&(e.__NEXT_PROCESSED_ENV||x.length===0))return[e];e.__NEXT_PROCESSED_ENV="true";const E=Object.assign({},u),k={};for(const U of x)try{let P={};P.parsed=s.parse(U.contents),P=(0,c.j)(P),P.parsed&&!h.some((T=>T.contents===U.contents&&T.path===U.path))&&_?.(U.path);for(const T of Object.keys(P.parsed||{}))typeof k[T]>"u"&&typeof E[T]>"u"&&(k[T]=(S=P.parsed)===null||S===void 0?void 0:S[T]);U.env=P.parsed||{}}catch(P){y.error(`Failed to load env from ${a.join(N||"",U.path)}`,P)}return[Object.assign(e,k),k]}function b(){u&&m(u)}function I(x,N,y=console,w=!1,_){if(u||(u=Object.assign({},e)),d&&!w)return{combinedEnv:d,parsedEnv:l,loadedEnvFiles:f};m(u),h=f,f=[];const S=N?"development":"production",E=[`.env.${S}.local`,S!=="test"&&".env.local",`.env.${S}`,".env"].filter(Boolean);for(const k of E){const U=a.join(x,k);try{const P=o.statSync(U);if(!P.isFile()&&!P.isFIFO())continue;const T=o.readFileSync(U,"utf8");f.push({path:k,contents:T,env:{}})}catch(P){P.code!=="ENOENT"&&y.error(`Failed to load env from ${k}`,P)}}return[d,l]=v(f,x,y,w,_),{combinedEnv:d,parsedEnv:l,loadedEnvFiles:f}}})(),Dd.exports=n})(),Dd.exports}var h$=f$();const p$=PN(h$),j=Symbol.for("drizzle:entityKind");function de(e,t){if(!e||typeof e!="object")return!1;if(e instanceof t)return!0;if(!Object.prototype.hasOwnProperty.call(t,j))throw new Error(`Class "${t.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let r=Object.getPrototypeOf(e).constructor;if(r)for(;r;){if(j in r&&r[j]===t[j])return!0;r=Object.getPrototypeOf(r)}return!1}class uo{constructor(t,r){this.table=t,this.config=r,this.name=r.name,this.keyAsName=r.keyAsName,this.notNull=r.notNull,this.default=r.default,this.defaultFn=r.defaultFn,this.onUpdateFn=r.onUpdateFn,this.hasDefault=r.hasDefault,this.primary=r.primaryKey,this.isUnique=r.isUnique,this.uniqueName=r.uniqueName,this.uniqueType=r.uniqueType,this.dataType=r.dataType,this.columnType=r.columnType,this.generated=r.generated,this.generatedIdentity=r.generatedIdentity}static[j]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(t){return t}mapToDriverValue(t){return t}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}}class m${static[j]="ColumnBuilder";config;constructor(t,r,i){this.config={name:t,keyAsName:t==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:r,columnType:i,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(t){return this.config.default=t,this.config.hasDefault=!0,this}$defaultFn(t){return this.config.defaultFn=t,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(t){return this.config.onUpdateFn=t,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(t){this.config.name===""&&(this.config.name=t)}}const Pi=Symbol.for("drizzle:Name"),wm=Symbol.for("drizzle:isPgEnum");function g$(e){return!!e&&typeof e=="function"&&wm in e&&e[wm]===!0}class On{static[j]="Subquery";constructor(t,r,i,n=!1,o=[]){this._={brand:"Subquery",sql:t,selectedFields:r,alias:i,isWith:n,usedTables:o}}}const y$={startActiveSpan(e,t){return t()}},Mt=Symbol.for("drizzle:ViewBaseConfig"),Rd=Symbol.for("drizzle:Schema"),vm=Symbol.for("drizzle:Columns"),bm=Symbol.for("drizzle:ExtraConfigColumns"),Ud=Symbol.for("drizzle:OriginalName"),Cd=Symbol.for("drizzle:BaseName"),ec=Symbol.for("drizzle:IsAlias"),_m=Symbol.for("drizzle:ExtraConfigBuilder"),w$=Symbol.for("drizzle:IsDrizzleTable");class we{static[j]="Table";static Symbol={Name:Pi,Schema:Rd,OriginalName:Ud,Columns:vm,ExtraConfigColumns:bm,BaseName:Cd,IsAlias:ec,ExtraConfigBuilder:_m};[Pi];[Ud];[Rd];[vm];[bm];[Cd];[ec]=!1;[w$]=!0;[_m]=void 0;constructor(t,r,i){this[Pi]=this[Ud]=t,this[Rd]=r,this[Cd]=i}}function v$(e){return e!=null&&typeof e.getSQL=="function"}function b$(e){const t={sql:"",params:[]};for(const r of e)t.sql+=r.sql,t.params.push(...r.params),r.typings?.length&&(t.typings||(t.typings=[]),t.typings.push(...r.typings));return t}class cr{static[j]="StringChunk";value;constructor(t){this.value=Array.isArray(t)?t:[t]}getSQL(){return new Ie([this])}}class Ie{constructor(t){this.queryChunks=t;for(const r of t)if(de(r,we)){const i=r[we.Symbol.Schema];this.usedTables.push(i===void 0?r[we.Symbol.Name]:i+"."+r[we.Symbol.Name])}}static[j]="SQL";decoder=dy;shouldInlineParams=!1;usedTables=[];append(t){return this.queryChunks.push(...t.queryChunks),this}toQuery(t){return y$.startActiveSpan("drizzle.buildSQL",r=>{const i=this.buildQueryFromSourceParams(this.queryChunks,t);return r?.setAttributes({"drizzle.query.text":i.sql,"drizzle.query.params":JSON.stringify(i.params)}),i})}buildQueryFromSourceParams(t,r){const i=Object.assign({},r,{inlineParams:r.inlineParams||this.shouldInlineParams,paramStartIndex:r.paramStartIndex||{value:0}}),{casing:n,escapeName:o,escapeParam:a,prepareTyping:s,inlineParams:c,paramStartIndex:u}=i;return b$(t.map(d=>{if(de(d,cr))return{sql:d.value.join(""),params:[]};if(de(d,nl))return{sql:o(d.value),params:[]};if(d===void 0)return{sql:"",params:[]};if(Array.isArray(d)){const l=[new cr("(")];for(const[f,h]of d.entries())l.push(h),f<d.length-1&&l.push(new cr(", "));return l.push(new cr(")")),this.buildQueryFromSourceParams(l,i)}if(de(d,Ie))return this.buildQueryFromSourceParams(d.queryChunks,{...i,inlineParams:c||d.shouldInlineParams});if(de(d,we)){const l=d[we.Symbol.Schema],f=d[we.Symbol.Name];return{sql:l===void 0||d[ec]?o(f):o(l)+"."+o(f),params:[]}}if(de(d,uo)){const l=n.getColumnCasing(d);if(r.invokeSource==="indexes")return{sql:o(l),params:[]};const f=d.table[we.Symbol.Schema];return{sql:d.table[ec]||f===void 0?o(d.table[we.Symbol.Name])+"."+o(l):o(f)+"."+o(d.table[we.Symbol.Name])+"."+o(l),params:[]}}if(de(d,Rc)){const l=d[Mt].schema,f=d[Mt].name;return{sql:l===void 0||d[Mt].isAlias?o(f):o(l)+"."+o(f),params:[]}}if(de(d,fy)){if(de(d.value,ol))return{sql:a(u.value++,d),params:[d],typings:["none"]};const l=d.value===null?null:d.encoder.mapToDriverValue(d.value);if(de(l,Ie))return this.buildQueryFromSourceParams([l],i);if(c)return{sql:this.mapInlineParam(l,i),params:[]};let f=["none"];return s&&(f=[s(d.encoder)]),{sql:a(u.value++,l),params:[l],typings:f}}return de(d,ol)?{sql:a(u.value++,d),params:[d],typings:["none"]}:de(d,Ie.Aliased)&&d.fieldAlias!==void 0?{sql:o(d.fieldAlias),params:[]}:de(d,On)?d._.isWith?{sql:o(d._.alias),params:[]}:this.buildQueryFromSourceParams([new cr("("),d._.sql,new cr(") "),new nl(d._.alias)],i):g$(d)?d.schema?{sql:o(d.schema)+"."+o(d.enumName),params:[]}:{sql:o(d.enumName),params:[]}:v$(d)?d.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([d.getSQL()],i):this.buildQueryFromSourceParams([new cr("("),d.getSQL(),new cr(")")],i):c?{sql:this.mapInlineParam(d,i),params:[]}:{sql:a(u.value++,d),params:[d],typings:["none"]}}))}mapInlineParam(t,{escapeString:r}){if(t===null)return"null";if(typeof t=="number"||typeof t=="boolean")return t.toString();if(typeof t=="string")return r(t);if(typeof t=="object"){const i=t.toString();return r(i==="[object Object]"?JSON.stringify(t):i)}throw new Error("Unexpected param value: "+t)}getSQL(){return this}as(t){return t===void 0?this:new Ie.Aliased(this,t)}mapWith(t){return this.decoder=typeof t=="function"?{mapFromDriverValue:t}:t,this}inlineParams(){return this.shouldInlineParams=!0,this}if(t){return t?this:void 0}}class nl{constructor(t){this.value=t}static[j]="Name";brand;getSQL(){return new Ie([this])}}const dy={mapFromDriverValue:e=>e},ly={mapToDriverValue:e=>e};({...dy,...ly});class fy{constructor(t,r=ly){this.value=t,this.encoder=r}static[j]="Param";brand;getSQL(){return new Ie([this])}}function il(e,...t){const r=[];(t.length>0||e.length>0&&e[0]!=="")&&r.push(new cr(e[0]));for(const[i,n]of t.entries())r.push(n,new cr(e[i+1]));return new Ie(r)}(e=>{function t(){return new Ie([])}e.empty=t;function r(c){return new Ie(c)}e.fromList=r;function i(c){return new Ie([new cr(c)])}e.raw=i;function n(c,u){const d=[];for(const[l,f]of c.entries())l>0&&u!==void 0&&d.push(u),d.push(f);return new Ie(d)}e.join=n;function o(c){return new nl(c)}e.identifier=o;function a(c){return new ol(c)}e.placeholder=a;function s(c,u){return new fy(c,u)}e.param=s})(il||(il={}));(e=>{class t{constructor(i,n){this.sql=i,this.fieldAlias=n}static[j]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new t(this.sql,this.fieldAlias)}}e.Aliased=t})(Ie||(Ie={}));class ol{constructor(t){this.name=t}static[j]="Placeholder";getSQL(){return new Ie([this])}}const _$=Symbol.for("drizzle:IsDrizzleView");class Rc{static[j]="View";[Mt];[_$]=!0;constructor({name:t,schema:r,selectedFields:i,query:n}){this[Mt]={name:t,originalName:t,schema:r,selectedFields:i,query:n,isExisting:!n,isAlias:!1}}getSQL(){return new Ie([this])}}uo.prototype.getSQL=function(){return new Ie([this])};we.prototype.getSQL=function(){return new Ie([this])};On.prototype.getSQL=function(){return new Ie([this])};class al{constructor(t){this.table=t}static[j]="ColumnAliasProxyHandler";get(t,r){return r==="table"?this.table:t[r]}}class S${constructor(t,r){this.alias=t,this.replaceOriginalName=r}static[j]="TableAliasProxyHandler";get(t,r){if(r===we.Symbol.IsAlias)return!0;if(r===we.Symbol.Name)return this.alias;if(this.replaceOriginalName&&r===we.Symbol.OriginalName)return this.alias;if(r===Mt)return{...t[Mt],name:this.alias,isAlias:!0};if(r===we.Symbol.Columns){const n=t[we.Symbol.Columns];if(!n)return n;const o={};return Object.keys(n).map(a=>{o[a]=new Proxy(n[a],new al(new Proxy(t,this)))}),o}const i=t[r];return de(i,uo)?new Proxy(i,new al(new Proxy(t,this))):i}}function sl(e,t){return Object.entries(e).reduce((r,[i,n])=>{if(typeof i!="string")return r;const o=t?[...t,i]:[i];return de(n,uo)||de(n,Ie)||de(n,Ie.Aliased)||de(n,On)?r.push({path:o,field:n}):de(n,we)?r.push(...sl(n[we.Symbol.Columns],o)):r.push(...sl(n,o)),r},[])}function hy(e,t){const r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(const[n,o]of r.entries())if(o!==i[n])return!1;return!0}function k$(e,t){for(const r of t)for(const i of Object.getOwnPropertyNames(r.prototype))i!=="constructor"&&Object.defineProperty(e.prototype,i,Object.getOwnPropertyDescriptor(r.prototype,i)||Object.create(null))}function Sm(e){return de(e,On)?e._.alias:de(e,Rc)?e[Mt].name:de(e,Ie)?void 0:e[we.Symbol.IsAlias]?e[we.Symbol.Name]:e[we.Symbol.BaseName]}function Ve(e,t){return{name:typeof e=="string"&&e.length>0?e:"",config:typeof e=="object"?e:t}}typeof TextDecoder>"u"||new TextDecoder;class N${static[j]="MySqlForeignKeyBuilder";reference;_onUpdate;_onDelete;constructor(t,r){this.reference=()=>{const{name:i,columns:n,foreignColumns:o}=t();return{name:i,columns:n,foreignTable:o[0].table,foreignColumns:o}},r&&(this._onUpdate=r.onUpdate,this._onDelete=r.onDelete)}onUpdate(t){return this._onUpdate=t,this}onDelete(t){return this._onDelete=t,this}build(t){return new $$(t,this)}}class $${constructor(t,r){this.table=t,this.reference=r.reference,this.onUpdate=r._onUpdate,this.onDelete=r._onDelete}static[j]="MySqlForeignKey";reference;onUpdate;onDelete;getName(){const{name:t,columns:r,foreignColumns:i}=this.reference(),n=r.map(s=>s.name),o=i.map(s=>s.name),a=[this.table[Pi],...n,i[0].table[Pi],...o];return t??`${a.join("_")}_fk`}}function E$(e,t){return`${e[Pi]}_${t.join("_")}_unique`}class ut extends m${static[j]="MySqlColumnBuilder";foreignKeyConfigs=[];references(t,r={}){return this.foreignKeyConfigs.push({ref:t,actions:r}),this}unique(t){return this.config.isUnique=!0,this.config.uniqueName=t,this}generatedAlwaysAs(t,r){return this.config.generated={as:t,type:"always",mode:r?.mode??"virtual"},this}buildForeignKeys(t,r){return this.foreignKeyConfigs.map(({ref:i,actions:n})=>((o,a)=>{const s=new N$(()=>{const c=o();return{columns:[t],foreignColumns:[c]}});return a.onUpdate&&s.onUpdate(a.onUpdate),a.onDelete&&s.onDelete(a.onDelete),s.build(r)})(i,n))}}class dt extends uo{constructor(t,r){r.uniqueName||(r.uniqueName=E$(t,[r.name])),super(t,r),this.table=t}static[j]="MySqlColumn"}class Kt extends ut{static[j]="MySqlColumnBuilderWithAutoIncrement";constructor(t,r,i){super(t,r,i),this.config.autoIncrement=!1}autoincrement(){return this.config.autoIncrement=!0,this.config.hasDefault=!0,this}}class Jt extends dt{static[j]="MySqlColumnWithAutoIncrement";autoIncrement=this.config.autoIncrement}class A$ extends Kt{static[j]="MySqlBigInt53Builder";constructor(t,r=!1){super(t,"number","MySqlBigInt53"),this.config.unsigned=r}build(t){return new I$(t,this.config)}}class I$ extends Jt{static[j]="MySqlBigInt53";getSQLType(){return`bigint${this.config.unsigned?" unsigned":""}`}mapFromDriverValue(t){return typeof t=="number"?t:Number(t)}}class T$ extends Kt{static[j]="MySqlBigInt64Builder";constructor(t,r=!1){super(t,"bigint","MySqlBigInt64"),this.config.unsigned=r}build(t){return new x$(t,this.config)}}class x$ extends Jt{static[j]="MySqlBigInt64";getSQLType(){return`bigint${this.config.unsigned?" unsigned":""}`}mapFromDriverValue(t){return BigInt(t)}}function O$(e,t){const{name:r,config:i}=Ve(e,t);return i.mode==="number"?new A$(r,i.unsigned):new T$(r,i.unsigned)}class D$ extends ut{static[j]="MySqlBinaryBuilder";constructor(t,r){super(t,"string","MySqlBinary"),this.config.length=r}build(t){return new R$(t,this.config)}}class R$ extends dt{static[j]="MySqlBinary";length=this.config.length;mapFromDriverValue(t){if(typeof t=="string")return t;if(Buffer.isBuffer(t))return t.toString();const r=[];for(const i of t)r.push(i===49?"1":"0");return r.join("")}getSQLType(){return this.length===void 0?"binary":`binary(${this.length})`}}function U$(e,t={}){const{name:r,config:i}=Ve(e,t);return new D$(r,i.length)}class C$ extends ut{static[j]="MySqlBooleanBuilder";constructor(t){super(t,"boolean","MySqlBoolean")}build(t){return new P$(t,this.config)}}class P$ extends dt{static[j]="MySqlBoolean";getSQLType(){return"boolean"}mapFromDriverValue(t){return typeof t=="boolean"?t:t===1}}function zn(e){return new C$(e??"")}class L$ extends ut{static[j]="MySqlCharBuilder";constructor(t,r){super(t,"string","MySqlChar"),this.config.length=r.length,this.config.enum=r.enum}build(t){return new z$(t,this.config)}}class z$ extends dt{static[j]="MySqlChar";length=this.config.length;enumValues=this.config.enum;getSQLType(){return this.length===void 0?"char":`char(${this.length})`}}function j$(e,t={}){const{name:r,config:i}=Ve(e,t);return new L$(r,i)}class M$ extends ut{static[j]="MySqlCustomColumnBuilder";constructor(t,r,i){super(t,"custom","MySqlCustomColumn"),this.config.fieldConfig=r,this.config.customTypeParams=i}build(t){return new q$(t,this.config)}}class q$ extends dt{static[j]="MySqlCustomColumn";sqlName;mapTo;mapFrom;constructor(t,r){super(t,r),this.sqlName=r.customTypeParams.dataType(r.fieldConfig),this.mapTo=r.customTypeParams.toDriver,this.mapFrom=r.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(t){return typeof this.mapFrom=="function"?this.mapFrom(t):t}mapToDriverValue(t){return typeof this.mapTo=="function"?this.mapTo(t):t}}function W$(e){return(t,r)=>{const{name:i,config:n}=Ve(t,r);return new M$(i,n,e)}}class F$ extends ut{static[j]="MySqlDateBuilder";constructor(t){super(t,"date","MySqlDate")}build(t){return new B$(t,this.config)}}class B$ extends dt{static[j]="MySqlDate";constructor(t,r){super(t,r)}getSQLType(){return"date"}mapFromDriverValue(t){return new Date(t)}}class V$ extends ut{static[j]="MySqlDateStringBuilder";constructor(t){super(t,"string","MySqlDateString")}build(t){return new K$(t,this.config)}}class K$ extends dt{static[j]="MySqlDateString";constructor(t,r){super(t,r)}getSQLType(){return"date"}}function J$(e,t){const{name:r,config:i}=Ve(e,t);return i?.mode==="string"?new V$(r):new F$(r)}class H$ extends ut{static[j]="MySqlDateTimeBuilder";constructor(t,r){super(t,"date","MySqlDateTime"),this.config.fsp=r?.fsp}build(t){return new Z$(t,this.config)}}class Z$ extends dt{static[j]="MySqlDateTime";fsp;constructor(t,r){super(t,r),this.fsp=r.fsp}getSQLType(){return`datetime${this.fsp===void 0?"":`(${this.fsp})`}`}mapToDriverValue(t){return t.toISOString().replace("T"," ").replace("Z","")}mapFromDriverValue(t){return new Date(t.replace(" ","T")+"Z")}}class G$ extends ut{static[j]="MySqlDateTimeStringBuilder";constructor(t,r){super(t,"string","MySqlDateTimeString"),this.config.fsp=r?.fsp}build(t){return new Q$(t,this.config)}}class Q$ extends dt{static[j]="MySqlDateTimeString";fsp;constructor(t,r){super(t,r),this.fsp=r.fsp}getSQLType(){return`datetime${this.fsp===void 0?"":`(${this.fsp})`}`}}function qe(e,t){const{name:r,config:i}=Ve(e,t);return i?.mode==="string"?new G$(r,i):new H$(r,i)}class Y$ extends Kt{static[j]="MySqlDecimalBuilder";constructor(t,r){super(t,"string","MySqlDecimal"),this.config.precision=r?.precision,this.config.scale=r?.scale,this.config.unsigned=r?.unsigned}build(t){return new X$(t,this.config)}}class X$ extends Jt{static[j]="MySqlDecimal";precision=this.config.precision;scale=this.config.scale;unsigned=this.config.unsigned;mapFromDriverValue(t){return typeof t=="string"?t:String(t)}getSQLType(){let t="";return this.precision!==void 0&&this.scale!==void 0?t+=`decimal(${this.precision},${this.scale})`:this.precision===void 0?t+="decimal":t+=`decimal(${this.precision})`,t=t==="decimal(10,0)"||t==="decimal(10)"?"decimal":t,this.unsigned?`${t} unsigned`:t}}class eE extends Kt{static[j]="MySqlDecimalNumberBuilder";constructor(t,r){super(t,"number","MySqlDecimalNumber"),this.config.precision=r?.precision,this.config.scale=r?.scale,this.config.unsigned=r?.unsigned}build(t){return new tE(t,this.config)}}class tE extends Jt{static[j]="MySqlDecimalNumber";precision=this.config.precision;scale=this.config.scale;unsigned=this.config.unsigned;mapFromDriverValue(t){return typeof t=="number"?t:Number(t)}mapToDriverValue=String;getSQLType(){let t="";return this.precision!==void 0&&this.scale!==void 0?t+=`decimal(${this.precision},${this.scale})`:this.precision===void 0?t+="decimal":t+=`decimal(${this.precision})`,t=t==="decimal(10,0)"||t==="decimal(10)"?"decimal":t,this.unsigned?`${t} unsigned`:t}}class rE extends Kt{static[j]="MySqlDecimalBigIntBuilder";constructor(t,r){super(t,"bigint","MySqlDecimalBigInt"),this.config.precision=r?.precision,this.config.scale=r?.scale,this.config.unsigned=r?.unsigned}build(t){return new nE(t,this.config)}}class nE extends Jt{static[j]="MySqlDecimalBigInt";precision=this.config.precision;scale=this.config.scale;unsigned=this.config.unsigned;mapFromDriverValue=BigInt;mapToDriverValue=String;getSQLType(){let t="";return this.precision!==void 0&&this.scale!==void 0?t+=`decimal(${this.precision},${this.scale})`:this.precision===void 0?t+="decimal":t+=`decimal(${this.precision})`,t=t==="decimal(10,0)"||t==="decimal(10)"?"decimal":t,this.unsigned?`${t} unsigned`:t}}function iE(e,t={}){const{name:r,config:i}=Ve(e,t),n=i?.mode;return n==="number"?new eE(r,i):n==="bigint"?new rE(r,i):new Y$(r,i)}class oE extends Kt{static[j]="MySqlDoubleBuilder";constructor(t,r){super(t,"number","MySqlDouble"),this.config.precision=r?.precision,this.config.scale=r?.scale,this.config.unsigned=r?.unsigned}build(t){return new aE(t,this.config)}}class aE extends Jt{static[j]="MySqlDouble";precision=this.config.precision;scale=this.config.scale;unsigned=this.config.unsigned;getSQLType(){let t="";return this.precision!==void 0&&this.scale!==void 0?t+=`double(${this.precision},${this.scale})`:this.precision===void 0?t+="double":t+=`double(${this.precision})`,this.unsigned?`${t} unsigned`:t}}function sE(e,t){const{name:r,config:i}=Ve(e,t);return new oE(r,i)}class cE extends ut{static[j]="MySqlEnumColumnBuilder";constructor(t,r){super(t,"string","MySqlEnumColumn"),this.config.enumValues=r}build(t){return new uE(t,this.config)}}class uE extends dt{static[j]="MySqlEnumColumn";enumValues=this.config.enumValues;getSQLType(){return`enum(${this.enumValues.map(t=>`'${t}'`).join(",")})`}}class dE extends ut{static[j]="MySqlEnumObjectColumnBuilder";constructor(t,r){super(t,"string","MySqlEnumObjectColumn"),this.config.enumValues=r}build(t){return new lE(t,this.config)}}class lE extends dt{static[j]="MySqlEnumObjectColumn";enumValues=this.config.enumValues;getSQLType(){return`enum(${this.enumValues.map(t=>`'${t}'`).join(",")})`}}function fa(e,t){if(typeof e=="string"&&Array.isArray(t)||Array.isArray(e)){const r=typeof e=="string"&&e.length>0?e:"",i=(typeof e=="string"?t:e)??[];if(i.length===0)throw new Error(`You have an empty array for "${r}" enum values`);return new cE(r,i)}if(typeof e=="string"&&typeof t=="object"||typeof e=="object"){const r=typeof e=="object"?"":e,i=typeof e=="object"?Object.values(e):typeof t=="object"?Object.values(t):[];if(i.length===0)throw new Error(`You have an empty array for "${r}" enum values`);return new dE(r,i)}}class fE extends Kt{static[j]="MySqlFloatBuilder";constructor(t,r){super(t,"number","MySqlFloat"),this.config.precision=r?.precision,this.config.scale=r?.scale,this.config.unsigned=r?.unsigned}build(t){return new hE(t,this.config)}}class hE extends Jt{static[j]="MySqlFloat";precision=this.config.precision;scale=this.config.scale;unsigned=this.config.unsigned;getSQLType(){let t="";return this.precision!==void 0&&this.scale!==void 0?t+=`float(${this.precision},${this.scale})`:this.precision===void 0?t+="float":t+=`float(${this.precision})`,this.unsigned?`${t} unsigned`:t}}function pE(e,t){const{name:r,config:i}=Ve(e,t);return new fE(r,i)}class mE extends Kt{static[j]="MySqlIntBuilder";constructor(t,r){super(t,"number","MySqlInt"),this.config.unsigned=r?r.unsigned:!1}build(t){return new gE(t,this.config)}}class gE extends Jt{static[j]="MySqlInt";getSQLType(){return`int${this.config.unsigned?" unsigned":""}`}mapFromDriverValue(t){return typeof t=="string"?Number(t):t}}function $r(e,t){const{name:r,config:i}=Ve(e,t);return new mE(r,i)}class yE extends ut{static[j]="MySqlJsonBuilder";constructor(t){super(t,"json","MySqlJson")}build(t){return new wE(t,this.config)}}class wE extends dt{static[j]="MySqlJson";getSQLType(){return"json"}mapToDriverValue(t){return JSON.stringify(t)}}function py(e){return new yE(e??"")}class vE extends Kt{static[j]="MySqlMediumIntBuilder";constructor(t,r){super(t,"number","MySqlMediumInt"),this.config.unsigned=r?r.unsigned:!1}build(t){return new bE(t,this.config)}}class bE extends Jt{static[j]="MySqlMediumInt";getSQLType(){return`mediumint${this.config.unsigned?" unsigned":""}`}mapFromDriverValue(t){return typeof t=="string"?Number(t):t}}function _E(e,t){const{name:r,config:i}=Ve(e,t);return new vE(r,i)}class SE extends Kt{static[j]="MySqlRealBuilder";constructor(t,r){super(t,"number","MySqlReal"),this.config.precision=r?.precision,this.config.scale=r?.scale}build(t){return new kE(t,this.config)}}class kE extends Jt{static[j]="MySqlReal";precision=this.config.precision;scale=this.config.scale;getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`real(${this.precision}, ${this.scale})`:this.precision===void 0?"real":`real(${this.precision})`}}function NE(e,t={}){const{name:r,config:i}=Ve(e,t);return new SE(r,i)}class $E extends Kt{static[j]="MySqlSerialBuilder";constructor(t){super(t,"number","MySqlSerial"),this.config.hasDefault=!0,this.config.autoIncrement=!0}build(t){return new EE(t,this.config)}}class EE extends Jt{static[j]="MySqlSerial";getSQLType(){return"serial"}mapFromDriverValue(t){return typeof t=="string"?Number(t):t}}function AE(e){return new $E(e??"")}class IE extends Kt{static[j]="MySqlSmallIntBuilder";constructor(t,r){super(t,"number","MySqlSmallInt"),this.config.unsigned=r?r.unsigned:!1}build(t){return new TE(t,this.config)}}class TE extends Jt{static[j]="MySqlSmallInt";getSQLType(){return`smallint${this.config.unsigned?" unsigned":""}`}mapFromDriverValue(t){return typeof t=="string"?Number(t):t}}function xE(e,t){const{name:r,config:i}=Ve(e,t);return new IE(r,i)}class Uc extends ut{static[j]="MySqlTextBuilder";constructor(t,r,i){super(t,"string","MySqlText"),this.config.textType=r,this.config.enumValues=i.enum}build(t){return new OE(t,this.config)}}class OE extends dt{static[j]="MySqlText";textType=this.config.textType;enumValues=this.config.enumValues;getSQLType(){return this.textType}}function Er(e,t={}){const{name:r,config:i}=Ve(e,t);return new Uc(r,"text",i)}function DE(e,t={}){const{name:r,config:i}=Ve(e,t);return new Uc(r,"tinytext",i)}function RE(e,t={}){const{name:r,config:i}=Ve(e,t);return new Uc(r,"mediumtext",i)}function UE(e,t={}){const{name:r,config:i}=Ve(e,t);return new Uc(r,"longtext",i)}class CE extends ut{static[j]="MySqlTimeBuilder";constructor(t,r){super(t,"string","MySqlTime"),this.config.fsp=r?.fsp}build(t){return new PE(t,this.config)}}class PE extends dt{static[j]="MySqlTime";fsp=this.config.fsp;getSQLType(){return`time${this.fsp===void 0?"":`(${this.fsp})`}`}}function LE(e,t){const{name:r,config:i}=Ve(e,t);return new CE(r,i)}class my extends ut{static[j]="MySqlDateColumnBuilder";defaultNow(){return this.default(il`(now())`)}onUpdateNow(){return this.config.hasOnUpdateNow=!0,this.config.hasDefault=!0,this}}class gy extends dt{static[j]="MySqlDateColumn";hasOnUpdateNow=this.config.hasOnUpdateNow}class zE extends my{static[j]="MySqlTimestampBuilder";constructor(t,r){super(t,"date","MySqlTimestamp"),this.config.fsp=r?.fsp}build(t){return new jE(t,this.config)}}class jE extends gy{static[j]="MySqlTimestamp";fsp=this.config.fsp;getSQLType(){return`timestamp${this.fsp===void 0?"":`(${this.fsp})`}`}mapFromDriverValue(t){return new Date(t+"+0000")}mapToDriverValue(t){return t.toISOString().slice(0,-1).replace("T"," ")}}class ME extends my{static[j]="MySqlTimestampStringBuilder";constructor(t,r){super(t,"string","MySqlTimestampString"),this.config.fsp=r?.fsp}build(t){return new qE(t,this.config)}}class qE extends gy{static[j]="MySqlTimestampString";fsp=this.config.fsp;getSQLType(){return`timestamp${this.fsp===void 0?"":`(${this.fsp})`}`}}function Wt(e,t={}){const{name:r,config:i}=Ve(e,t);return i?.mode==="string"?new ME(r,i):new zE(r,i)}class WE extends Kt{static[j]="MySqlTinyIntBuilder";constructor(t,r){super(t,"number","MySqlTinyInt"),this.config.unsigned=r?r.unsigned:!1}build(t){return new FE(t,this.config)}}class FE extends Jt{static[j]="MySqlTinyInt";getSQLType(){return`tinyint${this.config.unsigned?" unsigned":""}`}mapFromDriverValue(t){return typeof t=="string"?Number(t):t}}function BE(e,t){const{name:r,config:i}=Ve(e,t);return new WE(r,i)}class VE extends ut{static[j]="MySqlVarBinaryBuilder";constructor(t,r){super(t,"string","MySqlVarBinary"),this.config.length=r?.length}build(t){return new KE(t,this.config)}}class KE extends dt{static[j]="MySqlVarBinary";length=this.config.length;mapFromDriverValue(t){if(typeof t=="string")return t;if(Buffer.isBuffer(t))return t.toString();const r=[];for(const i of t)r.push(i===49?"1":"0");return r.join("")}getSQLType(){return this.length===void 0?"varbinary":`varbinary(${this.length})`}}function JE(e,t){const{name:r,config:i}=Ve(e,t);return new VE(r,i)}class HE extends ut{static[j]="MySqlVarCharBuilder";constructor(t,r){super(t,"string","MySqlVarChar"),this.config.length=r.length,this.config.enum=r.enum}build(t){return new ZE(t,this.config)}}class ZE extends dt{static[j]="MySqlVarChar";length=this.config.length;enumValues=this.config.enum;getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}}function H(e,t){const{name:r,config:i}=Ve(e,t);return new HE(r,i)}class GE extends ut{static[j]="MySqlYearBuilder";constructor(t){super(t,"number","MySqlYear")}build(t){return new QE(t,this.config)}}class QE extends dt{static[j]="MySqlYear";getSQLType(){return"year"}}function YE(e){return new GE(e??"")}class Mr{static[j]="SelectionProxyHandler";config;constructor(t){this.config={...t}}get(t,r){if(r==="_")return{...t._,selectedFields:new Proxy(t._.selectedFields,this)};if(r===Mt)return{...t[Mt],selectedFields:new Proxy(t[Mt].selectedFields,this)};if(typeof r=="symbol")return t[r];const n=(de(t,On)?t._.selectedFields:de(t,Rc)?t[Mt].selectedFields:t)[r];if(de(n,Ie.Aliased)){if(this.config.sqlAliasedBehavior==="sql"&&!n.isSelectionField)return n.sql;const o=n.clone();return o.isSelectionField=!0,o}if(de(n,Ie)){if(this.config.sqlBehavior==="sql")return n;throw new Error(`You tried to reference "${r}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return de(n,uo)?this.config.alias?new Proxy(n,new al(new Proxy(n.table,new S$(this.config.alias,this.config.replaceOriginalName??!1)))):n:typeof n!="object"||n===null?n:new Proxy(n,new Mr(this.config))}}class XE{static[j]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(t){return this.then(void 0,t)}finally(t){return this.then(r=>(t?.(),r),r=>{throw t?.(),r})}then(t,r){return this.execute().then(t,r)}}function eA(){return{bigint:O$,binary:U$,boolean:zn,char:j$,customType:W$,date:J$,datetime:qe,decimal:iE,double:sE,mysqlEnum:fa,float:pE,int:$r,json:py,mediumint:_E,real:NE,serial:AE,smallint:xE,text:Er,time:LE,timestamp:Wt,tinyint:BE,varbinary:JE,varchar:H,year:YE,longtext:UE,mediumtext:RE,tinytext:DE}}const cl=Symbol.for("drizzle:MySqlInlineForeignKeys");class ha extends we{static[j]="MySqlTable";static Symbol=Object.assign({},we.Symbol,{InlineForeignKeys:cl});[we.Symbol.Columns];[cl]=[];[we.Symbol.ExtraConfigBuilder]=void 0}function tA(e,t,r,i,n=e){const o=new ha(e,i,n),a=typeof t=="function"?t(eA()):t,s=Object.fromEntries(Object.entries(a).map(([u,d])=>{const l=d;l.setName(u);const f=l.build(o);return o[cl].push(...l.buildForeignKeys(f,o)),[u,f]})),c=Object.assign(o,s);return c[we.Symbol.Columns]=s,c[we.Symbol.ExtraConfigColumns]=s,r&&(c[ha.Symbol.ExtraConfigBuilder]=r),c}const lt=(e,t,r)=>tA(e,t,r,void 0,e);function Xl(...e){return e[0].columns?new km(e[0].columns,e[0].name):new km(e)}class km{static[j]="MySqlPrimaryKeyBuilder";columns;name;constructor(t,r){this.columns=t,this.name=r}build(t){return new rA(t,this.columns,this.name)}}class rA{constructor(t,r,i){this.table=t,this.columns=r,this.name=i}static[j]="MySqlPrimaryKey";columns;name;getName(){return this.name??`${this.table[ha.Symbol.Name]}_${this.columns.map(t=>t.name).join("_")}_pk`}}function Os(e){return de(e,ha)?[`${e[we.Symbol.BaseName]}`]:de(e,On)?e._.usedTables??[]:de(e,Ie)?e.usedTables??[]:[]}function Pd(e){return e.map(t=>typeof t=="object"?t.config.name:t)}function Ld(e){return Array.isArray(e)?e:[e]}class nA{static[j]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}}class iA extends nA{static[j]="MySqlSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;cacheConfig=void 0;usedTables=new Set;constructor({table:t,fields:r,isPartialSelect:i,session:n,dialect:o,withList:a,distinct:s,useIndex:c,forceIndex:u,ignoreIndex:d}){super(),this.config={withList:a,table:t,fields:{...r},distinct:s,setOperators:[],useIndex:c,forceIndex:u,ignoreIndex:d},this.isPartialSelect=i,this.session=n,this.dialect=o,this._={selectedFields:r,config:this.config},this.tableName=Sm(t),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{};for(const l of Os(t))this.usedTables.add(l)}getUsedTables(){return[...this.usedTables]}createJoin(t,r){return(i,n,o)=>{const a=t==="cross";let s=a?void 0:n;const c=a?n:o,u=this.tableName,d=Sm(i);for(const g of Os(i))this.usedTables.add(g);if(typeof d=="string"&&this.config.joins?.some(g=>g.alias===d))throw new Error(`Alias "${d}" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof u=="string"&&(this.config.fields={[u]:this.config.fields}),typeof d=="string"&&!de(i,Ie))){const g=de(i,On)?i._.selectedFields:de(i,Rc)?i[Mt].selectedFields:i[we.Symbol.Columns];this.config.fields[d]=g}typeof s=="function"&&(s=s(new Proxy(this.config.fields,new Mr({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]);let l=[],f=[],h=[];if(de(i,ha)&&c&&typeof c!="string"&&(c.useIndex&&(l=Pd(Ld(c.useIndex))),c.forceIndex&&(f=Pd(Ld(c.forceIndex))),c.ignoreIndex&&(h=Pd(Ld(c.ignoreIndex)))),this.config.joins.push({on:s,table:i,joinType:t,alias:d,useIndex:l,forceIndex:f,ignoreIndex:h,lateral:r}),typeof d=="string")switch(t){case"left":{this.joinsNotNullableMap[d]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([g])=>[g,!1])),this.joinsNotNullableMap[d]=!0;break}case"cross":case"inner":{this.joinsNotNullableMap[d]=!0;break}}return this}}leftJoin=this.createJoin("left",!1);leftJoinLateral=this.createJoin("left",!0);rightJoin=this.createJoin("right",!1);innerJoin=this.createJoin("inner",!1);innerJoinLateral=this.createJoin("inner",!0);crossJoin=this.createJoin("cross",!1);crossJoinLateral=this.createJoin("cross",!0);createSetOperator(t,r){return i=>{const n=typeof i=="function"?i(aA()):i;if(!hy(this.getSelectedFields(),n.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:t,isAll:r,rightSelect:n}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(t){return this.config.setOperators.push(...t),this}where(t){return typeof t=="function"&&(t=t(new Proxy(this.config.fields,new Mr({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=t,this}having(t){return typeof t=="function"&&(t=t(new Proxy(this.config.fields,new Mr({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=t,this}groupBy(...t){if(typeof t[0]=="function"){const r=t[0](new Proxy(this.config.fields,new Mr({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(r)?r:[r]}else this.config.groupBy=t;return this}orderBy(...t){if(typeof t[0]=="function"){const r=t[0](new Proxy(this.config.fields,new Mr({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),i=Array.isArray(r)?r:[r];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=i:this.config.orderBy=i}else{const r=t;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}return this}limit(t){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=t:this.config.limit=t,this}offset(t){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=t:this.config.offset=t,this}for(t,r={}){return this.config.lockingClause={strength:t,config:r},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){const{typings:t,...r}=this.dialect.sqlToQuery(this.getSQL());return r}as(t){const r=[];if(r.push(...Os(this.config.table)),this.config.joins)for(const i of this.config.joins)r.push(...Os(i.table));return new Proxy(new On(this.getSQL(),this.config.fields,t,!1,[...new Set(r)]),new Mr({alias:t,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new Mr({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}$withCache(t){return this.cacheConfig=t===void 0?{config:{},enable:!0,autoInvalidate:!0}:t===!1?{enable:!1}:{enable:!0,autoInvalidate:!0,...t},this}}class oA extends iA{static[j]="MySqlSelect";prepare(){if(!this.session)throw new Error("Cannot execute a query on a query builder. Please use a database instance instead.");const t=sl(this.config.fields),r=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),t,void 0,void 0,void 0,{type:"select",tables:[...this.usedTables]},this.cacheConfig);return r.joinsNotNullableMap=this.joinsNotNullableMap,r}execute=t=>this.prepare().execute(t);createIterator=()=>{const t=this;return async function*(r){yield*t.prepare().iterator(r)}};iterator=this.createIterator()}k$(oA,[XE]);function lo(e,t){return(r,i,...n)=>{const o=[i,...n].map(a=>({type:e,isAll:t,rightSelect:a}));for(const a of o)if(!hy(r.getSelectedFields(),a.rightSelect.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return r.addSetOperators(o)}}const aA=()=>({union:yy,unionAll:sA,intersect:cA,intersectAll:uA,except:dA,exceptAll:lA}),yy=lo("union",!1),sA=lo("union",!0),cA=lo("intersect",!1),uA=lo("intersect",!0),dA=lo("except",!1),lA=lo("except",!0),hr=lt("user",{id:H("id",{length:255}).primaryKey().$defaultFn(()=>crypto.randomUUID()),password:H("password",{length:255}),name:H("name",{length:255}),email:H("email",{length:255}).notNull().unique(),emailVerified:Wt("emailVerified",{mode:"date",fsp:3}),emailVerifiedTemp:zn("emailVerifiedTemp").default(!1),image:H("image",{length:255}),createdAt:Wt("createdAt",{mode:"date",fsp:3}).notNull().defaultNow(),updatedAt:Wt("updatedAt",{mode:"date",fsp:3}).notNull().defaultNow().$onUpdate(()=>new Date)}),fA=lt("session",{sessionToken:H("sessionToken",{length:255}).primaryKey(),userId:H("userId",{length:255}).notNull().references(()=>hr.id,{onDelete:"cascade"}),expires:Wt("expires",{mode:"date",fsp:3}).notNull(),id:H("id",{length:36}).$defaultFn(()=>crypto.randomUUID()),createdAt:Wt("createdAt",{mode:"date",fsp:3}).notNull().defaultNow(),updatedAt:Wt("updatedAt",{mode:"date",fsp:3}).notNull().defaultNow().$onUpdate(()=>new Date),ipAddress:Er("ipAddress"),userAgent:Er("userAgent")}),hA=lt("account",{userId:H("userId",{length:255}).notNull().references(()=>hr.id,{onDelete:"cascade"}),type:H("type",{length:255}).notNull().default("oauth"),provider:H("provider",{length:255}).notNull(),providerAccountId:H("providerAccountId",{length:255}).notNull(),refresh_token:H("refresh_token",{length:255}),access_token:Er("access_token"),expires_at:$r("expires_at"),token_type:H("token_type",{length:255}),scope:H("scope",{length:255}),id_token:H("id_token",{length:2048}),session_state:H("session_state",{length:255}),id:H("id",{length:36}).$defaultFn(()=>crypto.randomUUID()),refreshTokenExpiresAt:Wt("refreshTokenExpiresAt",{mode:"date",fsp:3}),password:Er("password"),createdAt:Wt("createdAt",{mode:"date",fsp:3}).notNull().defaultNow(),updatedAt:Wt("updatedAt",{mode:"date",fsp:3}).notNull().defaultNow().$onUpdate(()=>new Date)},e=>[Xl({columns:[e.provider,e.providerAccountId]})]),pA=lt("verificationToken",{identifier:H("identifier",{length:255}).notNull(),token:H("token",{length:255}).notNull(),expires:Wt("expires",{mode:"date"}).notNull(),id:H("id",{length:36}).$defaultFn(()=>crypto.randomUUID()),createdAt:Wt("createdAt",{mode:"date",fsp:3}).notNull().defaultNow(),updatedAt:Wt("updatedAt",{mode:"date",fsp:3}).notNull().defaultNow().$onUpdate(()=>new Date)},e=>[Xl({columns:[e.identifier,e.token]})]),mA=lt("authenticator",{credentialID:H("credentialID",{length:255}).notNull().unique(),userId:H("userId",{length:255}).notNull().references(()=>hr.id,{onDelete:"cascade"}),providerAccountId:H("providerAccountId",{length:255}).notNull(),credentialPublicKey:H("credentialPublicKey",{length:255}).notNull(),counter:$r("counter").notNull(),credentialDeviceType:H("credentialDeviceType",{length:255}).notNull(),credentialBackedUp:zn("credentialBackedUp").notNull(),transports:H("transports",{length:255})},e=>[Xl({columns:[e.userId,e.credentialID]})]),wy=Object.freeze(Object.defineProperty({__proto__:null,account:hA,authenticators:mA,session:fA,user:hr,verification:pA},Symbol.toStringTag,{value:"Module"})),gA=lt("userProfile",{userId:H("userId",{length:255}).notNull().references(()=>hr.id,{onDelete:"cascade"}),challenge:H("challenge",{length:255}),values:H("values",{length:255}),hiddenIdentity:H("hiddenIdentity",{length:255})}),Je=lt("quest",{id:H("id",{length:255}).primaryKey().$defaultFn(()=>crypto.randomUUID()),title:H("title",{length:255}).notNull(),description:Er("description"),userId:H("userId",{length:255}).notNull().references(()=>hr.id,{onDelete:"cascade"}),count:$r("count").notNull().default(0),archived:zn("archived").notNull().default(!1),order:$r("order").notNull().default(0),createdAt:qe("createdAt",{mode:"date",fsp:3}).notNull().$defaultFn(()=>new Date),updatedAt:qe("updatedAt",{mode:"date",fsp:3}).notNull().$defaultFn(()=>new Date).$onUpdate(()=>new Date)}),yr=lt("questHistory",{id:H("id",{length:255}).primaryKey().$defaultFn(()=>crypto.randomUUID()),questId:H("questId",{length:255}).notNull().references(()=>Je.id,{onDelete:"cascade"}),createdAt:qe("createdAt",{mode:"date",fsp:3}).notNull().$defaultFn(()=>new Date),updatedAt:qe("updatedAt",{mode:"date",fsp:3}).notNull().$defaultFn(()=>new Date).$onUpdate(()=>new Date)}),He=lt("powerup",{id:H("id",{length:255}).primaryKey().$defaultFn(()=>crypto.randomUUID()),title:H("title",{length:255}).notNull(),description:Er("description"),userId:H("userId",{length:255}).notNull().references(()=>hr.id,{onDelete:"cascade"}),count:$r("count").notNull().default(0),archived:zn("archived").notNull().default(!1),order:$r("order").notNull().default(0),createdAt:qe("createdAt",{mode:"date",fsp:3}).notNull().$defaultFn(()=>new Date),updatedAt:qe("updatedAt",{mode:"date",fsp:3}).notNull().$defaultFn(()=>new Date).$onUpdate(()=>new Date)}),wr=lt("powerupHistory",{id:H("id",{length:255}).primaryKey().$defaultFn(()=>crypto.randomUUID()),powerupId:H("powerupId",{length:255}).notNull().references(()=>He.id,{onDelete:"cascade"}),createdAt:qe("createdAt",{mode:"date",fsp:3}).notNull().$defaultFn(()=>new Date),updatedAt:qe("updatedAt",{mode:"date",fsp:3}).notNull().$defaultFn(()=>new Date).$onUpdate(()=>new Date)}),Ze=lt("villain",{id:H("id",{length:255}).primaryKey().$defaultFn(()=>crypto.randomUUID()),title:H("title",{length:255}).notNull(),description:Er("description"),userId:H("userId",{length:255}).notNull().references(()=>hr.id,{onDelete:"cascade"}),count:$r("count").notNull().default(0),archived:zn("archived").notNull().default(!1),order:$r("order").notNull().default(0),createdAt:qe("createdAt",{mode:"date",fsp:3}).notNull().$defaultFn(()=>new Date),updatedAt:qe("updatedAt",{mode:"date",fsp:3}).notNull().$defaultFn(()=>new Date).$onUpdate(()=>new Date)}),vr=lt("villainHistory",{id:H("id",{length:255}).primaryKey().$defaultFn(()=>crypto.randomUUID()),villainId:H("villainId",{length:255}).notNull().references(()=>Ze.id,{onDelete:"cascade"}),createdAt:qe("createdAt",{mode:"date",fsp:3}).notNull().$defaultFn(()=>new Date),updatedAt:qe("updatedAt",{mode:"date",fsp:3}).notNull().$defaultFn(()=>new Date).$onUpdate(()=>new Date)}),Gt=lt("epicwin",{id:H("id",{length:255}).primaryKey().$defaultFn(()=>crypto.randomUUID()),title:H("title",{length:255}).notNull(),description:Er("description"),userId:H("userId",{length:255}).notNull().references(()=>hr.id,{onDelete:"cascade"}),count:$r("count").notNull().default(0),archived:zn("archived").notNull().default(!1),createdAt:qe("createdAt",{mode:"date",fsp:3}).notNull().$defaultFn(()=>new Date),updatedAt:qe("updatedAt",{mode:"date",fsp:3}).notNull().$defaultFn(()=>new Date).$onUpdate(()=>new Date)}),Hn=lt("epicwinHistory",{id:H("id",{length:255}).primaryKey().$defaultFn(()=>crypto.randomUUID()),epicwinId:H("epicwinId",{length:255}).notNull().references(()=>Gt.id,{onDelete:"cascade"}),createdAt:qe("createdAt",{mode:"date",fsp:3}).notNull().$defaultFn(()=>new Date),updatedAt:qe("updatedAt",{mode:"date",fsp:3}).notNull().$defaultFn(()=>new Date).$onUpdate(()=>new Date)}),Qt=lt("mission",{id:H("id",{length:255}).primaryKey().$defaultFn(()=>crypto.randomUUID()),title:H("title",{length:255}).notNull(),description:Er("description"),userId:H("userId",{length:255}).notNull().references(()=>hr.id,{onDelete:"cascade"}),type:fa("type",["system-daily","system-weekly","system-monthly","user-defined"]).notNull(),deadline:qe("deadline",{mode:"date",fsp:3}),createdAt:qe("createdAt",{mode:"date",fsp:3}).notNull().$defaultFn(()=>new Date),updatedAt:qe("updatedAt",{mode:"date",fsp:3}).notNull().$defaultFn(()=>new Date).$onUpdate(()=>new Date)}),tt=lt("missionCondition",{id:H("id",{length:255}).primaryKey().$defaultFn(()=>crypto.randomUUID()),missionId:H("missionId",{length:255}).notNull().references(()=>Qt.id,{onDelete:"cascade"}),conditionType:fa("conditionType",["any","specific"]),itemType:fa("itemType",["quest","powerup","villain","epicwin"]).notNull(),itemId:H("itemId",{length:255}),completed:zn("completed").notNull().default(!1),createdAt:qe("createdAt",{mode:"date",fsp:3}).notNull().$defaultFn(()=>new Date),updatedAt:qe("updatedAt",{mode:"date",fsp:3}).notNull().$defaultFn(()=>new Date).$onUpdate(()=>new Date)}),vy=lt("testType",{id:H("id",{length:255}).primaryKey().$defaultFn(()=>crypto.randomUUID()),name:fa("name",["pos-neg"]).notNull().unique()}),yA=lt("testResult",{id:H("id",{length:255}).primaryKey().$defaultFn(()=>crypto.randomUUID()),userId:H("userId",{length:255}).notNull().references(()=>hr.id,{onDelete:"cascade"}),testTypeId:H("testTypeId",{length:255}).notNull().references(()=>vy.id,{onDelete:"cascade"}),answer:py("answer").notNull().$type(),createdAt:qe("createdAt",{mode:"date",fsp:3}).notNull().$defaultFn(()=>new Date)}),wA=Object.freeze(Object.defineProperty({__proto__:null,epicwinHistories:Hn,epicwins:Gt,missionConditions:tt,missions:Qt,powerupHistories:wr,powerups:He,questHistories:yr,quests:Je,testResults:yA,testTypes:vy,userProfile:gA,villainHistories:vr,villains:Ze},Symbol.toStringTag,{value:"Module"}));var Ro={};p$.loadEnvConfig(process.cwd());const vA={...wy,...wA},bA=VN({host:Ro.DB_HOST,user:Ro.DB_USERNAME,password:Ro.DB_PASSWORD,database:Ro.DB_DATABASE,connectionLimit:3,connectTimeout:5e3,enableKeepAlive:!0,keepAliveInitialDelay:0,ssl:Ro.DB_TYPE?.toLowerCase()==="tidb"?{}:void 0}),_A=BN(bA,{schema:vA,mode:"default"}),ur=globalThis._db||_A,Uo=Symbol.for("better-auth:global");let Co=null;const SA={},zd="1.4.17";function Cc(){return globalThis[Uo]||(globalThis[Uo]={version:zd,epoch:1,context:SA},Co=globalThis[Uo]),Co=globalThis[Uo],Co.version!==zd&&(Co.version=zd,Co.epoch++),globalThis[Uo]}function kA(){return Cc().version}var NA=class{#e=void 0;run(e,t){const r=this.#e;this.#e=e;const i=t();return i instanceof Promise?i.finally(()=>{this.#e=r}):(this.#e=r,i)}getStore(){return this.#e}};const $A=Promise.resolve().then(()=>"AsyncLocalStorage"in globalThis?globalThis.AsyncLocalStorage:NA);async function ef(){const e=await $A;if(e===null)throw new Error("getAsyncLocalStorage is only available in server code");return e}const by=async()=>{const e=Cc();if(!e.context.endpointContextAsyncStorage){const t=await ef();e.context.endpointContextAsyncStorage=new t}return e.context.endpointContextAsyncStorage};async function xi(){const e=(await by()).getStore();if(!e)throw new Error("No auth context found. Please make sure you are calling this function within a `runWithEndpointContext` callback.");return e}async function tc(e,t){return(await by()).run(e,t)}const tf=async()=>{const e=Cc();if(!e.context.requestStateAsyncStorage){const t=await ef();e.context.requestStateAsyncStorage=new t}return e.context.requestStateAsyncStorage};async function EA(){return(await tf()).getStore()!==void 0}async function Nm(){const e=(await tf()).getStore();if(!e)throw new Error("No request state found. Please make sure you are calling this function within a `runWithRequestState` callback.");return e}async function AA(e,t){return(await tf()).run(e,t)}function IA(e){const t=Object.freeze({});return{get ref(){return t},async get(){const r=await Nm();if(!r.has(t)){const i=await e();return r.set(t,i),i}return r.get(t)},async set(r){(await Nm()).set(t,r)}}}const rf=async()=>{const e=Cc();if(!e.context.adapterAsyncStorage){const t=await ef();e.context.adapterAsyncStorage=new t}return e.context.adapterAsyncStorage},je=async e=>rf().then(t=>t.getStore()||e).catch(()=>e),TA=async(e,t)=>{let r=!0;return rf().then(i=>(r=!0,i.run(e,t))).catch(i=>{if(!r)return t();throw i})},_y=async(e,t)=>{let r=!0;return rf().then(i=>(r=!0,e.transaction(async n=>i.run(n,t)))).catch(i=>{if(!r)return t();throw i})},{set:Sy}=IA(()=>null);function $m(e){switch(e){case"a-z":return"abcdefghijklmnopqrstuvwxyz";case"A-Z":return"ABCDEFGHIJKLMNOPQRSTUVWXYZ";case"0-9":return"0123456789";case"-_":return"-_";default:throw new Error(`Unsupported alphabet: ${e}`)}}function nf(...e){const t=e.map($m).join("");if(t.length===0)throw new Error("No valid characters provided for random string generation.");const r=t.length;return(i,...n)=>{if(i<=0)throw new Error("Length must be a positive integer.");let o=t,a=r;n.length>0&&(o=n.map($m).join(""),a=o.length);const s=Math.floor(256/a)*a,c=new Uint8Array(i*2),u=c.length;let d="",l=u,f;for(;d.length<i;)l>=u&&(crypto.getRandomValues(c),l=0),f=c[l++],f<s&&(d+=o[f%a]);return d}}const ul=nf("a-z","0-9","A-Z","-_");function xA(e,t){typeof e=="string"&&(e=new TextEncoder().encode(e)),typeof t=="string"&&(t=new TextEncoder().encode(t));const r=new Uint8Array(e),i=new Uint8Array(t);let n=r.length^i.length;const o=Math.max(r.length,i.length);for(let a=0;a<o;a++)n|=(a<r.length?r[a]:0)^(a<i.length?i[a]:0);return n===0}function OA(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Yt(e,t=""){if(!Number.isSafeInteger(e)||e<0){const r=t&&`"${t}" `;throw new Error(`${r}expected integer >= 0, got ${e}`)}}function Vi(e,t,r=""){const i=OA(e),n=e?.length,o=t!==void 0;if(!i||o&&n!==t){const a=r&&`"${r}" `,s=o?` of length ${t}`:"",c=i?`length=${n}`:`type=${typeof e}`;throw new Error(a+"expected Uint8Array"+s+", got "+c)}return e}function Pc(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash must wrapped by utils.createHasher");Yt(e.outputLen),Yt(e.blockLen)}function rc(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function DA(e,t){Vi(e,void 0,"digestInto() output");const r=t.outputLen;if(e.length<r)throw new Error('"digestInto() output" expected to be of length >='+r)}function jd(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function si(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function Bs(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function pr(e,t){return e<<32-t|e>>>t}function fe(e,t){return e<<t|e>>>32-t>>>0}const RA=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function UA(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function CA(e){for(let t=0;t<e.length;t++)e[t]=UA(e[t]);return e}const Em=RA?e=>e:CA,PA=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Pr={_0:48,_9:57,A:65,F:70,a:97,f:102};function Am(e){if(e>=Pr._0&&e<=Pr._9)return e-Pr._0;if(e>=Pr.A&&e<=Pr.F)return e-(Pr.A-10);if(e>=Pr.a&&e<=Pr.f)return e-(Pr.a-10)}function LA(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(PA)return Uint8Array.fromHex(e);const t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const i=new Uint8Array(r);for(let n=0,o=0;n<r;n++,o+=2){const a=Am(e.charCodeAt(o)),s=Am(e.charCodeAt(o+1));if(a===void 0||s===void 0){const c=e[o]+e[o+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+o)}i[n]=a*16+s}return i}const zA=async()=>{};async function Im(e,t,r){let i=Date.now();for(let n=0;n<e;n++){r(n);const o=Date.now()-i;o>=0&&o<t||(await zA(),i+=o)}}function jA(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function Tm(e,t=""){return typeof e=="string"?jA(e):Vi(e,void 0,t)}function ky(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("options must be object or undefined");return Object.assign(e,t)}function MA(e,t={}){const r=(n,o)=>e(o).update(n).digest(),i=e(void 0);return r.outputLen=i.outputLen,r.blockLen=i.blockLen,r.create=n=>e(n),Object.assign(r,t),Object.freeze(r)}const qA=e=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,e])});class Ny{oHash;iHash;blockLen;outputLen;finished=!1;destroyed=!1;constructor(t,r){if(Pc(t),Vi(r,void 0,"key"),this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,n=new Uint8Array(i);n.set(r.length>i?t.create().update(r).digest():r);for(let o=0;o<n.length;o++)n[o]^=54;this.iHash.update(n),this.oHash=t.create();for(let o=0;o<n.length;o++)n[o]^=106;this.oHash.update(n),si(n)}update(t){return rc(this),this.iHash.update(t),this}digestInto(t){rc(this),Vi(t,this.outputLen,"output"),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||=Object.create(Object.getPrototypeOf(this),{});const{oHash:r,iHash:i,finished:n,destroyed:o,blockLen:a,outputLen:s}=this;return t=t,t.finished=n,t.destroyed=o,t.blockLen=a,t.outputLen=s,t.oHash=r._cloneInto(t.oHash),t.iHash=i._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Lc=(e,t,r)=>new Ny(e,t).update(r).digest();Lc.create=(e,t)=>new Ny(e,t);function WA(e,t,r){return Pc(e),r===void 0&&(r=new Uint8Array(e.outputLen)),Lc(e,r,t)}const Md=Uint8Array.of(0),xm=Uint8Array.of();function FA(e,t,r,i=32){Pc(e),Yt(i,"length");const n=e.outputLen;if(i>255*n)throw new Error("Length must be <= 255*HashLen");const o=Math.ceil(i/n);r===void 0?r=xm:Vi(r,void 0,"info");const a=new Uint8Array(o*n),s=Lc.create(e,t),c=s._cloneInto(),u=new Uint8Array(s.outputLen);for(let d=0;d<o;d++)Md[0]=d+1,c.update(d===0?xm:u).update(r).update(Md).digestInto(u),a.set(u,n*d),s._cloneInto(c);return s.destroy(),c.destroy(),si(u,Md),a.slice(0,i)}const $y=(e,t,r,i,n)=>FA(e,WA(e,t,r),i,n);function BA(e,t,r){return e&t^~e&r}function VA(e,t,r){return e&t^e&r^t&r}class KA{blockLen;outputLen;padOffset;isLE;buffer;view;finished=!1;length=0;pos=0;destroyed=!1;constructor(t,r,i,n){this.blockLen=t,this.outputLen=r,this.padOffset=i,this.isLE=n,this.buffer=new Uint8Array(t),this.view=Bs(this.buffer)}update(t){rc(this),Vi(t);const{view:r,buffer:i,blockLen:n}=this,o=t.length;for(let a=0;a<o;){const s=Math.min(n-this.pos,o-a);if(s===n){const c=Bs(t);for(;n<=o-a;a+=n)this.process(c,a);continue}i.set(t.subarray(a,a+s),this.pos),this.pos+=s,a+=s,this.pos===n&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){rc(this),DA(t,this),this.finished=!0;const{buffer:r,view:i,blockLen:n,isLE:o}=this;let{pos:a}=this;r[a++]=128,si(this.buffer.subarray(a)),this.padOffset>n-a&&(this.process(i,0),a=0);for(let l=a;l<n;l++)r[l]=0;i.setBigUint64(n-8,BigInt(this.length*8),o),this.process(i,0);const s=Bs(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen must be aligned to 32bit");const u=c/4,d=this.get();if(u>d.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<u;l++)s.setUint32(4*l,d[l],o)}digest(){const{buffer:t,outputLen:r}=this;this.digestInto(t);const i=t.slice(0,r);return this.destroy(),i}_cloneInto(t){t||=new this.constructor,t.set(...this.get());const{blockLen:r,buffer:i,length:n,finished:o,destroyed:a,pos:s}=this;return t.destroyed=a,t.finished=o,t.length=n,t.pos=s,n%r&&t.buffer.set(i),t}clone(){return this._cloneInto()}}const pn=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),JA=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),mn=new Uint32Array(64);class HA extends KA{constructor(t){super(64,t,8,!1)}get(){const{A:t,B:r,C:i,D:n,E:o,F:a,G:s,H:c}=this;return[t,r,i,n,o,a,s,c]}set(t,r,i,n,o,a,s,c){this.A=t|0,this.B=r|0,this.C=i|0,this.D=n|0,this.E=o|0,this.F=a|0,this.G=s|0,this.H=c|0}process(t,r){for(let l=0;l<16;l++,r+=4)mn[l]=t.getUint32(r,!1);for(let l=16;l<64;l++){const f=mn[l-15],h=mn[l-2],g=pr(f,7)^pr(f,18)^f>>>3,m=pr(h,17)^pr(h,19)^h>>>10;mn[l]=m+mn[l-7]+g+mn[l-16]|0}let{A:i,B:n,C:o,D:a,E:s,F:c,G:u,H:d}=this;for(let l=0;l<64;l++){const f=pr(s,6)^pr(s,11)^pr(s,25),h=d+f+BA(s,c,u)+JA[l]+mn[l]|0,m=(pr(i,2)^pr(i,13)^pr(i,22))+VA(i,n,o)|0;d=u,u=c,c=s,s=a+h|0,a=o,o=n,n=i,i=h+m|0}i=i+this.A|0,n=n+this.B|0,o=o+this.C|0,a=a+this.D|0,s=s+this.E|0,c=c+this.F|0,u=u+this.G|0,d=d+this.H|0,this.set(i,n,o,a,s,c,u,d)}roundClean(){si(mn)}destroy(){this.set(0,0,0,0,0,0,0,0),si(this.buffer)}}class ZA extends HA{A=pn[0]|0;B=pn[1]|0;C=pn[2]|0;D=pn[3]|0;E=pn[4]|0;F=pn[5]|0;G=pn[6]|0;H=pn[7]|0;constructor(){super(32)}}const zc=MA(()=>new ZA,qA(1)),nc=new TextEncoder,Gr=new TextDecoder,ic=2**32;function Or(...e){const t=e.reduce((n,{length:o})=>n+o,0),r=new Uint8Array(t);let i=0;for(const n of e)r.set(n,i),i+=n.length;return r}function dl(e,t,r){if(t<0||t>=ic)throw new RangeError(`value must be >= 0 and <= ${ic-1}. Received ${t}`);e.set([t>>>24,t>>>16,t>>>8,t&255],r)}function Ey(e){const t=Math.floor(e/ic),r=e%ic,i=new Uint8Array(8);return dl(i,t,0),dl(i,r,4),i}function of(e){const t=new Uint8Array(4);return dl(t,e),t}function $t(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++){const i=e.charCodeAt(r);if(i>127)throw new TypeError("non-ASCII string encountered in encode()");t[r]=i}return t}function GA(e){if(Uint8Array.prototype.toBase64)return e.toBase64();const t=32768,r=[];for(let i=0;i<e.length;i+=t)r.push(String.fromCharCode.apply(null,e.subarray(i,i+t)));return btoa(r.join(""))}function QA(e){if(Uint8Array.fromBase64)return Uint8Array.fromBase64(e);const t=atob(e),r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}function st(e){if(Uint8Array.fromBase64)return Uint8Array.fromBase64(typeof e=="string"?e:Gr.decode(e),{alphabet:"base64url"});let t=e;t instanceof Uint8Array&&(t=Gr.decode(t)),t=t.replace(/-/g,"+").replace(/_/g,"/");try{return QA(t)}catch{throw new TypeError("The input to be decoded is not correctly encoded.")}}function ct(e){let t=e;return typeof t=="string"&&(t=nc.encode(t)),Uint8Array.prototype.toBase64?t.toBase64({alphabet:"base64url",omitPadding:!0}):GA(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}class _t extends Error{static code="ERR_JOSE_GENERIC";code="ERR_JOSE_GENERIC";constructor(t,r){super(t,r),this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}class Rt extends _t{static code="ERR_JWT_CLAIM_VALIDATION_FAILED";code="ERR_JWT_CLAIM_VALIDATION_FAILED";claim;reason;payload;constructor(t,r,i="unspecified",n="unspecified"){super(t,{cause:{claim:i,reason:n,payload:r}}),this.claim=i,this.reason=n,this.payload=r}}class ll extends _t{static code="ERR_JWT_EXPIRED";code="ERR_JWT_EXPIRED";claim;reason;payload;constructor(t,r,i="unspecified",n="unspecified"){super(t,{cause:{claim:i,reason:n,payload:r}}),this.claim=i,this.reason=n,this.payload=r}}class fl extends _t{static code="ERR_JOSE_ALG_NOT_ALLOWED";code="ERR_JOSE_ALG_NOT_ALLOWED"}class Me extends _t{static code="ERR_JOSE_NOT_SUPPORTED";code="ERR_JOSE_NOT_SUPPORTED"}class hl extends _t{static code="ERR_JWE_DECRYPTION_FAILED";code="ERR_JWE_DECRYPTION_FAILED";constructor(t="decryption operation failed",r){super(t,r)}}class Q extends _t{static code="ERR_JWE_INVALID";code="ERR_JWE_INVALID"}class Fe extends _t{static code="ERR_JWS_INVALID";code="ERR_JWS_INVALID"}class gr extends _t{static code="ERR_JWT_INVALID";code="ERR_JWT_INVALID"}class YA extends _t{static code="ERR_JWK_INVALID";code="ERR_JWK_INVALID"}class Ay extends _t{static code="ERR_JWKS_INVALID";code="ERR_JWKS_INVALID"}class Iy extends _t{static code="ERR_JWKS_NO_MATCHING_KEY";code="ERR_JWKS_NO_MATCHING_KEY";constructor(t="no applicable key found in the JSON Web Key Set",r){super(t,r)}}class XA extends _t{[Symbol.asyncIterator];static code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";constructor(t="multiple matching keys found in the JSON Web Key Set",r){super(t,r)}}class eI extends _t{static code="ERR_JWKS_TIMEOUT";code="ERR_JWKS_TIMEOUT";constructor(t="request timed out",r){super(t,r)}}class tI extends _t{static code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED";code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED";constructor(t="signature verification failed",r){super(t,r)}}function Ty(e){switch(e){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new Me(`Unsupported JWE Algorithm: ${e}`)}}const rI=e=>crypto.getRandomValues(new Uint8Array(Ty(e)>>3));function xy(e,t){if(t.length<<3!==Ty(e))throw new Q("Invalid Initialization Vector length")}function oc(e,t){const r=e.byteLength<<3;if(r!==t)throw new Q(`Invalid Content Encryption Key length. Expected ${t} bits, got ${r} bits`)}const at=(e,t="algorithm.name")=>new TypeError(`CryptoKey does not support this operation, its ${t} must be ${e}`),br=(e,t)=>e.name===t;function Vs(e){return parseInt(e.name.slice(4),10)}function nI(e){switch(e){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw new Error("unreachable")}}function Oy(e,t){if(t&&!e.usages.includes(t))throw new TypeError(`CryptoKey does not support this operation, its usages must include ${t}.`)}function iI(e,t,r){switch(t){case"HS256":case"HS384":case"HS512":{if(!br(e.algorithm,"HMAC"))throw at("HMAC");const i=parseInt(t.slice(2),10);if(Vs(e.algorithm.hash)!==i)throw at(`SHA-${i}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!br(e.algorithm,"RSASSA-PKCS1-v1_5"))throw at("RSASSA-PKCS1-v1_5");const i=parseInt(t.slice(2),10);if(Vs(e.algorithm.hash)!==i)throw at(`SHA-${i}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!br(e.algorithm,"RSA-PSS"))throw at("RSA-PSS");const i=parseInt(t.slice(2),10);if(Vs(e.algorithm.hash)!==i)throw at(`SHA-${i}`,"algorithm.hash");break}case"Ed25519":case"EdDSA":{if(!br(e.algorithm,"Ed25519"))throw at("Ed25519");break}case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":{if(!br(e.algorithm,t))throw at(t);break}case"ES256":case"ES384":case"ES512":{if(!br(e.algorithm,"ECDSA"))throw at("ECDSA");const i=nI(t);if(e.algorithm.namedCurve!==i)throw at(i,"algorithm.namedCurve");break}default:throw new TypeError("CryptoKey does not support this operation")}Oy(e,r)}function Dn(e,t,r){switch(t){case"A128GCM":case"A192GCM":case"A256GCM":{if(!br(e.algorithm,"AES-GCM"))throw at("AES-GCM");const i=parseInt(t.slice(1,4),10);if(e.algorithm.length!==i)throw at(i,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if(!br(e.algorithm,"AES-KW"))throw at("AES-KW");const i=parseInt(t.slice(1,4),10);if(e.algorithm.length!==i)throw at(i,"algorithm.length");break}case"ECDH":{switch(e.algorithm.name){case"ECDH":case"X25519":break;default:throw at("ECDH or X25519")}break}case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!br(e.algorithm,"PBKDF2"))throw at("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(!br(e.algorithm,"RSA-OAEP"))throw at("RSA-OAEP");const i=parseInt(t.slice(9),10)||1;if(Vs(e.algorithm.hash)!==i)throw at(`SHA-${i}`,"algorithm.hash");break}default:throw new TypeError("CryptoKey does not support this operation")}Oy(e,r)}function Dy(e,t,...r){if(r=r.filter(Boolean),r.length>2){const i=r.pop();e+=`one of type ${r.join(", ")}, or ${i}.`}else r.length===2?e+=`one of type ${r[0]} or ${r[1]}.`:e+=`of type ${r[0]}.`;return t==null?e+=` Received ${t}`:typeof t=="function"&&t.name?e+=` Received function ${t.name}`:typeof t=="object"&&t!=null&&t.constructor?.name&&(e+=` Received an instance of ${t.constructor.name}`),e}const gi=(e,...t)=>Dy("Key must be ",e,...t),Ry=(e,t,...r)=>Dy(`Key for the ${e} algorithm must be `,t,...r);function Go(e){if(!fo(e))throw new Error("CryptoKey instance expected")}const fo=e=>e?.[Symbol.toStringTag]==="CryptoKey",af=e=>e?.[Symbol.toStringTag]==="KeyObject",sf=e=>fo(e)||af(e);async function oI(e,t){if(!(e instanceof Uint8Array))throw new TypeError("First argument must be a buffer");if(!(t instanceof Uint8Array))throw new TypeError("Second argument must be a buffer");const r={name:"HMAC",hash:"SHA-256"},i=await crypto.subtle.generateKey(r,!1,["sign"]),n=new Uint8Array(await crypto.subtle.sign(r,i,e)),o=new Uint8Array(await crypto.subtle.sign(r,i,t));let a=0,s=-1;for(;++s<32;)a|=n[s]^o[s];return a===0}async function aI(e,t,r,i,n,o){if(!(t instanceof Uint8Array))throw new TypeError(gi(t,"Uint8Array"));const a=parseInt(e.slice(1,4),10),s=await crypto.subtle.importKey("raw",t.subarray(a>>3),"AES-CBC",!1,["decrypt"]),c=await crypto.subtle.importKey("raw",t.subarray(0,a>>3),{hash:`SHA-${a<<1}`,name:"HMAC"},!1,["sign"]),u=Or(o,i,r,Ey(o.length<<3)),d=new Uint8Array((await crypto.subtle.sign("HMAC",c,u)).slice(0,a>>3));let l;try{l=await oI(n,d)}catch{}if(!l)throw new hl;let f;try{f=new Uint8Array(await crypto.subtle.decrypt({iv:i,name:"AES-CBC"},s,r))}catch{}if(!f)throw new hl;return f}async function sI(e,t,r,i,n,o){let a;t instanceof Uint8Array?a=await crypto.subtle.importKey("raw",t,"AES-GCM",!1,["decrypt"]):(Dn(t,e,"decrypt"),a=t);try{return new Uint8Array(await crypto.subtle.decrypt({additionalData:o,iv:i,name:"AES-GCM",tagLength:128},a,Or(r,n)))}catch{throw new hl}}async function Uy(e,t,r,i,n,o){if(!fo(t)&&!(t instanceof Uint8Array))throw new TypeError(gi(t,"CryptoKey","KeyObject","Uint8Array","JSON Web Key"));if(!i)throw new Q("JWE Initialization Vector missing");if(!n)throw new Q("JWE Authentication Tag missing");switch(xy(e,i),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return t instanceof Uint8Array&&oc(t,parseInt(e.slice(-3),10)),aI(e,t,r,i,n,o);case"A128GCM":case"A192GCM":case"A256GCM":return t instanceof Uint8Array&&oc(t,parseInt(e.slice(1,4),10)),sI(e,t,r,i,n,o);default:throw new Me("Unsupported JWE Content Encryption Algorithm")}}function jc(...e){const t=e.filter(Boolean);if(t.length===0||t.length===1)return!0;let r;for(const i of t){const n=Object.keys(i);if(!r||r.size===0){r=new Set(n);continue}for(const o of n){if(r.has(o))return!1;r.add(o)}}return!0}const cI=e=>typeof e=="object"&&e!==null;function Et(e){if(!cI(e)||Object.prototype.toString.call(e)!=="[object Object]")return!1;if(Object.getPrototypeOf(e)===null)return!0;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function Cy(e,t){if(e.algorithm.length!==parseInt(t.slice(1,4),10))throw new TypeError(`Invalid key size for alg: ${t}`)}function Py(e,t,r){return e instanceof Uint8Array?crypto.subtle.importKey("raw",e,"AES-KW",!0,[r]):(Dn(e,t,r),e)}async function pl(e,t,r){const i=await Py(t,e,"wrapKey");Cy(i,e);const n=await crypto.subtle.importKey("raw",r,{hash:"SHA-256",name:"HMAC"},!0,["sign"]);return new Uint8Array(await crypto.subtle.wrapKey("raw",n,i,"AES-KW"))}async function ml(e,t,r){const i=await Py(t,e,"unwrapKey");Cy(i,e);const n=await crypto.subtle.unwrapKey("raw",r,i,"AES-KW",{hash:"SHA-256",name:"HMAC"},!0,["sign"]);return new Uint8Array(await crypto.subtle.exportKey("raw",n))}async function Ly(e,t){const r=`SHA-${e.slice(-3)}`;return new Uint8Array(await crypto.subtle.digest(r,t))}function qd(e){return Or(of(e.length),e)}async function uI(e,t,r){const i=t>>3,n=32,o=Math.ceil(i/n),a=new Uint8Array(o*n);for(let s=1;s<=o;s++){const c=new Uint8Array(4+e.length+r.length);c.set(of(s),0),c.set(e,4),c.set(r,4+e.length);const u=await Ly("sha256",c);a.set(u,(s-1)*n)}return a.slice(0,i)}async function zy(e,t,r,i,n=new Uint8Array,o=new Uint8Array){Dn(e,"ECDH"),Dn(t,"ECDH","deriveBits");const a=qd($t(r)),s=qd(n),c=qd(o),u=of(i),d=new Uint8Array,l=Or(a,s,c,u,d),f=new Uint8Array(await crypto.subtle.deriveBits({name:e.algorithm.name,public:e},t,dI(e)));return uI(f,i,l)}function dI(e){return e.algorithm.name==="X25519"?256:Math.ceil(parseInt(e.algorithm.namedCurve.slice(-3),10)/8)<<3}function jy(e){switch(e.algorithm.namedCurve){case"P-256":case"P-384":case"P-521":return!0;default:return e.algorithm.name==="X25519"}}function lI(e,t){return e instanceof Uint8Array?crypto.subtle.importKey("raw",e,"PBKDF2",!1,["deriveBits"]):(Dn(e,t,"deriveBits"),e)}const fI=(e,t)=>Or($t(e),Uint8Array.of(0),t);async function My(e,t,r,i){if(!(e instanceof Uint8Array)||e.length<8)throw new Q("PBES2 Salt Input must be 8 or more octets");const n=fI(t,e),o=parseInt(t.slice(13,16),10),a={hash:`SHA-${t.slice(8,11)}`,iterations:r,name:"PBKDF2",salt:n},s=await lI(i,t);return new Uint8Array(await crypto.subtle.deriveBits(a,s,o))}async function hI(e,t,r,i=2048,n=crypto.getRandomValues(new Uint8Array(16))){const o=await My(n,e,i,t);return{encryptedKey:await pl(e.slice(-6),o,r),p2c:i,p2s:ct(n)}}async function pI(e,t,r,i,n){const o=await My(n,e,i,t);return ml(e.slice(-6),o,r)}function Mc(e,t){if(e.startsWith("RS")||e.startsWith("PS")){const{modulusLength:r}=t.algorithm;if(typeof r!="number"||r<2048)throw new TypeError(`${e} requires key modulusLength to be 2048 bits or larger`)}}const qy=e=>{switch(e){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return"RSA-OAEP";default:throw new Me(`alg ${e} is not supported either by JOSE or your javascript runtime`)}};async function mI(e,t,r){return Dn(t,e,"encrypt"),Mc(e,t),new Uint8Array(await crypto.subtle.encrypt(qy(e),t,r))}async function gI(e,t,r){return Dn(t,e,"decrypt"),Mc(e,t),new Uint8Array(await crypto.subtle.decrypt(qy(e),t,r))}function cf(e){switch(e){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new Me(`Unsupported JWE Algorithm: ${e}`)}}const Oi=e=>crypto.getRandomValues(new Uint8Array(cf(e)>>3));function yI(e){let t,r;switch(e.kty){case"AKP":{switch(e.alg){case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":t={name:e.alg},r=e.priv?["sign"]:["verify"];break;default:throw new Me('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"RSA":{switch(e.alg){case"PS256":case"PS384":case"PS512":t={name:"RSA-PSS",hash:`SHA-${e.alg.slice(-3)}`},r=e.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":t={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${e.alg.slice(-3)}`},r=e.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":t={name:"RSA-OAEP",hash:`SHA-${parseInt(e.alg.slice(-3),10)||1}`},r=e.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new Me('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"EC":{switch(e.alg){case"ES256":t={name:"ECDSA",namedCurve:"P-256"},r=e.d?["sign"]:["verify"];break;case"ES384":t={name:"ECDSA",namedCurve:"P-384"},r=e.d?["sign"]:["verify"];break;case"ES512":t={name:"ECDSA",namedCurve:"P-521"},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:"ECDH",namedCurve:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new Me('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"OKP":{switch(e.alg){case"Ed25519":case"EdDSA":t={name:"Ed25519"},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new Me('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}default:throw new Me('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:t,keyUsages:r}}async function Ks(e){if(!e.alg)throw new TypeError('"alg" argument is required when "jwk.alg" is not present');const{algorithm:t,keyUsages:r}=yI(e),i={...e};return i.kty!=="AKP"&&delete i.alg,delete i.use,crypto.subtle.importKey("jwk",i,t,e.ext??!(e.d||e.priv),e.key_ops??r)}async function $a(e,t,r){if(!Et(e))throw new TypeError("JWK must be an object");let i;switch(t??=e.alg,i??=e.ext,e.kty){case"oct":if(typeof e.k!="string"||!e.k)throw new TypeError('missing "k" (Key Value) Parameter value');return st(e.k);case"RSA":if("oth"in e&&e.oth!==void 0)throw new Me('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');return Ks({...e,alg:t,ext:i});case"AKP":{if(typeof e.alg!="string"||!e.alg)throw new TypeError('missing "alg" (Algorithm) Parameter value');if(t!==void 0&&t!==e.alg)throw new TypeError("JWK alg and alg option value mismatch");return Ks({...e,ext:i})}case"EC":case"OKP":return Ks({...e,alg:t,ext:i});default:throw new Me('Unsupported "kty" (Key Type) Parameter value')}}async function wI(e,t,r,i,n){if(!(r instanceof Uint8Array))throw new TypeError(gi(r,"Uint8Array"));const o=parseInt(e.slice(1,4),10),a=await crypto.subtle.importKey("raw",r.subarray(o>>3),"AES-CBC",!1,["encrypt"]),s=await crypto.subtle.importKey("raw",r.subarray(0,o>>3),{hash:`SHA-${o<<1}`,name:"HMAC"},!1,["sign"]),c=new Uint8Array(await crypto.subtle.encrypt({iv:i,name:"AES-CBC"},a,t)),u=Or(n,i,c,Ey(n.length<<3)),d=new Uint8Array((await crypto.subtle.sign("HMAC",s,u)).slice(0,o>>3));return{ciphertext:c,tag:d,iv:i}}async function vI(e,t,r,i,n){let o;r instanceof Uint8Array?o=await crypto.subtle.importKey("raw",r,"AES-GCM",!1,["encrypt"]):(Dn(r,e,"encrypt"),o=r);const a=new Uint8Array(await crypto.subtle.encrypt({additionalData:n,iv:i,name:"AES-GCM",tagLength:128},o,t)),s=a.slice(-16);return{ciphertext:a.slice(0,-16),tag:s,iv:i}}async function Wy(e,t,r,i,n){if(!fo(r)&&!(r instanceof Uint8Array))throw new TypeError(gi(r,"CryptoKey","KeyObject","Uint8Array","JSON Web Key"));switch(i?xy(e,i):i=rI(e),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return r instanceof Uint8Array&&oc(r,parseInt(e.slice(-3),10)),wI(e,t,r,i,n);case"A128GCM":case"A192GCM":case"A256GCM":return r instanceof Uint8Array&&oc(r,parseInt(e.slice(1,4),10)),vI(e,t,r,i,n);default:throw new Me("Unsupported JWE Content Encryption Algorithm")}}async function bI(e,t,r,i){const n=e.slice(0,7),o=await Wy(n,r,t,i,new Uint8Array);return{encryptedKey:o.ciphertext,iv:ct(o.iv),tag:ct(o.tag)}}async function _I(e,t,r,i,n){const o=e.slice(0,7);return Uy(o,t,r,i,n,new Uint8Array)}async function SI(e,t,r,i,n){switch(e){case"dir":{if(r!==void 0)throw new Q("Encountered unexpected JWE Encrypted Key");return t}case"ECDH-ES":if(r!==void 0)throw new Q("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(!Et(i.epk))throw new Q('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(Go(t),!jy(t))throw new Me("ECDH with the provided key is not allowed or not supported by your javascript runtime");const o=await $a(i.epk,e);Go(o);let a,s;if(i.apu!==void 0){if(typeof i.apu!="string")throw new Q('JOSE Header "apu" (Agreement PartyUInfo) invalid');try{a=st(i.apu)}catch{throw new Q("Failed to base64url decode the apu")}}if(i.apv!==void 0){if(typeof i.apv!="string")throw new Q('JOSE Header "apv" (Agreement PartyVInfo) invalid');try{s=st(i.apv)}catch{throw new Q("Failed to base64url decode the apv")}}const c=await zy(o,t,e==="ECDH-ES"?i.enc:e,e==="ECDH-ES"?cf(i.enc):parseInt(e.slice(-5,-2),10),a,s);if(e==="ECDH-ES")return c;if(r===void 0)throw new Q("JWE Encrypted Key missing");return ml(e.slice(-6),c,r)}case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(r===void 0)throw new Q("JWE Encrypted Key missing");return Go(t),gI(e,t,r)}case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{if(r===void 0)throw new Q("JWE Encrypted Key missing");if(typeof i.p2c!="number")throw new Q('JOSE Header "p2c" (PBES2 Count) missing or invalid');const o=n?.maxPBES2Count||1e4;if(i.p2c>o)throw new Q('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if(typeof i.p2s!="string")throw new Q('JOSE Header "p2s" (PBES2 Salt) missing or invalid');let a;try{a=st(i.p2s)}catch{throw new Q("Failed to base64url decode the p2s")}return pI(e,t,r,i.p2c,a)}case"A128KW":case"A192KW":case"A256KW":{if(r===void 0)throw new Q("JWE Encrypted Key missing");return ml(e,t,r)}case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{if(r===void 0)throw new Q("JWE Encrypted Key missing");if(typeof i.iv!="string")throw new Q('JOSE Header "iv" (Initialization Vector) missing or invalid');if(typeof i.tag!="string")throw new Q('JOSE Header "tag" (Authentication Tag) missing or invalid');let o;try{o=st(i.iv)}catch{throw new Q("Failed to base64url decode the iv")}let a;try{a=st(i.tag)}catch{throw new Q("Failed to base64url decode the tag")}return _I(e,t,r,o,a)}default:throw new Me('Invalid or unsupported "alg" (JWE Algorithm) header value')}}function qc(e,t,r,i,n){if(n.crit!==void 0&&i?.crit===void 0)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!i||i.crit===void 0)return new Set;if(!Array.isArray(i.crit)||i.crit.length===0||i.crit.some(a=>typeof a!="string"||a.length===0))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');let o;r!==void 0?o=new Map([...Object.entries(r),...t.entries()]):o=t;for(const a of i.crit){if(!o.has(a))throw new Me(`Extension Header Parameter "${a}" is not recognized`);if(n[a]===void 0)throw new e(`Extension Header Parameter "${a}" is missing`);if(o.get(a)&&i[a]===void 0)throw new e(`Extension Header Parameter "${a}" MUST be integrity protected`)}return new Set(i.crit)}function gl(e,t){if(t!==void 0&&(!Array.isArray(t)||t.some(r=>typeof r!="string")))throw new TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t)}const Wc=e=>Et(e)&&typeof e.kty=="string",kI=e=>e.kty!=="oct"&&(e.kty==="AKP"&&typeof e.priv=="string"||typeof e.d=="string"),NI=e=>e.kty!=="oct"&&e.d===void 0&&e.priv===void 0,$I=e=>e.kty==="oct"&&typeof e.k=="string";let Li;const Om=async(e,t,r,i=!1)=>{Li||=new WeakMap;let n=Li.get(e);if(n?.[r])return n[r];const o=await Ks({...t,alg:r});return i&&Object.freeze(e),n?n[r]=o:Li.set(e,{[r]:o}),o},EI=(e,t)=>{Li||=new WeakMap;let r=Li.get(e);if(r?.[t])return r[t];const i=e.type==="public",n=!!i;let o;if(e.asymmetricKeyType==="x25519"){switch(t){case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":break;default:throw new TypeError("given KeyObject instance cannot be used for this algorithm")}o=e.toCryptoKey(e.asymmetricKeyType,n,i?[]:["deriveBits"])}if(e.asymmetricKeyType==="ed25519"){if(t!=="EdDSA"&&t!=="Ed25519")throw new TypeError("given KeyObject instance cannot be used for this algorithm");o=e.toCryptoKey(e.asymmetricKeyType,n,[i?"verify":"sign"])}switch(e.asymmetricKeyType){case"ml-dsa-44":case"ml-dsa-65":case"ml-dsa-87":{if(t!==e.asymmetricKeyType.toUpperCase())throw new TypeError("given KeyObject instance cannot be used for this algorithm");o=e.toCryptoKey(e.asymmetricKeyType,n,[i?"verify":"sign"])}}if(e.asymmetricKeyType==="rsa"){let a;switch(t){case"RSA-OAEP":a="SHA-1";break;case"RS256":case"PS256":case"RSA-OAEP-256":a="SHA-256";break;case"RS384":case"PS384":case"RSA-OAEP-384":a="SHA-384";break;case"RS512":case"PS512":case"RSA-OAEP-512":a="SHA-512";break;default:throw new TypeError("given KeyObject instance cannot be used for this algorithm")}if(t.startsWith("RSA-OAEP"))return e.toCryptoKey({name:"RSA-OAEP",hash:a},n,i?["encrypt"]:["decrypt"]);o=e.toCryptoKey({name:t.startsWith("PS")?"RSA-PSS":"RSASSA-PKCS1-v1_5",hash:a},n,[i?"verify":"sign"])}if(e.asymmetricKeyType==="ec"){const s=new Map([["prime256v1","P-256"],["secp384r1","P-384"],["secp521r1","P-521"]]).get(e.asymmetricKeyDetails?.namedCurve);if(!s)throw new TypeError("given KeyObject instance cannot be used for this algorithm");t==="ES256"&&s==="P-256"&&(o=e.toCryptoKey({name:"ECDSA",namedCurve:s},n,[i?"verify":"sign"])),t==="ES384"&&s==="P-384"&&(o=e.toCryptoKey({name:"ECDSA",namedCurve:s},n,[i?"verify":"sign"])),t==="ES512"&&s==="P-521"&&(o=e.toCryptoKey({name:"ECDSA",namedCurve:s},n,[i?"verify":"sign"])),t.startsWith("ECDH-ES")&&(o=e.toCryptoKey({name:"ECDH",namedCurve:s},n,i?[]:["deriveBits"]))}if(!o)throw new TypeError("given KeyObject instance cannot be used for this algorithm");return r?r[t]=o:Li.set(e,{[t]:o}),o};async function Ea(e,t){if(e instanceof Uint8Array||fo(e))return e;if(af(e)){if(e.type==="secret")return e.export();if("toCryptoKey"in e&&typeof e.toCryptoKey=="function")try{return EI(e,t)}catch(i){if(i instanceof TypeError)throw i}let r=e.export({format:"jwk"});return Om(e,r,t)}if(Wc(e))return e.k?st(e.k):Om(e,e,t,!0);throw new Error("unreachable")}const Di=e=>e?.[Symbol.toStringTag],yl=(e,t,r)=>{if(t.use!==void 0){let i;switch(r){case"sign":case"verify":i="sig";break;case"encrypt":case"decrypt":i="enc";break}if(t.use!==i)throw new TypeError(`Invalid key for this operation, its "use" must be "${i}" when present`)}if(t.alg!==void 0&&t.alg!==e)throw new TypeError(`Invalid key for this operation, its "alg" must be "${e}" when present`);if(Array.isArray(t.key_ops)){let i;switch(!0){case(r==="sign"||r==="verify"):case e==="dir":case e.includes("CBC-HS"):i=r;break;case e.startsWith("PBES2"):i="deriveBits";break;case/^A\d{3}(?:GCM)?(?:KW)?$/.test(e):!e.includes("GCM")&&e.endsWith("KW")?i=r==="encrypt"?"wrapKey":"unwrapKey":i=r;break;case(r==="encrypt"&&e.startsWith("RSA")):i="wrapKey";break;case r==="decrypt":i=e.startsWith("RSA")?"unwrapKey":"deriveBits";break}if(i&&t.key_ops?.includes?.(i)===!1)throw new TypeError(`Invalid key for this operation, its "key_ops" must include "${i}" when present`)}return!0},AI=(e,t,r)=>{if(!(t instanceof Uint8Array)){if(Wc(t)){if($I(t)&&yl(e,t,r))return;throw new TypeError('JSON Web Key for symmetric algorithms must have JWK "kty" (Key Type) equal to "oct" and the JWK "k" (Key Value) present')}if(!sf(t))throw new TypeError(Ry(e,t,"CryptoKey","KeyObject","JSON Web Key","Uint8Array"));if(t.type!=="secret")throw new TypeError(`${Di(t)} instances for symmetric algorithms must be of type "secret"`)}},II=(e,t,r)=>{if(Wc(t))switch(r){case"decrypt":case"sign":if(kI(t)&&yl(e,t,r))return;throw new TypeError("JSON Web Key for this operation be a private JWK");case"encrypt":case"verify":if(NI(t)&&yl(e,t,r))return;throw new TypeError("JSON Web Key for this operation be a public JWK")}if(!sf(t))throw new TypeError(Ry(e,t,"CryptoKey","KeyObject","JSON Web Key"));if(t.type==="secret")throw new TypeError(`${Di(t)} instances for asymmetric algorithms must not be of type "secret"`);if(t.type==="public")switch(r){case"sign":throw new TypeError(`${Di(t)} instances for asymmetric algorithm signing must be of type "private"`);case"decrypt":throw new TypeError(`${Di(t)} instances for asymmetric algorithm decryption must be of type "private"`)}if(t.type==="private")switch(r){case"verify":throw new TypeError(`${Di(t)} instances for asymmetric algorithm verifying must be of type "public"`);case"encrypt":throw new TypeError(`${Di(t)} instances for asymmetric algorithm encryption must be of type "public"`)}};function Fc(e,t,r){switch(e.substring(0,2)){case"A1":case"A2":case"di":case"HS":case"PB":AI(e,t,r);break;default:II(e,t,r)}}async function TI(e,t,r){if(!Et(e))throw new Q("Flattened JWE must be an object");if(e.protected===void 0&&e.header===void 0&&e.unprotected===void 0)throw new Q("JOSE Header missing");if(e.iv!==void 0&&typeof e.iv!="string")throw new Q("JWE Initialization Vector incorrect type");if(typeof e.ciphertext!="string")throw new Q("JWE Ciphertext missing or incorrect type");if(e.tag!==void 0&&typeof e.tag!="string")throw new Q("JWE Authentication Tag incorrect type");if(e.protected!==void 0&&typeof e.protected!="string")throw new Q("JWE Protected Header incorrect type");if(e.encrypted_key!==void 0&&typeof e.encrypted_key!="string")throw new Q("JWE Encrypted Key incorrect type");if(e.aad!==void 0&&typeof e.aad!="string")throw new Q("JWE AAD incorrect type");if(e.header!==void 0&&!Et(e.header))throw new Q("JWE Shared Unprotected Header incorrect type");if(e.unprotected!==void 0&&!Et(e.unprotected))throw new Q("JWE Per-Recipient Unprotected Header incorrect type");let i;if(e.protected)try{const N=st(e.protected);i=JSON.parse(Gr.decode(N))}catch{throw new Q("JWE Protected Header is invalid")}if(!jc(i,e.header,e.unprotected))throw new Q("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");const n={...i,...e.header,...e.unprotected};if(qc(Q,new Map,r?.crit,i,n),n.zip!==void 0)throw new Me('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');const{alg:o,enc:a}=n;if(typeof o!="string"||!o)throw new Q("missing JWE Algorithm (alg) in JWE Header");if(typeof a!="string"||!a)throw new Q("missing JWE Encryption Algorithm (enc) in JWE Header");const s=r&&gl("keyManagementAlgorithms",r.keyManagementAlgorithms),c=r&&gl("contentEncryptionAlgorithms",r.contentEncryptionAlgorithms);if(s&&!s.has(o)||!s&&o.startsWith("PBES2"))throw new fl('"alg" (Algorithm) Header Parameter value not allowed');if(c&&!c.has(a))throw new fl('"enc" (Encryption Algorithm) Header Parameter value not allowed');let u;if(e.encrypted_key!==void 0)try{u=st(e.encrypted_key)}catch{throw new Q("Failed to base64url decode the encrypted_key")}let d=!1;typeof t=="function"&&(t=await t(i,e),d=!0),Fc(o==="dir"?a:o,t,"decrypt");const l=await Ea(t,o);let f;try{f=await SI(o,l,u,n,r)}catch(N){if(N instanceof TypeError||N instanceof Q||N instanceof Me)throw N;f=Oi(a)}let h,g;if(e.iv!==void 0)try{h=st(e.iv)}catch{throw new Q("Failed to base64url decode the iv")}if(e.tag!==void 0)try{g=st(e.tag)}catch{throw new Q("Failed to base64url decode the tag")}const m=e.protected!==void 0?$t(e.protected):new Uint8Array;let v;e.aad!==void 0?v=Or(m,$t("."),$t(e.aad)):v=m;let b;try{b=st(e.ciphertext)}catch{throw new Q("Failed to base64url decode the ciphertext")}const x={plaintext:await Uy(a,f,b,h,g,v)};if(e.protected!==void 0&&(x.protectedHeader=i),e.aad!==void 0)try{x.additionalAuthenticatedData=st(e.aad)}catch{throw new Q("Failed to base64url decode the aad")}return e.unprotected!==void 0&&(x.sharedUnprotectedHeader=e.unprotected),e.header!==void 0&&(x.unprotectedHeader=e.header),d?{...x,key:l}:x}async function xI(e,t,r){if(e instanceof Uint8Array&&(e=Gr.decode(e)),typeof e!="string")throw new Q("Compact JWE must be a string or Uint8Array");const{0:i,1:n,2:o,3:a,4:s,length:c}=e.split(".");if(c!==5)throw new Q("Invalid Compact JWE");const u=await TI({ciphertext:a,iv:o||void 0,protected:i,tag:s||void 0,encrypted_key:n||void 0},t,r),d={plaintext:u.plaintext,protectedHeader:u.protectedHeader};return typeof t=="function"?{...d,key:u.key}:d}const OI=Symbol();async function DI(e){if(af(e))if(e.type==="secret")e=e.export();else return e.export({format:"jwk"});if(e instanceof Uint8Array)return{kty:"oct",k:ct(e)};if(!fo(e))throw new TypeError(gi(e,"CryptoKey","KeyObject","Uint8Array"));if(!e.extractable)throw new TypeError("non-extractable CryptoKey cannot be exported as a JWK");const{ext:t,key_ops:r,alg:i,use:n,...o}=await crypto.subtle.exportKey("jwk",e);return o.kty==="AKP"&&(o.alg=i),o}async function Fy(e){return DI(e)}async function RI(e,t,r,i,n={}){let o,a,s;switch(e){case"dir":{s=r;break}case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(Go(r),!jy(r))throw new Me("ECDH with the provided key is not allowed or not supported by your javascript runtime");const{apu:c,apv:u}=n;let d;n.epk?d=await Ea(n.epk,e):d=(await crypto.subtle.generateKey(r.algorithm,!0,["deriveBits"])).privateKey;const{x:l,y:f,crv:h,kty:g}=await Fy(d),m=await zy(r,d,e==="ECDH-ES"?t:e,e==="ECDH-ES"?cf(t):parseInt(e.slice(-5,-2),10),c,u);if(a={epk:{x:l,crv:h,kty:g}},g==="EC"&&(a.epk.y=f),c&&(a.apu=ct(c)),u&&(a.apv=ct(u)),e==="ECDH-ES"){s=m;break}s=i||Oi(t);const v=e.slice(-6);o=await pl(v,m,s);break}case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{s=i||Oi(t),Go(r),o=await mI(e,r,s);break}case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{s=i||Oi(t);const{p2c:c,p2s:u}=n;({encryptedKey:o,...a}=await hI(e,r,s,c,u));break}case"A128KW":case"A192KW":case"A256KW":{s=i||Oi(t),o=await pl(e,r,s);break}case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{s=i||Oi(t);const{iv:c}=n;({encryptedKey:o,...a}=await bI(e,r,s,c));break}default:throw new Me('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:s,encryptedKey:o,parameters:a}}class UI{#e;#t;#r;#n;#i;#a;#s;#o;constructor(t){if(!(t instanceof Uint8Array))throw new TypeError("plaintext must be an instance of Uint8Array");this.#e=t}setKeyManagementParameters(t){if(this.#o)throw new TypeError("setKeyManagementParameters can only be called once");return this.#o=t,this}setProtectedHeader(t){if(this.#t)throw new TypeError("setProtectedHeader can only be called once");return this.#t=t,this}setSharedUnprotectedHeader(t){if(this.#r)throw new TypeError("setSharedUnprotectedHeader can only be called once");return this.#r=t,this}setUnprotectedHeader(t){if(this.#n)throw new TypeError("setUnprotectedHeader can only be called once");return this.#n=t,this}setAdditionalAuthenticatedData(t){return this.#i=t,this}setContentEncryptionKey(t){if(this.#a)throw new TypeError("setContentEncryptionKey can only be called once");return this.#a=t,this}setInitializationVector(t){if(this.#s)throw new TypeError("setInitializationVector can only be called once");return this.#s=t,this}async encrypt(t,r){if(!this.#t&&!this.#n&&!this.#r)throw new Q("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!jc(this.#t,this.#n,this.#r))throw new Q("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");const i={...this.#t,...this.#n,...this.#r};if(qc(Q,new Map,r?.crit,this.#t,i),i.zip!==void 0)throw new Me('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');const{alg:n,enc:o}=i;if(typeof n!="string"||!n)throw new Q('JWE "alg" (Algorithm) Header Parameter missing or invalid');if(typeof o!="string"||!o)throw new Q('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');let a;if(this.#a&&(n==="dir"||n==="ECDH-ES"))throw new TypeError(`setContentEncryptionKey cannot be called with JWE "alg" (Algorithm) Header ${n}`);Fc(n==="dir"?o:n,t,"encrypt");let s;{let v;const b=await Ea(t,n);({cek:s,encryptedKey:a,parameters:v}=await RI(n,o,b,this.#a,this.#o)),v&&(r&&OI in r?this.#n?this.#n={...this.#n,...v}:this.setUnprotectedHeader(v):this.#t?this.#t={...this.#t,...v}:this.setProtectedHeader(v))}let c,u,d,l;if(this.#t?(u=ct(JSON.stringify(this.#t)),d=$t(u)):(u="",d=new Uint8Array),this.#i){l=ct(this.#i);const v=$t(l);c=Or(d,$t("."),v)}else c=d;const{ciphertext:f,tag:h,iv:g}=await Wy(o,this.#e,s,this.#s,c),m={ciphertext:ct(f)};return g&&(m.iv=ct(g)),h&&(m.tag=ct(h)),a&&(m.encrypted_key=ct(a)),l&&(m.aad=l),this.#t&&(m.protected=u),this.#r&&(m.unprotected=this.#r),this.#n&&(m.header=this.#n),m}}function By(e,t){const r=`SHA-${e.slice(-3)}`;switch(e){case"HS256":case"HS384":case"HS512":return{hash:r,name:"HMAC"};case"PS256":case"PS384":case"PS512":return{hash:r,name:"RSA-PSS",saltLength:parseInt(e.slice(-3),10)>>3};case"RS256":case"RS384":case"RS512":return{hash:r,name:"RSASSA-PKCS1-v1_5"};case"ES256":case"ES384":case"ES512":return{hash:r,name:"ECDSA",namedCurve:t.namedCurve};case"Ed25519":case"EdDSA":return{name:"Ed25519"};case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":return{name:e};default:throw new Me(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}async function Vy(e,t,r){if(t instanceof Uint8Array){if(!e.startsWith("HS"))throw new TypeError(gi(t,"CryptoKey","KeyObject","JSON Web Key"));return crypto.subtle.importKey("raw",t,{hash:`SHA-${e.slice(-3)}`,name:"HMAC"},!1,[r])}return iI(t,e,r),t}async function CI(e,t,r,i){const n=await Vy(e,t,"verify");Mc(e,n);const o=By(e,n.algorithm);try{return await crypto.subtle.verify(o,n,r,i)}catch{return!1}}async function PI(e,t,r){if(!Et(e))throw new Fe("Flattened JWS must be an object");if(e.protected===void 0&&e.header===void 0)throw new Fe('Flattened JWS must have either of the "protected" or "header" members');if(e.protected!==void 0&&typeof e.protected!="string")throw new Fe("JWS Protected Header incorrect type");if(e.payload===void 0)throw new Fe("JWS Payload missing");if(typeof e.signature!="string")throw new Fe("JWS Signature missing or incorrect type");if(e.header!==void 0&&!Et(e.header))throw new Fe("JWS Unprotected Header incorrect type");let i={};if(e.protected)try{const v=st(e.protected);i=JSON.parse(Gr.decode(v))}catch{throw new Fe("JWS Protected Header is invalid")}if(!jc(i,e.header))throw new Fe("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");const n={...i,...e.header},o=qc(Fe,new Map([["b64",!0]]),r?.crit,i,n);let a=!0;if(o.has("b64")&&(a=i.b64,typeof a!="boolean"))throw new Fe('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:s}=n;if(typeof s!="string"||!s)throw new Fe('JWS "alg" (Algorithm) Header Parameter missing or invalid');const c=r&&gl("algorithms",r.algorithms);if(c&&!c.has(s))throw new fl('"alg" (Algorithm) Header Parameter value not allowed');if(a){if(typeof e.payload!="string")throw new Fe("JWS Payload must be a string")}else if(typeof e.payload!="string"&&!(e.payload instanceof Uint8Array))throw new Fe("JWS Payload must be a string or an Uint8Array instance");let u=!1;typeof t=="function"&&(t=await t(i,e),u=!0),Fc(s,t,"verify");const d=Or(e.protected!==void 0?$t(e.protected):new Uint8Array,$t("."),typeof e.payload=="string"?a?$t(e.payload):nc.encode(e.payload):e.payload);let l;try{l=st(e.signature)}catch{throw new Fe("Failed to base64url decode the signature")}const f=await Ea(t,s);if(!await CI(s,f,l,d))throw new tI;let g;if(a)try{g=st(e.payload)}catch{throw new Fe("Failed to base64url decode the payload")}else typeof e.payload=="string"?g=nc.encode(e.payload):g=e.payload;const m={payload:g};return e.protected!==void 0&&(m.protectedHeader=i),e.header!==void 0&&(m.unprotectedHeader=e.header),u?{...m,key:f}:m}async function LI(e,t,r){if(e instanceof Uint8Array&&(e=Gr.decode(e)),typeof e!="string")throw new Fe("Compact JWS must be a string or Uint8Array");const{0:i,1:n,2:o,length:a}=e.split(".");if(a!==3)throw new Fe("Invalid Compact JWS");const s=await PI({payload:n,protected:i,signature:o},t,r),c={payload:s.payload,protectedHeader:s.protectedHeader};return typeof t=="function"?{...c,key:s.key}:c}const wn=e=>Math.floor(e.getTime()/1e3),Ky=60,Jy=Ky*60,uf=Jy*24,zI=uf*7,jI=uf*365.25,MI=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i;function Qo(e){const t=MI.exec(e);if(!t||t[4]&&t[1])throw new TypeError("Invalid time period format");const r=parseFloat(t[2]),i=t[3].toLowerCase();let n;switch(i){case"sec":case"secs":case"second":case"seconds":case"s":n=Math.round(r);break;case"minute":case"minutes":case"min":case"mins":case"m":n=Math.round(r*Ky);break;case"hour":case"hours":case"hr":case"hrs":case"h":n=Math.round(r*Jy);break;case"day":case"days":case"d":n=Math.round(r*uf);break;case"week":case"weeks":case"w":n=Math.round(r*zI);break;default:n=Math.round(r*jI);break}return t[1]==="-"||t[4]==="ago"?-n:n}function Bn(e,t){if(!Number.isFinite(t))throw new TypeError(`Invalid ${e} input`);return t}const Dm=e=>e.includes("/")?e.toLowerCase():`application/${e.toLowerCase()}`,qI=(e,t)=>typeof e=="string"?t.includes(e):Array.isArray(e)?t.some(Set.prototype.has.bind(new Set(e))):!1;function Hy(e,t,r={}){let i;try{i=JSON.parse(Gr.decode(t))}catch{}if(!Et(i))throw new gr("JWT Claims Set must be a top-level JSON object");const{typ:n}=r;if(n&&(typeof e.typ!="string"||Dm(e.typ)!==Dm(n)))throw new Rt('unexpected "typ" JWT header value',i,"typ","check_failed");const{requiredClaims:o=[],issuer:a,subject:s,audience:c,maxTokenAge:u}=r,d=[...o];u!==void 0&&d.push("iat"),c!==void 0&&d.push("aud"),s!==void 0&&d.push("sub"),a!==void 0&&d.push("iss");for(const g of new Set(d.reverse()))if(!(g in i))throw new Rt(`missing required "${g}" claim`,i,g,"missing");if(a&&!(Array.isArray(a)?a:[a]).includes(i.iss))throw new Rt('unexpected "iss" claim value',i,"iss","check_failed");if(s&&i.sub!==s)throw new Rt('unexpected "sub" claim value',i,"sub","check_failed");if(c&&!qI(i.aud,typeof c=="string"?[c]:c))throw new Rt('unexpected "aud" claim value',i,"aud","check_failed");let l;switch(typeof r.clockTolerance){case"string":l=Qo(r.clockTolerance);break;case"number":l=r.clockTolerance;break;case"undefined":l=0;break;default:throw new TypeError("Invalid clockTolerance option type")}const{currentDate:f}=r,h=wn(f||new Date);if((i.iat!==void 0||u)&&typeof i.iat!="number")throw new Rt('"iat" claim must be a number',i,"iat","invalid");if(i.nbf!==void 0){if(typeof i.nbf!="number")throw new Rt('"nbf" claim must be a number',i,"nbf","invalid");if(i.nbf>h+l)throw new Rt('"nbf" claim timestamp check failed',i,"nbf","check_failed")}if(i.exp!==void 0){if(typeof i.exp!="number")throw new Rt('"exp" claim must be a number',i,"exp","invalid");if(i.exp<=h-l)throw new ll('"exp" claim timestamp check failed',i,"exp","check_failed")}if(u){const g=h-i.iat,m=typeof u=="number"?u:Qo(u);if(g-l>m)throw new ll('"iat" claim timestamp check failed (too far in the past)',i,"iat","check_failed");if(g<0-l)throw new Rt('"iat" claim timestamp check failed (it should be in the past)',i,"iat","check_failed")}return i}class Zy{#e;constructor(t){if(!Et(t))throw new TypeError("JWT Claims Set MUST be an object");this.#e=structuredClone(t)}data(){return nc.encode(JSON.stringify(this.#e))}get iss(){return this.#e.iss}set iss(t){this.#e.iss=t}get sub(){return this.#e.sub}set sub(t){this.#e.sub=t}get aud(){return this.#e.aud}set aud(t){this.#e.aud=t}set jti(t){this.#e.jti=t}set nbf(t){typeof t=="number"?this.#e.nbf=Bn("setNotBefore",t):t instanceof Date?this.#e.nbf=Bn("setNotBefore",wn(t)):this.#e.nbf=wn(new Date)+Qo(t)}set exp(t){typeof t=="number"?this.#e.exp=Bn("setExpirationTime",t):t instanceof Date?this.#e.exp=Bn("setExpirationTime",wn(t)):this.#e.exp=wn(new Date)+Qo(t)}set iat(t){t===void 0?this.#e.iat=wn(new Date):t instanceof Date?this.#e.iat=Bn("setIssuedAt",wn(t)):typeof t=="string"?this.#e.iat=Bn("setIssuedAt",wn(new Date)+Qo(t)):this.#e.iat=Bn("setIssuedAt",t)}}async function ho(e,t,r){const i=await LI(e,t,r);if(i.protectedHeader.crit?.includes("b64")&&i.protectedHeader.b64===!1)throw new gr("JWTs MUST NOT use unencoded payload");const o={payload:Hy(i.protectedHeader,i.payload,r),protectedHeader:i.protectedHeader};return typeof t=="function"?{...o,key:i.key}:o}async function WI(e,t,r){const i=await xI(e,t,r),n=Hy(i.protectedHeader,i.plaintext,r),{protectedHeader:o}=i;if(o.iss!==void 0&&o.iss!==n.iss)throw new Rt('replicated "iss" claim header parameter mismatch',n,"iss","mismatch");if(o.sub!==void 0&&o.sub!==n.sub)throw new Rt('replicated "sub" claim header parameter mismatch',n,"sub","mismatch");if(o.aud!==void 0&&JSON.stringify(o.aud)!==JSON.stringify(n.aud))throw new Rt('replicated "aud" claim header parameter mismatch',n,"aud","mismatch");const a={payload:n,protectedHeader:o};return typeof t=="function"?{...a,key:i.key}:a}class FI{#e;constructor(t){this.#e=new UI(t)}setContentEncryptionKey(t){return this.#e.setContentEncryptionKey(t),this}setInitializationVector(t){return this.#e.setInitializationVector(t),this}setProtectedHeader(t){return this.#e.setProtectedHeader(t),this}setKeyManagementParameters(t){return this.#e.setKeyManagementParameters(t),this}async encrypt(t,r){const i=await this.#e.encrypt(t,r);return[i.protected,i.encrypted_key,i.iv,i.ciphertext,i.tag].join(".")}}async function BI(e,t,r){const i=await Vy(e,t,"sign");Mc(e,i);const n=await crypto.subtle.sign(By(e,i.algorithm),i,r);return new Uint8Array(n)}class VI{#e;#t;#r;constructor(t){if(!(t instanceof Uint8Array))throw new TypeError("payload must be an instance of Uint8Array");this.#e=t}setProtectedHeader(t){if(this.#t)throw new TypeError("setProtectedHeader can only be called once");return this.#t=t,this}setUnprotectedHeader(t){if(this.#r)throw new TypeError("setUnprotectedHeader can only be called once");return this.#r=t,this}async sign(t,r){if(!this.#t&&!this.#r)throw new Fe("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!jc(this.#t,this.#r))throw new Fe("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");const i={...this.#t,...this.#r},n=qc(Fe,new Map([["b64",!0]]),r?.crit,this.#t,i);let o=!0;if(n.has("b64")&&(o=this.#t.b64,typeof o!="boolean"))throw new Fe('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:a}=i;if(typeof a!="string"||!a)throw new Fe('JWS "alg" (Algorithm) Header Parameter missing or invalid');Fc(a,t,"sign");let s,c;o?(s=ct(this.#e),c=$t(s)):(c=this.#e,s="");let u,d;this.#t?(u=ct(JSON.stringify(this.#t)),d=$t(u)):(u="",d=new Uint8Array);const l=Or(d,$t("."),c),f=await Ea(t,a),h=await BI(a,f,l),g={signature:ct(h),payload:s};return this.#r&&(g.header=this.#r),this.#t&&(g.protected=u),g}}class KI{#e;constructor(t){this.#e=new VI(t)}setProtectedHeader(t){return this.#e.setProtectedHeader(t),this}async sign(t,r){const i=await this.#e.sign(t,r);if(i.payload===void 0)throw new TypeError("use the flattened module for creating JWS with b64: false");return`${i.protected}.${i.payload}.${i.signature}`}}class JI{#e;#t;constructor(t={}){this.#t=new Zy(t)}setIssuer(t){return this.#t.iss=t,this}setSubject(t){return this.#t.sub=t,this}setAudience(t){return this.#t.aud=t,this}setJti(t){return this.#t.jti=t,this}setNotBefore(t){return this.#t.nbf=t,this}setExpirationTime(t){return this.#t.exp=t,this}setIssuedAt(t){return this.#t.iat=t,this}setProtectedHeader(t){return this.#e=t,this}async sign(t,r){const i=new KI(this.#t.data());if(i.setProtectedHeader(this.#e),Array.isArray(this.#e?.crit)&&this.#e.crit.includes("b64")&&this.#e.b64===!1)throw new gr("JWTs MUST NOT use unencoded payload");return i.sign(t,r)}}class HI{#e;#t;#r;#n;#i;#a;#s;#o;constructor(t={}){this.#o=new Zy(t)}setIssuer(t){return this.#o.iss=t,this}setSubject(t){return this.#o.sub=t,this}setAudience(t){return this.#o.aud=t,this}setJti(t){return this.#o.jti=t,this}setNotBefore(t){return this.#o.nbf=t,this}setExpirationTime(t){return this.#o.exp=t,this}setIssuedAt(t){return this.#o.iat=t,this}setProtectedHeader(t){if(this.#n)throw new TypeError("setProtectedHeader can only be called once");return this.#n=t,this}setKeyManagementParameters(t){if(this.#r)throw new TypeError("setKeyManagementParameters can only be called once");return this.#r=t,this}setContentEncryptionKey(t){if(this.#e)throw new TypeError("setContentEncryptionKey can only be called once");return this.#e=t,this}setInitializationVector(t){if(this.#t)throw new TypeError("setInitializationVector can only be called once");return this.#t=t,this}replicateIssuerAsHeader(){return this.#i=!0,this}replicateSubjectAsHeader(){return this.#a=!0,this}replicateAudienceAsHeader(){return this.#s=!0,this}async encrypt(t,r){const i=new FI(this.#o.data());return this.#n&&(this.#i||this.#a||this.#s)&&(this.#n={...this.#n,iss:this.#i?this.#o.iss:void 0,sub:this.#a?this.#o.sub:void 0,aud:this.#s?this.#o.aud:void 0}),i.setProtectedHeader(this.#n),this.#t&&i.setInitializationVector(this.#t),this.#e&&i.setContentEncryptionKey(this.#e),this.#r&&i.setKeyManagementParameters(this.#r),i.encrypt(t,r)}}const mr=(e,t)=>{if(typeof e!="string"||!e)throw new YA(`${t} missing or invalid`)};async function Gy(e,t){let r;if(Wc(e))r=e;else if(sf(e))r=await Fy(e);else throw new TypeError(gi(e,"CryptoKey","KeyObject","JSON Web Key"));if(t??="sha256",t!=="sha256"&&t!=="sha384"&&t!=="sha512")throw new TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');let i;switch(r.kty){case"AKP":mr(r.alg,'"alg" (Algorithm) Parameter'),mr(r.pub,'"pub" (Public key) Parameter'),i={alg:r.alg,kty:r.kty,pub:r.pub};break;case"EC":mr(r.crv,'"crv" (Curve) Parameter'),mr(r.x,'"x" (X Coordinate) Parameter'),mr(r.y,'"y" (Y Coordinate) Parameter'),i={crv:r.crv,kty:r.kty,x:r.x,y:r.y};break;case"OKP":mr(r.crv,'"crv" (Subtype of Key Pair) Parameter'),mr(r.x,'"x" (Public Key) Parameter'),i={crv:r.crv,kty:r.kty,x:r.x};break;case"RSA":mr(r.e,'"e" (Exponent) Parameter'),mr(r.n,'"n" (Modulus) Parameter'),i={e:r.e,kty:r.kty,n:r.n};break;case"oct":mr(r.k,'"k" (Key Value) Parameter'),i={k:r.k,kty:r.kty};break;default:throw new Me('"kty" (Key Type) Parameter missing or unsupported')}const n=$t(JSON.stringify(i));return ct(await Ly(t,n))}function ZI(e){switch(typeof e=="string"&&e.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";case"ML":return"AKP";default:throw new Me('Unsupported "alg" value for a JSON Web Key Set')}}function GI(e){return e&&typeof e=="object"&&Array.isArray(e.keys)&&e.keys.every(QI)}function QI(e){return Et(e)}class YI{#e;#t=new WeakMap;constructor(t){if(!GI(t))throw new Ay("JSON Web Key Set malformed");this.#e=structuredClone(t)}jwks(){return this.#e}async getKey(t,r){const{alg:i,kid:n}={...t,...r?.header},o=ZI(i),a=this.#e.keys.filter(u=>{let d=o===u.kty;if(d&&typeof n=="string"&&(d=n===u.kid),d&&(typeof u.alg=="string"||o==="AKP")&&(d=i===u.alg),d&&typeof u.use=="string"&&(d=u.use==="sig"),d&&Array.isArray(u.key_ops)&&(d=u.key_ops.includes("verify")),d)switch(i){case"ES256":d=u.crv==="P-256";break;case"ES384":d=u.crv==="P-384";break;case"ES512":d=u.crv==="P-521";break;case"Ed25519":case"EdDSA":d=u.crv==="Ed25519";break}return d}),{0:s,length:c}=a;if(c===0)throw new Iy;if(c!==1){const u=new XA,d=this.#t;throw u[Symbol.asyncIterator]=async function*(){for(const l of a)try{yield await Rm(d,l,i)}catch{}},u}return Rm(this.#t,s,i)}}async function Rm(e,t,r){const i=e.get(t)||e.set(t,{}).get(t);if(i[r]===void 0){const n=await $a({...t,ext:!0},r);if(n instanceof Uint8Array||n.type!=="public")throw new Ay("JSON Web Key Set members must be public keys");i[r]=n}return i[r]}function Um(e){const t=new YI(e),r=async(i,n)=>t.getKey(i,n);return Object.defineProperties(r,{jwks:{value:()=>structuredClone(t.jwks()),enumerable:!1,configurable:!1,writable:!1}}),r}function XI(){return typeof WebSocketPair<"u"||typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"||typeof EdgeRuntime<"u"&&EdgeRuntime==="vercel"}let wl;(typeof navigator>"u"||!navigator.userAgent?.startsWith?.("Mozilla/5.0 "))&&(wl="jose/v6.1.1");const eT=Symbol();async function tT(e,t,r,i=fetch){const n=await i(e,{method:"GET",signal:r,redirect:"manual",headers:t}).catch(o=>{throw o.name==="TimeoutError"?new eI:o});if(n.status!==200)throw new _t("Expected 200 OK from the JSON Web Key Set HTTP response");try{return await n.json()}catch{throw new _t("Failed to parse the JSON Web Key Set HTTP response as JSON")}}const Wd=Symbol();function rT(e,t){return!(typeof e!="object"||e===null||!("uat"in e)||typeof e.uat!="number"||Date.now()-e.uat>=t||!("jwks"in e)||!Et(e.jwks)||!Array.isArray(e.jwks.keys)||!Array.prototype.every.call(e.jwks.keys,Et))}class nT{#e;#t;#r;#n;#i;#a;#s;#o;#c;#u;constructor(t,r){if(!(t instanceof URL))throw new TypeError("url must be an instance of URL");this.#e=new URL(t.href),this.#t=typeof r?.timeoutDuration=="number"?r?.timeoutDuration:5e3,this.#r=typeof r?.cooldownDuration=="number"?r?.cooldownDuration:3e4,this.#n=typeof r?.cacheMaxAge=="number"?r?.cacheMaxAge:6e5,this.#s=new Headers(r?.headers),wl&&!this.#s.has("User-Agent")&&this.#s.set("User-Agent",wl),this.#s.has("accept")||(this.#s.set("accept","application/json"),this.#s.append("accept","application/jwk-set+json")),this.#o=r?.[eT],r?.[Wd]!==void 0&&(this.#u=r?.[Wd],rT(r?.[Wd],this.#n)&&(this.#i=this.#u.uat,this.#c=Um(this.#u.jwks)))}pendingFetch(){return!!this.#a}coolingDown(){return typeof this.#i=="number"?Date.now()<this.#i+this.#r:!1}fresh(){return typeof this.#i=="number"?Date.now()<this.#i+this.#n:!1}jwks(){return this.#c?.jwks()}async getKey(t,r){(!this.#c||!this.fresh())&&await this.reload();try{return await this.#c(t,r)}catch(i){if(i instanceof Iy&&this.coolingDown()===!1)return await this.reload(),this.#c(t,r);throw i}}async reload(){this.#a&&XI()&&(this.#a=void 0),this.#a||=tT(this.#e.href,this.#s,AbortSignal.timeout(this.#t),this.#o).then(t=>{this.#c=Um(t),this.#u&&(this.#u.uat=Date.now(),this.#u.jwks=t),this.#i=Date.now(),this.#a=void 0}).catch(t=>{throw this.#a=void 0,t}),await this.#a}}function iT(e,t){const r=new nT(e,t),i=async(n,o)=>r.getKey(n,o);return Object.defineProperties(i,{coolingDown:{get:()=>r.coolingDown(),enumerable:!0,configurable:!1},fresh:{get:()=>r.fresh(),enumerable:!0,configurable:!1},reload:{value:()=>r.reload(),enumerable:!0,configurable:!1,writable:!1},reloading:{get:()=>r.pendingFetch(),enumerable:!0,configurable:!1},jwks:{value:()=>r.jwks(),enumerable:!0,configurable:!1,writable:!1}}),i}function df(e){let t;if(typeof e=="string"){const r=e.split(".");(r.length===3||r.length===5)&&([t]=r)}else if(typeof e=="object"&&e)if("protected"in e)t=e.protected;else throw new TypeError("Token does not contain a Protected Header");try{if(typeof t!="string"||!t)throw new Error;const r=JSON.parse(Gr.decode(st(t)));if(!Et(r))throw new Error;return r}catch{throw new TypeError("Invalid Token or Protected Header formatting")}}function dn(e){if(typeof e!="string")throw new gr("JWTs must use Compact JWS serialization, JWT must be a string");const{1:t,length:r}=e.split(".");if(r===5)throw new gr("Only JWTs using Compact JWS serialization can be decoded");if(r!==3)throw new gr("Invalid JWT");if(!t)throw new gr("JWTs must contain a payload");let i;try{i=st(t)}catch{throw new gr("Failed to base64url decode the payload")}let n;try{n=JSON.parse(Gr.decode(i))}catch{throw new gr("Failed to parse the decoded payload as JSON")}if(!Et(n))throw new gr("Invalid JWT Claims Set");return n}async function Qy(e,t,r=3600){return await new JI(e).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime(Math.floor(Date.now()/1e3)+r).sign(new TextEncoder().encode(t))}async function oT(e,t){try{return(await ho(e,new TextEncoder().encode(t))).payload}catch{return null}}const Yy=new Uint8Array([66,101,116,116,101,114,65,117,116,104,46,106,115,32,71,101,110,101,114,97,116,101,100,32,69,110,99,114,121,112,116,105,111,110,32,75,101,121]),aT=()=>Date.now()/1e3|0,Xy="dir",ew="A256CBC-HS512";async function tw(e,t,r,i=3600){const n=$y(zc,new TextEncoder().encode(t),new TextEncoder().encode(r),Yy,64),o=await Gy({kty:"oct",k:ct(n)},"sha256");return await new HI(e).setProtectedHeader({alg:Xy,enc:ew,kid:o}).setIssuedAt().setExpirationTime(aT()+i).setJti(crypto.randomUUID()).encrypt(n)}async function rw(e,t,r){if(!e)return null;try{const{payload:i}=await WI(e,async({kid:n})=>{const o=$y(zc,new TextEncoder().encode(t),new TextEncoder().encode(r),Yy,64);if(n===void 0||n===await Gy({kty:"oct",k:ct(o)},"sha256"))return o;throw new Error("no matching decryption secret")},{clockTolerance:15,keyManagementAlgorithms:[Xy],contentEncryptionAlgorithms:[ew,"A256GCM"]});return i}catch{return null}}function nw(e,t,r){let i=!1;return function(...n){return i||((r?.warn??console.warn)(`[Deprecation] ${t}`),i=!0),e.apply(this,n)}}const pa=e=>nf("a-z","A-Z","0-9")(e||32),lf=Object.freeze({status:"aborted"});function $(e,t,r){function i(s,c){if(s._zod||Object.defineProperty(s,"_zod",{value:{def:c,constr:a,traits:new Set},enumerable:!1}),s._zod.traits.has(e))return;s._zod.traits.add(e),t(s,c);const u=a.prototype,d=Object.keys(u);for(let l=0;l<d.length;l++){const f=d[l];f in s||(s[f]=u[f].bind(s))}}const n=r?.Parent??Object;class o extends n{}Object.defineProperty(o,"name",{value:e});function a(s){var c;const u=r?.Parent?new o:this;i(u,s),(c=u._zod).deferred??(c.deferred=[]);for(const d of u._zod.deferred)d();return u}return Object.defineProperty(a,"init",{value:i}),Object.defineProperty(a,Symbol.hasInstance,{value:s=>r?.Parent&&s instanceof r.Parent?!0:s?._zod?.traits?.has(e)}),Object.defineProperty(a,"name",{value:e}),a}const ff=Symbol("zod_brand");class ni extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class Bc extends Error{constructor(t){super(`Encountered unidirectional transform during encode: ${t}`),this.name="ZodEncodeError"}}const ac={};function pt(e){return e&&Object.assign(ac,e),ac}function sT(e){return e}function cT(e){return e}function uT(e){}function dT(e){throw new Error("Unexpected value in exhaustive check")}function lT(e){}function hf(e){const t=Object.values(e).filter(i=>typeof i=="number");return Object.entries(e).filter(([i,n])=>t.indexOf(+i)===-1).map(([i,n])=>n)}function q(e,t="|"){return e.map(r=>X(r)).join(t)}function sc(e,t){return typeof t=="bigint"?t.toString():t}function Aa(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function yi(e){return e==null}function Vc(e){const t=e.startsWith("^")?1:0,r=e.endsWith("$")?e.length-1:e.length;return e.slice(t,r)}function iw(e,t){const r=(e.toString().split(".")[1]||"").length,i=t.toString();let n=(i.split(".")[1]||"").length;if(n===0&&/\d?e-\d?/.test(i)){const c=i.match(/\d?e-(\d?)/);c?.[1]&&(n=Number.parseInt(c[1]))}const o=r>n?r:n,a=Number.parseInt(e.toFixed(o).replace(".","")),s=Number.parseInt(t.toFixed(o).replace(".",""));return a%s/10**o}const Cm=Symbol("evaluating");function ae(e,t,r){let i;Object.defineProperty(e,t,{get(){if(i!==Cm)return i===void 0&&(i=Cm,i=r()),i},set(n){Object.defineProperty(e,t,{value:n})},configurable:!0})}function fT(e){return Object.create(Object.getPrototypeOf(e),Object.getOwnPropertyDescriptors(e))}function jn(e,t,r){Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0})}function Dr(...e){const t={};for(const r of e){const i=Object.getOwnPropertyDescriptors(r);Object.assign(t,i)}return Object.defineProperties({},t)}function hT(e){return Dr(e._zod.def)}function pT(e,t){return t?t.reduce((r,i)=>r?.[i],e):e}function mT(e){const t=Object.keys(e),r=t.map(i=>e[i]);return Promise.all(r).then(i=>{const n={};for(let o=0;o<t.length;o++)n[t[o]]=i[o];return n})}function gT(e=10){const t="abcdefghijklmnopqrstuvwxyz";let r="";for(let i=0;i<e;i++)r+=t[Math.floor(Math.random()*t.length)];return r}function vl(e){return JSON.stringify(e)}function ow(e){return e.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}const pf="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function Ki(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}const aw=Aa(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const e=Function;return new e(""),!0}catch{return!1}});function ci(e){if(Ki(e)===!1)return!1;const t=e.constructor;if(t===void 0||typeof t!="function")return!0;const r=t.prototype;return!(Ki(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}function Kc(e){return ci(e)?{...e}:Array.isArray(e)?[...e]:e}function yT(e){let t=0;for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}const wT=e=>{const t=typeof e;switch(t){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(e)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":return Array.isArray(e)?"array":e===null?"null":e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?"promise":typeof Map<"u"&&e instanceof Map?"map":typeof Set<"u"&&e instanceof Set?"set":typeof Date<"u"&&e instanceof Date?"date":typeof File<"u"&&e instanceof File?"file":"object";default:throw new Error(`Unknown data type: ${t}`)}},cc=new Set(["string","number","symbol"]),sw=new Set(["string","number","bigint","boolean","symbol","undefined"]);function Qr(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Ht(e,t,r){const i=new e._zod.constr(t??e._zod.def);return(!t||r?.parent)&&(i._zod.parent=e),i}function L(e){const t=e;if(!t)return{};if(typeof t=="string")return{error:()=>t};if(t?.message!==void 0){if(t?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function vT(e){let t;return new Proxy({},{get(r,i,n){return t??(t=e()),Reflect.get(t,i,n)},set(r,i,n,o){return t??(t=e()),Reflect.set(t,i,n,o)},has(r,i){return t??(t=e()),Reflect.has(t,i)},deleteProperty(r,i){return t??(t=e()),Reflect.deleteProperty(t,i)},ownKeys(r){return t??(t=e()),Reflect.ownKeys(t)},getOwnPropertyDescriptor(r,i){return t??(t=e()),Reflect.getOwnPropertyDescriptor(t,i)},defineProperty(r,i,n){return t??(t=e()),Reflect.defineProperty(t,i,n)}})}function X(e){return typeof e=="bigint"?e.toString()+"n":typeof e=="string"?`"${e}"`:`${e}`}function cw(e){return Object.keys(e).filter(t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional")}const uw={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},dw={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]};function lw(e,t){const r=e._zod.def,i=r.checks;if(i&&i.length>0)throw new Error(".pick() cannot be used on object schemas containing refinements");const o=Dr(e._zod.def,{get shape(){const a={};for(const s in t){if(!(s in r.shape))throw new Error(`Unrecognized key: "${s}"`);t[s]&&(a[s]=r.shape[s])}return jn(this,"shape",a),a},checks:[]});return Ht(e,o)}function fw(e,t){const r=e._zod.def,i=r.checks;if(i&&i.length>0)throw new Error(".omit() cannot be used on object schemas containing refinements");const o=Dr(e._zod.def,{get shape(){const a={...e._zod.def.shape};for(const s in t){if(!(s in r.shape))throw new Error(`Unrecognized key: "${s}"`);t[s]&&delete a[s]}return jn(this,"shape",a),a},checks:[]});return Ht(e,o)}function hw(e,t){if(!ci(t))throw new Error("Invalid input to extend: expected a plain object");const r=e._zod.def.checks;if(r&&r.length>0){const o=e._zod.def.shape;for(const a in t)if(Object.getOwnPropertyDescriptor(o,a)!==void 0)throw new Error("Cannot overwrite keys on object schemas containing refinements. Use `.safeExtend()` instead.")}const n=Dr(e._zod.def,{get shape(){const o={...e._zod.def.shape,...t};return jn(this,"shape",o),o}});return Ht(e,n)}function pw(e,t){if(!ci(t))throw new Error("Invalid input to safeExtend: expected a plain object");const r=Dr(e._zod.def,{get shape(){const i={...e._zod.def.shape,...t};return jn(this,"shape",i),i}});return Ht(e,r)}function mw(e,t){const r=Dr(e._zod.def,{get shape(){const i={...e._zod.def.shape,...t._zod.def.shape};return jn(this,"shape",i),i},get catchall(){return t._zod.def.catchall},checks:[]});return Ht(e,r)}function gw(e,t,r){const n=t._zod.def.checks;if(n&&n.length>0)throw new Error(".partial() cannot be used on object schemas containing refinements");const a=Dr(t._zod.def,{get shape(){const s=t._zod.def.shape,c={...s};if(r)for(const u in r){if(!(u in s))throw new Error(`Unrecognized key: "${u}"`);r[u]&&(c[u]=e?new e({type:"optional",innerType:s[u]}):s[u])}else for(const u in s)c[u]=e?new e({type:"optional",innerType:s[u]}):s[u];return jn(this,"shape",c),c},checks:[]});return Ht(t,a)}function yw(e,t,r){const i=Dr(t._zod.def,{get shape(){const n=t._zod.def.shape,o={...n};if(r)for(const a in r){if(!(a in o))throw new Error(`Unrecognized key: "${a}"`);r[a]&&(o[a]=new e({type:"nonoptional",innerType:n[a]}))}else for(const a in n)o[a]=new e({type:"nonoptional",innerType:n[a]});return jn(this,"shape",o),o}});return Ht(t,i)}function ei(e,t=0){if(e.aborted===!0)return!0;for(let r=t;r<e.issues.length;r++)if(e.issues[r]?.continue!==!0)return!0;return!1}function lr(e,t){return t.map(r=>{var i;return(i=r).path??(i.path=[]),r.path.unshift(e),r})}function Fo(e){return typeof e=="string"?e:e?.message}function nr(e,t,r){const i={...e,path:e.path??[]};if(!e.message){const n=Fo(e.inst?._zod.def?.error?.(e))??Fo(t?.error?.(e))??Fo(r.customError?.(e))??Fo(r.localeError?.(e))??"Invalid input";i.message=n}return delete i.inst,delete i.continue,t?.reportInput||delete i.input,i}function Jc(e){return e instanceof Set?"set":e instanceof Map?"map":e instanceof File?"file":"unknown"}function Hc(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function ee(e){const t=typeof e;switch(t){case"number":return Number.isNaN(e)?"nan":"number";case"object":{if(e===null)return"null";if(Array.isArray(e))return"array";const r=e;if(r&&Object.getPrototypeOf(r)!==Object.prototype&&"constructor"in r&&r.constructor)return r.constructor.name}}return t}function Ji(...e){const[t,r,i]=e;return typeof t=="string"?{message:t,code:"custom",input:r,inst:i}:{...t}}function bT(e){return Object.entries(e).filter(([t,r])=>Number.isNaN(Number.parseInt(t,10))).map(t=>t[1])}function ww(e){const t=atob(e),r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}function vw(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return btoa(t)}function _T(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),r="=".repeat((4-t.length%4)%4);return ww(t+r)}function ST(e){return vw(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function kT(e){const t=e.replace(/^0x/,"");if(t.length%2!==0)throw new Error("Invalid hex string length");const r=new Uint8Array(t.length/2);for(let i=0;i<t.length;i+=2)r[i/2]=Number.parseInt(t.slice(i,i+2),16);return r}function NT(e){return Array.from(e).map(t=>t.toString(16).padStart(2,"0")).join("")}class $T{constructor(...t){}}const mf=Object.freeze(Object.defineProperty({__proto__:null,BIGINT_FORMAT_RANGES:dw,Class:$T,NUMBER_FORMAT_RANGES:uw,aborted:ei,allowsEval:aw,assert:lT,assertEqual:sT,assertIs:uT,assertNever:dT,assertNotEqual:cT,assignProp:jn,base64ToUint8Array:ww,base64urlToUint8Array:_T,cached:Aa,captureStackTrace:pf,cleanEnum:bT,cleanRegex:Vc,clone:Ht,cloneDef:hT,createTransparentProxy:vT,defineLazy:ae,esc:vl,escapeRegex:Qr,extend:hw,finalizeIssue:nr,floatSafeRemainder:iw,getElementAtPath:pT,getEnumValues:hf,getLengthableOrigin:Hc,getParsedType:wT,getSizableOrigin:Jc,hexToUint8Array:kT,isObject:Ki,isPlainObject:ci,issue:Ji,joinValues:q,jsonStringifyReplacer:sc,merge:mw,mergeDefs:Dr,normalizeParams:L,nullish:yi,numKeys:yT,objectClone:fT,omit:fw,optionalKeys:cw,parsedType:ee,partial:gw,pick:lw,prefixIssues:lr,primitiveTypes:sw,promiseAllObject:mT,propertyKeyTypes:cc,randomString:gT,required:yw,safeExtend:pw,shallowClone:Kc,slugify:ow,stringifyPrimitive:X,uint8ArrayToBase64:vw,uint8ArrayToBase64url:ST,uint8ArrayToHex:NT,unwrapMessage:Fo},Symbol.toStringTag,{value:"Module"})),bw=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),e.message=JSON.stringify(t,sc,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},gf=$("$ZodError",bw),Zt=$("$ZodError",bw,{Parent:Error});function Zc(e,t=r=>r.message){const r={},i=[];for(const n of e.issues)n.path.length>0?(r[n.path[0]]=r[n.path[0]]||[],r[n.path[0]].push(t(n))):i.push(t(n));return{formErrors:i,fieldErrors:r}}function Gc(e,t=r=>r.message){const r={_errors:[]},i=n=>{for(const o of n.issues)if(o.code==="invalid_union"&&o.errors.length)o.errors.map(a=>i({issues:a}));else if(o.code==="invalid_key")i({issues:o.issues});else if(o.code==="invalid_element")i({issues:o.issues});else if(o.path.length===0)r._errors.push(t(o));else{let a=r,s=0;for(;s<o.path.length;){const c=o.path[s];s===o.path.length-1?(a[c]=a[c]||{_errors:[]},a[c]._errors.push(t(o))):a[c]=a[c]||{_errors:[]},a=a[c],s++}}};return i(e),r}function yf(e,t=r=>r.message){const r={errors:[]},i=(n,o=[])=>{var a,s;for(const c of n.issues)if(c.code==="invalid_union"&&c.errors.length)c.errors.map(u=>i({issues:u},c.path));else if(c.code==="invalid_key")i({issues:c.issues},c.path);else if(c.code==="invalid_element")i({issues:c.issues},c.path);else{const u=[...o,...c.path];if(u.length===0){r.errors.push(t(c));continue}let d=r,l=0;for(;l<u.length;){const f=u[l],h=l===u.length-1;typeof f=="string"?(d.properties??(d.properties={}),(a=d.properties)[f]??(a[f]={errors:[]}),d=d.properties[f]):(d.items??(d.items=[]),(s=d.items)[f]??(s[f]={errors:[]}),d=d.items[f]),h&&d.errors.push(t(c)),l++}}};return i(e),r}function _w(e){const t=[],r=e.map(i=>typeof i=="object"?i.key:i);for(const i of r)typeof i=="number"?t.push(`[${i}]`):typeof i=="symbol"?t.push(`[${JSON.stringify(String(i))}]`):/[^\w$]/.test(i)?t.push(`[${JSON.stringify(i)}]`):(t.length&&t.push("."),t.push(i));return t.join("")}function wf(e){const t=[],r=[...e.issues].sort((i,n)=>(i.path??[]).length-(n.path??[]).length);for(const i of r)t.push(` ${i.message}`),i.path?.length&&t.push(`   at ${_w(i.path)}`);return t.join(`
`)}const Ia=e=>(t,r,i,n)=>{const o=i?Object.assign(i,{async:!1}):{async:!1},a=t._zod.run({value:r,issues:[]},o);if(a instanceof Promise)throw new ni;if(a.issues.length){const s=new(n?.Err??e)(a.issues.map(c=>nr(c,o,pt())));throw pf(s,n?.callee),s}return a.value},bl=Ia(Zt),Ta=e=>async(t,r,i,n)=>{const o=i?Object.assign(i,{async:!0}):{async:!0};let a=t._zod.run({value:r,issues:[]},o);if(a instanceof Promise&&(a=await a),a.issues.length){const s=new(n?.Err??e)(a.issues.map(c=>nr(c,o,pt())));throw pf(s,n?.callee),s}return a.value},_l=Ta(Zt),xa=e=>(t,r,i)=>{const n=i?{...i,async:!1}:{async:!1},o=t._zod.run({value:r,issues:[]},n);if(o instanceof Promise)throw new ni;return o.issues.length?{success:!1,error:new(e??gf)(o.issues.map(a=>nr(a,n,pt())))}:{success:!0,data:o.value}},Sw=xa(Zt),Oa=e=>async(t,r,i)=>{const n=i?Object.assign(i,{async:!0}):{async:!0};let o=t._zod.run({value:r,issues:[]},n);return o instanceof Promise&&(o=await o),o.issues.length?{success:!1,error:new e(o.issues.map(a=>nr(a,n,pt())))}:{success:!0,data:o.value}},kw=Oa(Zt),vf=e=>(t,r,i)=>{const n=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return Ia(e)(t,r,n)},ET=vf(Zt),bf=e=>(t,r,i)=>Ia(e)(t,r,i),AT=bf(Zt),_f=e=>async(t,r,i)=>{const n=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return Ta(e)(t,r,n)},IT=_f(Zt),Sf=e=>async(t,r,i)=>Ta(e)(t,r,i),TT=Sf(Zt),kf=e=>(t,r,i)=>{const n=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return xa(e)(t,r,n)},xT=kf(Zt),Nf=e=>(t,r,i)=>xa(e)(t,r,i),OT=Nf(Zt),$f=e=>async(t,r,i)=>{const n=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return Oa(e)(t,r,n)},DT=$f(Zt),Ef=e=>async(t,r,i)=>Oa(e)(t,r,i),RT=Ef(Zt),Nw=/^[cC][^\s-]{8,}$/,$w=/^[0-9a-z]+$/,Ew=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,Aw=/^[0-9a-vA-V]{20}$/,Iw=/^[A-Za-z0-9]{27}$/,Tw=/^[a-zA-Z0-9_-]{21}$/,xw=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,UT=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Ow=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Hi=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,CT=Hi(4),PT=Hi(6),LT=Hi(7),Dw=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,zT=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,jT=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,Rw=/^[^\s@"]{1,64}@[^\s@]{1,255}$/u,MT=Rw,qT=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,WT="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function Uw(){return new RegExp(WT,"u")}const Cw=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Pw=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,Lw=e=>{const t=Qr(e??":");return new RegExp(`^(?:[0-9A-F]{2}${t}){5}[0-9A-F]{2}$|^(?:[0-9a-f]{2}${t}){5}[0-9a-f]{2}$`)},zw=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,jw=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Mw=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,Af=/^[A-Za-z0-9_-]*$/,qw=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,Ww=/^([a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}$/,Fw=/^\+[1-9]\d{6,14}$/,Bw="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",Vw=new RegExp(`^${Bw}$`);function Kw(e){const t="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof e.precision=="number"?e.precision===-1?`${t}`:e.precision===0?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function Jw(e){return new RegExp(`^${Kw(e)}$`)}function Hw(e){const t=Kw({precision:e.precision}),r=["Z"];e.local&&r.push(""),e.offset&&r.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const i=`${t}(?:${r.join("|")})`;return new RegExp(`^${Bw}T(?:${i})$`)}const Zw=e=>{const t=e?`[\\s\\S]{${e?.minimum??0},${e?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)},Gw=/^-?\d+n?$/,Qw=/^-?\d+$/,If=/^-?\d+(?:\.\d+)?$/,Yw=/^(?:true|false)$/i,Xw=/^null$/i,ev=/^undefined$/i,tv=/^[^A-Z]*$/,rv=/^[^a-z]*$/,nv=/^[0-9a-fA-F]*$/;function Da(e,t){return new RegExp(`^[A-Za-z0-9+/]{${e}}${t}$`)}function Ra(e){return new RegExp(`^[A-Za-z0-9_-]{${e}}$`)}const FT=/^[0-9a-fA-F]{32}$/,BT=Da(22,"=="),VT=Ra(22),KT=/^[0-9a-fA-F]{40}$/,JT=Da(27,"="),HT=Ra(27),ZT=/^[0-9a-fA-F]{64}$/,GT=Da(43,"="),QT=Ra(43),YT=/^[0-9a-fA-F]{96}$/,XT=Da(64,""),ex=Ra(64),tx=/^[0-9a-fA-F]{128}$/,rx=Da(86,"=="),nx=Ra(86),Qc=Object.freeze(Object.defineProperty({__proto__:null,base64:Mw,base64url:Af,bigint:Gw,boolean:Yw,browserEmail:qT,cidrv4:zw,cidrv6:jw,cuid:Nw,cuid2:$w,date:Vw,datetime:Hw,domain:Ww,duration:xw,e164:Fw,email:Dw,emoji:Uw,extendedDuration:UT,guid:Ow,hex:nv,hostname:qw,html5Email:zT,idnEmail:MT,integer:Qw,ipv4:Cw,ipv6:Pw,ksuid:Iw,lowercase:tv,mac:Lw,md5_base64:BT,md5_base64url:VT,md5_hex:FT,nanoid:Tw,null:Xw,number:If,rfc5322Email:jT,sha1_base64:JT,sha1_base64url:HT,sha1_hex:KT,sha256_base64:GT,sha256_base64url:QT,sha256_hex:ZT,sha384_base64:XT,sha384_base64url:ex,sha384_hex:YT,sha512_base64:rx,sha512_base64url:nx,sha512_hex:tx,string:Zw,time:Jw,ulid:Ew,undefined:ev,unicodeEmail:Rw,uppercase:rv,uuid:Hi,uuid4:CT,uuid6:PT,uuid7:LT,xid:Aw},Symbol.toStringTag,{value:"Module"})),ze=$("$ZodCheck",(e,t)=>{var r;e._zod??(e._zod={}),e._zod.def=t,(r=e._zod).onattach??(r.onattach=[])}),iv={number:"number",bigint:"bigint",object:"date"},Tf=$("$ZodCheckLessThan",(e,t)=>{ze.init(e,t);const r=iv[typeof t.value];e._zod.onattach.push(i=>{const n=i._zod.bag,o=(t.inclusive?n.maximum:n.exclusiveMaximum)??Number.POSITIVE_INFINITY;t.value<o&&(t.inclusive?n.maximum=t.value:n.exclusiveMaximum=t.value)}),e._zod.check=i=>{(t.inclusive?i.value<=t.value:i.value<t.value)||i.issues.push({origin:r,code:"too_big",maximum:typeof t.value=="object"?t.value.getTime():t.value,input:i.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),xf=$("$ZodCheckGreaterThan",(e,t)=>{ze.init(e,t);const r=iv[typeof t.value];e._zod.onattach.push(i=>{const n=i._zod.bag,o=(t.inclusive?n.minimum:n.exclusiveMinimum)??Number.NEGATIVE_INFINITY;t.value>o&&(t.inclusive?n.minimum=t.value:n.exclusiveMinimum=t.value)}),e._zod.check=i=>{(t.inclusive?i.value>=t.value:i.value>t.value)||i.issues.push({origin:r,code:"too_small",minimum:typeof t.value=="object"?t.value.getTime():t.value,input:i.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),ov=$("$ZodCheckMultipleOf",(e,t)=>{ze.init(e,t),e._zod.onattach.push(r=>{var i;(i=r._zod.bag).multipleOf??(i.multipleOf=t.value)}),e._zod.check=r=>{if(typeof r.value!=typeof t.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%t.value===BigInt(0):iw(r.value,t.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:t.value,input:r.value,inst:e,continue:!t.abort})}}),av=$("$ZodCheckNumberFormat",(e,t)=>{ze.init(e,t),t.format=t.format||"float64";const r=t.format?.includes("int"),i=r?"int":"number",[n,o]=uw[t.format];e._zod.onattach.push(a=>{const s=a._zod.bag;s.format=t.format,s.minimum=n,s.maximum=o,r&&(s.pattern=Qw)}),e._zod.check=a=>{const s=a.value;if(r){if(!Number.isInteger(s)){a.issues.push({expected:i,format:t.format,code:"invalid_type",continue:!1,input:s,inst:e});return}if(!Number.isSafeInteger(s)){s>0?a.issues.push({input:s,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:i,inclusive:!0,continue:!t.abort}):a.issues.push({input:s,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:i,inclusive:!0,continue:!t.abort});return}}s<n&&a.issues.push({origin:"number",input:s,code:"too_small",minimum:n,inclusive:!0,inst:e,continue:!t.abort}),s>o&&a.issues.push({origin:"number",input:s,code:"too_big",maximum:o,inclusive:!0,inst:e,continue:!t.abort})}}),sv=$("$ZodCheckBigIntFormat",(e,t)=>{ze.init(e,t);const[r,i]=dw[t.format];e._zod.onattach.push(n=>{const o=n._zod.bag;o.format=t.format,o.minimum=r,o.maximum=i}),e._zod.check=n=>{const o=n.value;o<r&&n.issues.push({origin:"bigint",input:o,code:"too_small",minimum:r,inclusive:!0,inst:e,continue:!t.abort}),o>i&&n.issues.push({origin:"bigint",input:o,code:"too_big",maximum:i,inclusive:!0,inst:e,continue:!t.abort})}}),cv=$("$ZodCheckMaxSize",(e,t)=>{var r;ze.init(e,t),(r=e._zod.def).when??(r.when=i=>{const n=i.value;return!yi(n)&&n.size!==void 0}),e._zod.onattach.push(i=>{const n=i._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<n&&(i._zod.bag.maximum=t.maximum)}),e._zod.check=i=>{const n=i.value;n.size<=t.maximum||i.issues.push({origin:Jc(n),code:"too_big",maximum:t.maximum,inclusive:!0,input:n,inst:e,continue:!t.abort})}}),uv=$("$ZodCheckMinSize",(e,t)=>{var r;ze.init(e,t),(r=e._zod.def).when??(r.when=i=>{const n=i.value;return!yi(n)&&n.size!==void 0}),e._zod.onattach.push(i=>{const n=i._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>n&&(i._zod.bag.minimum=t.minimum)}),e._zod.check=i=>{const n=i.value;n.size>=t.minimum||i.issues.push({origin:Jc(n),code:"too_small",minimum:t.minimum,inclusive:!0,input:n,inst:e,continue:!t.abort})}}),dv=$("$ZodCheckSizeEquals",(e,t)=>{var r;ze.init(e,t),(r=e._zod.def).when??(r.when=i=>{const n=i.value;return!yi(n)&&n.size!==void 0}),e._zod.onattach.push(i=>{const n=i._zod.bag;n.minimum=t.size,n.maximum=t.size,n.size=t.size}),e._zod.check=i=>{const n=i.value,o=n.size;if(o===t.size)return;const a=o>t.size;i.issues.push({origin:Jc(n),...a?{code:"too_big",maximum:t.size}:{code:"too_small",minimum:t.size},inclusive:!0,exact:!0,input:i.value,inst:e,continue:!t.abort})}}),lv=$("$ZodCheckMaxLength",(e,t)=>{var r;ze.init(e,t),(r=e._zod.def).when??(r.when=i=>{const n=i.value;return!yi(n)&&n.length!==void 0}),e._zod.onattach.push(i=>{const n=i._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<n&&(i._zod.bag.maximum=t.maximum)}),e._zod.check=i=>{const n=i.value;if(n.length<=t.maximum)return;const a=Hc(n);i.issues.push({origin:a,code:"too_big",maximum:t.maximum,inclusive:!0,input:n,inst:e,continue:!t.abort})}}),fv=$("$ZodCheckMinLength",(e,t)=>{var r;ze.init(e,t),(r=e._zod.def).when??(r.when=i=>{const n=i.value;return!yi(n)&&n.length!==void 0}),e._zod.onattach.push(i=>{const n=i._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>n&&(i._zod.bag.minimum=t.minimum)}),e._zod.check=i=>{const n=i.value;if(n.length>=t.minimum)return;const a=Hc(n);i.issues.push({origin:a,code:"too_small",minimum:t.minimum,inclusive:!0,input:n,inst:e,continue:!t.abort})}}),hv=$("$ZodCheckLengthEquals",(e,t)=>{var r;ze.init(e,t),(r=e._zod.def).when??(r.when=i=>{const n=i.value;return!yi(n)&&n.length!==void 0}),e._zod.onattach.push(i=>{const n=i._zod.bag;n.minimum=t.length,n.maximum=t.length,n.length=t.length}),e._zod.check=i=>{const n=i.value,o=n.length;if(o===t.length)return;const a=Hc(n),s=o>t.length;i.issues.push({origin:a,...s?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:i.value,inst:e,continue:!t.abort})}}),Ua=$("$ZodCheckStringFormat",(e,t)=>{var r,i;ze.init(e,t),e._zod.onattach.push(n=>{const o=n._zod.bag;o.format=t.format,t.pattern&&(o.patterns??(o.patterns=new Set),o.patterns.add(t.pattern))}),t.pattern?(r=e._zod).check??(r.check=n=>{t.pattern.lastIndex=0,!t.pattern.test(n.value)&&n.issues.push({origin:"string",code:"invalid_format",format:t.format,input:n.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(i=e._zod).check??(i.check=()=>{})}),pv=$("$ZodCheckRegex",(e,t)=>{Ua.init(e,t),e._zod.check=r=>{t.pattern.lastIndex=0,!t.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),mv=$("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=tv),Ua.init(e,t)}),gv=$("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=rv),Ua.init(e,t)}),yv=$("$ZodCheckIncludes",(e,t)=>{ze.init(e,t);const r=Qr(t.includes),i=new RegExp(typeof t.position=="number"?`^.{${t.position}}${r}`:r);t.pattern=i,e._zod.onattach.push(n=>{const o=n._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(i)}),e._zod.check=n=>{n.value.includes(t.includes,t.position)||n.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:n.value,inst:e,continue:!t.abort})}}),wv=$("$ZodCheckStartsWith",(e,t)=>{ze.init(e,t);const r=new RegExp(`^${Qr(t.prefix)}.*`);t.pattern??(t.pattern=r),e._zod.onattach.push(i=>{const n=i._zod.bag;n.patterns??(n.patterns=new Set),n.patterns.add(r)}),e._zod.check=i=>{i.value.startsWith(t.prefix)||i.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:i.value,inst:e,continue:!t.abort})}}),vv=$("$ZodCheckEndsWith",(e,t)=>{ze.init(e,t);const r=new RegExp(`.*${Qr(t.suffix)}$`);t.pattern??(t.pattern=r),e._zod.onattach.push(i=>{const n=i._zod.bag;n.patterns??(n.patterns=new Set),n.patterns.add(r)}),e._zod.check=i=>{i.value.endsWith(t.suffix)||i.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:i.value,inst:e,continue:!t.abort})}});function Pm(e,t,r){e.issues.length&&t.issues.push(...lr(r,e.issues))}const bv=$("$ZodCheckProperty",(e,t)=>{ze.init(e,t),e._zod.check=r=>{const i=t.schema._zod.run({value:r.value[t.property],issues:[]},{});if(i instanceof Promise)return i.then(n=>Pm(n,r,t.property));Pm(i,r,t.property)}}),_v=$("$ZodCheckMimeType",(e,t)=>{ze.init(e,t);const r=new Set(t.mime);e._zod.onattach.push(i=>{i._zod.bag.mime=t.mime}),e._zod.check=i=>{r.has(i.value.type)||i.issues.push({code:"invalid_value",values:t.mime,input:i.value.type,inst:e,continue:!t.abort})}}),Sv=$("$ZodCheckOverwrite",(e,t)=>{ze.init(e,t),e._zod.check=r=>{r.value=t.tx(r.value)}});class kv{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if(typeof t=="function"){t(this,{execution:"sync"}),t(this,{execution:"async"});return}const i=t.split(`
`).filter(a=>a),n=Math.min(...i.map(a=>a.length-a.trimStart().length)),o=i.map(a=>a.slice(n)).map(a=>" ".repeat(this.indent*2)+a);for(const a of o)this.content.push(a)}compile(){const t=Function,r=this?.args,n=[...(this?.content??[""]).map(o=>`  ${o}`)];return new t(...r,n.join(`
`))}}const Nv={major:4,minor:3,patch:5},te=$("$ZodType",(e,t)=>{var r;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=Nv;const i=[...e._zod.def.checks??[]];e._zod.traits.has("$ZodCheck")&&i.unshift(e);for(const n of i)for(const o of n._zod.onattach)o(e);if(i.length===0)(r=e._zod).deferred??(r.deferred=[]),e._zod.deferred?.push(()=>{e._zod.run=e._zod.parse});else{const n=(a,s,c)=>{let u=ei(a),d;for(const l of s){if(l._zod.def.when){if(!l._zod.def.when(a))continue}else if(u)continue;const f=a.issues.length,h=l._zod.check(a);if(h instanceof Promise&&c?.async===!1)throw new ni;if(d||h instanceof Promise)d=(d??Promise.resolve()).then(async()=>{await h,a.issues.length!==f&&(u||(u=ei(a,f)))});else{if(a.issues.length===f)continue;u||(u=ei(a,f))}}return d?d.then(()=>a):a},o=(a,s,c)=>{if(ei(a))return a.aborted=!0,a;const u=n(s,i,c);if(u instanceof Promise){if(c.async===!1)throw new ni;return u.then(d=>e._zod.parse(d,c))}return e._zod.parse(u,c)};e._zod.run=(a,s)=>{if(s.skipChecks)return e._zod.parse(a,s);if(s.direction==="backward"){const u=e._zod.parse({value:a.value,issues:[]},{...s,skipChecks:!0});return u instanceof Promise?u.then(d=>o(d,a,s)):o(u,a,s)}const c=e._zod.parse(a,s);if(c instanceof Promise){if(s.async===!1)throw new ni;return c.then(u=>n(u,i,s))}return n(c,i,s)}}ae(e,"~standard",()=>({validate:n=>{try{const o=Sw(e,n);return o.success?{value:o.data}:{issues:o.error?.issues}}catch{return kw(e,n).then(a=>a.success?{value:a.data}:{issues:a.error?.issues})}},vendor:"zod",version:1}))}),Ca=$("$ZodString",(e,t)=>{te.init(e,t),e._zod.pattern=[...e?._zod.bag?.patterns??[]].pop()??Zw(e._zod.bag),e._zod.parse=(r,i)=>{if(t.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:e}),r}}),Te=$("$ZodStringFormat",(e,t)=>{Ua.init(e,t),Ca.init(e,t)}),$v=$("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=Ow),Te.init(e,t)}),Ev=$("$ZodUUID",(e,t)=>{if(t.version){const i={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(i===void 0)throw new Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=Hi(i))}else t.pattern??(t.pattern=Hi());Te.init(e,t)}),Av=$("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=Dw),Te.init(e,t)}),Iv=$("$ZodURL",(e,t)=>{Te.init(e,t),e._zod.check=r=>{try{const i=r.value.trim(),n=new URL(i);t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(n.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:t.hostname.source,input:r.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(n.protocol.endsWith(":")?n.protocol.slice(0,-1):n.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:r.value,inst:e,continue:!t.abort})),t.normalize?r.value=n.href:r.value=i;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:e,continue:!t.abort})}}}),Tv=$("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=Uw()),Te.init(e,t)}),xv=$("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=Tw),Te.init(e,t)}),Ov=$("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=Nw),Te.init(e,t)}),Dv=$("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=$w),Te.init(e,t)}),Rv=$("$ZodULID",(e,t)=>{t.pattern??(t.pattern=Ew),Te.init(e,t)}),Uv=$("$ZodXID",(e,t)=>{t.pattern??(t.pattern=Aw),Te.init(e,t)}),Cv=$("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=Iw),Te.init(e,t)}),Pv=$("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=Hw(t)),Te.init(e,t)}),Lv=$("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=Vw),Te.init(e,t)}),zv=$("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=Jw(t)),Te.init(e,t)}),jv=$("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=xw),Te.init(e,t)}),Mv=$("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=Cw),Te.init(e,t),e._zod.bag.format="ipv4"}),qv=$("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=Pw),Te.init(e,t),e._zod.bag.format="ipv6",e._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:e,continue:!t.abort})}}}),Wv=$("$ZodMAC",(e,t)=>{t.pattern??(t.pattern=Lw(t.delimiter)),Te.init(e,t),e._zod.bag.format="mac"}),Fv=$("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=zw),Te.init(e,t)}),Bv=$("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=jw),Te.init(e,t),e._zod.check=r=>{const i=r.value.split("/");try{if(i.length!==2)throw new Error;const[n,o]=i;if(!o)throw new Error;const a=Number(o);if(`${a}`!==o)throw new Error;if(a<0||a>128)throw new Error;new URL(`http://[${n}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:e,continue:!t.abort})}}});function Of(e){if(e==="")return!0;if(e.length%4!==0)return!1;try{return atob(e),!0}catch{return!1}}const Vv=$("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=Mw),Te.init(e,t),e._zod.bag.contentEncoding="base64",e._zod.check=r=>{Of(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:e,continue:!t.abort})}});function Kv(e){if(!Af.test(e))return!1;const t=e.replace(/[-_]/g,i=>i==="-"?"+":"/"),r=t.padEnd(Math.ceil(t.length/4)*4,"=");return Of(r)}const Jv=$("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=Af),Te.init(e,t),e._zod.bag.contentEncoding="base64url",e._zod.check=r=>{Kv(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:e,continue:!t.abort})}}),Hv=$("$ZodE164",(e,t)=>{t.pattern??(t.pattern=Fw),Te.init(e,t)});function Zv(e,t=null){try{const r=e.split(".");if(r.length!==3)return!1;const[i]=r;if(!i)return!1;const n=JSON.parse(atob(i));return!("typ"in n&&n?.typ!=="JWT"||!n.alg||t&&(!("alg"in n)||n.alg!==t))}catch{return!1}}const Gv=$("$ZodJWT",(e,t)=>{Te.init(e,t),e._zod.check=r=>{Zv(r.value,t.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:e,continue:!t.abort})}}),Qv=$("$ZodCustomStringFormat",(e,t)=>{Te.init(e,t),e._zod.check=r=>{t.fn(r.value)||r.issues.push({code:"invalid_format",format:t.format,input:r.value,inst:e,continue:!t.abort})}}),Df=$("$ZodNumber",(e,t)=>{te.init(e,t),e._zod.pattern=e._zod.bag.pattern??If,e._zod.parse=(r,i)=>{if(t.coerce)try{r.value=Number(r.value)}catch{}const n=r.value;if(typeof n=="number"&&!Number.isNaN(n)&&Number.isFinite(n))return r;const o=typeof n=="number"?Number.isNaN(n)?"NaN":Number.isFinite(n)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:n,inst:e,...o?{received:o}:{}}),r}}),Yv=$("$ZodNumberFormat",(e,t)=>{av.init(e,t),Df.init(e,t)}),Rf=$("$ZodBoolean",(e,t)=>{te.init(e,t),e._zod.pattern=Yw,e._zod.parse=(r,i)=>{if(t.coerce)try{r.value=!!r.value}catch{}const n=r.value;return typeof n=="boolean"||r.issues.push({expected:"boolean",code:"invalid_type",input:n,inst:e}),r}}),Uf=$("$ZodBigInt",(e,t)=>{te.init(e,t),e._zod.pattern=Gw,e._zod.parse=(r,i)=>{if(t.coerce)try{r.value=BigInt(r.value)}catch{}return typeof r.value=="bigint"||r.issues.push({expected:"bigint",code:"invalid_type",input:r.value,inst:e}),r}}),Xv=$("$ZodBigIntFormat",(e,t)=>{sv.init(e,t),Uf.init(e,t)}),eb=$("$ZodSymbol",(e,t)=>{te.init(e,t),e._zod.parse=(r,i)=>{const n=r.value;return typeof n=="symbol"||r.issues.push({expected:"symbol",code:"invalid_type",input:n,inst:e}),r}}),tb=$("$ZodUndefined",(e,t)=>{te.init(e,t),e._zod.pattern=ev,e._zod.values=new Set([void 0]),e._zod.optin="optional",e._zod.optout="optional",e._zod.parse=(r,i)=>{const n=r.value;return typeof n>"u"||r.issues.push({expected:"undefined",code:"invalid_type",input:n,inst:e}),r}}),rb=$("$ZodNull",(e,t)=>{te.init(e,t),e._zod.pattern=Xw,e._zod.values=new Set([null]),e._zod.parse=(r,i)=>{const n=r.value;return n===null||r.issues.push({expected:"null",code:"invalid_type",input:n,inst:e}),r}}),nb=$("$ZodAny",(e,t)=>{te.init(e,t),e._zod.parse=r=>r}),ib=$("$ZodUnknown",(e,t)=>{te.init(e,t),e._zod.parse=r=>r}),ob=$("$ZodNever",(e,t)=>{te.init(e,t),e._zod.parse=(r,i)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:e}),r)}),ab=$("$ZodVoid",(e,t)=>{te.init(e,t),e._zod.parse=(r,i)=>{const n=r.value;return typeof n>"u"||r.issues.push({expected:"void",code:"invalid_type",input:n,inst:e}),r}}),sb=$("$ZodDate",(e,t)=>{te.init(e,t),e._zod.parse=(r,i)=>{if(t.coerce)try{r.value=new Date(r.value)}catch{}const n=r.value,o=n instanceof Date;return o&&!Number.isNaN(n.getTime())||r.issues.push({expected:"date",code:"invalid_type",input:n,...o?{received:"Invalid Date"}:{},inst:e}),r}});function Lm(e,t,r){e.issues.length&&t.issues.push(...lr(r,e.issues)),t.value[r]=e.value}const cb=$("$ZodArray",(e,t)=>{te.init(e,t),e._zod.parse=(r,i)=>{const n=r.value;if(!Array.isArray(n))return r.issues.push({expected:"array",code:"invalid_type",input:n,inst:e}),r;r.value=Array(n.length);const o=[];for(let a=0;a<n.length;a++){const s=n[a],c=t.element._zod.run({value:s,issues:[]},i);c instanceof Promise?o.push(c.then(u=>Lm(u,r,a))):Lm(c,r,a)}return o.length?Promise.all(o).then(()=>r):r}});function uc(e,t,r,i,n){if(e.issues.length){if(n&&!(r in i))return;t.issues.push(...lr(r,e.issues))}e.value===void 0?r in i&&(t.value[r]=void 0):t.value[r]=e.value}function ub(e){const t=Object.keys(e.shape);for(const i of t)if(!e.shape?.[i]?._zod?.traits?.has("$ZodType"))throw new Error(`Invalid element at key "${i}": expected a Zod schema`);const r=cw(e.shape);return{...e,keys:t,keySet:new Set(t),numKeys:t.length,optionalKeys:new Set(r)}}function db(e,t,r,i,n,o){const a=[],s=n.keySet,c=n.catchall._zod,u=c.def.type,d=c.optout==="optional";for(const l in t){if(s.has(l))continue;if(u==="never"){a.push(l);continue}const f=c.run({value:t[l],issues:[]},i);f instanceof Promise?e.push(f.then(h=>uc(h,r,l,t,d))):uc(f,r,l,t,d)}return a.length&&r.issues.push({code:"unrecognized_keys",keys:a,input:t,inst:o}),e.length?Promise.all(e).then(()=>r):r}const lb=$("$ZodObject",(e,t)=>{if(te.init(e,t),!Object.getOwnPropertyDescriptor(t,"shape")?.get){const s=t.shape;Object.defineProperty(t,"shape",{get:()=>{const c={...s};return Object.defineProperty(t,"shape",{value:c}),c}})}const i=Aa(()=>ub(t));ae(e._zod,"propValues",()=>{const s=t.shape,c={};for(const u in s){const d=s[u]._zod;if(d.values){c[u]??(c[u]=new Set);for(const l of d.values)c[u].add(l)}}return c});const n=Ki,o=t.catchall;let a;e._zod.parse=(s,c)=>{a??(a=i.value);const u=s.value;if(!n(u))return s.issues.push({expected:"object",code:"invalid_type",input:u,inst:e}),s;s.value={};const d=[],l=a.shape;for(const f of a.keys){const h=l[f],g=h._zod.optout==="optional",m=h._zod.run({value:u[f],issues:[]},c);m instanceof Promise?d.push(m.then(v=>uc(v,s,f,u,g))):uc(m,s,f,u,g)}return o?db(d,u,s,c,i.value,e):d.length?Promise.all(d).then(()=>s):s}}),fb=$("$ZodObjectJIT",(e,t)=>{lb.init(e,t);const r=e._zod.parse,i=Aa(()=>ub(t)),n=f=>{const h=new kv(["shape","payload","ctx"]),g=i.value,m=x=>{const N=vl(x);return`shape[${N}]._zod.run({ value: input[${N}], issues: [] }, ctx)`};h.write("const input = payload.value;");const v=Object.create(null);let b=0;for(const x of g.keys)v[x]=`key_${b++}`;h.write("const newResult = {};");for(const x of g.keys){const N=v[x],y=vl(x),_=f[x]?._zod?.optout==="optional";h.write(`const ${N} = ${m(x)};`),_?h.write(`
        if (${N}.issues.length) {
          if (${y} in input) {
            payload.issues = payload.issues.concat(${N}.issues.map(iss => ({
              ...iss,
              path: iss.path ? [${y}, ...iss.path] : [${y}]
            })));
          }
        }
        
        if (${N}.value === undefined) {
          if (${y} in input) {
            newResult[${y}] = undefined;
          }
        } else {
          newResult[${y}] = ${N}.value;
        }
        
      `):h.write(`
        if (${N}.issues.length) {
          payload.issues = payload.issues.concat(${N}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${y}, ...iss.path] : [${y}]
          })));
        }
        
        if (${N}.value === undefined) {
          if (${y} in input) {
            newResult[${y}] = undefined;
          }
        } else {
          newResult[${y}] = ${N}.value;
        }
        
      `)}h.write("payload.value = newResult;"),h.write("return payload;");const I=h.compile();return(x,N)=>I(f,x,N)};let o;const a=Ki,s=!ac.jitless,u=s&&aw.value,d=t.catchall;let l;e._zod.parse=(f,h)=>{l??(l=i.value);const g=f.value;return a(g)?s&&u&&h?.async===!1&&h.jitless!==!0?(o||(o=n(t.shape)),f=o(f,h),d?db([],g,f,h,l,e):f):r(f,h):(f.issues.push({expected:"object",code:"invalid_type",input:g,inst:e}),f)}});function zm(e,t,r,i){for(const o of e)if(o.issues.length===0)return t.value=o.value,t;const n=e.filter(o=>!ei(o));return n.length===1?(t.value=n[0].value,n[0]):(t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:e.map(o=>o.issues.map(a=>nr(a,i,pt())))}),t)}const Yc=$("$ZodUnion",(e,t)=>{te.init(e,t),ae(e._zod,"optin",()=>t.options.some(n=>n._zod.optin==="optional")?"optional":void 0),ae(e._zod,"optout",()=>t.options.some(n=>n._zod.optout==="optional")?"optional":void 0),ae(e._zod,"values",()=>{if(t.options.every(n=>n._zod.values))return new Set(t.options.flatMap(n=>Array.from(n._zod.values)))}),ae(e._zod,"pattern",()=>{if(t.options.every(n=>n._zod.pattern)){const n=t.options.map(o=>o._zod.pattern);return new RegExp(`^(${n.map(o=>Vc(o.source)).join("|")})$`)}});const r=t.options.length===1,i=t.options[0]._zod.run;e._zod.parse=(n,o)=>{if(r)return i(n,o);let a=!1;const s=[];for(const c of t.options){const u=c._zod.run({value:n.value,issues:[]},o);if(u instanceof Promise)s.push(u),a=!0;else{if(u.issues.length===0)return u;s.push(u)}}return a?Promise.all(s).then(c=>zm(c,n,e,o)):zm(s,n,e,o)}});function jm(e,t,r,i){const n=e.filter(o=>o.issues.length===0);return n.length===1?(t.value=n[0].value,t):(n.length===0?t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:e.map(o=>o.issues.map(a=>nr(a,i,pt())))}):t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:[],inclusive:!1}),t)}const hb=$("$ZodXor",(e,t)=>{Yc.init(e,t),t.inclusive=!1;const r=t.options.length===1,i=t.options[0]._zod.run;e._zod.parse=(n,o)=>{if(r)return i(n,o);let a=!1;const s=[];for(const c of t.options){const u=c._zod.run({value:n.value,issues:[]},o);u instanceof Promise?(s.push(u),a=!0):s.push(u)}return a?Promise.all(s).then(c=>jm(c,n,e,o)):jm(s,n,e,o)}}),pb=$("$ZodDiscriminatedUnion",(e,t)=>{t.inclusive=!1,Yc.init(e,t);const r=e._zod.parse;ae(e._zod,"propValues",()=>{const n={};for(const o of t.options){const a=o._zod.propValues;if(!a||Object.keys(a).length===0)throw new Error(`Invalid discriminated union option at index "${t.options.indexOf(o)}"`);for(const[s,c]of Object.entries(a)){n[s]||(n[s]=new Set);for(const u of c)n[s].add(u)}}return n});const i=Aa(()=>{const n=t.options,o=new Map;for(const a of n){const s=a._zod.propValues?.[t.discriminator];if(!s||s.size===0)throw new Error(`Invalid discriminated union option at index "${t.options.indexOf(a)}"`);for(const c of s){if(o.has(c))throw new Error(`Duplicate discriminator value "${String(c)}"`);o.set(c,a)}}return o});e._zod.parse=(n,o)=>{const a=n.value;if(!Ki(a))return n.issues.push({code:"invalid_type",expected:"object",input:a,inst:e}),n;const s=i.value.get(a?.[t.discriminator]);return s?s._zod.run(n,o):t.unionFallback?r(n,o):(n.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",discriminator:t.discriminator,input:a,path:[t.discriminator],inst:e}),n)}}),mb=$("$ZodIntersection",(e,t)=>{te.init(e,t),e._zod.parse=(r,i)=>{const n=r.value,o=t.left._zod.run({value:n,issues:[]},i),a=t.right._zod.run({value:n,issues:[]},i);return o instanceof Promise||a instanceof Promise?Promise.all([o,a]).then(([c,u])=>Mm(r,c,u)):Mm(r,o,a)}});function Sl(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e==+t)return{valid:!0,data:e};if(ci(e)&&ci(t)){const r=Object.keys(t),i=Object.keys(e).filter(o=>r.indexOf(o)!==-1),n={...e,...t};for(const o of i){const a=Sl(e[o],t[o]);if(!a.valid)return{valid:!1,mergeErrorPath:[o,...a.mergeErrorPath]};n[o]=a.data}return{valid:!0,data:n}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const r=[];for(let i=0;i<e.length;i++){const n=e[i],o=t[i],a=Sl(n,o);if(!a.valid)return{valid:!1,mergeErrorPath:[i,...a.mergeErrorPath]};r.push(a.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function Mm(e,t,r){const i=new Map;let n;for(const s of t.issues)if(s.code==="unrecognized_keys"){n??(n=s);for(const c of s.keys)i.has(c)||i.set(c,{}),i.get(c).l=!0}else e.issues.push(s);for(const s of r.issues)if(s.code==="unrecognized_keys")for(const c of s.keys)i.has(c)||i.set(c,{}),i.get(c).r=!0;else e.issues.push(s);const o=[...i].filter(([,s])=>s.l&&s.r).map(([s])=>s);if(o.length&&n&&e.issues.push({...n,keys:o}),ei(e))return e;const a=Sl(t.value,r.value);if(!a.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(a.mergeErrorPath)}`);return e.value=a.data,e}const Cf=$("$ZodTuple",(e,t)=>{te.init(e,t);const r=t.items;e._zod.parse=(i,n)=>{const o=i.value;if(!Array.isArray(o))return i.issues.push({input:o,inst:e,expected:"tuple",code:"invalid_type"}),i;i.value=[];const a=[],s=[...r].reverse().findIndex(d=>d._zod.optin!=="optional"),c=s===-1?0:r.length-s;if(!t.rest){const d=o.length>r.length,l=o.length<c-1;if(d||l)return i.issues.push({...d?{code:"too_big",maximum:r.length,inclusive:!0}:{code:"too_small",minimum:r.length},input:o,inst:e,origin:"array"}),i}let u=-1;for(const d of r){if(u++,u>=o.length&&u>=c)continue;const l=d._zod.run({value:o[u],issues:[]},n);l instanceof Promise?a.push(l.then(f=>Ds(f,i,u))):Ds(l,i,u)}if(t.rest){const d=o.slice(r.length);for(const l of d){u++;const f=t.rest._zod.run({value:l,issues:[]},n);f instanceof Promise?a.push(f.then(h=>Ds(h,i,u))):Ds(f,i,u)}}return a.length?Promise.all(a).then(()=>i):i}});function Ds(e,t,r){e.issues.length&&t.issues.push(...lr(r,e.issues)),t.value[r]=e.value}const gb=$("$ZodRecord",(e,t)=>{te.init(e,t),e._zod.parse=(r,i)=>{const n=r.value;if(!ci(n))return r.issues.push({expected:"record",code:"invalid_type",input:n,inst:e}),r;const o=[],a=t.keyType._zod.values;if(a){r.value={};const s=new Set;for(const u of a)if(typeof u=="string"||typeof u=="number"||typeof u=="symbol"){s.add(typeof u=="number"?u.toString():u);const d=t.valueType._zod.run({value:n[u],issues:[]},i);d instanceof Promise?o.push(d.then(l=>{l.issues.length&&r.issues.push(...lr(u,l.issues)),r.value[u]=l.value})):(d.issues.length&&r.issues.push(...lr(u,d.issues)),r.value[u]=d.value)}let c;for(const u in n)s.has(u)||(c=c??[],c.push(u));c&&c.length>0&&r.issues.push({code:"unrecognized_keys",input:n,inst:e,keys:c})}else{r.value={};for(const s of Reflect.ownKeys(n)){if(s==="__proto__")continue;let c=t.keyType._zod.run({value:s,issues:[]},i);if(c instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(typeof s=="string"&&If.test(s)&&c.issues.length&&c.issues.some(l=>l.code==="invalid_type"&&l.expected==="number")){const l=t.keyType._zod.run({value:Number(s),issues:[]},i);if(l instanceof Promise)throw new Error("Async schemas not supported in object keys currently");l.issues.length===0&&(c=l)}if(c.issues.length){t.mode==="loose"?r.value[s]=n[s]:r.issues.push({code:"invalid_key",origin:"record",issues:c.issues.map(l=>nr(l,i,pt())),input:s,path:[s],inst:e});continue}const d=t.valueType._zod.run({value:n[s],issues:[]},i);d instanceof Promise?o.push(d.then(l=>{l.issues.length&&r.issues.push(...lr(s,l.issues)),r.value[c.value]=l.value})):(d.issues.length&&r.issues.push(...lr(s,d.issues)),r.value[c.value]=d.value)}}return o.length?Promise.all(o).then(()=>r):r}}),yb=$("$ZodMap",(e,t)=>{te.init(e,t),e._zod.parse=(r,i)=>{const n=r.value;if(!(n instanceof Map))return r.issues.push({expected:"map",code:"invalid_type",input:n,inst:e}),r;const o=[];r.value=new Map;for(const[a,s]of n){const c=t.keyType._zod.run({value:a,issues:[]},i),u=t.valueType._zod.run({value:s,issues:[]},i);c instanceof Promise||u instanceof Promise?o.push(Promise.all([c,u]).then(([d,l])=>{qm(d,l,r,a,n,e,i)})):qm(c,u,r,a,n,e,i)}return o.length?Promise.all(o).then(()=>r):r}});function qm(e,t,r,i,n,o,a){e.issues.length&&(cc.has(typeof i)?r.issues.push(...lr(i,e.issues)):r.issues.push({code:"invalid_key",origin:"map",input:n,inst:o,issues:e.issues.map(s=>nr(s,a,pt()))})),t.issues.length&&(cc.has(typeof i)?r.issues.push(...lr(i,t.issues)):r.issues.push({origin:"map",code:"invalid_element",input:n,inst:o,key:i,issues:t.issues.map(s=>nr(s,a,pt()))})),r.value.set(e.value,t.value)}const wb=$("$ZodSet",(e,t)=>{te.init(e,t),e._zod.parse=(r,i)=>{const n=r.value;if(!(n instanceof Set))return r.issues.push({input:n,inst:e,expected:"set",code:"invalid_type"}),r;const o=[];r.value=new Set;for(const a of n){const s=t.valueType._zod.run({value:a,issues:[]},i);s instanceof Promise?o.push(s.then(c=>Wm(c,r))):Wm(s,r)}return o.length?Promise.all(o).then(()=>r):r}});function Wm(e,t){e.issues.length&&t.issues.push(...e.issues),t.value.add(e.value)}const vb=$("$ZodEnum",(e,t)=>{te.init(e,t);const r=hf(t.entries),i=new Set(r);e._zod.values=i,e._zod.pattern=new RegExp(`^(${r.filter(n=>cc.has(typeof n)).map(n=>typeof n=="string"?Qr(n):n.toString()).join("|")})$`),e._zod.parse=(n,o)=>{const a=n.value;return i.has(a)||n.issues.push({code:"invalid_value",values:r,input:a,inst:e}),n}}),bb=$("$ZodLiteral",(e,t)=>{if(te.init(e,t),t.values.length===0)throw new Error("Cannot create literal schema with no valid values");const r=new Set(t.values);e._zod.values=r,e._zod.pattern=new RegExp(`^(${t.values.map(i=>typeof i=="string"?Qr(i):i?Qr(i.toString()):String(i)).join("|")})$`),e._zod.parse=(i,n)=>{const o=i.value;return r.has(o)||i.issues.push({code:"invalid_value",values:t.values,input:o,inst:e}),i}}),_b=$("$ZodFile",(e,t)=>{te.init(e,t),e._zod.parse=(r,i)=>{const n=r.value;return n instanceof File||r.issues.push({expected:"file",code:"invalid_type",input:n,inst:e}),r}}),Sb=$("$ZodTransform",(e,t)=>{te.init(e,t),e._zod.parse=(r,i)=>{if(i.direction==="backward")throw new Bc(e.constructor.name);const n=t.transform(r.value,r);if(i.async)return(n instanceof Promise?n:Promise.resolve(n)).then(a=>(r.value=a,r));if(n instanceof Promise)throw new ni;return r.value=n,r}});function Fm(e,t){return e.issues.length&&t===void 0?{issues:[],value:void 0}:e}const Pf=$("$ZodOptional",(e,t)=>{te.init(e,t),e._zod.optin="optional",e._zod.optout="optional",ae(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),ae(e._zod,"pattern",()=>{const r=t.innerType._zod.pattern;return r?new RegExp(`^(${Vc(r.source)})?$`):void 0}),e._zod.parse=(r,i)=>{if(t.innerType._zod.optin==="optional"){const n=t.innerType._zod.run(r,i);return n instanceof Promise?n.then(o=>Fm(o,r.value)):Fm(n,r.value)}return r.value===void 0?r:t.innerType._zod.run(r,i)}}),kb=$("$ZodExactOptional",(e,t)=>{Pf.init(e,t),ae(e._zod,"values",()=>t.innerType._zod.values),ae(e._zod,"pattern",()=>t.innerType._zod.pattern),e._zod.parse=(r,i)=>t.innerType._zod.run(r,i)}),Nb=$("$ZodNullable",(e,t)=>{te.init(e,t),ae(e._zod,"optin",()=>t.innerType._zod.optin),ae(e._zod,"optout",()=>t.innerType._zod.optout),ae(e._zod,"pattern",()=>{const r=t.innerType._zod.pattern;return r?new RegExp(`^(${Vc(r.source)}|null)$`):void 0}),ae(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(r,i)=>r.value===null?r:t.innerType._zod.run(r,i)}),$b=$("$ZodDefault",(e,t)=>{te.init(e,t),e._zod.optin="optional",ae(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,i)=>{if(i.direction==="backward")return t.innerType._zod.run(r,i);if(r.value===void 0)return r.value=t.defaultValue,r;const n=t.innerType._zod.run(r,i);return n instanceof Promise?n.then(o=>Bm(o,t)):Bm(n,t)}});function Bm(e,t){return e.value===void 0&&(e.value=t.defaultValue),e}const Eb=$("$ZodPrefault",(e,t)=>{te.init(e,t),e._zod.optin="optional",ae(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,i)=>(i.direction==="backward"||r.value===void 0&&(r.value=t.defaultValue),t.innerType._zod.run(r,i))}),Ab=$("$ZodNonOptional",(e,t)=>{te.init(e,t),ae(e._zod,"values",()=>{const r=t.innerType._zod.values;return r?new Set([...r].filter(i=>i!==void 0)):void 0}),e._zod.parse=(r,i)=>{const n=t.innerType._zod.run(r,i);return n instanceof Promise?n.then(o=>Vm(o,e)):Vm(n,e)}});function Vm(e,t){return!e.issues.length&&e.value===void 0&&e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}const Ib=$("$ZodSuccess",(e,t)=>{te.init(e,t),e._zod.parse=(r,i)=>{if(i.direction==="backward")throw new Bc("ZodSuccess");const n=t.innerType._zod.run(r,i);return n instanceof Promise?n.then(o=>(r.value=o.issues.length===0,r)):(r.value=n.issues.length===0,r)}}),Tb=$("$ZodCatch",(e,t)=>{te.init(e,t),ae(e._zod,"optin",()=>t.innerType._zod.optin),ae(e._zod,"optout",()=>t.innerType._zod.optout),ae(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,i)=>{if(i.direction==="backward")return t.innerType._zod.run(r,i);const n=t.innerType._zod.run(r,i);return n instanceof Promise?n.then(o=>(r.value=o.value,o.issues.length&&(r.value=t.catchValue({...r,error:{issues:o.issues.map(a=>nr(a,i,pt()))},input:r.value}),r.issues=[]),r)):(r.value=n.value,n.issues.length&&(r.value=t.catchValue({...r,error:{issues:n.issues.map(o=>nr(o,i,pt()))},input:r.value}),r.issues=[]),r)}}),xb=$("$ZodNaN",(e,t)=>{te.init(e,t),e._zod.parse=(r,i)=>((typeof r.value!="number"||!Number.isNaN(r.value))&&r.issues.push({input:r.value,inst:e,expected:"nan",code:"invalid_type"}),r)}),Ob=$("$ZodPipe",(e,t)=>{te.init(e,t),ae(e._zod,"values",()=>t.in._zod.values),ae(e._zod,"optin",()=>t.in._zod.optin),ae(e._zod,"optout",()=>t.out._zod.optout),ae(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(r,i)=>{if(i.direction==="backward"){const o=t.out._zod.run(r,i);return o instanceof Promise?o.then(a=>Rs(a,t.in,i)):Rs(o,t.in,i)}const n=t.in._zod.run(r,i);return n instanceof Promise?n.then(o=>Rs(o,t.out,i)):Rs(n,t.out,i)}});function Rs(e,t,r){return e.issues.length?(e.aborted=!0,e):t._zod.run({value:e.value,issues:e.issues},r)}const Lf=$("$ZodCodec",(e,t)=>{te.init(e,t),ae(e._zod,"values",()=>t.in._zod.values),ae(e._zod,"optin",()=>t.in._zod.optin),ae(e._zod,"optout",()=>t.out._zod.optout),ae(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(r,i)=>{if((i.direction||"forward")==="forward"){const o=t.in._zod.run(r,i);return o instanceof Promise?o.then(a=>Us(a,t,i)):Us(o,t,i)}else{const o=t.out._zod.run(r,i);return o instanceof Promise?o.then(a=>Us(a,t,i)):Us(o,t,i)}}});function Us(e,t,r){if(e.issues.length)return e.aborted=!0,e;if((r.direction||"forward")==="forward"){const n=t.transform(e.value,e);return n instanceof Promise?n.then(o=>Cs(e,o,t.out,r)):Cs(e,n,t.out,r)}else{const n=t.reverseTransform(e.value,e);return n instanceof Promise?n.then(o=>Cs(e,o,t.in,r)):Cs(e,n,t.in,r)}}function Cs(e,t,r,i){return e.issues.length?(e.aborted=!0,e):r._zod.run({value:t,issues:e.issues},i)}const Db=$("$ZodReadonly",(e,t)=>{te.init(e,t),ae(e._zod,"propValues",()=>t.innerType._zod.propValues),ae(e._zod,"values",()=>t.innerType._zod.values),ae(e._zod,"optin",()=>t.innerType?._zod?.optin),ae(e._zod,"optout",()=>t.innerType?._zod?.optout),e._zod.parse=(r,i)=>{if(i.direction==="backward")return t.innerType._zod.run(r,i);const n=t.innerType._zod.run(r,i);return n instanceof Promise?n.then(Km):Km(n)}});function Km(e){return e.value=Object.freeze(e.value),e}const Rb=$("$ZodTemplateLiteral",(e,t)=>{te.init(e,t);const r=[];for(const i of t.parts)if(typeof i=="object"&&i!==null){if(!i._zod.pattern)throw new Error(`Invalid template literal part, no pattern found: ${[...i._zod.traits].shift()}`);const n=i._zod.pattern instanceof RegExp?i._zod.pattern.source:i._zod.pattern;if(!n)throw new Error(`Invalid template literal part: ${i._zod.traits}`);const o=n.startsWith("^")?1:0,a=n.endsWith("$")?n.length-1:n.length;r.push(n.slice(o,a))}else if(i===null||sw.has(typeof i))r.push(Qr(`${i}`));else throw new Error(`Invalid template literal part: ${i}`);e._zod.pattern=new RegExp(`^${r.join("")}$`),e._zod.parse=(i,n)=>typeof i.value!="string"?(i.issues.push({input:i.value,inst:e,expected:"string",code:"invalid_type"}),i):(e._zod.pattern.lastIndex=0,e._zod.pattern.test(i.value)||i.issues.push({input:i.value,inst:e,code:"invalid_format",format:t.format??"template_literal",pattern:e._zod.pattern.source}),i)}),Ub=$("$ZodFunction",(e,t)=>(te.init(e,t),e._def=t,e._zod.def=t,e.implement=r=>{if(typeof r!="function")throw new Error("implement() must be called with a function");return function(...i){const n=e._def.input?bl(e._def.input,i):i,o=Reflect.apply(r,this,n);return e._def.output?bl(e._def.output,o):o}},e.implementAsync=r=>{if(typeof r!="function")throw new Error("implementAsync() must be called with a function");return async function(...i){const n=e._def.input?await _l(e._def.input,i):i,o=await Reflect.apply(r,this,n);return e._def.output?await _l(e._def.output,o):o}},e._zod.parse=(r,i)=>typeof r.value!="function"?(r.issues.push({code:"invalid_type",expected:"function",input:r.value,inst:e}),r):(e._def.output&&e._def.output._zod.def.type==="promise"?r.value=e.implementAsync(r.value):r.value=e.implement(r.value),r),e.input=(...r)=>{const i=e.constructor;return Array.isArray(r[0])?new i({type:"function",input:new Cf({type:"tuple",items:r[0],rest:r[1]}),output:e._def.output}):new i({type:"function",input:r[0],output:e._def.output})},e.output=r=>{const i=e.constructor;return new i({type:"function",input:e._def.input,output:r})},e)),Cb=$("$ZodPromise",(e,t)=>{te.init(e,t),e._zod.parse=(r,i)=>Promise.resolve(r.value).then(n=>t.innerType._zod.run({value:n,issues:[]},i))}),Pb=$("$ZodLazy",(e,t)=>{te.init(e,t),ae(e._zod,"innerType",()=>t.getter()),ae(e._zod,"pattern",()=>e._zod.innerType?._zod?.pattern),ae(e._zod,"propValues",()=>e._zod.innerType?._zod?.propValues),ae(e._zod,"optin",()=>e._zod.innerType?._zod?.optin??void 0),ae(e._zod,"optout",()=>e._zod.innerType?._zod?.optout??void 0),e._zod.parse=(r,i)=>e._zod.innerType._zod.run(r,i)}),Lb=$("$ZodCustom",(e,t)=>{ze.init(e,t),te.init(e,t),e._zod.parse=(r,i)=>r,e._zod.check=r=>{const i=r.value,n=t.fn(i);if(n instanceof Promise)return n.then(o=>Jm(o,r,i,e));Jm(n,r,i,e)}});function Jm(e,t,r,i){if(!e){const n={code:"custom",input:r,inst:i,path:[...i._zod.def.path??[]],continue:!i._zod.def.abort};i._zod.def.params&&(n.params=i._zod.def.params),t.issues.push(Ji(n))}}const ix=()=>{const e={string:{unit:"",verb:" "},file:{unit:"",verb:" "},array:{unit:"",verb:" "},set:{unit:"",verb:" "}};function t(n){return e[n]??null}const r={regex:"",email:" ",url:"",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"   ISO",date:"  ISO",time:"  ISO",duration:"  ISO",ipv4:" IPv4",ipv6:" IPv6",cidrv4:"   IPv4",cidrv6:"   IPv6",base64:"  base64-encoded",base64url:"  base64url-encoded",json_string:"   JSON",e164:"   E.164",jwt:"JWT",template_literal:""},i={nan:"NaN"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`  :   instanceof ${n.expected}    ${s}`:`  :   ${o}    ${s}`}case"invalid_value":return n.values.length===1?`  :   ${X(n.values[0])}`:`  :     : ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?`   :    ${n.origin??""} ${o} ${n.maximum.toString()} ${a.unit??""}`:`  :    ${n.origin??""} ${o} ${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?`  :   ${n.origin}   ${o} ${n.minimum.toString()} ${a.unit}`:`  :   ${n.origin}   ${o} ${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`  :     "${n.prefix}"`:o.format==="ends_with"?`  :     "${o.suffix}"`:o.format==="includes"?`  :    "${o.includes}"`:o.format==="regex"?`  :     ${o.pattern}`:`${r[o.format]??n.format}  `}case"not_multiple_of":return`  :      ${n.divisor}`;case"unrecognized_keys":return`${n.keys.length>1?"":""} ${n.keys.length>1?"":""}: ${q(n.keys," ")}`;case"invalid_key":return`    ${n.origin}`;case"invalid_union":return"  ";case"invalid_element":return`    ${n.origin}`;default:return"  "}}};function ox(){return{localeError:ix()}}const ax=()=>{const e={string:{unit:"simvol",verb:"olmaldr"},file:{unit:"bayt",verb:"olmaldr"},array:{unit:"element",verb:"olmaldr"},set:{unit:"element",verb:"olmaldr"}};function t(n){return e[n]??null}const r={regex:"input",email:"email address",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datetime",date:"ISO date",time:"ISO time",duration:"ISO duration",ipv4:"IPv4 address",ipv6:"IPv6 address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded string",base64url:"base64url-encoded string",json_string:"JSON string",e164:"E.164 number",jwt:"JWT",template_literal:"input"},i={nan:"NaN"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`Yanl dyr: gzlniln instanceof ${n.expected}, daxil olan ${s}`:`Yanl dyr: gzlniln ${o}, daxil olan ${s}`}case"invalid_value":return n.values.length===1?`Yanl dyr: gzlniln ${X(n.values[0])}`:`Yanl seim: aadaklardan biri olmaldr: ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?`ox byk: gzlniln ${n.origin??"dyr"} ${o}${n.maximum.toString()} ${a.unit??"element"}`:`ox byk: gzlniln ${n.origin??"dyr"} ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?`ox kiik: gzlniln ${n.origin} ${o}${n.minimum.toString()} ${a.unit}`:`ox kiik: gzlniln ${n.origin} ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`Yanl mtn: "${o.prefix}" il balamaldr`:o.format==="ends_with"?`Yanl mtn: "${o.suffix}" il bitmlidir`:o.format==="includes"?`Yanl mtn: "${o.includes}" daxil olmaldr`:o.format==="regex"?`Yanl mtn: ${o.pattern} ablonuna uyun olmaldr`:`Yanl ${r[o.format]??n.format}`}case"not_multiple_of":return`Yanl dd: ${n.divisor} il bln biln olmaldr`;case"unrecognized_keys":return`Tannmayan aar${n.keys.length>1?"lar":""}: ${q(n.keys,", ")}`;case"invalid_key":return`${n.origin} daxilind yanl aar`;case"invalid_union":return"Yanl dyr";case"invalid_element":return`${n.origin} daxilind yanl dyr`;default:return"Yanl dyr"}}};function sx(){return{localeError:ax()}}function Hm(e,t,r,i){const n=Math.abs(e),o=n%10,a=n%100;return a>=11&&a<=19?i:o===1?t:o>=2&&o<=4?r:i}const cx=()=>{const e={string:{unit:{one:"",few:"",many:""},verb:""},array:{unit:{one:"",few:"",many:""},verb:""},set:{unit:{one:"",few:"",many:""},verb:""},file:{unit:{one:"",few:"",many:""},verb:""}};function t(n){return e[n]??null}const r={regex:"",email:"email ",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO   ",date:"ISO ",time:"ISO ",duration:"ISO ",ipv4:"IPv4 ",ipv6:"IPv6 ",cidrv4:"IPv4 ",cidrv6:"IPv6 ",base64:"   base64",base64url:"   base64url",json_string:"JSON ",e164:" E.164",jwt:"JWT",template_literal:""},i={nan:"NaN",number:"",array:""};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?` :  instanceof ${n.expected},  ${s}`:` :  ${o},  ${s}`}case"invalid_value":return n.values.length===1?` :  ${X(n.values[0])}`:` :    ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);if(a){const s=Number(n.maximum),c=Hm(s,a.unit.one,a.unit.few,a.unit.many);return` : ,  ${n.origin??""}  ${a.verb} ${o}${n.maximum.toString()} ${c}`}return` : ,  ${n.origin??""}   ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);if(a){const s=Number(n.minimum),c=Hm(s,a.unit.one,a.unit.few,a.unit.many);return` : ,  ${n.origin}  ${a.verb} ${o}${n.minimum.toString()} ${c}`}return` : ,  ${n.origin}   ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?` :    "${o.prefix}"`:o.format==="ends_with"?` :    "${o.suffix}"`:o.format==="includes"?` :   "${o.includes}"`:o.format==="regex"?` :    ${o.pattern}`:` ${r[o.format]??n.format}`}case"not_multiple_of":return` :    ${n.divisor}`;case"unrecognized_keys":return` ${n.keys.length>1?"":""}: ${q(n.keys,", ")}`;case"invalid_key":return`   ${n.origin}`;case"invalid_union":return" ";case"invalid_element":return`   ${n.origin}`;default:return" "}}};function ux(){return{localeError:cx()}}const dx=()=>{const e={string:{unit:"",verb:" "},file:{unit:"",verb:" "},array:{unit:"",verb:" "},set:{unit:"",verb:" "}};function t(n){return e[n]??null}const r={regex:"",email:" ",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO ",date:"ISO ",time:"ISO ",duration:"ISO ",ipv4:"IPv4 ",ipv6:"IPv6 ",cidrv4:"IPv4 ",cidrv6:"IPv6 ",base64:"base64- ",base64url:"base64url- ",json_string:"JSON ",e164:"E.164 ",jwt:"JWT",template_literal:""},i={nan:"NaN",number:"",array:""};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?` :  instanceof ${n.expected},  ${s}`:` :  ${o},  ${s}`}case"invalid_value":return n.values.length===1?` :  ${X(n.values[0])}`:` :    ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?` :   ${n.origin??""}   ${o}${n.maximum.toString()} ${a.unit??""}`:` :   ${n.origin??""}   ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?` :   ${n.origin}   ${o}${n.minimum.toString()} ${a.unit}`:` :   ${n.origin}   ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;if(o.format==="starts_with")return` :     "${o.prefix}"`;if(o.format==="ends_with")return` :     "${o.suffix}"`;if(o.format==="includes")return` :    "${o.includes}"`;if(o.format==="regex")return` :     ${o.pattern}`;let a="";return o.format==="emoji"&&(a=""),o.format==="datetime"&&(a=""),o.format==="date"&&(a=""),o.format==="time"&&(a=""),o.format==="duration"&&(a=""),`${a} ${r[o.format]??n.format}`}case"not_multiple_of":return` :      ${n.divisor}`;case"unrecognized_keys":return`${n.keys.length>1?"":""} ${n.keys.length>1?"":""}: ${q(n.keys,", ")}`;case"invalid_key":return`   ${n.origin}`;case"invalid_union":return" ";case"invalid_element":return`   ${n.origin}`;default:return" "}}};function lx(){return{localeError:dx()}}const fx=()=>{const e={string:{unit:"carcters",verb:"contenir"},file:{unit:"bytes",verb:"contenir"},array:{unit:"elements",verb:"contenir"},set:{unit:"elements",verb:"contenir"}};function t(n){return e[n]??null}const r={regex:"entrada",email:"adrea electrnica",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"data i hora ISO",date:"data ISO",time:"hora ISO",duration:"durada ISO",ipv4:"adrea IPv4",ipv6:"adrea IPv6",cidrv4:"rang IPv4",cidrv6:"rang IPv6",base64:"cadena codificada en base64",base64url:"cadena codificada en base64url",json_string:"cadena JSON",e164:"nmero E.164",jwt:"JWT",template_literal:"entrada"},i={nan:"NaN"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`Tipus invlid: s'esperava instanceof ${n.expected}, s'ha rebut ${s}`:`Tipus invlid: s'esperava ${o}, s'ha rebut ${s}`}case"invalid_value":return n.values.length===1?`Valor invlid: s'esperava ${X(n.values[0])}`:`Opci invlida: s'esperava una de ${q(n.values," o ")}`;case"too_big":{const o=n.inclusive?"com a mxim":"menys de",a=t(n.origin);return a?`Massa gran: s'esperava que ${n.origin??"el valor"} contingus ${o} ${n.maximum.toString()} ${a.unit??"elements"}`:`Massa gran: s'esperava que ${n.origin??"el valor"} fos ${o} ${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?"com a mnim":"ms de",a=t(n.origin);return a?`Massa petit: s'esperava que ${n.origin} contingus ${o} ${n.minimum.toString()} ${a.unit}`:`Massa petit: s'esperava que ${n.origin} fos ${o} ${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`Format invlid: ha de comenar amb "${o.prefix}"`:o.format==="ends_with"?`Format invlid: ha d'acabar amb "${o.suffix}"`:o.format==="includes"?`Format invlid: ha d'incloure "${o.includes}"`:o.format==="regex"?`Format invlid: ha de coincidir amb el patr ${o.pattern}`:`Format invlid per a ${r[o.format]??n.format}`}case"not_multiple_of":return`Nmero invlid: ha de ser mltiple de ${n.divisor}`;case"unrecognized_keys":return`Clau${n.keys.length>1?"s":""} no reconeguda${n.keys.length>1?"s":""}: ${q(n.keys,", ")}`;case"invalid_key":return`Clau invlida a ${n.origin}`;case"invalid_union":return"Entrada invlida";case"invalid_element":return`Element invlid a ${n.origin}`;default:return"Entrada invlida"}}};function hx(){return{localeError:fx()}}const px=()=>{const e={string:{unit:"znak",verb:"mt"},file:{unit:"bajt",verb:"mt"},array:{unit:"prvk",verb:"mt"},set:{unit:"prvk",verb:"mt"}};function t(n){return e[n]??null}const r={regex:"regulrn vraz",email:"e-mailov adresa",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"datum a as ve formtu ISO",date:"datum ve formtu ISO",time:"as ve formtu ISO",duration:"doba trvn ISO",ipv4:"IPv4 adresa",ipv6:"IPv6 adresa",cidrv4:"rozsah IPv4",cidrv6:"rozsah IPv6",base64:"etzec zakdovan ve formtu base64",base64url:"etzec zakdovan ve formtu base64url",json_string:"etzec ve formtu JSON",e164:"slo E.164",jwt:"JWT",template_literal:"vstup"},i={nan:"NaN",number:"slo",string:"etzec",function:"funkce",array:"pole"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`Neplatn vstup: oekvno instanceof ${n.expected}, obdreno ${s}`:`Neplatn vstup: oekvno ${o}, obdreno ${s}`}case"invalid_value":return n.values.length===1?`Neplatn vstup: oekvno ${X(n.values[0])}`:`Neplatn monost: oekvna jedna z hodnot ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?`Hodnota je pli velk: ${n.origin??"hodnota"} mus mt ${o}${n.maximum.toString()} ${a.unit??"prvk"}`:`Hodnota je pli velk: ${n.origin??"hodnota"} mus bt ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?`Hodnota je pli mal: ${n.origin??"hodnota"} mus mt ${o}${n.minimum.toString()} ${a.unit??"prvk"}`:`Hodnota je pli mal: ${n.origin??"hodnota"} mus bt ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`Neplatn etzec: mus zanat na "${o.prefix}"`:o.format==="ends_with"?`Neplatn etzec: mus konit na "${o.suffix}"`:o.format==="includes"?`Neplatn etzec: mus obsahovat "${o.includes}"`:o.format==="regex"?`Neplatn etzec: mus odpovdat vzoru ${o.pattern}`:`Neplatn formt ${r[o.format]??n.format}`}case"not_multiple_of":return`Neplatn slo: mus bt nsobkem ${n.divisor}`;case"unrecognized_keys":return`Neznm kle: ${q(n.keys,", ")}`;case"invalid_key":return`Neplatn kl v ${n.origin}`;case"invalid_union":return"Neplatn vstup";case"invalid_element":return`Neplatn hodnota v ${n.origin}`;default:return"Neplatn vstup"}}};function mx(){return{localeError:px()}}const gx=()=>{const e={string:{unit:"tegn",verb:"havde"},file:{unit:"bytes",verb:"havde"},array:{unit:"elementer",verb:"indeholdt"},set:{unit:"elementer",verb:"indeholdt"}};function t(n){return e[n]??null}const r={regex:"input",email:"e-mailadresse",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO dato- og klokkeslt",date:"ISO-dato",time:"ISO-klokkeslt",duration:"ISO-varighed",ipv4:"IPv4-omrde",ipv6:"IPv6-omrde",cidrv4:"IPv4-spektrum",cidrv6:"IPv6-spektrum",base64:"base64-kodet streng",base64url:"base64url-kodet streng",json_string:"JSON-streng",e164:"E.164-nummer",jwt:"JWT",template_literal:"input"},i={nan:"NaN",string:"streng",number:"tal",boolean:"boolean",array:"liste",object:"objekt",set:"st",file:"fil"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`Ugyldigt input: forventede instanceof ${n.expected}, fik ${s}`:`Ugyldigt input: forventede ${o}, fik ${s}`}case"invalid_value":return n.values.length===1?`Ugyldig vrdi: forventede ${X(n.values[0])}`:`Ugyldigt valg: forventede en af flgende ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin),s=i[n.origin]??n.origin;return a?`For stor: forventede ${s??"value"} ${a.verb} ${o} ${n.maximum.toString()} ${a.unit??"elementer"}`:`For stor: forventede ${s??"value"} havde ${o} ${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin),s=i[n.origin]??n.origin;return a?`For lille: forventede ${s} ${a.verb} ${o} ${n.minimum.toString()} ${a.unit}`:`For lille: forventede ${s} havde ${o} ${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`Ugyldig streng: skal starte med "${o.prefix}"`:o.format==="ends_with"?`Ugyldig streng: skal ende med "${o.suffix}"`:o.format==="includes"?`Ugyldig streng: skal indeholde "${o.includes}"`:o.format==="regex"?`Ugyldig streng: skal matche mnsteret ${o.pattern}`:`Ugyldig ${r[o.format]??n.format}`}case"not_multiple_of":return`Ugyldigt tal: skal vre deleligt med ${n.divisor}`;case"unrecognized_keys":return`${n.keys.length>1?"Ukendte ngler":"Ukendt ngle"}: ${q(n.keys,", ")}`;case"invalid_key":return`Ugyldig ngle i ${n.origin}`;case"invalid_union":return"Ugyldigt input: matcher ingen af de tilladte typer";case"invalid_element":return`Ugyldig vrdi i ${n.origin}`;default:return"Ugyldigt input"}}};function yx(){return{localeError:gx()}}const wx=()=>{const e={string:{unit:"Zeichen",verb:"zu haben"},file:{unit:"Bytes",verb:"zu haben"},array:{unit:"Elemente",verb:"zu haben"},set:{unit:"Elemente",verb:"zu haben"}};function t(n){return e[n]??null}const r={regex:"Eingabe",email:"E-Mail-Adresse",url:"URL",emoji:"Emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO-Datum und -Uhrzeit",date:"ISO-Datum",time:"ISO-Uhrzeit",duration:"ISO-Dauer",ipv4:"IPv4-Adresse",ipv6:"IPv6-Adresse",cidrv4:"IPv4-Bereich",cidrv6:"IPv6-Bereich",base64:"Base64-codierter String",base64url:"Base64-URL-codierter String",json_string:"JSON-String",e164:"E.164-Nummer",jwt:"JWT",template_literal:"Eingabe"},i={nan:"NaN",number:"Zahl",array:"Array"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`Ungltige Eingabe: erwartet instanceof ${n.expected}, erhalten ${s}`:`Ungltige Eingabe: erwartet ${o}, erhalten ${s}`}case"invalid_value":return n.values.length===1?`Ungltige Eingabe: erwartet ${X(n.values[0])}`:`Ungltige Option: erwartet eine von ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?`Zu gro: erwartet, dass ${n.origin??"Wert"} ${o}${n.maximum.toString()} ${a.unit??"Elemente"} hat`:`Zu gro: erwartet, dass ${n.origin??"Wert"} ${o}${n.maximum.toString()} ist`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?`Zu klein: erwartet, dass ${n.origin} ${o}${n.minimum.toString()} ${a.unit} hat`:`Zu klein: erwartet, dass ${n.origin} ${o}${n.minimum.toString()} ist`}case"invalid_format":{const o=n;return o.format==="starts_with"?`Ungltiger String: muss mit "${o.prefix}" beginnen`:o.format==="ends_with"?`Ungltiger String: muss mit "${o.suffix}" enden`:o.format==="includes"?`Ungltiger String: muss "${o.includes}" enthalten`:o.format==="regex"?`Ungltiger String: muss dem Muster ${o.pattern} entsprechen`:`Ungltig: ${r[o.format]??n.format}`}case"not_multiple_of":return`Ungltige Zahl: muss ein Vielfaches von ${n.divisor} sein`;case"unrecognized_keys":return`${n.keys.length>1?"Unbekannte Schlssel":"Unbekannter Schlssel"}: ${q(n.keys,", ")}`;case"invalid_key":return`Ungltiger Schlssel in ${n.origin}`;case"invalid_union":return"Ungltige Eingabe";case"invalid_element":return`Ungltiger Wert in ${n.origin}`;default:return"Ungltige Eingabe"}}};function vx(){return{localeError:wx()}}const bx=()=>{const e={string:{unit:"characters",verb:"to have"},file:{unit:"bytes",verb:"to have"},array:{unit:"items",verb:"to have"},set:{unit:"items",verb:"to have"},map:{unit:"entries",verb:"to have"}};function t(n){return e[n]??null}const r={regex:"input",email:"email address",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datetime",date:"ISO date",time:"ISO time",duration:"ISO duration",ipv4:"IPv4 address",ipv6:"IPv6 address",mac:"MAC address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded string",base64url:"base64url-encoded string",json_string:"JSON string",e164:"E.164 number",jwt:"JWT",template_literal:"input"},i={nan:"NaN"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return`Invalid input: expected ${o}, received ${s}`}case"invalid_value":return n.values.length===1?`Invalid input: expected ${X(n.values[0])}`:`Invalid option: expected one of ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?`Too big: expected ${n.origin??"value"} to have ${o}${n.maximum.toString()} ${a.unit??"elements"}`:`Too big: expected ${n.origin??"value"} to be ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?`Too small: expected ${n.origin} to have ${o}${n.minimum.toString()} ${a.unit}`:`Too small: expected ${n.origin} to be ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`Invalid string: must start with "${o.prefix}"`:o.format==="ends_with"?`Invalid string: must end with "${o.suffix}"`:o.format==="includes"?`Invalid string: must include "${o.includes}"`:o.format==="regex"?`Invalid string: must match pattern ${o.pattern}`:`Invalid ${r[o.format]??n.format}`}case"not_multiple_of":return`Invalid number: must be a multiple of ${n.divisor}`;case"unrecognized_keys":return`Unrecognized key${n.keys.length>1?"s":""}: ${q(n.keys,", ")}`;case"invalid_key":return`Invalid key in ${n.origin}`;case"invalid_union":return"Invalid input";case"invalid_element":return`Invalid value in ${n.origin}`;default:return"Invalid input"}}};function zb(){return{localeError:bx()}}const _x=()=>{const e={string:{unit:"karaktrojn",verb:"havi"},file:{unit:"bajtojn",verb:"havi"},array:{unit:"elementojn",verb:"havi"},set:{unit:"elementojn",verb:"havi"}};function t(n){return e[n]??null}const r={regex:"enigo",email:"retadreso",url:"URL",emoji:"emoio",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO-datotempo",date:"ISO-dato",time:"ISO-tempo",duration:"ISO-daro",ipv4:"IPv4-adreso",ipv6:"IPv6-adreso",cidrv4:"IPv4-rango",cidrv6:"IPv6-rango",base64:"64-ume kodita karaktraro",base64url:"URL-64-ume kodita karaktraro",json_string:"JSON-karaktraro",e164:"E.164-nombro",jwt:"JWT",template_literal:"enigo"},i={nan:"NaN",number:"nombro",array:"tabelo",null:"senvalora"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`Nevalida enigo: atendiis instanceof ${n.expected}, riceviis ${s}`:`Nevalida enigo: atendiis ${o}, riceviis ${s}`}case"invalid_value":return n.values.length===1?`Nevalida enigo: atendiis ${X(n.values[0])}`:`Nevalida opcio: atendiis unu el ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?`Tro granda: atendiis ke ${n.origin??"valoro"} havu ${o}${n.maximum.toString()} ${a.unit??"elementojn"}`:`Tro granda: atendiis ke ${n.origin??"valoro"} havu ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?`Tro malgranda: atendiis ke ${n.origin} havu ${o}${n.minimum.toString()} ${a.unit}`:`Tro malgranda: atendiis ke ${n.origin} estu ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`Nevalida karaktraro: devas komencii per "${o.prefix}"`:o.format==="ends_with"?`Nevalida karaktraro: devas finii per "${o.suffix}"`:o.format==="includes"?`Nevalida karaktraro: devas inkluzivi "${o.includes}"`:o.format==="regex"?`Nevalida karaktraro: devas kongrui kun la modelo ${o.pattern}`:`Nevalida ${r[o.format]??n.format}`}case"not_multiple_of":return`Nevalida nombro: devas esti oblo de ${n.divisor}`;case"unrecognized_keys":return`Nekonata${n.keys.length>1?"j":""} losilo${n.keys.length>1?"j":""}: ${q(n.keys,", ")}`;case"invalid_key":return`Nevalida losilo en ${n.origin}`;case"invalid_union":return"Nevalida enigo";case"invalid_element":return`Nevalida valoro en ${n.origin}`;default:return"Nevalida enigo"}}};function Sx(){return{localeError:_x()}}const kx=()=>{const e={string:{unit:"caracteres",verb:"tener"},file:{unit:"bytes",verb:"tener"},array:{unit:"elementos",verb:"tener"},set:{unit:"elementos",verb:"tener"}};function t(n){return e[n]??null}const r={regex:"entrada",email:"direccin de correo electrnico",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"fecha y hora ISO",date:"fecha ISO",time:"hora ISO",duration:"duracin ISO",ipv4:"direccin IPv4",ipv6:"direccin IPv6",cidrv4:"rango IPv4",cidrv6:"rango IPv6",base64:"cadena codificada en base64",base64url:"URL codificada en base64",json_string:"cadena JSON",e164:"nmero E.164",jwt:"JWT",template_literal:"entrada"},i={nan:"NaN",string:"texto",number:"nmero",boolean:"booleano",array:"arreglo",object:"objeto",set:"conjunto",file:"archivo",date:"fecha",bigint:"nmero grande",symbol:"smbolo",undefined:"indefinido",null:"nulo",function:"funcin",map:"mapa",record:"registro",tuple:"tupla",enum:"enumeracin",union:"unin",literal:"literal",promise:"promesa",void:"vaco",never:"nunca",unknown:"desconocido",any:"cualquiera"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`Entrada invlida: se esperaba instanceof ${n.expected}, recibido ${s}`:`Entrada invlida: se esperaba ${o}, recibido ${s}`}case"invalid_value":return n.values.length===1?`Entrada invlida: se esperaba ${X(n.values[0])}`:`Opcin invlida: se esperaba una de ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin),s=i[n.origin]??n.origin;return a?`Demasiado grande: se esperaba que ${s??"valor"} tuviera ${o}${n.maximum.toString()} ${a.unit??"elementos"}`:`Demasiado grande: se esperaba que ${s??"valor"} fuera ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin),s=i[n.origin]??n.origin;return a?`Demasiado pequeo: se esperaba que ${s} tuviera ${o}${n.minimum.toString()} ${a.unit}`:`Demasiado pequeo: se esperaba que ${s} fuera ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`Cadena invlida: debe comenzar con "${o.prefix}"`:o.format==="ends_with"?`Cadena invlida: debe terminar en "${o.suffix}"`:o.format==="includes"?`Cadena invlida: debe incluir "${o.includes}"`:o.format==="regex"?`Cadena invlida: debe coincidir con el patrn ${o.pattern}`:`Invlido ${r[o.format]??n.format}`}case"not_multiple_of":return`Nmero invlido: debe ser mltiplo de ${n.divisor}`;case"unrecognized_keys":return`Llave${n.keys.length>1?"s":""} desconocida${n.keys.length>1?"s":""}: ${q(n.keys,", ")}`;case"invalid_key":return`Llave invlida en ${i[n.origin]??n.origin}`;case"invalid_union":return"Entrada invlida";case"invalid_element":return`Valor invlido en ${i[n.origin]??n.origin}`;default:return"Entrada invlida"}}};function Nx(){return{localeError:kx()}}const $x=()=>{const e={string:{unit:"",verb:" "},file:{unit:"",verb:" "},array:{unit:"",verb:" "},set:{unit:"",verb:" "}};function t(n){return e[n]??null}const r={regex:"",email:" ",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"   ",date:" ",time:" ",duration:"  ",ipv4:"IPv4 ",ipv6:"IPv6 ",cidrv4:"IPv4 ",cidrv6:"IPv6 ",base64:"base64-encoded ",base64url:"base64url-encoded ",json_string:"JSON ",e164:"E.164 ",jwt:"JWT",template_literal:""},i={nan:"NaN",number:"",array:""};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?` :  instanceof ${n.expected}  ${s}  `:` :  ${o}  ${s}  `}case"invalid_value":return n.values.length===1?` :  ${X(n.values[0])} `:` :    ${q(n.values,"|")} `;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?` : ${n.origin??""}  ${o}${n.maximum.toString()} ${a.unit??""} `:` : ${n.origin??""}  ${o}${n.maximum.toString()} `}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?` : ${n.origin}  ${o}${n.minimum.toString()} ${a.unit} `:` : ${n.origin}  ${o}${n.minimum.toString()} `}case"invalid_format":{const o=n;return o.format==="starts_with"?` :   "${o.prefix}"  `:o.format==="ends_with"?` :   "${o.suffix}"  `:o.format==="includes"?` :   "${o.includes}" `:o.format==="regex"?` :    ${o.pattern}   `:`${r[o.format]??n.format} `}case"not_multiple_of":return` :   ${n.divisor} `;case"unrecognized_keys":return`${n.keys.length>1?"":""} : ${q(n.keys,", ")}`;case"invalid_key":return`   ${n.origin}`;case"invalid_union":return" ";case"invalid_element":return`   ${n.origin}`;default:return" "}}};function Ex(){return{localeError:$x()}}const Ax=()=>{const e={string:{unit:"merkki",subject:"merkkijonon"},file:{unit:"tavua",subject:"tiedoston"},array:{unit:"alkiota",subject:"listan"},set:{unit:"alkiota",subject:"joukon"},number:{unit:"",subject:"luvun"},bigint:{unit:"",subject:"suuren kokonaisluvun"},int:{unit:"",subject:"kokonaisluvun"},date:{unit:"",subject:"pivmrn"}};function t(n){return e[n]??null}const r={regex:"snnllinen lauseke",email:"shkpostiosoite",url:"URL-osoite",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO-aikaleima",date:"ISO-pivmr",time:"ISO-aika",duration:"ISO-kesto",ipv4:"IPv4-osoite",ipv6:"IPv6-osoite",cidrv4:"IPv4-alue",cidrv6:"IPv6-alue",base64:"base64-koodattu merkkijono",base64url:"base64url-koodattu merkkijono",json_string:"JSON-merkkijono",e164:"E.164-luku",jwt:"JWT",template_literal:"templaattimerkkijono"},i={nan:"NaN"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`Virheellinen tyyppi: odotettiin instanceof ${n.expected}, oli ${s}`:`Virheellinen tyyppi: odotettiin ${o}, oli ${s}`}case"invalid_value":return n.values.length===1?`Virheellinen syte: tytyy olla ${X(n.values[0])}`:`Virheellinen valinta: tytyy olla yksi seuraavista: ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?`Liian suuri: ${a.subject} tytyy olla ${o}${n.maximum.toString()} ${a.unit}`.trim():`Liian suuri: arvon tytyy olla ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?`Liian pieni: ${a.subject} tytyy olla ${o}${n.minimum.toString()} ${a.unit}`.trim():`Liian pieni: arvon tytyy olla ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`Virheellinen syte: tytyy alkaa "${o.prefix}"`:o.format==="ends_with"?`Virheellinen syte: tytyy loppua "${o.suffix}"`:o.format==="includes"?`Virheellinen syte: tytyy sislt "${o.includes}"`:o.format==="regex"?`Virheellinen syte: tytyy vastata snnllist lauseketta ${o.pattern}`:`Virheellinen ${r[o.format]??n.format}`}case"not_multiple_of":return`Virheellinen luku: tytyy olla luvun ${n.divisor} monikerta`;case"unrecognized_keys":return`${n.keys.length>1?"Tuntemattomat avaimet":"Tuntematon avain"}: ${q(n.keys,", ")}`;case"invalid_key":return"Virheellinen avain tietueessa";case"invalid_union":return"Virheellinen unioni";case"invalid_element":return"Virheellinen arvo joukossa";default:return"Virheellinen syte"}}};function Ix(){return{localeError:Ax()}}const Tx=()=>{const e={string:{unit:"caractres",verb:"avoir"},file:{unit:"octets",verb:"avoir"},array:{unit:"lments",verb:"avoir"},set:{unit:"lments",verb:"avoir"}};function t(n){return e[n]??null}const r={regex:"entre",email:"adresse e-mail",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"date et heure ISO",date:"date ISO",time:"heure ISO",duration:"dure ISO",ipv4:"adresse IPv4",ipv6:"adresse IPv6",cidrv4:"plage IPv4",cidrv6:"plage IPv6",base64:"chane encode en base64",base64url:"chane encode en base64url",json_string:"chane JSON",e164:"numro E.164",jwt:"JWT",template_literal:"entre"},i={nan:"NaN",number:"nombre",array:"tableau"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`Entre invalide : instanceof ${n.expected} attendu, ${s} reu`:`Entre invalide : ${o} attendu, ${s} reu`}case"invalid_value":return n.values.length===1?`Entre invalide : ${X(n.values[0])} attendu`:`Option invalide : une valeur parmi ${q(n.values,"|")} attendue`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?`Trop grand : ${n.origin??"valeur"} doit ${a.verb} ${o}${n.maximum.toString()} ${a.unit??"lment(s)"}`:`Trop grand : ${n.origin??"valeur"} doit tre ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?`Trop petit : ${n.origin} doit ${a.verb} ${o}${n.minimum.toString()} ${a.unit}`:`Trop petit : ${n.origin} doit tre ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`Chane invalide : doit commencer par "${o.prefix}"`:o.format==="ends_with"?`Chane invalide : doit se terminer par "${o.suffix}"`:o.format==="includes"?`Chane invalide : doit inclure "${o.includes}"`:o.format==="regex"?`Chane invalide : doit correspondre au modle ${o.pattern}`:`${r[o.format]??n.format} invalide`}case"not_multiple_of":return`Nombre invalide : doit tre un multiple de ${n.divisor}`;case"unrecognized_keys":return`Cl${n.keys.length>1?"s":""} non reconnue${n.keys.length>1?"s":""} : ${q(n.keys,", ")}`;case"invalid_key":return`Cl invalide dans ${n.origin}`;case"invalid_union":return"Entre invalide";case"invalid_element":return`Valeur invalide dans ${n.origin}`;default:return"Entre invalide"}}};function xx(){return{localeError:Tx()}}const Ox=()=>{const e={string:{unit:"caractres",verb:"avoir"},file:{unit:"octets",verb:"avoir"},array:{unit:"lments",verb:"avoir"},set:{unit:"lments",verb:"avoir"}};function t(n){return e[n]??null}const r={regex:"entre",email:"adresse courriel",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"date-heure ISO",date:"date ISO",time:"heure ISO",duration:"dure ISO",ipv4:"adresse IPv4",ipv6:"adresse IPv6",cidrv4:"plage IPv4",cidrv6:"plage IPv6",base64:"chane encode en base64",base64url:"chane encode en base64url",json_string:"chane JSON",e164:"numro E.164",jwt:"JWT",template_literal:"entre"},i={nan:"NaN"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`Entre invalide : attendu instanceof ${n.expected}, reu ${s}`:`Entre invalide : attendu ${o}, reu ${s}`}case"invalid_value":return n.values.length===1?`Entre invalide : attendu ${X(n.values[0])}`:`Option invalide : attendu l'une des valeurs suivantes ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"":"<",a=t(n.origin);return a?`Trop grand : attendu que ${n.origin??"la valeur"} ait ${o}${n.maximum.toString()} ${a.unit}`:`Trop grand : attendu que ${n.origin??"la valeur"} soit ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?"":">",a=t(n.origin);return a?`Trop petit : attendu que ${n.origin} ait ${o}${n.minimum.toString()} ${a.unit}`:`Trop petit : attendu que ${n.origin} soit ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`Chane invalide : doit commencer par "${o.prefix}"`:o.format==="ends_with"?`Chane invalide : doit se terminer par "${o.suffix}"`:o.format==="includes"?`Chane invalide : doit inclure "${o.includes}"`:o.format==="regex"?`Chane invalide : doit correspondre au motif ${o.pattern}`:`${r[o.format]??n.format} invalide`}case"not_multiple_of":return`Nombre invalide : doit tre un multiple de ${n.divisor}`;case"unrecognized_keys":return`Cl${n.keys.length>1?"s":""} non reconnue${n.keys.length>1?"s":""} : ${q(n.keys,", ")}`;case"invalid_key":return`Cl invalide dans ${n.origin}`;case"invalid_union":return"Entre invalide";case"invalid_element":return`Valeur invalide dans ${n.origin}`;default:return"Entre invalide"}}};function Dx(){return{localeError:Ox()}}const Rx=()=>{const e={string:{label:"",gender:"f"},number:{label:"",gender:"m"},boolean:{label:" ",gender:"m"},bigint:{label:"BigInt",gender:"m"},date:{label:"",gender:"m"},array:{label:"",gender:"m"},object:{label:"",gender:"m"},null:{label:"  (null)",gender:"m"},undefined:{label:"   (undefined)",gender:"m"},symbol:{label:" (Symbol)",gender:"m"},function:{label:"",gender:"f"},map:{label:" (Map)",gender:"f"},set:{label:" (Set)",gender:"f"},file:{label:"",gender:"m"},promise:{label:"Promise",gender:"m"},NaN:{label:"NaN",gender:"m"},unknown:{label:"  ",gender:"m"},value:{label:"",gender:"m"}},t={string:{unit:"",shortLabel:"",longLabel:""},file:{unit:"",shortLabel:"",longLabel:""},array:{unit:"",shortLabel:"",longLabel:""},set:{unit:"",shortLabel:"",longLabel:""},number:{unit:"",shortLabel:"",longLabel:""}},r=u=>u?e[u]:void 0,i=u=>{const d=r(u);return d?d.label:u??e.unknown.label},n=u=>`${i(u)}`,o=u=>(r(u)?.gender??"m")==="f"?" ":" ",a=u=>u?t[u]??null:null,s={regex:{label:"",gender:"m"},email:{label:" ",gender:"f"},url:{label:" ",gender:"f"},emoji:{label:"'",gender:"m"},uuid:{label:"UUID",gender:"m"},nanoid:{label:"nanoid",gender:"m"},guid:{label:"GUID",gender:"m"},cuid:{label:"cuid",gender:"m"},cuid2:{label:"cuid2",gender:"m"},ulid:{label:"ULID",gender:"m"},xid:{label:"XID",gender:"m"},ksuid:{label:"KSUID",gender:"m"},datetime:{label:"  ISO",gender:"m"},date:{label:" ISO",gender:"m"},time:{label:" ISO",gender:"m"},duration:{label:"  ISO",gender:"m"},ipv4:{label:" IPv4",gender:"f"},ipv6:{label:" IPv6",gender:"f"},cidrv4:{label:" IPv4",gender:"m"},cidrv6:{label:" IPv6",gender:"m"},base64:{label:"  64",gender:"f"},base64url:{label:"  64  ",gender:"f"},json_string:{label:" JSON",gender:"f"},e164:{label:" E.164",gender:"m"},jwt:{label:"JWT",gender:"m"},ends_with:{label:"",gender:"m"},includes:{label:"",gender:"m"},lowercase:{label:"",gender:"m"},starts_with:{label:"",gender:"m"},uppercase:{label:"",gender:"m"}},c={nan:"NaN"};return u=>{switch(u.code){case"invalid_type":{const d=u.expected,l=c[d??""]??i(d),f=ee(u.input),h=c[f]??e[f]?.label??f;return/^[A-Z]/.test(u.expected)?`  :   instanceof ${u.expected},  ${h}`:`  :   ${l},  ${h}`}case"invalid_value":{if(u.values.length===1)return`  :    ${X(u.values[0])}`;const d=u.values.map(h=>X(h));if(u.values.length===2)return`  :    ${d[0]}  ${d[1]}`;const l=d[d.length-1];return`  :    ${d.slice(0,-1).join(", ")}  ${l}`}case"too_big":{const d=a(u.origin),l=n(u.origin??"value");if(u.origin==="string")return`${d?.longLabel??""} : ${l}   ${u.maximum.toString()} ${d?.unit??""} ${u.inclusive?" ":" "}`.trim();if(u.origin==="number"){const g=u.inclusive?`   -${u.maximum}`:` -${u.maximum}`;return` : ${l}   ${g}`}if(u.origin==="array"||u.origin==="set"){const g=u.origin==="set"?"":"",m=u.inclusive?`${u.maximum} ${d?.unit??""}  `:` -${u.maximum} ${d?.unit??""}`;return` : ${l} ${g}  ${m}`.trim()}const f=u.inclusive?"<=":"<",h=o(u.origin??"value");return d?.unit?`${d.longLabel} : ${l} ${h} ${f}${u.maximum.toString()} ${d.unit}`:`${d?.longLabel??""} : ${l} ${h} ${f}${u.maximum.toString()}`}case"too_small":{const d=a(u.origin),l=n(u.origin??"value");if(u.origin==="string")return`${d?.shortLabel??""} : ${l}   ${u.minimum.toString()} ${d?.unit??""} ${u.inclusive?" ":""}`.trim();if(u.origin==="number"){const g=u.inclusive?`   -${u.minimum}`:` -${u.minimum}`;return` : ${l}   ${g}`}if(u.origin==="array"||u.origin==="set"){const g=u.origin==="set"?"":"";if(u.minimum===1&&u.inclusive){const v=(u.origin==="set","  ");return` : ${l} ${g}  ${v}`}const m=u.inclusive?`${u.minimum} ${d?.unit??""}  `:` -${u.minimum} ${d?.unit??""}`;return` : ${l} ${g}  ${m}`.trim()}const f=u.inclusive?">=":">",h=o(u.origin??"value");return d?.unit?`${d.shortLabel} : ${l} ${h} ${f}${u.minimum.toString()} ${d.unit}`:`${d?.shortLabel??""} : ${l} ${h} ${f}${u.minimum.toString()}`}case"invalid_format":{const d=u;if(d.format==="starts_with")return`    "${d.prefix}"`;if(d.format==="ends_with")return`    "${d.suffix}"`;if(d.format==="includes")return`   "${d.includes}"`;if(d.format==="regex")return`    ${d.pattern}`;const l=s[d.format],f=l?.label??d.format,g=(l?.gender??"m")==="f"?"":"";return`${f}  ${g}`}case"not_multiple_of":return`  :     ${u.divisor}`;case"unrecognized_keys":return`${u.keys.length>1?"":""}  ${u.keys.length>1?"":""}: ${q(u.keys,", ")}`;case"invalid_key":return"   ";case"invalid_union":return"  ";case"invalid_element":return`   ${n(u.origin??"array")}`;default:return"  "}}};function Ux(){return{localeError:Rx()}}const Cx=()=>{const e={string:{unit:"karakter",verb:"legyen"},file:{unit:"byte",verb:"legyen"},array:{unit:"elem",verb:"legyen"},set:{unit:"elem",verb:"legyen"}};function t(n){return e[n]??null}const r={regex:"bemenet",email:"email cm",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO idblyeg",date:"ISO dtum",time:"ISO id",duration:"ISO idintervallum",ipv4:"IPv4 cm",ipv6:"IPv6 cm",cidrv4:"IPv4 tartomny",cidrv6:"IPv6 tartomny",base64:"base64-kdolt string",base64url:"base64url-kdolt string",json_string:"JSON string",e164:"E.164 szm",jwt:"JWT",template_literal:"bemenet"},i={nan:"NaN",number:"szm",array:"tmb"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`rvnytelen bemenet: a vrt rtk instanceof ${n.expected}, a kapott rtk ${s}`:`rvnytelen bemenet: a vrt rtk ${o}, a kapott rtk ${s}`}case"invalid_value":return n.values.length===1?`rvnytelen bemenet: a vrt rtk ${X(n.values[0])}`:`rvnytelen opci: valamelyik rtk vrt ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?`Tl nagy: ${n.origin??"rtk"} mrete tl nagy ${o}${n.maximum.toString()} ${a.unit??"elem"}`:`Tl nagy: a bemeneti rtk ${n.origin??"rtk"} tl nagy: ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?`Tl kicsi: a bemeneti rtk ${n.origin} mrete tl kicsi ${o}${n.minimum.toString()} ${a.unit}`:`Tl kicsi: a bemeneti rtk ${n.origin} tl kicsi ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`rvnytelen string: "${o.prefix}" rtkkel kell kezddnie`:o.format==="ends_with"?`rvnytelen string: "${o.suffix}" rtkkel kell vgzdnie`:o.format==="includes"?`rvnytelen string: "${o.includes}" rtket kell tartalmaznia`:o.format==="regex"?`rvnytelen string: ${o.pattern} mintnak kell megfelelnie`:`rvnytelen ${r[o.format]??n.format}`}case"not_multiple_of":return`rvnytelen szm: ${n.divisor} tbbszrsnek kell lennie`;case"unrecognized_keys":return`Ismeretlen kulcs${n.keys.length>1?"s":""}: ${q(n.keys,", ")}`;case"invalid_key":return`rvnytelen kulcs ${n.origin}`;case"invalid_union":return"rvnytelen bemenet";case"invalid_element":return`rvnytelen rtk: ${n.origin}`;default:return"rvnytelen bemenet"}}};function Px(){return{localeError:Cx()}}function Zm(e,t,r){return Math.abs(e)===1?t:r}function $i(e){if(!e)return"";const t=["","","","","","",""],r=e[e.length-1];return e+(t.includes(r)?"":"")}const Lx=()=>{const e={string:{unit:{one:"",many:""},verb:""},file:{unit:{one:"",many:""},verb:""},array:{unit:{one:"",many:""},verb:""},set:{unit:{one:"",many:""},verb:""}};function t(n){return e[n]??null}const r={regex:"",email:". ",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO   ",date:"ISO ",time:"ISO ",duration:"ISO ",ipv4:"IPv4 ",ipv6:"IPv6 ",cidrv4:"IPv4 ",cidrv6:"IPv6 ",base64:"base64  ",base64url:"base64url  ",json_string:"JSON ",e164:"E.164 ",jwt:"JWT",template_literal:""},i={nan:"NaN",number:"",array:""};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`    instanceof ${n.expected},   ${s}`:`    ${o},   ${s}`}case"invalid_value":return n.values.length===1?`    ${X(n.values[1])}`:`      ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);if(a){const s=Number(n.maximum),c=Zm(s,a.unit.one,a.unit.many);return`    ,  ${$i(n.origin??"")}  ${o}${n.maximum.toString()} ${c}`}return`    ,  ${$i(n.origin??"")}  ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);if(a){const s=Number(n.minimum),c=Zm(s,a.unit.one,a.unit.many);return`    ,  ${$i(n.origin)}  ${o}${n.minimum.toString()} ${c}`}return`    ,  ${$i(n.origin)}  ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`     "${o.prefix}"-`:o.format==="ends_with"?`     "${o.suffix}"-`:o.format==="includes"?`     "${o.includes}"`:o.format==="regex"?`     ${o.pattern} `:` ${r[o.format]??n.format}`}case"not_multiple_of":return`      ${n.divisor}-`;case"unrecognized_keys":return` ${n.keys.length>1?"":""}. ${q(n.keys,", ")}`;case"invalid_key":return`  ${$i(n.origin)}-`;case"invalid_union":return" ";case"invalid_element":return`  ${$i(n.origin)}-`;default:return" "}}};function zx(){return{localeError:Lx()}}const jx=()=>{const e={string:{unit:"karakter",verb:"memiliki"},file:{unit:"byte",verb:"memiliki"},array:{unit:"item",verb:"memiliki"},set:{unit:"item",verb:"memiliki"}};function t(n){return e[n]??null}const r={regex:"input",email:"alamat email",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"tanggal dan waktu format ISO",date:"tanggal format ISO",time:"jam format ISO",duration:"durasi format ISO",ipv4:"alamat IPv4",ipv6:"alamat IPv6",cidrv4:"rentang alamat IPv4",cidrv6:"rentang alamat IPv6",base64:"string dengan enkode base64",base64url:"string dengan enkode base64url",json_string:"string JSON",e164:"angka E.164",jwt:"JWT",template_literal:"input"},i={nan:"NaN"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`Input tidak valid: diharapkan instanceof ${n.expected}, diterima ${s}`:`Input tidak valid: diharapkan ${o}, diterima ${s}`}case"invalid_value":return n.values.length===1?`Input tidak valid: diharapkan ${X(n.values[0])}`:`Pilihan tidak valid: diharapkan salah satu dari ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?`Terlalu besar: diharapkan ${n.origin??"value"} memiliki ${o}${n.maximum.toString()} ${a.unit??"elemen"}`:`Terlalu besar: diharapkan ${n.origin??"value"} menjadi ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?`Terlalu kecil: diharapkan ${n.origin} memiliki ${o}${n.minimum.toString()} ${a.unit}`:`Terlalu kecil: diharapkan ${n.origin} menjadi ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`String tidak valid: harus dimulai dengan "${o.prefix}"`:o.format==="ends_with"?`String tidak valid: harus berakhir dengan "${o.suffix}"`:o.format==="includes"?`String tidak valid: harus menyertakan "${o.includes}"`:o.format==="regex"?`String tidak valid: harus sesuai pola ${o.pattern}`:`${r[o.format]??n.format} tidak valid`}case"not_multiple_of":return`Angka tidak valid: harus kelipatan dari ${n.divisor}`;case"unrecognized_keys":return`Kunci tidak dikenali ${n.keys.length>1?"s":""}: ${q(n.keys,", ")}`;case"invalid_key":return`Kunci tidak valid di ${n.origin}`;case"invalid_union":return"Input tidak valid";case"invalid_element":return`Nilai tidak valid di ${n.origin}`;default:return"Input tidak valid"}}};function Mx(){return{localeError:jx()}}const qx=()=>{const e={string:{unit:"stafi",verb:"a hafa"},file:{unit:"bti",verb:"a hafa"},array:{unit:"hluti",verb:"a hafa"},set:{unit:"hluti",verb:"a hafa"}};function t(n){return e[n]??null}const r={regex:"gildi",email:"netfang",url:"vefsl",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO dagsetning og tmi",date:"ISO dagsetning",time:"ISO tmi",duration:"ISO tmalengd",ipv4:"IPv4 address",ipv6:"IPv6 address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded strengur",base64url:"base64url-encoded strengur",json_string:"JSON strengur",e164:"E.164 tlugildi",jwt:"JWT",template_literal:"gildi"},i={nan:"NaN",number:"nmer",array:"fylki"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`Rangt gildi:  slst inn ${s} ar sem  a vera instanceof ${n.expected}`:`Rangt gildi:  slst inn ${s} ar sem  a vera ${o}`}case"invalid_value":return n.values.length===1?`Rangt gildi: gert r fyrir ${X(n.values[0])}`:`gilt val: m vera eitt af eftirfarandi ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?`Of strt: gert er r fyrir a ${n.origin??"gildi"} hafi ${o}${n.maximum.toString()} ${a.unit??"hluti"}`:`Of strt: gert er r fyrir a ${n.origin??"gildi"} s ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?`Of lti: gert er r fyrir a ${n.origin} hafi ${o}${n.minimum.toString()} ${a.unit}`:`Of lti: gert er r fyrir a ${n.origin} s ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`gildur strengur: verur a byrja  "${o.prefix}"`:o.format==="ends_with"?`gildur strengur: verur a enda  "${o.suffix}"`:o.format==="includes"?`gildur strengur: verur a innihalda "${o.includes}"`:o.format==="regex"?`gildur strengur: verur a fylgja mynstri ${o.pattern}`:`Rangt ${r[o.format]??n.format}`}case"not_multiple_of":return`Rng tala: verur a vera margfeldi af ${n.divisor}`;case"unrecognized_keys":return`ekkt ${n.keys.length>1?"ir lyklar":"ur lykill"}: ${q(n.keys,", ")}`;case"invalid_key":return`Rangur lykill  ${n.origin}`;case"invalid_union":return"Rangt gildi";case"invalid_element":return`Rangt gildi  ${n.origin}`;default:return"Rangt gildi"}}};function Wx(){return{localeError:qx()}}const Fx=()=>{const e={string:{unit:"caratteri",verb:"avere"},file:{unit:"byte",verb:"avere"},array:{unit:"elementi",verb:"avere"},set:{unit:"elementi",verb:"avere"}};function t(n){return e[n]??null}const r={regex:"input",email:"indirizzo email",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"data e ora ISO",date:"data ISO",time:"ora ISO",duration:"durata ISO",ipv4:"indirizzo IPv4",ipv6:"indirizzo IPv6",cidrv4:"intervallo IPv4",cidrv6:"intervallo IPv6",base64:"stringa codificata in base64",base64url:"URL codificata in base64",json_string:"stringa JSON",e164:"numero E.164",jwt:"JWT",template_literal:"input"},i={nan:"NaN",number:"numero",array:"vettore"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`Input non valido: atteso instanceof ${n.expected}, ricevuto ${s}`:`Input non valido: atteso ${o}, ricevuto ${s}`}case"invalid_value":return n.values.length===1?`Input non valido: atteso ${X(n.values[0])}`:`Opzione non valida: atteso uno tra ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?`Troppo grande: ${n.origin??"valore"} deve avere ${o}${n.maximum.toString()} ${a.unit??"elementi"}`:`Troppo grande: ${n.origin??"valore"} deve essere ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?`Troppo piccolo: ${n.origin} deve avere ${o}${n.minimum.toString()} ${a.unit}`:`Troppo piccolo: ${n.origin} deve essere ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`Stringa non valida: deve iniziare con "${o.prefix}"`:o.format==="ends_with"?`Stringa non valida: deve terminare con "${o.suffix}"`:o.format==="includes"?`Stringa non valida: deve includere "${o.includes}"`:o.format==="regex"?`Stringa non valida: deve corrispondere al pattern ${o.pattern}`:`Invalid ${r[o.format]??n.format}`}case"not_multiple_of":return`Numero non valido: deve essere un multiplo di ${n.divisor}`;case"unrecognized_keys":return`Chiav${n.keys.length>1?"i":"e"} non riconosciut${n.keys.length>1?"e":"a"}: ${q(n.keys,", ")}`;case"invalid_key":return`Chiave non valida in ${n.origin}`;case"invalid_union":return"Input non valido";case"invalid_element":return`Valore non valido in ${n.origin}`;default:return"Input non valido"}}};function Bx(){return{localeError:Fx()}}const Vx=()=>{const e={string:{unit:"",verb:""},file:{unit:"",verb:""},array:{unit:"",verb:""},set:{unit:"",verb:""}};function t(n){return e[n]??null}const r={regex:"",email:"",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO",date:"ISO",time:"ISO",duration:"ISO",ipv4:"IPv4",ipv6:"IPv6",cidrv4:"IPv4",cidrv6:"IPv6",base64:"base64",base64url:"base64url",json_string:"JSON",e164:"E.164",jwt:"JWT",template_literal:""},i={nan:"NaN",number:"",array:""};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`: instanceof ${n.expected}${s}`:`: ${o}${s}`}case"invalid_value":return n.values.length===1?`: ${X(n.values[0])}`:`: ${q(n.values,"")}`;case"too_big":{const o=n.inclusive?"":"",a=t(n.origin);return a?`: ${n.origin??""}${n.maximum.toString()}${a.unit??""}${o}`:`: ${n.origin??""}${n.maximum.toString()}${o}`}case"too_small":{const o=n.inclusive?"":"",a=t(n.origin);return a?`: ${n.origin}${n.minimum.toString()}${a.unit}${o}`:`: ${n.origin}${n.minimum.toString()}${o}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`: "${o.prefix}"`:o.format==="ends_with"?`: "${o.suffix}"`:o.format==="includes"?`: "${o.includes}"`:o.format==="regex"?`: ${o.pattern}`:`${r[o.format]??n.format}`}case"not_multiple_of":return`: ${n.divisor}`;case"unrecognized_keys":return`${n.keys.length>1?"":""}: ${q(n.keys,"")}`;case"invalid_key":return`${n.origin}`;case"invalid_union":return"";case"invalid_element":return`${n.origin}`;default:return""}}};function Kx(){return{localeError:Vx()}}const Jx=()=>{const e={string:{unit:"",verb:" "},file:{unit:"",verb:" "},array:{unit:"",verb:" "},set:{unit:"",verb:" "}};function t(n){return e[n]??null}const r={regex:"",email:"- ",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"-",date:"",time:"",duration:"",ipv4:"IPv4 ",ipv6:"IPv6 ",cidrv4:"IPv4 ",cidrv6:"IPv6 ",base64:"base64- ",base64url:"base64url- ",json_string:"JSON ",e164:"E.164 ",jwt:"JWT",template_literal:""},i={nan:"NaN",number:"",string:"",boolean:"",function:"",array:""};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?` :  instanceof ${n.expected},  ${s}`:` :  ${o},  ${s}`}case"invalid_value":return n.values.length===1?` :  ${X(n.values[0])}`:` :  - ${q(n.values,"|")}-`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?` :  ${n.origin??""} ${a.verb} ${o}${n.maximum.toString()} ${a.unit}`:` :  ${n.origin??""}  ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?` :  ${n.origin} ${a.verb} ${o}${n.minimum.toString()} ${a.unit}`:` :  ${n.origin}  ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?` :   "${o.prefix}"-`:o.format==="ends_with"?` :   "${o.suffix}"-`:o.format==="includes"?` :   "${o.includes}"-`:o.format==="regex"?` :    ${o.pattern}`:` ${r[o.format]??n.format}`}case"not_multiple_of":return` :   ${n.divisor}- `;case"unrecognized_keys":return` ${n.keys.length>1?"":""}: ${q(n.keys,", ")}`;case"invalid_key":return`  ${n.origin}-`;case"invalid_union":return" ";case"invalid_element":return`  ${n.origin}-`;default:return" "}}};function Hx(){return{localeError:Jx()}}const Zx=()=>{const e={string:{unit:"",verb:""},file:{unit:"",verb:""},array:{unit:"",verb:""},set:{unit:"",verb:""}};function t(n){return e[n]??null}const r={regex:"",email:"",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"  ISO",date:" ISO",time:" ISO",duration:" ISO",ipv4:" IPv4",ipv6:" IPv6",cidrv4:" IPv4",cidrv6:" IPv6",base64:" base64",base64url:" base64url",json_string:" JSON",e164:" E.164",jwt:"JWT",template_literal:""},i={nan:"NaN",number:"",array:" (Array)",null:" (null)"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`  instanceof ${n.expected}  ${s}`:`  ${o}  ${s}`}case"invalid_value":return n.values.length===1?`  ${X(n.values[0])}`:`  ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?`  ${n.origin??""} ${o} ${n.maximum.toString()} ${a.unit??""}`:`  ${n.origin??""} ${o} ${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?`  ${n.origin} ${o} ${n.minimum.toString()} ${a.unit}`:`  ${n.origin} ${o} ${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`  "${o.prefix}"`:o.format==="ends_with"?`  "${o.suffix}"`:o.format==="includes"?`  "${o.includes}"`:o.format==="regex"?`  ${o.pattern}`:` ${r[o.format]??n.format}`}case"not_multiple_of":return`  ${n.divisor}`;case"unrecognized_keys":return` ${q(n.keys,", ")}`;case"invalid_key":return` ${n.origin}`;case"invalid_union":return"";case"invalid_element":return` ${n.origin}`;default:return""}}};function jb(){return{localeError:Zx()}}function Gx(){return jb()}const Qx=()=>{const e={string:{unit:"",verb:"to have"},file:{unit:"",verb:"to have"},array:{unit:"",verb:"to have"},set:{unit:"",verb:"to have"}};function t(n){return e[n]??null}const r={regex:"",email:" ",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO ",date:"ISO ",time:"ISO ",duration:"ISO ",ipv4:"IPv4 ",ipv6:"IPv6 ",cidrv4:"IPv4 ",cidrv6:"IPv6 ",base64:"base64  ",base64url:"base64url  ",json_string:"JSON ",e164:"E.164 ",jwt:"JWT",template_literal:""},i={nan:"NaN"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?` :   instanceof ${n.expected},   ${s}`:` :   ${o},   ${s}`}case"invalid_value":return n.values.length===1?` :  ${X(n.values[0])}  `:` : ${q(n.values," ")}   `;case"too_big":{const o=n.inclusive?"":"",a=o===""?" ":" ",s=t(n.origin),c=s?.unit??"";return s?`${n.origin??""}  : ${n.maximum.toString()}${c} ${o}${a}`:`${n.origin??""}  : ${n.maximum.toString()} ${o}${a}`}case"too_small":{const o=n.inclusive?"":"",a=o===""?" ":" ",s=t(n.origin),c=s?.unit??"";return s?`${n.origin??""}  : ${n.minimum.toString()}${c} ${o}${a}`:`${n.origin??""}  : ${n.minimum.toString()} ${o}${a}`}case"invalid_format":{const o=n;return o.format==="starts_with"?` : "${o.prefix}"()  `:o.format==="ends_with"?` : "${o.suffix}"()  `:o.format==="includes"?` : "${o.includes}"()  `:o.format==="regex"?` :  ${o.pattern}   `:` ${r[o.format]??n.format}`}case"not_multiple_of":return` : ${n.divisor}  `;case"unrecognized_keys":return`   : ${q(n.keys,", ")}`;case"invalid_key":return` : ${n.origin}`;case"invalid_union":return" ";case"invalid_element":return` : ${n.origin}`;default:return" "}}};function Yx(){return{localeError:Qx()}}const Po=e=>e.charAt(0).toUpperCase()+e.slice(1);function Gm(e){const t=Math.abs(e),r=t%10,i=t%100;return i>=11&&i<=19||r===0?"many":r===1?"one":"few"}const Xx=()=>{const e={string:{unit:{one:"simbolis",few:"simboliai",many:"simboli"},verb:{smaller:{inclusive:"turi bti ne ilgesn kaip",notInclusive:"turi bti trumpesn kaip"},bigger:{inclusive:"turi bti ne trumpesn kaip",notInclusive:"turi bti ilgesn kaip"}}},file:{unit:{one:"baitas",few:"baitai",many:"bait"},verb:{smaller:{inclusive:"turi bti ne didesnis kaip",notInclusive:"turi bti maesnis kaip"},bigger:{inclusive:"turi bti ne maesnis kaip",notInclusive:"turi bti didesnis kaip"}}},array:{unit:{one:"element",few:"elementus",many:"element"},verb:{smaller:{inclusive:"turi turti ne daugiau kaip",notInclusive:"turi turti maiau kaip"},bigger:{inclusive:"turi turti ne maiau kaip",notInclusive:"turi turti daugiau kaip"}}},set:{unit:{one:"element",few:"elementus",many:"element"},verb:{smaller:{inclusive:"turi turti ne daugiau kaip",notInclusive:"turi turti maiau kaip"},bigger:{inclusive:"turi turti ne maiau kaip",notInclusive:"turi turti daugiau kaip"}}}};function t(n,o,a,s){const c=e[n]??null;return c===null?c:{unit:c.unit[o],verb:c.verb[s][a?"inclusive":"notInclusive"]}}const r={regex:"vestis",email:"el. pato adresas",url:"URL",emoji:"jaustukas",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO data ir laikas",date:"ISO data",time:"ISO laikas",duration:"ISO trukm",ipv4:"IPv4 adresas",ipv6:"IPv6 adresas",cidrv4:"IPv4 tinklo prefiksas (CIDR)",cidrv6:"IPv6 tinklo prefiksas (CIDR)",base64:"base64 ukoduota eilut",base64url:"base64url ukoduota eilut",json_string:"JSON eilut",e164:"E.164 numeris",jwt:"JWT",template_literal:"vestis"},i={nan:"NaN",number:"skaiius",bigint:"sveikasis skaiius",string:"eilut",boolean:"login reikm",undefined:"neapibrta reikm",function:"funkcija",symbol:"simbolis",array:"masyvas",object:"objektas",null:"nulin reikm"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`Gautas tipas ${s}, o tiktasi - instanceof ${n.expected}`:`Gautas tipas ${s}, o tiktasi - ${o}`}case"invalid_value":return n.values.length===1?`Privalo bti ${X(n.values[0])}`:`Privalo bti vienas i ${q(n.values,"|")} pasirinkim`;case"too_big":{const o=i[n.origin]??n.origin,a=t(n.origin,Gm(Number(n.maximum)),n.inclusive??!1,"smaller");if(a?.verb)return`${Po(o??n.origin??"reikm")} ${a.verb} ${n.maximum.toString()} ${a.unit??"element"}`;const s=n.inclusive?"ne didesnis kaip":"maesnis kaip";return`${Po(o??n.origin??"reikm")} turi bti ${s} ${n.maximum.toString()} ${a?.unit}`}case"too_small":{const o=i[n.origin]??n.origin,a=t(n.origin,Gm(Number(n.minimum)),n.inclusive??!1,"bigger");if(a?.verb)return`${Po(o??n.origin??"reikm")} ${a.verb} ${n.minimum.toString()} ${a.unit??"element"}`;const s=n.inclusive?"ne maesnis kaip":"didesnis kaip";return`${Po(o??n.origin??"reikm")} turi bti ${s} ${n.minimum.toString()} ${a?.unit}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`Eilut privalo prasidti "${o.prefix}"`:o.format==="ends_with"?`Eilut privalo pasibaigti "${o.suffix}"`:o.format==="includes"?`Eilut privalo traukti "${o.includes}"`:o.format==="regex"?`Eilut privalo atitikti ${o.pattern}`:`Neteisingas ${r[o.format]??n.format}`}case"not_multiple_of":return`Skaiius privalo bti ${n.divisor} kartotinis.`;case"unrecognized_keys":return`Neatpaint${n.keys.length>1?"i":"as"} rakt${n.keys.length>1?"ai":"as"}: ${q(n.keys,", ")}`;case"invalid_key":return"Rastas klaidingas raktas";case"invalid_union":return"Klaidinga vestis";case"invalid_element":{const o=i[n.origin]??n.origin;return`${Po(o??n.origin??"reikm")} turi klaiding vest`}default:return"Klaidinga vestis"}}};function eO(){return{localeError:Xx()}}const tO=()=>{const e={string:{unit:"",verb:" "},file:{unit:"",verb:" "},array:{unit:"",verb:" "},set:{unit:"",verb:" "}};function t(n){return e[n]??null}const r={regex:"",email:"  -",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO   ",date:"ISO ",time:"ISO ",duration:"ISO ",ipv4:"IPv4 ",ipv6:"IPv6 ",cidrv4:"IPv4 ",cidrv6:"IPv6 ",base64:"base64- ",base64url:"base64url- ",json_string:"JSON ",e164:"E.164 ",jwt:"JWT",template_literal:""},i={nan:"NaN",number:"",array:""};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?` :   instanceof ${n.expected},  ${s}`:` :   ${o},  ${s}`}case"invalid_value":return n.values.length===1?`Invalid input: expected ${X(n.values[0])}`:` :    ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?` :   ${n.origin??""}   ${o}${n.maximum.toString()} ${a.unit??""}`:` :   ${n.origin??""}   ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?` :   ${n.origin}   ${o}${n.minimum.toString()} ${a.unit}`:` :   ${n.origin}   ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?` :     "${o.prefix}"`:o.format==="ends_with"?` :     "${o.suffix}"`:o.format==="includes"?` :    "${o.includes}"`:o.format==="regex"?` :      ${o.pattern}`:`Invalid ${r[o.format]??n.format}`}case"not_multiple_of":return` :      ${n.divisor}`;case"unrecognized_keys":return`${n.keys.length>1?" ":" "}: ${q(n.keys,", ")}`;case"invalid_key":return`   ${n.origin}`;case"invalid_union":return" ";case"invalid_element":return`   ${n.origin}`;default:return" "}}};function rO(){return{localeError:tO()}}const nO=()=>{const e={string:{unit:"aksara",verb:"mempunyai"},file:{unit:"bait",verb:"mempunyai"},array:{unit:"elemen",verb:"mempunyai"},set:{unit:"elemen",verb:"mempunyai"}};function t(n){return e[n]??null}const r={regex:"input",email:"alamat e-mel",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"tarikh masa ISO",date:"tarikh ISO",time:"masa ISO",duration:"tempoh ISO",ipv4:"alamat IPv4",ipv6:"alamat IPv6",cidrv4:"julat IPv4",cidrv6:"julat IPv6",base64:"string dikodkan base64",base64url:"string dikodkan base64url",json_string:"string JSON",e164:"nombor E.164",jwt:"JWT",template_literal:"input"},i={nan:"NaN",number:"nombor"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`Input tidak sah: dijangka instanceof ${n.expected}, diterima ${s}`:`Input tidak sah: dijangka ${o}, diterima ${s}`}case"invalid_value":return n.values.length===1?`Input tidak sah: dijangka ${X(n.values[0])}`:`Pilihan tidak sah: dijangka salah satu daripada ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?`Terlalu besar: dijangka ${n.origin??"nilai"} ${a.verb} ${o}${n.maximum.toString()} ${a.unit??"elemen"}`:`Terlalu besar: dijangka ${n.origin??"nilai"} adalah ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?`Terlalu kecil: dijangka ${n.origin} ${a.verb} ${o}${n.minimum.toString()} ${a.unit}`:`Terlalu kecil: dijangka ${n.origin} adalah ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`String tidak sah: mesti bermula dengan "${o.prefix}"`:o.format==="ends_with"?`String tidak sah: mesti berakhir dengan "${o.suffix}"`:o.format==="includes"?`String tidak sah: mesti mengandungi "${o.includes}"`:o.format==="regex"?`String tidak sah: mesti sepadan dengan corak ${o.pattern}`:`${r[o.format]??n.format} tidak sah`}case"not_multiple_of":return`Nombor tidak sah: perlu gandaan ${n.divisor}`;case"unrecognized_keys":return`Kunci tidak dikenali: ${q(n.keys,", ")}`;case"invalid_key":return`Kunci tidak sah dalam ${n.origin}`;case"invalid_union":return"Input tidak sah";case"invalid_element":return`Nilai tidak sah dalam ${n.origin}`;default:return"Input tidak sah"}}};function iO(){return{localeError:nO()}}const oO=()=>{const e={string:{unit:"tekens",verb:"heeft"},file:{unit:"bytes",verb:"heeft"},array:{unit:"elementen",verb:"heeft"},set:{unit:"elementen",verb:"heeft"}};function t(n){return e[n]??null}const r={regex:"invoer",email:"emailadres",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datum en tijd",date:"ISO datum",time:"ISO tijd",duration:"ISO duur",ipv4:"IPv4-adres",ipv6:"IPv6-adres",cidrv4:"IPv4-bereik",cidrv6:"IPv6-bereik",base64:"base64-gecodeerde tekst",base64url:"base64 URL-gecodeerde tekst",json_string:"JSON string",e164:"E.164-nummer",jwt:"JWT",template_literal:"invoer"},i={nan:"NaN",number:"getal"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`Ongeldige invoer: verwacht instanceof ${n.expected}, ontving ${s}`:`Ongeldige invoer: verwacht ${o}, ontving ${s}`}case"invalid_value":return n.values.length===1?`Ongeldige invoer: verwacht ${X(n.values[0])}`:`Ongeldige optie: verwacht n van ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin),s=n.origin==="date"?"laat":n.origin==="string"?"lang":"groot";return a?`Te ${s}: verwacht dat ${n.origin??"waarde"} ${o}${n.maximum.toString()} ${a.unit??"elementen"} ${a.verb}`:`Te ${s}: verwacht dat ${n.origin??"waarde"} ${o}${n.maximum.toString()} is`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin),s=n.origin==="date"?"vroeg":n.origin==="string"?"kort":"klein";return a?`Te ${s}: verwacht dat ${n.origin} ${o}${n.minimum.toString()} ${a.unit} ${a.verb}`:`Te ${s}: verwacht dat ${n.origin} ${o}${n.minimum.toString()} is`}case"invalid_format":{const o=n;return o.format==="starts_with"?`Ongeldige tekst: moet met "${o.prefix}" beginnen`:o.format==="ends_with"?`Ongeldige tekst: moet op "${o.suffix}" eindigen`:o.format==="includes"?`Ongeldige tekst: moet "${o.includes}" bevatten`:o.format==="regex"?`Ongeldige tekst: moet overeenkomen met patroon ${o.pattern}`:`Ongeldig: ${r[o.format]??n.format}`}case"not_multiple_of":return`Ongeldig getal: moet een veelvoud van ${n.divisor} zijn`;case"unrecognized_keys":return`Onbekende key${n.keys.length>1?"s":""}: ${q(n.keys,", ")}`;case"invalid_key":return`Ongeldige key in ${n.origin}`;case"invalid_union":return"Ongeldige invoer";case"invalid_element":return`Ongeldige waarde in ${n.origin}`;default:return"Ongeldige invoer"}}};function aO(){return{localeError:oO()}}const sO=()=>{const e={string:{unit:"tegn",verb:" ha"},file:{unit:"bytes",verb:" ha"},array:{unit:"elementer",verb:" inneholde"},set:{unit:"elementer",verb:" inneholde"}};function t(n){return e[n]??null}const r={regex:"input",email:"e-postadresse",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO dato- og klokkeslett",date:"ISO-dato",time:"ISO-klokkeslett",duration:"ISO-varighet",ipv4:"IPv4-omrde",ipv6:"IPv6-omrde",cidrv4:"IPv4-spekter",cidrv6:"IPv6-spekter",base64:"base64-enkodet streng",base64url:"base64url-enkodet streng",json_string:"JSON-streng",e164:"E.164-nummer",jwt:"JWT",template_literal:"input"},i={nan:"NaN",number:"tall",array:"liste"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`Ugyldig input: forventet instanceof ${n.expected}, fikk ${s}`:`Ugyldig input: forventet ${o}, fikk ${s}`}case"invalid_value":return n.values.length===1?`Ugyldig verdi: forventet ${X(n.values[0])}`:`Ugyldig valg: forventet en av ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?`For stor(t): forventet ${n.origin??"value"} til  ha ${o}${n.maximum.toString()} ${a.unit??"elementer"}`:`For stor(t): forventet ${n.origin??"value"} til  ha ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?`For lite(n): forventet ${n.origin} til  ha ${o}${n.minimum.toString()} ${a.unit}`:`For lite(n): forventet ${n.origin} til  ha ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`Ugyldig streng: m starte med "${o.prefix}"`:o.format==="ends_with"?`Ugyldig streng: m ende med "${o.suffix}"`:o.format==="includes"?`Ugyldig streng: m inneholde "${o.includes}"`:o.format==="regex"?`Ugyldig streng: m matche mnsteret ${o.pattern}`:`Ugyldig ${r[o.format]??n.format}`}case"not_multiple_of":return`Ugyldig tall: m vre et multiplum av ${n.divisor}`;case"unrecognized_keys":return`${n.keys.length>1?"Ukjente nkler":"Ukjent nkkel"}: ${q(n.keys,", ")}`;case"invalid_key":return`Ugyldig nkkel i ${n.origin}`;case"invalid_union":return"Ugyldig input";case"invalid_element":return`Ugyldig verdi i ${n.origin}`;default:return"Ugyldig input"}}};function cO(){return{localeError:sO()}}const uO=()=>{const e={string:{unit:"harf",verb:"olmaldr"},file:{unit:"bayt",verb:"olmaldr"},array:{unit:"unsur",verb:"olmaldr"},set:{unit:"unsur",verb:"olmaldr"}};function t(n){return e[n]??null}const r={regex:"giren",email:"epostagh",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO hengm",date:"ISO tarihi",time:"ISO zaman",duration:"ISO mddeti",ipv4:"IPv4 nin",ipv6:"IPv6 nin",cidrv4:"IPv4 menzili",cidrv6:"IPv6 menzili",base64:"base64-ifreli metin",base64url:"base64url-ifreli metin",json_string:"JSON metin",e164:"E.164 says",jwt:"JWT",template_literal:"giren"},i={nan:"NaN",number:"numara",array:"saf",null:"gayb"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`Fsit giren: umulan instanceof ${n.expected}, alnan ${s}`:`Fsit giren: umulan ${o}, alnan ${s}`}case"invalid_value":return n.values.length===1?`Fsit giren: umulan ${X(n.values[0])}`:`Fsit tercih: mteberler ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?`Fazla byk: ${n.origin??"value"}, ${o}${n.maximum.toString()} ${a.unit??"elements"} sahip olmalyd.`:`Fazla byk: ${n.origin??"value"}, ${o}${n.maximum.toString()} olmalyd.`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?`Fazla kk: ${n.origin}, ${o}${n.minimum.toString()} ${a.unit} sahip olmalyd.`:`Fazla kk: ${n.origin}, ${o}${n.minimum.toString()} olmalyd.`}case"invalid_format":{const o=n;return o.format==="starts_with"?`Fsit metin: "${o.prefix}" ile balamal.`:o.format==="ends_with"?`Fsit metin: "${o.suffix}" ile bitmeli.`:o.format==="includes"?`Fsit metin: "${o.includes}" ihtiv etmeli.`:o.format==="regex"?`Fsit metin: ${o.pattern} nakna uymal.`:`Fsit ${r[o.format]??n.format}`}case"not_multiple_of":return`Fsit say: ${n.divisor} kat olmalyd.`;case"unrecognized_keys":return`Tannmayan anahtar ${n.keys.length>1?"s":""}: ${q(n.keys,", ")}`;case"invalid_key":return`${n.origin} iin tannmayan anahtar var.`;case"invalid_union":return"Giren tannamad.";case"invalid_element":return`${n.origin} iin tannmayan kymet var.`;default:return"Kymet tannamad."}}};function dO(){return{localeError:uO()}}const lO=()=>{const e={string:{unit:"",verb:""},file:{unit:"",verb:""},array:{unit:"",verb:""},set:{unit:"",verb:""}};function t(n){return e[n]??null}const r={regex:"",email:"",url:"  ",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"  ",date:"",time:"",duration:"",ipv4:" IPv4 ",ipv6:" IPv6 ",cidrv4:" IPv4 ",cidrv6:" IPv6 ",base64:"base64-encoded ",base64url:"base64url-encoded ",json_string:"JSON ",e164:" E.164 ",jwt:"JWT",template_literal:""},i={nan:"NaN",number:"",array:""};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?` :  instanceof ${n.expected} ,  ${s}  `:` :  ${o} ,  ${s}  `}case"invalid_value":return n.values.length===1?` :  ${X(n.values[0])} `:` :    ${q(n.values,"|")}  `;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?` : ${n.origin??""}  ${o}${n.maximum.toString()} ${a.unit??""} `:` : ${n.origin??""}  ${o}${n.maximum.toString()} `}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?` : ${n.origin}  ${o}${n.minimum.toString()} ${a.unit} `:` : ${n.origin}  ${o}${n.minimum.toString()} `}case"invalid_format":{const o=n;return o.format==="starts_with"?` :   "${o.prefix}"   `:o.format==="ends_with"?` :   "${o.suffix}"    `:o.format==="includes"?` :  "${o.includes}" `:o.format==="regex"?` :   ${o.pattern}   `:`${r[o.format]??n.format}  `}case"not_multiple_of":return` :   ${n.divisor}  `;case"unrecognized_keys":return` ${n.keys.length>1?"":""}: ${q(n.keys,", ")}`;case"invalid_key":return`   ${n.origin} `;case"invalid_union":return" ";case"invalid_element":return`   ${n.origin} `;default:return" "}}};function fO(){return{localeError:lO()}}const hO=()=>{const e={string:{unit:"znakw",verb:"mie"},file:{unit:"bajtw",verb:"mie"},array:{unit:"elementw",verb:"mie"},set:{unit:"elementw",verb:"mie"}};function t(n){return e[n]??null}const r={regex:"wyraenie",email:"adres email",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"data i godzina w formacie ISO",date:"data w formacie ISO",time:"godzina w formacie ISO",duration:"czas trwania ISO",ipv4:"adres IPv4",ipv6:"adres IPv6",cidrv4:"zakres IPv4",cidrv6:"zakres IPv6",base64:"cig znakw zakodowany w formacie base64",base64url:"cig znakw zakodowany w formacie base64url",json_string:"cig znakw w formacie JSON",e164:"liczba E.164",jwt:"JWT",template_literal:"wejcie"},i={nan:"NaN",number:"liczba",array:"tablica"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`Nieprawidowe dane wejciowe: oczekiwano instanceof ${n.expected}, otrzymano ${s}`:`Nieprawidowe dane wejciowe: oczekiwano ${o}, otrzymano ${s}`}case"invalid_value":return n.values.length===1?`Nieprawidowe dane wejciowe: oczekiwano ${X(n.values[0])}`:`Nieprawidowa opcja: oczekiwano jednej z wartoci ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?`Za dua warto: oczekiwano, e ${n.origin??"warto"} bdzie mie ${o}${n.maximum.toString()} ${a.unit??"elementw"}`:`Zbyt du(y/a/e): oczekiwano, e ${n.origin??"warto"} bdzie wynosi ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?`Za maa warto: oczekiwano, e ${n.origin??"warto"} bdzie mie ${o}${n.minimum.toString()} ${a.unit??"elementw"}`:`Zbyt ma(y/a/e): oczekiwano, e ${n.origin??"warto"} bdzie wynosi ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`Nieprawidowy cig znakw: musi zaczyna si od "${o.prefix}"`:o.format==="ends_with"?`Nieprawidowy cig znakw: musi koczy si na "${o.suffix}"`:o.format==="includes"?`Nieprawidowy cig znakw: musi zawiera "${o.includes}"`:o.format==="regex"?`Nieprawidowy cig znakw: musi odpowiada wzorcowi ${o.pattern}`:`Nieprawidow(y/a/e) ${r[o.format]??n.format}`}case"not_multiple_of":return`Nieprawidowa liczba: musi by wielokrotnoci ${n.divisor}`;case"unrecognized_keys":return`Nierozpoznane klucze${n.keys.length>1?"s":""}: ${q(n.keys,", ")}`;case"invalid_key":return`Nieprawidowy klucz w ${n.origin}`;case"invalid_union":return"Nieprawidowe dane wejciowe";case"invalid_element":return`Nieprawidowa warto w ${n.origin}`;default:return"Nieprawidowe dane wejciowe"}}};function pO(){return{localeError:hO()}}const mO=()=>{const e={string:{unit:"caracteres",verb:"ter"},file:{unit:"bytes",verb:"ter"},array:{unit:"itens",verb:"ter"},set:{unit:"itens",verb:"ter"}};function t(n){return e[n]??null}const r={regex:"padro",email:"endereo de e-mail",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"data e hora ISO",date:"data ISO",time:"hora ISO",duration:"durao ISO",ipv4:"endereo IPv4",ipv6:"endereo IPv6",cidrv4:"faixa de IPv4",cidrv6:"faixa de IPv6",base64:"texto codificado em base64",base64url:"URL codificada em base64",json_string:"texto JSON",e164:"nmero E.164",jwt:"JWT",template_literal:"entrada"},i={nan:"NaN",number:"nmero",null:"nulo"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`Tipo invlido: esperado instanceof ${n.expected}, recebido ${s}`:`Tipo invlido: esperado ${o}, recebido ${s}`}case"invalid_value":return n.values.length===1?`Entrada invlida: esperado ${X(n.values[0])}`:`Opo invlida: esperada uma das ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?`Muito grande: esperado que ${n.origin??"valor"} tivesse ${o}${n.maximum.toString()} ${a.unit??"elementos"}`:`Muito grande: esperado que ${n.origin??"valor"} fosse ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?`Muito pequeno: esperado que ${n.origin} tivesse ${o}${n.minimum.toString()} ${a.unit}`:`Muito pequeno: esperado que ${n.origin} fosse ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`Texto invlido: deve comear com "${o.prefix}"`:o.format==="ends_with"?`Texto invlido: deve terminar com "${o.suffix}"`:o.format==="includes"?`Texto invlido: deve incluir "${o.includes}"`:o.format==="regex"?`Texto invlido: deve corresponder ao padro ${o.pattern}`:`${r[o.format]??n.format} invlido`}case"not_multiple_of":return`Nmero invlido: deve ser mltiplo de ${n.divisor}`;case"unrecognized_keys":return`Chave${n.keys.length>1?"s":""} desconhecida${n.keys.length>1?"s":""}: ${q(n.keys,", ")}`;case"invalid_key":return`Chave invlida em ${n.origin}`;case"invalid_union":return"Entrada invlida";case"invalid_element":return`Valor invlido em ${n.origin}`;default:return"Campo invlido"}}};function gO(){return{localeError:mO()}}function Qm(e,t,r,i){const n=Math.abs(e),o=n%10,a=n%100;return a>=11&&a<=19?i:o===1?t:o>=2&&o<=4?r:i}const yO=()=>{const e={string:{unit:{one:"",few:"",many:""},verb:""},file:{unit:{one:"",few:"",many:""},verb:""},array:{unit:{one:"",few:"",many:""},verb:""},set:{unit:{one:"",few:"",many:""},verb:""}};function t(n){return e[n]??null}const r={regex:"",email:"email ",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO   ",date:"ISO ",time:"ISO ",duration:"ISO ",ipv4:"IPv4 ",ipv6:"IPv6 ",cidrv4:"IPv4 ",cidrv6:"IPv6 ",base64:"   base64",base64url:"   base64url",json_string:"JSON ",e164:" E.164",jwt:"JWT",template_literal:""},i={nan:"NaN",number:"",array:""};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?` :  instanceof ${n.expected},  ${s}`:` :  ${o},  ${s}`}case"invalid_value":return n.values.length===1?` :  ${X(n.values[0])}`:` :    ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);if(a){const s=Number(n.maximum),c=Qm(s,a.unit.one,a.unit.few,a.unit.many);return`  : ,  ${n.origin??""}   ${o}${n.maximum.toString()} ${c}`}return`  : ,  ${n.origin??""}  ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);if(a){const s=Number(n.minimum),c=Qm(s,a.unit.one,a.unit.few,a.unit.many);return`  : ,  ${n.origin}   ${o}${n.minimum.toString()} ${c}`}return`  : ,  ${n.origin}  ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?` :    "${o.prefix}"`:o.format==="ends_with"?` :    "${o.suffix}"`:o.format==="includes"?` :   "${o.includes}"`:o.format==="regex"?` :    ${o.pattern}`:` ${r[o.format]??n.format}`}case"not_multiple_of":return` :    ${n.divisor}`;case"unrecognized_keys":return`${n.keys.length>1?"":""} ${n.keys.length>1?"":""}: ${q(n.keys,", ")}`;case"invalid_key":return`   ${n.origin}`;case"invalid_union":return"  ";case"invalid_element":return`   ${n.origin}`;default:return"  "}}};function wO(){return{localeError:yO()}}const vO=()=>{const e={string:{unit:"znakov",verb:"imeti"},file:{unit:"bajtov",verb:"imeti"},array:{unit:"elementov",verb:"imeti"},set:{unit:"elementov",verb:"imeti"}};function t(n){return e[n]??null}const r={regex:"vnos",email:"e-potni naslov",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datum in as",date:"ISO datum",time:"ISO as",duration:"ISO trajanje",ipv4:"IPv4 naslov",ipv6:"IPv6 naslov",cidrv4:"obseg IPv4",cidrv6:"obseg IPv6",base64:"base64 kodiran niz",base64url:"base64url kodiran niz",json_string:"JSON niz",e164:"E.164 tevilka",jwt:"JWT",template_literal:"vnos"},i={nan:"NaN",number:"tevilo",array:"tabela"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`Neveljaven vnos: priakovano instanceof ${n.expected}, prejeto ${s}`:`Neveljaven vnos: priakovano ${o}, prejeto ${s}`}case"invalid_value":return n.values.length===1?`Neveljaven vnos: priakovano ${X(n.values[0])}`:`Neveljavna monost: priakovano eno izmed ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?`Preveliko: priakovano, da bo ${n.origin??"vrednost"} imelo ${o}${n.maximum.toString()} ${a.unit??"elementov"}`:`Preveliko: priakovano, da bo ${n.origin??"vrednost"} ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?`Premajhno: priakovano, da bo ${n.origin} imelo ${o}${n.minimum.toString()} ${a.unit}`:`Premajhno: priakovano, da bo ${n.origin} ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`Neveljaven niz: mora se zaeti z "${o.prefix}"`:o.format==="ends_with"?`Neveljaven niz: mora se konati z "${o.suffix}"`:o.format==="includes"?`Neveljaven niz: mora vsebovati "${o.includes}"`:o.format==="regex"?`Neveljaven niz: mora ustrezati vzorcu ${o.pattern}`:`Neveljaven ${r[o.format]??n.format}`}case"not_multiple_of":return`Neveljavno tevilo: mora biti vekratnik ${n.divisor}`;case"unrecognized_keys":return`Neprepoznan${n.keys.length>1?"i kljui":" klju"}: ${q(n.keys,", ")}`;case"invalid_key":return`Neveljaven klju v ${n.origin}`;case"invalid_union":return"Neveljaven vnos";case"invalid_element":return`Neveljavna vrednost v ${n.origin}`;default:return"Neveljaven vnos"}}};function bO(){return{localeError:vO()}}const _O=()=>{const e={string:{unit:"tecken",verb:"att ha"},file:{unit:"bytes",verb:"att ha"},array:{unit:"objekt",verb:"att innehlla"},set:{unit:"objekt",verb:"att innehlla"}};function t(n){return e[n]??null}const r={regex:"reguljrt uttryck",email:"e-postadress",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO-datum och tid",date:"ISO-datum",time:"ISO-tid",duration:"ISO-varaktighet",ipv4:"IPv4-intervall",ipv6:"IPv6-intervall",cidrv4:"IPv4-spektrum",cidrv6:"IPv6-spektrum",base64:"base64-kodad strng",base64url:"base64url-kodad strng",json_string:"JSON-strng",e164:"E.164-nummer",jwt:"JWT",template_literal:"mall-literal"},i={nan:"NaN",number:"antal",array:"lista"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`Ogiltig inmatning: frvntat instanceof ${n.expected}, fick ${s}`:`Ogiltig inmatning: frvntat ${o}, fick ${s}`}case"invalid_value":return n.values.length===1?`Ogiltig inmatning: frvntat ${X(n.values[0])}`:`Ogiltigt val: frvntade en av ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?`Fr stor(t): frvntade ${n.origin??"vrdet"} att ha ${o}${n.maximum.toString()} ${a.unit??"element"}`:`Fr stor(t): frvntat ${n.origin??"vrdet"} att ha ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?`Fr lite(t): frvntade ${n.origin??"vrdet"} att ha ${o}${n.minimum.toString()} ${a.unit}`:`Fr lite(t): frvntade ${n.origin??"vrdet"} att ha ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`Ogiltig strng: mste brja med "${o.prefix}"`:o.format==="ends_with"?`Ogiltig strng: mste sluta med "${o.suffix}"`:o.format==="includes"?`Ogiltig strng: mste innehlla "${o.includes}"`:o.format==="regex"?`Ogiltig strng: mste matcha mnstret "${o.pattern}"`:`Ogiltig(t) ${r[o.format]??n.format}`}case"not_multiple_of":return`Ogiltigt tal: mste vara en multipel av ${n.divisor}`;case"unrecognized_keys":return`${n.keys.length>1?"Oknda nycklar":"Oknd nyckel"}: ${q(n.keys,", ")}`;case"invalid_key":return`Ogiltig nyckel i ${n.origin??"vrdet"}`;case"invalid_union":return"Ogiltig input";case"invalid_element":return`Ogiltigt vrde i ${n.origin??"vrdet"}`;default:return"Ogiltig input"}}};function SO(){return{localeError:_O()}}const kO=()=>{const e={string:{unit:"",verb:" "},file:{unit:"",verb:" "},array:{unit:"",verb:" "},set:{unit:"",verb:" "}};function t(n){return e[n]??null}const r={regex:"",email:" ",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO  ",date:"ISO ",time:"ISO ",duration:"ISO  ",ipv4:"IPv4 ",ipv6:"IPv6 ",cidrv4:"IPv4 ",cidrv6:"IPv6 ",base64:"base64-encoded ",base64url:"base64url-encoded ",json_string:"JSON ",e164:"E.164 ",jwt:"JWT",template_literal:"input"},i={nan:"NaN",number:"",array:"",null:""};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?` :  instanceof ${n.expected},  ${s}`:` :  ${o},  ${s}`}case"invalid_value":return n.values.length===1?` :  ${X(n.values[0])}`:` :  ${q(n.values,"|")}  `;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?` :  ${n.origin??""} ${o}${n.maximum.toString()} ${a.unit??""}   `:` :  ${n.origin??""} ${o}${n.maximum.toString()}   `}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?` :  ${n.origin} ${o}${n.minimum.toString()} ${a.unit}   `:` :  ${n.origin} ${o}${n.minimum.toString()}   `}case"invalid_format":{const o=n;return o.format==="starts_with"?` : "${o.prefix}"   `:o.format==="ends_with"?` : "${o.suffix}"   `:o.format==="includes"?` : "${o.includes}"   `:o.format==="regex"?` : ${o.pattern}   `:` ${r[o.format]??n.format}`}case"not_multiple_of":return` : ${n.divisor}    `;case"unrecognized_keys":return`  ${n.keys.length>1?"":""}: ${q(n.keys,", ")}`;case"invalid_key":return`${n.origin}   `;case"invalid_union":return" ";case"invalid_element":return`${n.origin}   `;default:return" "}}};function NO(){return{localeError:kO()}}const $O=()=>{const e={string:{unit:"",verb:""},file:{unit:"",verb:""},array:{unit:"",verb:""},set:{unit:"",verb:""}};function t(n){return e[n]??null}const r={regex:"",email:"",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:" ISO",date:" ISO",time:" ISO",duration:" ISO",ipv4:" IPv4",ipv6:" IPv6",cidrv4:" IP  IPv4",cidrv6:" IP  IPv6",base64:" Base64",base64url:" Base64  URL",json_string:" JSON",e164:" (E.164)",jwt:" JWT",template_literal:""},i={nan:"NaN",number:"",array:" (Array)",null:" (null)"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`:  instanceof ${n.expected}  ${s}`:`:  ${o}  ${s}`}case"invalid_value":return n.values.length===1?`:  ${X(n.values[0])}`:`:  ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"":"",a=t(n.origin);return a?`: ${n.origin??""} ${o} ${n.maximum.toString()} ${a.unit??""}`:`: ${n.origin??""} ${o} ${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?"":"",a=t(n.origin);return a?`: ${n.origin} ${o} ${n.minimum.toString()} ${a.unit}`:`: ${n.origin} ${o} ${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`:  "${o.prefix}"`:o.format==="ends_with"?`:  "${o.suffix}"`:o.format==="includes"?`:  "${o.includes}" `:o.format==="regex"?`:  ${o.pattern}`:`: ${r[o.format]??n.format}`}case"not_multiple_of":return`:  ${n.divisor} `;case"unrecognized_keys":return`: ${q(n.keys,", ")}`;case"invalid_key":return` ${n.origin}`;case"invalid_union":return": ";case"invalid_element":return` ${n.origin}`;default:return""}}};function EO(){return{localeError:$O()}}const AO=()=>{const e={string:{unit:"karakter",verb:"olmal"},file:{unit:"bayt",verb:"olmal"},array:{unit:"e",verb:"olmal"},set:{unit:"e",verb:"olmal"}};function t(n){return e[n]??null}const r={regex:"girdi",email:"e-posta adresi",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO tarih ve saat",date:"ISO tarih",time:"ISO saat",duration:"ISO sre",ipv4:"IPv4 adresi",ipv6:"IPv6 adresi",cidrv4:"IPv4 aral",cidrv6:"IPv6 aral",base64:"base64 ile ifrelenmi metin",base64url:"base64url ile ifrelenmi metin",json_string:"JSON dizesi",e164:"E.164 says",jwt:"JWT",template_literal:"ablon dizesi"},i={nan:"NaN"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`Geersiz deer: beklenen instanceof ${n.expected}, alnan ${s}`:`Geersiz deer: beklenen ${o}, alnan ${s}`}case"invalid_value":return n.values.length===1?`Geersiz deer: beklenen ${X(n.values[0])}`:`Geersiz seenek: aadakilerden biri olmal: ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?`ok byk: beklenen ${n.origin??"deer"} ${o}${n.maximum.toString()} ${a.unit??"e"}`:`ok byk: beklenen ${n.origin??"deer"} ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?`ok kk: beklenen ${n.origin} ${o}${n.minimum.toString()} ${a.unit}`:`ok kk: beklenen ${n.origin} ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`Geersiz metin: "${o.prefix}" ile balamal`:o.format==="ends_with"?`Geersiz metin: "${o.suffix}" ile bitmeli`:o.format==="includes"?`Geersiz metin: "${o.includes}" iermeli`:o.format==="regex"?`Geersiz metin: ${o.pattern} desenine uymal`:`Geersiz ${r[o.format]??n.format}`}case"not_multiple_of":return`Geersiz say: ${n.divisor} ile tam blnebilmeli`;case"unrecognized_keys":return`Tannmayan anahtar${n.keys.length>1?"lar":""}: ${q(n.keys,", ")}`;case"invalid_key":return`${n.origin} iinde geersiz anahtar`;case"invalid_union":return"Geersiz deer";case"invalid_element":return`${n.origin} iinde geersiz deer`;default:return"Geersiz deer"}}};function IO(){return{localeError:AO()}}const TO=()=>{const e={string:{unit:"",verb:""},file:{unit:"",verb:""},array:{unit:"",verb:""},set:{unit:"",verb:""}};function t(n){return e[n]??null}const r={regex:" ",email:"  ",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"   ISO",date:" ISO",time:" ISO",duration:" ISO",ipv4:" IPv4",ipv6:" IPv6",cidrv4:" IPv4",cidrv6:" IPv6",base64:"   base64",base64url:"   base64url",json_string:" JSON",e164:" E.164",jwt:"JWT",template_literal:" "},i={nan:"NaN",number:"",array:""};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`  :  instanceof ${n.expected},  ${s}`:`  :  ${o},  ${s}`}case"invalid_value":return n.values.length===1?`  :  ${X(n.values[0])}`:` :    ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?` : ,  ${n.origin??""} ${a.verb} ${o}${n.maximum.toString()} ${a.unit??""}`:` : ,  ${n.origin??""}  ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?` : ,  ${n.origin} ${a.verb} ${o}${n.minimum.toString()} ${a.unit}`:` : ,  ${n.origin}  ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?` :    "${o.prefix}"`:o.format==="ends_with"?` :    "${o.suffix}"`:o.format==="includes"?` :   "${o.includes}"`:o.format==="regex"?` :    ${o.pattern}`:` ${r[o.format]??n.format}`}case"not_multiple_of":return` :    ${n.divisor}`;case"unrecognized_keys":return` ${n.keys.length>1?"":""}: ${q(n.keys,", ")}`;case"invalid_key":return`   ${n.origin}`;case"invalid_union":return"  ";case"invalid_element":return`   ${n.origin}`;default:return"  "}}};function Mb(){return{localeError:TO()}}function xO(){return Mb()}const OO=()=>{const e={string:{unit:"",verb:""},file:{unit:"",verb:""},array:{unit:"",verb:""},set:{unit:"",verb:""}};function t(n){return e[n]??null}const r={regex:" ",email:"  ",url:"  ",emoji:"",uuid:"   ",uuidv4:"     4",uuidv6:"     6",nanoid:"  ",guid:"   ",cuid:"   ",cuid2:"    2",ulid:"   ",xid:"  ",ksuid:"    ",datetime:"    ",date:"   ",time:"   ",duration:"   ",ipv4:"   4 ",ipv6:"   6 ",cidrv4:"   4 ",cidrv6:"   6 ",base64:" 64   ",base64url:" 64      ",json_string:"    ",e164:" 164 ",jwt:"  ",template_literal:" "},i={nan:"NaN",number:"",array:"",null:""};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`  : instanceof ${n.expected}   ${s}  `:`  : ${o}   ${s}  `}case"invalid_value":return n.values.length===1?`  : ${X(n.values[0])}  `:` : ${q(n.values,"|")}     `;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?` : ${n.origin??""}  ${o}${n.maximum.toString()} ${a.unit??""}   `:` : ${n.origin??""}  ${o}${n.maximum.toString()}   `}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?` : ${n.origin}  ${o}${n.minimum.toString()} ${a.unit}   `:` : ${n.origin}  ${o}${n.minimum.toString()}   `}case"invalid_format":{const o=n;return o.format==="starts_with"?` : "${o.prefix}"    `:o.format==="ends_with"?` : "${o.suffix}"    `:o.format==="includes"?` : "${o.includes}"   `:o.format==="regex"?` :  ${o.pattern}    `:` ${r[o.format]??n.format}`}case"not_multiple_of":return` : ${n.divisor}    `;case"unrecognized_keys":return`   ${n.keys.length>1?"":""}: ${q(n.keys," ")}`;case"invalid_key":return`${n.origin}   `;case"invalid_union":return"  ";case"invalid_element":return`${n.origin}   `;default:return"  "}}};function DO(){return{localeError:OO()}}const RO=()=>{const e={string:{unit:"belgi",verb:"bolishi kerak"},file:{unit:"bayt",verb:"bolishi kerak"},array:{unit:"element",verb:"bolishi kerak"},set:{unit:"element",verb:"bolishi kerak"}};function t(n){return e[n]??null}const r={regex:"kirish",email:"elektron pochta manzili",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO sana va vaqti",date:"ISO sana",time:"ISO vaqt",duration:"ISO davomiylik",ipv4:"IPv4 manzil",ipv6:"IPv6 manzil",mac:"MAC manzil",cidrv4:"IPv4 diapazon",cidrv6:"IPv6 diapazon",base64:"base64 kodlangan satr",base64url:"base64url kodlangan satr",json_string:"JSON satr",e164:"E.164 raqam",jwt:"JWT",template_literal:"kirish"},i={nan:"NaN",number:"raqam",array:"massiv"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`Notogri kirish: kutilgan instanceof ${n.expected}, qabul qilingan ${s}`:`Notogri kirish: kutilgan ${o}, qabul qilingan ${s}`}case"invalid_value":return n.values.length===1?`Notogri kirish: kutilgan ${X(n.values[0])}`:`Notogri variant: quyidagilardan biri kutilgan ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?`Juda katta: kutilgan ${n.origin??"qiymat"} ${o}${n.maximum.toString()} ${a.unit} ${a.verb}`:`Juda katta: kutilgan ${n.origin??"qiymat"} ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?`Juda kichik: kutilgan ${n.origin} ${o}${n.minimum.toString()} ${a.unit} ${a.verb}`:`Juda kichik: kutilgan ${n.origin} ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`Notogri satr: "${o.prefix}" bilan boshlanishi kerak`:o.format==="ends_with"?`Notogri satr: "${o.suffix}" bilan tugashi kerak`:o.format==="includes"?`Notogri satr: "${o.includes}" ni oz ichiga olishi kerak`:o.format==="regex"?`Notogri satr: ${o.pattern} shabloniga mos kelishi kerak`:`Notogri ${r[o.format]??n.format}`}case"not_multiple_of":return`Notogri raqam: ${n.divisor} ning karralisi bolishi kerak`;case"unrecognized_keys":return`Nomalum kalit${n.keys.length>1?"lar":""}: ${q(n.keys,", ")}`;case"invalid_key":return`${n.origin} dagi kalit notogri`;case"invalid_union":return"Notogri kirish";case"invalid_element":return`${n.origin} da notogri qiymat`;default:return"Notogri kirish"}}};function UO(){return{localeError:RO()}}const CO=()=>{const e={string:{unit:"k t",verb:"c"},file:{unit:"byte",verb:"c"},array:{unit:"phn t",verb:"c"},set:{unit:"phn t",verb:"c"}};function t(n){return e[n]??null}const r={regex:"u vo",email:"a ch email",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ngy gi ISO",date:"ngy ISO",time:"gi ISO",duration:"khong thi gian ISO",ipv4:"a ch IPv4",ipv6:"a ch IPv6",cidrv4:"di IPv4",cidrv6:"di IPv6",base64:"chui m ha base64",base64url:"chui m ha base64url",json_string:"chui JSON",e164:"s E.164",jwt:"JWT",template_literal:"u vo"},i={nan:"NaN",number:"s",array:"mng"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`u vo khng hp l: mong i instanceof ${n.expected}, nhn c ${s}`:`u vo khng hp l: mong i ${o}, nhn c ${s}`}case"invalid_value":return n.values.length===1?`u vo khng hp l: mong i ${X(n.values[0])}`:`Ty chn khng hp l: mong i mt trong cc gi tr ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?`Qu ln: mong i ${n.origin??"gi tr"} ${a.verb} ${o}${n.maximum.toString()} ${a.unit??"phn t"}`:`Qu ln: mong i ${n.origin??"gi tr"} ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?`Qu nh: mong i ${n.origin} ${a.verb} ${o}${n.minimum.toString()} ${a.unit}`:`Qu nh: mong i ${n.origin} ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`Chui khng hp l: phi bt u bng "${o.prefix}"`:o.format==="ends_with"?`Chui khng hp l: phi kt thc bng "${o.suffix}"`:o.format==="includes"?`Chui khng hp l: phi bao gm "${o.includes}"`:o.format==="regex"?`Chui khng hp l: phi khp vi mu ${o.pattern}`:`${r[o.format]??n.format} khng hp l`}case"not_multiple_of":return`S khng hp l: phi l bi s ca ${n.divisor}`;case"unrecognized_keys":return`Kha khng c nhn dng: ${q(n.keys,", ")}`;case"invalid_key":return`Kha khng hp l trong ${n.origin}`;case"invalid_union":return"u vo khng hp l";case"invalid_element":return`Gi tr khng hp l trong ${n.origin}`;default:return"u vo khng hp l"}}};function PO(){return{localeError:CO()}}const LO=()=>{const e={string:{unit:"",verb:""},file:{unit:"",verb:""},array:{unit:"",verb:""},set:{unit:"",verb:""}};function t(n){return e[n]??null}const r={regex:"",email:"",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO",date:"ISO",time:"ISO",duration:"ISO",ipv4:"IPv4",ipv6:"IPv6",cidrv4:"IPv4",cidrv6:"IPv6",base64:"base64",base64url:"base64url",json_string:"JSON",e164:"E.164",jwt:"JWT",template_literal:""},i={nan:"NaN",number:"",array:"",null:"(null)"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?` instanceof ${n.expected} ${s}`:` ${o} ${s}`}case"invalid_value":return n.values.length===1?` ${X(n.values[0])}`:` ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?` ${n.origin??""} ${o}${n.maximum.toString()} ${a.unit??""}`:` ${n.origin??""} ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?` ${n.origin} ${o}${n.minimum.toString()} ${a.unit}`:` ${n.origin} ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?` "${o.prefix}" `:o.format==="ends_with"?` "${o.suffix}" `:o.format==="includes"?` "${o.includes}"`:o.format==="regex"?` ${o.pattern}`:`${r[o.format]??n.format}`}case"not_multiple_of":return` ${n.divisor} `;case"unrecognized_keys":return`(key): ${q(n.keys,", ")}`;case"invalid_key":return`${n.origin} (key)`;case"invalid_union":return"";case"invalid_element":return`${n.origin} (value)`;default:return""}}};function zO(){return{localeError:LO()}}const jO=()=>{const e={string:{unit:"",verb:""},file:{unit:"",verb:""},array:{unit:"",verb:""},set:{unit:"",verb:""}};function t(n){return e[n]??null}const r={regex:"",email:"",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO ",date:"ISO ",time:"ISO ",duration:"ISO ",ipv4:"IPv4 ",ipv6:"IPv6 ",cidrv4:"IPv4 ",cidrv6:"IPv6 ",base64:"base64 ",base64url:"base64url ",json_string:"JSON ",e164:"E.164 ",jwt:"JWT",template_literal:""},i={nan:"NaN"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?` instanceof ${n.expected} ${s}`:` ${o} ${s}`}case"invalid_value":return n.values.length===1?` ${X(n.values[0])}`:` ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?` ${n.origin??""}  ${o}${n.maximum.toString()} ${a.unit??""}`:` ${n.origin??""}  ${o}${n.maximum.toString()}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?` ${n.origin}  ${o}${n.minimum.toString()} ${a.unit}`:` ${n.origin}  ${o}${n.minimum.toString()}`}case"invalid_format":{const o=n;return o.format==="starts_with"?` "${o.prefix}" `:o.format==="ends_with"?` "${o.suffix}" `:o.format==="includes"?` "${o.includes}"`:o.format==="regex"?` ${o.pattern}`:` ${r[o.format]??n.format}`}case"not_multiple_of":return` ${n.divisor} `;case"unrecognized_keys":return`${n.keys.length>1?"":""}${q(n.keys,"")}`;case"invalid_key":return`${n.origin} `;case"invalid_union":return"";case"invalid_element":return`${n.origin} `;default:return""}}};function MO(){return{localeError:jO()}}const qO=()=>{const e={string:{unit:"mi",verb:"n"},file:{unit:"bytes",verb:"n"},array:{unit:"nkan",verb:"n"},set:{unit:"nkan",verb:"n"}};function t(n){return e[n]??null}const r={regex:"r bwl",email:"drs ml",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"kk ISO",date:"j ISO",time:"kk ISO",duration:"kk t p ISO",ipv4:"drs IPv4",ipv6:"drs IPv6",cidrv4:"gbgb IPv4",cidrv6:"gbgb IPv6",base64:"r t a k n base64",base64url:"r base64url",json_string:"r JSON",e164:"nmb E.164",jwt:"JWT",template_literal:"r bwl"},i={nan:"NaN",number:"nmb",array:"akop"};return n=>{switch(n.code){case"invalid_type":{const o=i[n.expected]??n.expected,a=ee(n.input),s=i[a]??a;return/^[A-Z]/.test(n.expected)?`bwl ae: a n lti fi instanceof ${n.expected}, m a r ${s}`:`bwl ae: a n lti fi ${o}, m a r ${s}`}case"invalid_value":return n.values.length===1?`bwl ae: a n lti fi ${X(n.values[0])}`:`yn ae: yan kan lra ${q(n.values,"|")}`;case"too_big":{const o=n.inclusive?"<=":"<",a=t(n.origin);return a?`T p j: a n lti j p ${n.origin??"iye"} ${a.verb} ${o}${n.maximum} ${a.unit}`:`T p j: a n lti j ${o}${n.maximum}`}case"too_small":{const o=n.inclusive?">=":">",a=t(n.origin);return a?`Kr ju: a n lti j p ${n.origin} ${a.verb} ${o}${n.minimum} ${a.unit}`:`Kr ju: a n lti j ${o}${n.minimum}`}case"invalid_format":{const o=n;return o.format==="starts_with"?`r ae: gbd br pl "${o.prefix}"`:o.format==="ends_with"?`r ae: gbd par pl "${o.suffix}"`:o.format==="includes"?`r ae: gbd n "${o.includes}"`:o.format==="regex"?`r ae: gbd b pr mu ${o.pattern}`:`Ae: ${r[o.format]??n.format}`}case"not_multiple_of":return`Nmb ae: gbd j y ppn ti ${n.divisor}`;case"unrecognized_keys":return`Btn m: ${q(n.keys,", ")}`;case"invalid_key":return`Btn ae nn ${n.origin}`;case"invalid_union":return"bwl ae";case"invalid_element":return`Iye ae nn ${n.origin}`;default:return"bwl ae"}}};function WO(){return{localeError:qO()}}const zf=Object.freeze(Object.defineProperty({__proto__:null,ar:ox,az:sx,be:ux,bg:lx,ca:hx,cs:mx,da:yx,de:vx,en:zb,eo:Sx,es:Nx,fa:Ex,fi:Ix,fr:xx,frCA:Dx,he:Ux,hu:Px,hy:zx,id:Mx,is:Wx,it:Bx,ja:Kx,ka:Hx,kh:Gx,km:jb,ko:Yx,lt:eO,mk:rO,ms:iO,nl:aO,no:cO,ota:dO,pl:pO,ps:fO,pt:gO,ru:wO,sl:bO,sv:SO,ta:NO,th:EO,tr:IO,ua:xO,uk:Mb,ur:DO,uz:UO,vi:PO,yo:WO,zhCN:zO,zhTW:MO},Symbol.toStringTag,{value:"Module"}));var Ym;const jf=Symbol("ZodOutput"),Mf=Symbol("ZodInput");class qb{constructor(){this._map=new WeakMap,this._idmap=new Map}add(t,...r){const i=r[0];return this._map.set(t,i),i&&typeof i=="object"&&"id"in i&&this._idmap.set(i.id,t),this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(t){const r=this._map.get(t);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(t),this}get(t){const r=t._zod.parent;if(r){const i={...this.get(r)??{}};delete i.id;const n={...i,...this._map.get(t)};return Object.keys(n).length?n:void 0}return this._map.get(t)}has(t){return this._map.has(t)}}function Xc(){return new qb}(Ym=globalThis).__zod_globalRegistry??(Ym.__zod_globalRegistry=Xc());const qt=globalThis.__zod_globalRegistry;function Wb(e,t){return new e({type:"string",...L(t)})}function Fb(e,t){return new e({type:"string",coerce:!0,...L(t)})}function qf(e,t){return new e({type:"string",format:"email",check:"string_format",abort:!1,...L(t)})}function dc(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...L(t)})}function Wf(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...L(t)})}function Ff(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...L(t)})}function Bf(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...L(t)})}function Vf(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...L(t)})}function eu(e,t){return new e({type:"string",format:"url",check:"string_format",abort:!1,...L(t)})}function Kf(e,t){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...L(t)})}function Jf(e,t){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...L(t)})}function Hf(e,t){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...L(t)})}function Zf(e,t){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...L(t)})}function Gf(e,t){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...L(t)})}function Qf(e,t){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...L(t)})}function Yf(e,t){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...L(t)})}function Xf(e,t){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...L(t)})}function eh(e,t){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...L(t)})}function Bb(e,t){return new e({type:"string",format:"mac",check:"string_format",abort:!1,...L(t)})}function th(e,t){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...L(t)})}function rh(e,t){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...L(t)})}function nh(e,t){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...L(t)})}function ih(e,t){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...L(t)})}function oh(e,t){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...L(t)})}function ah(e,t){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...L(t)})}const sh={Any:null,Minute:-1,Second:0,Millisecond:3,Microsecond:6};function Vb(e,t){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...L(t)})}function Kb(e,t){return new e({type:"string",format:"date",check:"string_format",...L(t)})}function Jb(e,t){return new e({type:"string",format:"time",check:"string_format",precision:null,...L(t)})}function Hb(e,t){return new e({type:"string",format:"duration",check:"string_format",...L(t)})}function Zb(e,t){return new e({type:"number",checks:[],...L(t)})}function Gb(e,t){return new e({type:"number",coerce:!0,checks:[],...L(t)})}function Qb(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"safeint",...L(t)})}function Yb(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"float32",...L(t)})}function Xb(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"float64",...L(t)})}function e_(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"int32",...L(t)})}function t_(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"uint32",...L(t)})}function r_(e,t){return new e({type:"boolean",...L(t)})}function n_(e,t){return new e({type:"boolean",coerce:!0,...L(t)})}function i_(e,t){return new e({type:"bigint",...L(t)})}function o_(e,t){return new e({type:"bigint",coerce:!0,...L(t)})}function a_(e,t){return new e({type:"bigint",check:"bigint_format",abort:!1,format:"int64",...L(t)})}function s_(e,t){return new e({type:"bigint",check:"bigint_format",abort:!1,format:"uint64",...L(t)})}function c_(e,t){return new e({type:"symbol",...L(t)})}function u_(e,t){return new e({type:"undefined",...L(t)})}function d_(e,t){return new e({type:"null",...L(t)})}function l_(e){return new e({type:"any"})}function f_(e){return new e({type:"unknown"})}function h_(e,t){return new e({type:"never",...L(t)})}function p_(e,t){return new e({type:"void",...L(t)})}function m_(e,t){return new e({type:"date",...L(t)})}function g_(e,t){return new e({type:"date",coerce:!0,...L(t)})}function y_(e,t){return new e({type:"nan",...L(t)})}function Yr(e,t){return new Tf({check:"less_than",...L(t),value:e,inclusive:!1})}function Ft(e,t){return new Tf({check:"less_than",...L(t),value:e,inclusive:!0})}function Xr(e,t){return new xf({check:"greater_than",...L(t),value:e,inclusive:!1})}function Nt(e,t){return new xf({check:"greater_than",...L(t),value:e,inclusive:!0})}function tu(e){return Xr(0,e)}function ru(e){return Yr(0,e)}function nu(e){return Ft(0,e)}function iu(e){return Nt(0,e)}function ui(e,t){return new ov({check:"multiple_of",...L(t),value:e})}function wi(e,t){return new cv({check:"max_size",...L(t),maximum:e})}function en(e,t){return new uv({check:"min_size",...L(t),minimum:e})}function po(e,t){return new dv({check:"size_equals",...L(t),size:e})}function mo(e,t){return new lv({check:"max_length",...L(t),maximum:e})}function Rn(e,t){return new fv({check:"min_length",...L(t),minimum:e})}function go(e,t){return new hv({check:"length_equals",...L(t),length:e})}function Pa(e,t){return new pv({check:"string_format",format:"regex",...L(t),pattern:e})}function La(e){return new mv({check:"string_format",format:"lowercase",...L(e)})}function za(e){return new gv({check:"string_format",format:"uppercase",...L(e)})}function ja(e,t){return new yv({check:"string_format",format:"includes",...L(t),includes:e})}function Ma(e,t){return new wv({check:"string_format",format:"starts_with",...L(t),prefix:e})}function qa(e,t){return new vv({check:"string_format",format:"ends_with",...L(t),suffix:e})}function ou(e,t,r){return new bv({check:"property",property:e,schema:t,...L(r)})}function Wa(e,t){return new _v({check:"mime_type",mime:e,...L(t)})}function Rr(e){return new Sv({check:"overwrite",tx:e})}function Fa(e){return Rr(t=>t.normalize(e))}function Ba(){return Rr(e=>e.trim())}function Va(){return Rr(e=>e.toLowerCase())}function Ka(){return Rr(e=>e.toUpperCase())}function Ja(){return Rr(e=>ow(e))}function w_(e,t,r){return new e({type:"array",element:t,...L(r)})}function FO(e,t,r){return new e({type:"union",options:t,...L(r)})}function BO(e,t,r){return new e({type:"union",options:t,inclusive:!1,...L(r)})}function VO(e,t,r,i){return new e({type:"union",options:r,discriminator:t,...L(i)})}function KO(e,t,r){return new e({type:"intersection",left:t,right:r})}function JO(e,t,r,i){const n=r instanceof te,o=n?i:r,a=n?r:null;return new e({type:"tuple",items:t,rest:a,...L(o)})}function HO(e,t,r,i){return new e({type:"record",keyType:t,valueType:r,...L(i)})}function ZO(e,t,r,i){return new e({type:"map",keyType:t,valueType:r,...L(i)})}function GO(e,t,r){return new e({type:"set",valueType:t,...L(r)})}function QO(e,t,r){const i=Array.isArray(t)?Object.fromEntries(t.map(n=>[n,n])):t;return new e({type:"enum",entries:i,...L(r)})}function YO(e,t,r){return new e({type:"enum",entries:t,...L(r)})}function XO(e,t,r){return new e({type:"literal",values:Array.isArray(t)?t:[t],...L(r)})}function v_(e,t){return new e({type:"file",...L(t)})}function e0(e,t){return new e({type:"transform",transform:t})}function t0(e,t){return new e({type:"optional",innerType:t})}function r0(e,t){return new e({type:"nullable",innerType:t})}function n0(e,t,r){return new e({type:"default",innerType:t,get defaultValue(){return typeof r=="function"?r():Kc(r)}})}function i0(e,t,r){return new e({type:"nonoptional",innerType:t,...L(r)})}function o0(e,t){return new e({type:"success",innerType:t})}function a0(e,t,r){return new e({type:"catch",innerType:t,catchValue:typeof r=="function"?r:()=>r})}function s0(e,t,r){return new e({type:"pipe",in:t,out:r})}function c0(e,t){return new e({type:"readonly",innerType:t})}function u0(e,t,r){return new e({type:"template_literal",parts:t,...L(r)})}function d0(e,t){return new e({type:"lazy",getter:t})}function l0(e,t){return new e({type:"promise",innerType:t})}function b_(e,t,r){const i=L(r);return i.abort??(i.abort=!0),new e({type:"custom",check:"custom",fn:t,...i})}function __(e,t,r){return new e({type:"custom",check:"custom",fn:t,...L(r)})}function S_(e){const t=k_(r=>(r.addIssue=i=>{if(typeof i=="string")r.issues.push(Ji(i,r.value,t._zod.def));else{const n=i;n.fatal&&(n.continue=!1),n.code??(n.code="custom"),n.input??(n.input=r.value),n.inst??(n.inst=t),n.continue??(n.continue=!t._zod.def.abort),r.issues.push(Ji(n))}},e(r.value,r)));return t}function k_(e,t){const r=new ze({check:"custom",...L(t)});return r._zod.check=e,r}function N_(e){const t=new ze({check:"describe"});return t._zod.onattach=[r=>{const i=qt.get(r)??{};qt.add(r,{...i,description:e})}],t._zod.check=()=>{},t}function $_(e){const t=new ze({check:"meta"});return t._zod.onattach=[r=>{const i=qt.get(r)??{};qt.add(r,{...i,...e})}],t._zod.check=()=>{},t}function E_(e,t){const r=L(t);let i=r.truthy??["true","1","yes","on","y","enabled"],n=r.falsy??["false","0","no","off","n","disabled"];r.case!=="sensitive"&&(i=i.map(h=>typeof h=="string"?h.toLowerCase():h),n=n.map(h=>typeof h=="string"?h.toLowerCase():h));const o=new Set(i),a=new Set(n),s=e.Codec??Lf,c=e.Boolean??Rf,u=e.String??Ca,d=new u({type:"string",error:r.error}),l=new c({type:"boolean",error:r.error}),f=new s({type:"pipe",in:d,out:l,transform:((h,g)=>{let m=h;return r.case!=="sensitive"&&(m=m.toLowerCase()),o.has(m)?!0:a.has(m)?!1:(g.issues.push({code:"invalid_value",expected:"stringbool",values:[...o,...a],input:g.value,inst:f,continue:!1}),{})}),reverseTransform:((h,g)=>h===!0?i[0]||"true":n[0]||"false"),error:r.error});return f}function Ha(e,t,r,i={}){const n=L(i),o={...L(i),check:"string_format",type:"string",format:t,fn:typeof r=="function"?r:s=>r.test(s),...n};return r instanceof RegExp&&(o.pattern=r),new e(o)}function Zi(e){let t=e?.target??"draft-2020-12";return t==="draft-4"&&(t="draft-04"),t==="draft-7"&&(t="draft-07"),{processors:e.processors??{},metadataRegistry:e?.metadata??qt,target:t,unrepresentable:e?.unrepresentable??"throw",override:e?.override??(()=>{}),io:e?.io??"output",counter:0,seen:new Map,cycles:e?.cycles??"ref",reused:e?.reused??"inline",external:e?.external??void 0}}function ke(e,t,r={path:[],schemaPath:[]}){var i;const n=e._zod.def,o=t.seen.get(e);if(o)return o.count++,r.schemaPath.includes(e)&&(o.cycle=r.path),o.schema;const a={schema:{},count:1,cycle:void 0,path:r.path};t.seen.set(e,a);const s=e._zod.toJSONSchema?.();if(s)a.schema=s;else{const d={...r,schemaPath:[...r.schemaPath,e],path:r.path};if(e._zod.processJSONSchema)e._zod.processJSONSchema(t,a.schema,d);else{const f=a.schema,h=t.processors[n.type];if(!h)throw new Error(`[toJSONSchema]: Non-representable type encountered: ${n.type}`);h(e,t,f,d)}const l=e._zod.parent;l&&(a.ref||(a.ref=l),ke(l,t,d),t.seen.get(l).isParent=!0)}const c=t.metadataRegistry.get(e);return c&&Object.assign(a.schema,c),t.io==="input"&&kt(e)&&(delete a.schema.examples,delete a.schema.default),t.io==="input"&&a.schema._prefault&&((i=a.schema).default??(i.default=a.schema._prefault)),delete a.schema._prefault,t.seen.get(e).schema}function Gi(e,t){const r=e.seen.get(t);if(!r)throw new Error("Unprocessed schema. This is a bug in Zod.");const i=new Map;for(const a of e.seen.entries()){const s=e.metadataRegistry.get(a[0])?.id;if(s){const c=i.get(s);if(c&&c!==a[0])throw new Error(`Duplicate schema id "${s}" detected during JSON Schema conversion. Two different schemas cannot share the same id when converted together.`);i.set(s,a[0])}}const n=a=>{const s=e.target==="draft-2020-12"?"$defs":"definitions";if(e.external){const l=e.external.registry.get(a[0])?.id,f=e.external.uri??(g=>g);if(l)return{ref:f(l)};const h=a[1].defId??a[1].schema.id??`schema${e.counter++}`;return a[1].defId=h,{defId:h,ref:`${f("__shared")}#/${s}/${h}`}}if(a[1]===r)return{ref:"#"};const u=`#/${s}/`,d=a[1].schema.id??`__schema${e.counter++}`;return{defId:d,ref:u+d}},o=a=>{if(a[1].schema.$ref)return;const s=a[1],{ref:c,defId:u}=n(a);s.def={...s.schema},u&&(s.defId=u);const d=s.schema;for(const l in d)delete d[l];d.$ref=c};if(e.cycles==="throw")for(const a of e.seen.entries()){const s=a[1];if(s.cycle)throw new Error(`Cycle detected: #/${s.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(const a of e.seen.entries()){const s=a[1];if(t===a[0]){o(a);continue}if(e.external){const u=e.external.registry.get(a[0])?.id;if(t!==a[0]&&u){o(a);continue}}if(e.metadataRegistry.get(a[0])?.id){o(a);continue}if(s.cycle){o(a);continue}if(s.count>1&&e.reused==="ref"){o(a);continue}}}function Qi(e,t){const r=e.seen.get(t);if(!r)throw new Error("Unprocessed schema. This is a bug in Zod.");const i=a=>{const s=e.seen.get(a);if(s.ref===null)return;const c=s.def??s.schema,u={...c},d=s.ref;if(s.ref=null,d){i(d);const f=e.seen.get(d),h=f.schema;if(h.$ref&&(e.target==="draft-07"||e.target==="draft-04"||e.target==="openapi-3.0")?(c.allOf=c.allOf??[],c.allOf.push(h)):Object.assign(c,h),Object.assign(c,u),a._zod.parent===d)for(const m in c)m==="$ref"||m==="allOf"||m in u||delete c[m];if(h.$ref)for(const m in c)m==="$ref"||m==="allOf"||m in f.def&&JSON.stringify(c[m])===JSON.stringify(f.def[m])&&delete c[m]}const l=a._zod.parent;if(l&&l!==d){i(l);const f=e.seen.get(l);if(f?.schema.$ref&&(c.$ref=f.schema.$ref,f.def))for(const h in c)h==="$ref"||h==="allOf"||h in f.def&&JSON.stringify(c[h])===JSON.stringify(f.def[h])&&delete c[h]}e.override({zodSchema:a,jsonSchema:c,path:s.path??[]})};for(const a of[...e.seen.entries()].reverse())i(a[0]);const n={};if(e.target==="draft-2020-12"?n.$schema="https://json-schema.org/draft/2020-12/schema":e.target==="draft-07"?n.$schema="http://json-schema.org/draft-07/schema#":e.target==="draft-04"?n.$schema="http://json-schema.org/draft-04/schema#":e.target,e.external?.uri){const a=e.external.registry.get(t)?.id;if(!a)throw new Error("Schema is missing an `id` property");n.$id=e.external.uri(a)}Object.assign(n,r.def??r.schema);const o=e.external?.defs??{};for(const a of e.seen.entries()){const s=a[1];s.def&&s.defId&&(o[s.defId]=s.def)}e.external||Object.keys(o).length>0&&(e.target==="draft-2020-12"?n.$defs=o:n.definitions=o);try{const a=JSON.parse(JSON.stringify(n));return Object.defineProperty(a,"~standard",{value:{...t["~standard"],jsonSchema:{input:ma(t,"input",e.processors),output:ma(t,"output",e.processors)}},enumerable:!1,writable:!1}),a}catch{throw new Error("Error converting schema to JSON.")}}function kt(e,t){const r=t??{seen:new Set};if(r.seen.has(e))return!1;r.seen.add(e);const i=e._zod.def;if(i.type==="transform")return!0;if(i.type==="array")return kt(i.element,r);if(i.type==="set")return kt(i.valueType,r);if(i.type==="lazy")return kt(i.getter(),r);if(i.type==="promise"||i.type==="optional"||i.type==="nonoptional"||i.type==="nullable"||i.type==="readonly"||i.type==="default"||i.type==="prefault")return kt(i.innerType,r);if(i.type==="intersection")return kt(i.left,r)||kt(i.right,r);if(i.type==="record"||i.type==="map")return kt(i.keyType,r)||kt(i.valueType,r);if(i.type==="pipe")return kt(i.in,r)||kt(i.out,r);if(i.type==="object"){for(const n in i.shape)if(kt(i.shape[n],r))return!0;return!1}if(i.type==="union"){for(const n of i.options)if(kt(n,r))return!0;return!1}if(i.type==="tuple"){for(const n of i.items)if(kt(n,r))return!0;return!!(i.rest&&kt(i.rest,r))}return!1}const A_=(e,t={})=>r=>{const i=Zi({...r,processors:t});return ke(e,i),Gi(i,e),Qi(i,e)},ma=(e,t,r={})=>i=>{const{libraryOptions:n,target:o}=i??{},a=Zi({...n??{},target:o,io:t,processors:r});return ke(e,a),Gi(a,e),Qi(a,e)},f0={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},I_=(e,t,r,i)=>{const n=r;n.type="string";const{minimum:o,maximum:a,format:s,patterns:c,contentEncoding:u}=e._zod.bag;if(typeof o=="number"&&(n.minLength=o),typeof a=="number"&&(n.maxLength=a),s&&(n.format=f0[s]??s,n.format===""&&delete n.format,s==="time"&&delete n.format),u&&(n.contentEncoding=u),c&&c.size>0){const d=[...c];d.length===1?n.pattern=d[0].source:d.length>1&&(n.allOf=[...d.map(l=>({...t.target==="draft-07"||t.target==="draft-04"||t.target==="openapi-3.0"?{type:"string"}:{},pattern:l.source}))])}},T_=(e,t,r,i)=>{const n=r,{minimum:o,maximum:a,format:s,multipleOf:c,exclusiveMaximum:u,exclusiveMinimum:d}=e._zod.bag;typeof s=="string"&&s.includes("int")?n.type="integer":n.type="number",typeof d=="number"&&(t.target==="draft-04"||t.target==="openapi-3.0"?(n.minimum=d,n.exclusiveMinimum=!0):n.exclusiveMinimum=d),typeof o=="number"&&(n.minimum=o,typeof d=="number"&&t.target!=="draft-04"&&(d>=o?delete n.minimum:delete n.exclusiveMinimum)),typeof u=="number"&&(t.target==="draft-04"||t.target==="openapi-3.0"?(n.maximum=u,n.exclusiveMaximum=!0):n.exclusiveMaximum=u),typeof a=="number"&&(n.maximum=a,typeof u=="number"&&t.target!=="draft-04"&&(u<=a?delete n.maximum:delete n.exclusiveMaximum)),typeof c=="number"&&(n.multipleOf=c)},x_=(e,t,r,i)=>{r.type="boolean"},O_=(e,t,r,i)=>{if(t.unrepresentable==="throw")throw new Error("BigInt cannot be represented in JSON Schema")},D_=(e,t,r,i)=>{if(t.unrepresentable==="throw")throw new Error("Symbols cannot be represented in JSON Schema")},R_=(e,t,r,i)=>{t.target==="openapi-3.0"?(r.type="string",r.nullable=!0,r.enum=[null]):r.type="null"},U_=(e,t,r,i)=>{if(t.unrepresentable==="throw")throw new Error("Undefined cannot be represented in JSON Schema")},C_=(e,t,r,i)=>{if(t.unrepresentable==="throw")throw new Error("Void cannot be represented in JSON Schema")},P_=(e,t,r,i)=>{r.not={}},L_=(e,t,r,i)=>{},z_=(e,t,r,i)=>{},j_=(e,t,r,i)=>{if(t.unrepresentable==="throw")throw new Error("Date cannot be represented in JSON Schema")},M_=(e,t,r,i)=>{const n=e._zod.def,o=hf(n.entries);o.every(a=>typeof a=="number")&&(r.type="number"),o.every(a=>typeof a=="string")&&(r.type="string"),r.enum=o},q_=(e,t,r,i)=>{const n=e._zod.def,o=[];for(const a of n.values)if(a===void 0){if(t.unrepresentable==="throw")throw new Error("Literal `undefined` cannot be represented in JSON Schema")}else if(typeof a=="bigint"){if(t.unrepresentable==="throw")throw new Error("BigInt literals cannot be represented in JSON Schema");o.push(Number(a))}else o.push(a);if(o.length!==0)if(o.length===1){const a=o[0];r.type=a===null?"null":typeof a,t.target==="draft-04"||t.target==="openapi-3.0"?r.enum=[a]:r.const=a}else o.every(a=>typeof a=="number")&&(r.type="number"),o.every(a=>typeof a=="string")&&(r.type="string"),o.every(a=>typeof a=="boolean")&&(r.type="boolean"),o.every(a=>a===null)&&(r.type="null"),r.enum=o},W_=(e,t,r,i)=>{if(t.unrepresentable==="throw")throw new Error("NaN cannot be represented in JSON Schema")},F_=(e,t,r,i)=>{const n=r,o=e._zod.pattern;if(!o)throw new Error("Pattern not found in template literal");n.type="string",n.pattern=o.source},B_=(e,t,r,i)=>{const n=r,o={type:"string",format:"binary",contentEncoding:"binary"},{minimum:a,maximum:s,mime:c}=e._zod.bag;a!==void 0&&(o.minLength=a),s!==void 0&&(o.maxLength=s),c?c.length===1?(o.contentMediaType=c[0],Object.assign(n,o)):(Object.assign(n,o),n.anyOf=c.map(u=>({contentMediaType:u}))):Object.assign(n,o)},V_=(e,t,r,i)=>{r.type="boolean"},K_=(e,t,r,i)=>{if(t.unrepresentable==="throw")throw new Error("Custom types cannot be represented in JSON Schema")},J_=(e,t,r,i)=>{if(t.unrepresentable==="throw")throw new Error("Function types cannot be represented in JSON Schema")},H_=(e,t,r,i)=>{if(t.unrepresentable==="throw")throw new Error("Transforms cannot be represented in JSON Schema")},Z_=(e,t,r,i)=>{if(t.unrepresentable==="throw")throw new Error("Map cannot be represented in JSON Schema")},G_=(e,t,r,i)=>{if(t.unrepresentable==="throw")throw new Error("Set cannot be represented in JSON Schema")},Q_=(e,t,r,i)=>{const n=r,o=e._zod.def,{minimum:a,maximum:s}=e._zod.bag;typeof a=="number"&&(n.minItems=a),typeof s=="number"&&(n.maxItems=s),n.type="array",n.items=ke(o.element,t,{...i,path:[...i.path,"items"]})},Y_=(e,t,r,i)=>{const n=r,o=e._zod.def;n.type="object",n.properties={};const a=o.shape;for(const u in a)n.properties[u]=ke(a[u],t,{...i,path:[...i.path,"properties",u]});const s=new Set(Object.keys(a)),c=new Set([...s].filter(u=>{const d=o.shape[u]._zod;return t.io==="input"?d.optin===void 0:d.optout===void 0}));c.size>0&&(n.required=Array.from(c)),o.catchall?._zod.def.type==="never"?n.additionalProperties=!1:o.catchall?o.catchall&&(n.additionalProperties=ke(o.catchall,t,{...i,path:[...i.path,"additionalProperties"]})):t.io==="output"&&(n.additionalProperties=!1)},ch=(e,t,r,i)=>{const n=e._zod.def,o=n.inclusive===!1,a=n.options.map((s,c)=>ke(s,t,{...i,path:[...i.path,o?"oneOf":"anyOf",c]}));o?r.oneOf=a:r.anyOf=a},X_=(e,t,r,i)=>{const n=e._zod.def,o=ke(n.left,t,{...i,path:[...i.path,"allOf",0]}),a=ke(n.right,t,{...i,path:[...i.path,"allOf",1]}),s=u=>"allOf"in u&&Object.keys(u).length===1,c=[...s(o)?o.allOf:[o],...s(a)?a.allOf:[a]];r.allOf=c},eS=(e,t,r,i)=>{const n=r,o=e._zod.def;n.type="array";const a=t.target==="draft-2020-12"?"prefixItems":"items",s=t.target==="draft-2020-12"||t.target==="openapi-3.0"?"items":"additionalItems",c=o.items.map((f,h)=>ke(f,t,{...i,path:[...i.path,a,h]})),u=o.rest?ke(o.rest,t,{...i,path:[...i.path,s,...t.target==="openapi-3.0"?[o.items.length]:[]]}):null;t.target==="draft-2020-12"?(n.prefixItems=c,u&&(n.items=u)):t.target==="openapi-3.0"?(n.items={anyOf:c},u&&n.items.anyOf.push(u),n.minItems=c.length,u||(n.maxItems=c.length)):(n.items=c,u&&(n.additionalItems=u));const{minimum:d,maximum:l}=e._zod.bag;typeof d=="number"&&(n.minItems=d),typeof l=="number"&&(n.maxItems=l)},tS=(e,t,r,i)=>{const n=r,o=e._zod.def;n.type="object";const a=o.keyType,c=a._zod.bag?.patterns;if(o.mode==="loose"&&c&&c.size>0){const d=ke(o.valueType,t,{...i,path:[...i.path,"patternProperties","*"]});n.patternProperties={};for(const l of c)n.patternProperties[l.source]=d}else(t.target==="draft-07"||t.target==="draft-2020-12")&&(n.propertyNames=ke(o.keyType,t,{...i,path:[...i.path,"propertyNames"]})),n.additionalProperties=ke(o.valueType,t,{...i,path:[...i.path,"additionalProperties"]});const u=a._zod.values;if(u){const d=[...u].filter(l=>typeof l=="string"||typeof l=="number");d.length>0&&(n.required=d)}},rS=(e,t,r,i)=>{const n=e._zod.def,o=ke(n.innerType,t,i),a=t.seen.get(e);t.target==="openapi-3.0"?(a.ref=n.innerType,r.nullable=!0):r.anyOf=[o,{type:"null"}]},nS=(e,t,r,i)=>{const n=e._zod.def;ke(n.innerType,t,i);const o=t.seen.get(e);o.ref=n.innerType},iS=(e,t,r,i)=>{const n=e._zod.def;ke(n.innerType,t,i);const o=t.seen.get(e);o.ref=n.innerType,r.default=JSON.parse(JSON.stringify(n.defaultValue))},oS=(e,t,r,i)=>{const n=e._zod.def;ke(n.innerType,t,i);const o=t.seen.get(e);o.ref=n.innerType,t.io==="input"&&(r._prefault=JSON.parse(JSON.stringify(n.defaultValue)))},aS=(e,t,r,i)=>{const n=e._zod.def;ke(n.innerType,t,i);const o=t.seen.get(e);o.ref=n.innerType;let a;try{a=n.catchValue(void 0)}catch{throw new Error("Dynamic catch values are not supported in JSON Schema")}r.default=a},sS=(e,t,r,i)=>{const n=e._zod.def,o=t.io==="input"?n.in._zod.def.type==="transform"?n.out:n.in:n.out;ke(o,t,i);const a=t.seen.get(e);a.ref=o},cS=(e,t,r,i)=>{const n=e._zod.def;ke(n.innerType,t,i);const o=t.seen.get(e);o.ref=n.innerType,r.readOnly=!0},uS=(e,t,r,i)=>{const n=e._zod.def;ke(n.innerType,t,i);const o=t.seen.get(e);o.ref=n.innerType},uh=(e,t,r,i)=>{const n=e._zod.def;ke(n.innerType,t,i);const o=t.seen.get(e);o.ref=n.innerType},dS=(e,t,r,i)=>{const n=e._zod.innerType;ke(n,t,i);const o=t.seen.get(e);o.ref=n},kl={string:I_,number:T_,boolean:x_,bigint:O_,symbol:D_,null:R_,undefined:U_,void:C_,never:P_,any:L_,unknown:z_,date:j_,enum:M_,literal:q_,nan:W_,template_literal:F_,file:B_,success:V_,custom:K_,function:J_,transform:H_,map:Z_,set:G_,array:Q_,object:Y_,union:ch,intersection:X_,tuple:eS,record:tS,nullable:rS,nonoptional:nS,default:iS,prefault:oS,catch:aS,pipe:sS,readonly:cS,promise:uS,optional:uh,lazy:dS};function dh(e,t){if("_idmap"in e){const i=e,n=Zi({...t,processors:kl}),o={};for(const c of i._idmap.entries()){const[u,d]=c;ke(d,n)}const a={},s={registry:i,uri:t?.uri,defs:o};n.external=s;for(const c of i._idmap.entries()){const[u,d]=c;Gi(n,d),a[u]=Qi(n,d)}if(Object.keys(o).length>0){const c=n.target==="draft-2020-12"?"$defs":"definitions";a.__shared={[c]:o}}return{schemas:a}}const r=Zi({...t,processors:kl});return ke(e,r),Gi(r,e),Qi(r,e)}class h0{get metadataRegistry(){return this.ctx.metadataRegistry}get target(){return this.ctx.target}get unrepresentable(){return this.ctx.unrepresentable}get override(){return this.ctx.override}get io(){return this.ctx.io}get counter(){return this.ctx.counter}set counter(t){this.ctx.counter=t}get seen(){return this.ctx.seen}constructor(t){let r=t?.target??"draft-2020-12";r==="draft-4"&&(r="draft-04"),r==="draft-7"&&(r="draft-07"),this.ctx=Zi({processors:kl,target:r,...t?.metadata&&{metadata:t.metadata},...t?.unrepresentable&&{unrepresentable:t.unrepresentable},...t?.override&&{override:t.override},...t?.io&&{io:t.io}})}process(t,r={path:[],schemaPath:[]}){return ke(t,this.ctx,r)}emit(t,r){r&&(r.cycles&&(this.ctx.cycles=r.cycles),r.reused&&(this.ctx.reused=r.reused),r.external&&(this.ctx.external=r.external)),Gi(this.ctx,t);const i=Qi(this.ctx,t),{"~standard":n,...o}=i;return o}}const p0=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),lS=Object.freeze(Object.defineProperty({__proto__:null,$ZodAny:nb,$ZodArray:cb,$ZodAsyncError:ni,$ZodBase64:Vv,$ZodBase64URL:Jv,$ZodBigInt:Uf,$ZodBigIntFormat:Xv,$ZodBoolean:Rf,$ZodCIDRv4:Fv,$ZodCIDRv6:Bv,$ZodCUID:Ov,$ZodCUID2:Dv,$ZodCatch:Tb,$ZodCheck:ze,$ZodCheckBigIntFormat:sv,$ZodCheckEndsWith:vv,$ZodCheckGreaterThan:xf,$ZodCheckIncludes:yv,$ZodCheckLengthEquals:hv,$ZodCheckLessThan:Tf,$ZodCheckLowerCase:mv,$ZodCheckMaxLength:lv,$ZodCheckMaxSize:cv,$ZodCheckMimeType:_v,$ZodCheckMinLength:fv,$ZodCheckMinSize:uv,$ZodCheckMultipleOf:ov,$ZodCheckNumberFormat:av,$ZodCheckOverwrite:Sv,$ZodCheckProperty:bv,$ZodCheckRegex:pv,$ZodCheckSizeEquals:dv,$ZodCheckStartsWith:wv,$ZodCheckStringFormat:Ua,$ZodCheckUpperCase:gv,$ZodCodec:Lf,$ZodCustom:Lb,$ZodCustomStringFormat:Qv,$ZodDate:sb,$ZodDefault:$b,$ZodDiscriminatedUnion:pb,$ZodE164:Hv,$ZodEmail:Av,$ZodEmoji:Tv,$ZodEncodeError:Bc,$ZodEnum:vb,$ZodError:gf,$ZodExactOptional:kb,$ZodFile:_b,$ZodFunction:Ub,$ZodGUID:$v,$ZodIPv4:Mv,$ZodIPv6:qv,$ZodISODate:Lv,$ZodISODateTime:Pv,$ZodISODuration:jv,$ZodISOTime:zv,$ZodIntersection:mb,$ZodJWT:Gv,$ZodKSUID:Cv,$ZodLazy:Pb,$ZodLiteral:bb,$ZodMAC:Wv,$ZodMap:yb,$ZodNaN:xb,$ZodNanoID:xv,$ZodNever:ob,$ZodNonOptional:Ab,$ZodNull:rb,$ZodNullable:Nb,$ZodNumber:Df,$ZodNumberFormat:Yv,$ZodObject:lb,$ZodObjectJIT:fb,$ZodOptional:Pf,$ZodPipe:Ob,$ZodPrefault:Eb,$ZodPromise:Cb,$ZodReadonly:Db,$ZodRealError:Zt,$ZodRecord:gb,$ZodRegistry:qb,$ZodSet:wb,$ZodString:Ca,$ZodStringFormat:Te,$ZodSuccess:Ib,$ZodSymbol:eb,$ZodTemplateLiteral:Rb,$ZodTransform:Sb,$ZodTuple:Cf,$ZodType:te,$ZodULID:Rv,$ZodURL:Iv,$ZodUUID:Ev,$ZodUndefined:tb,$ZodUnion:Yc,$ZodUnknown:ib,$ZodVoid:ab,$ZodXID:Uv,$ZodXor:hb,$brand:ff,$constructor:$,$input:Mf,$output:jf,Doc:kv,JSONSchema:p0,JSONSchemaGenerator:h0,NEVER:lf,TimePrecision:sh,_any:l_,_array:w_,_base64:nh,_base64url:ih,_bigint:i_,_boolean:r_,_catch:a0,_check:k_,_cidrv4:th,_cidrv6:rh,_coercedBigint:o_,_coercedBoolean:n_,_coercedDate:g_,_coercedNumber:Gb,_coercedString:Fb,_cuid:Hf,_cuid2:Zf,_custom:b_,_date:m_,_decode:bf,_decodeAsync:Sf,_default:n0,_discriminatedUnion:VO,_e164:oh,_email:qf,_emoji:Kf,_encode:vf,_encodeAsync:_f,_endsWith:qa,_enum:QO,_file:v_,_float32:Yb,_float64:Xb,_gt:Xr,_gte:Nt,_guid:dc,_includes:ja,_int:Qb,_int32:e_,_int64:a_,_intersection:KO,_ipv4:Xf,_ipv6:eh,_isoDate:Kb,_isoDateTime:Vb,_isoDuration:Hb,_isoTime:Jb,_jwt:ah,_ksuid:Yf,_lazy:d0,_length:go,_literal:XO,_lowercase:La,_lt:Yr,_lte:Ft,_mac:Bb,_map:ZO,_max:Ft,_maxLength:mo,_maxSize:wi,_mime:Wa,_min:Nt,_minLength:Rn,_minSize:en,_multipleOf:ui,_nan:y_,_nanoid:Jf,_nativeEnum:YO,_negative:ru,_never:h_,_nonnegative:iu,_nonoptional:i0,_nonpositive:nu,_normalize:Fa,_null:d_,_nullable:r0,_number:Zb,_optional:t0,_overwrite:Rr,_parse:Ia,_parseAsync:Ta,_pipe:s0,_positive:tu,_promise:l0,_property:ou,_readonly:c0,_record:HO,_refine:__,_regex:Pa,_safeDecode:Nf,_safeDecodeAsync:Ef,_safeEncode:kf,_safeEncodeAsync:$f,_safeParse:xa,_safeParseAsync:Oa,_set:GO,_size:po,_slugify:Ja,_startsWith:Ma,_string:Wb,_stringFormat:Ha,_stringbool:E_,_success:o0,_superRefine:S_,_symbol:c_,_templateLiteral:u0,_toLowerCase:Va,_toUpperCase:Ka,_transform:e0,_trim:Ba,_tuple:JO,_uint32:t_,_uint64:s_,_ulid:Gf,_undefined:u_,_union:FO,_unknown:f_,_uppercase:za,_url:eu,_uuid:Wf,_uuidv4:Ff,_uuidv6:Bf,_uuidv7:Vf,_void:p_,_xid:Qf,_xor:BO,clone:Ht,config:pt,createStandardJSONSchemaMethod:ma,createToJSONSchemaMethod:A_,decode:AT,decodeAsync:TT,describe:N_,encode:ET,encodeAsync:IT,extractDefs:Gi,finalize:Qi,flattenError:Zc,formatError:Gc,globalConfig:ac,globalRegistry:qt,initializeContext:Zi,isValidBase64:Of,isValidBase64URL:Kv,isValidJWT:Zv,locales:zf,meta:$_,parse:bl,parseAsync:_l,prettifyError:wf,process:ke,regexes:Qc,registry:Xc,safeDecode:OT,safeDecodeAsync:RT,safeEncode:xT,safeEncodeAsync:DT,safeParse:Sw,safeParseAsync:kw,toDotPath:_w,toJSONSchema:dh,treeifyError:yf,util:mf,version:Nv},Symbol.toStringTag,{value:"Module"})),m0=Object.freeze(Object.defineProperty({__proto__:null,endsWith:qa,gt:Xr,gte:Nt,includes:ja,length:go,lowercase:La,lt:Yr,lte:Ft,maxLength:mo,maxSize:wi,mime:Wa,minLength:Rn,minSize:en,multipleOf:ui,negative:ru,nonnegative:iu,nonpositive:nu,normalize:Fa,overwrite:Rr,positive:tu,property:ou,regex:Pa,size:po,slugify:Ja,startsWith:Ma,toLowerCase:Va,toUpperCase:Ka,trim:Ba,uppercase:za},Symbol.toStringTag,{value:"Module"})),au=$("ZodISODateTime",(e,t)=>{Pv.init(e,t),Ne.init(e,t)});function fS(e){return Vb(au,e)}const su=$("ZodISODate",(e,t)=>{Lv.init(e,t),Ne.init(e,t)});function hS(e){return Kb(su,e)}const cu=$("ZodISOTime",(e,t)=>{zv.init(e,t),Ne.init(e,t)});function pS(e){return Jb(cu,e)}const uu=$("ZodISODuration",(e,t)=>{jv.init(e,t),Ne.init(e,t)});function mS(e){return Hb(uu,e)}const lh=Object.freeze(Object.defineProperty({__proto__:null,ZodISODate:su,ZodISODateTime:au,ZodISODuration:uu,ZodISOTime:cu,date:hS,datetime:fS,duration:mS,time:pS},Symbol.toStringTag,{value:"Module"})),gS=(e,t)=>{gf.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:r=>Gc(e,r)},flatten:{value:r=>Zc(e,r)},addIssue:{value:r=>{e.issues.push(r),e.message=JSON.stringify(e.issues,sc,2)}},addIssues:{value:r=>{e.issues.push(...r),e.message=JSON.stringify(e.issues,sc,2)}},isEmpty:{get(){return e.issues.length===0}}})},yS=$("ZodError",gS),xt=$("ZodError",gS,{Parent:Error}),fh=Ia(xt),hh=Ta(xt),ph=xa(xt),mh=Oa(xt),gh=vf(xt),yh=bf(xt),wh=_f(xt),vh=Sf(xt),bh=kf(xt),_h=Nf(xt),Sh=$f(xt),kh=Ef(xt),ne=$("ZodType",(e,t)=>(te.init(e,t),Object.assign(e["~standard"],{jsonSchema:{input:ma(e,"input"),output:ma(e,"output")}}),e.toJSONSchema=A_(e,{}),e.def=t,e.type=t.type,Object.defineProperty(e,"_def",{value:t}),e.check=(...r)=>e.clone(Dr(t,{checks:[...t.checks??[],...r.map(i=>typeof i=="function"?{_zod:{check:i,def:{check:"custom"},onattach:[]}}:i)]}),{parent:!0}),e.with=e.check,e.clone=(r,i)=>Ht(e,r,i),e.brand=()=>e,e.register=((r,i)=>(r.add(e,i),e)),e.parse=(r,i)=>fh(e,r,i,{callee:e.parse}),e.safeParse=(r,i)=>ph(e,r,i),e.parseAsync=async(r,i)=>hh(e,r,i,{callee:e.parseAsync}),e.safeParseAsync=async(r,i)=>mh(e,r,i),e.spa=e.safeParseAsync,e.encode=(r,i)=>gh(e,r,i),e.decode=(r,i)=>yh(e,r,i),e.encodeAsync=async(r,i)=>wh(e,r,i),e.decodeAsync=async(r,i)=>vh(e,r,i),e.safeEncode=(r,i)=>bh(e,r,i),e.safeDecode=(r,i)=>_h(e,r,i),e.safeEncodeAsync=async(r,i)=>Sh(e,r,i),e.safeDecodeAsync=async(r,i)=>kh(e,r,i),e.refine=(r,i)=>e.check(Qu(r,i)),e.superRefine=r=>e.check(Yu(r)),e.overwrite=r=>e.check(Rr(r)),e.optional=()=>on(e),e.exactOptional=()=>Ru(e),e.nullable=()=>Xi(e),e.nullish=()=>on(Xi(e)),e.nonoptional=r=>ju(e,r),e.array=()=>Ar(e),e.or=r=>gs([e,r]),e.and=r=>Nu(e,r),e.transform=r=>eo(e,ys(r)),e.default=r=>Pu(e,r),e.prefault=r=>zu(e,r),e.catch=r=>Wu(e,r),e.pipe=r=>eo(e,r),e.readonly=()=>Vu(e),e.describe=r=>{const i=e.clone();return qt.add(i,{description:r}),i},Object.defineProperty(e,"description",{get(){return qt.get(e)?.description},configurable:!0}),e.meta=(...r)=>{if(r.length===0)return qt.get(e);const i=e.clone();return qt.add(i,r[0]),i},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e.apply=r=>r(e),e)),Za=$("_ZodString",(e,t)=>{Ca.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(i,n,o)=>I_(e,i,n);const r=e._zod.bag;e.format=r.format??null,e.minLength=r.minimum??null,e.maxLength=r.maximum??null,e.regex=(...i)=>e.check(Pa(...i)),e.includes=(...i)=>e.check(ja(...i)),e.startsWith=(...i)=>e.check(Ma(...i)),e.endsWith=(...i)=>e.check(qa(...i)),e.min=(...i)=>e.check(Rn(...i)),e.max=(...i)=>e.check(mo(...i)),e.length=(...i)=>e.check(go(...i)),e.nonempty=(...i)=>e.check(Rn(1,...i)),e.lowercase=i=>e.check(La(i)),e.uppercase=i=>e.check(za(i)),e.trim=()=>e.check(Ba()),e.normalize=(...i)=>e.check(Fa(...i)),e.toLowerCase=()=>e.check(Va()),e.toUpperCase=()=>e.check(Ka()),e.slugify=()=>e.check(Ja())}),yo=$("ZodString",(e,t)=>{Ca.init(e,t),Za.init(e,t),e.email=r=>e.check(qf(Ga,r)),e.url=r=>e.check(eu(wo,r)),e.jwt=r=>e.check(ah(fs,r)),e.emoji=r=>e.check(Kf(Qa,r)),e.guid=r=>e.check(dc(Yi,r)),e.uuid=r=>e.check(Wf(fr,r)),e.uuidv4=r=>e.check(Ff(fr,r)),e.uuidv6=r=>e.check(Bf(fr,r)),e.uuidv7=r=>e.check(Vf(fr,r)),e.nanoid=r=>e.check(Jf(Ya,r)),e.guid=r=>e.check(dc(Yi,r)),e.cuid=r=>e.check(Hf(Xa,r)),e.cuid2=r=>e.check(Zf(es,r)),e.ulid=r=>e.check(Gf(ts,r)),e.base64=r=>e.check(nh(us,r)),e.base64url=r=>e.check(ih(ds,r)),e.xid=r=>e.check(Qf(rs,r)),e.ksuid=r=>e.check(Yf(ns,r)),e.ipv4=r=>e.check(Xf(is,r)),e.ipv6=r=>e.check(eh(os,r)),e.cidrv4=r=>e.check(th(ss,r)),e.cidrv6=r=>e.check(rh(cs,r)),e.e164=r=>e.check(oh(ls,r)),e.datetime=r=>e.check(fS(r)),e.date=r=>e.check(hS(r)),e.time=r=>e.check(pS(r)),e.duration=r=>e.check(mS(r))});function M(e){return Wb(yo,e)}const Ne=$("ZodStringFormat",(e,t)=>{Te.init(e,t),Za.init(e,t)}),Ga=$("ZodEmail",(e,t)=>{Av.init(e,t),Ne.init(e,t)});function Ur(e){return qf(Ga,e)}const Yi=$("ZodGUID",(e,t)=>{$v.init(e,t),Ne.init(e,t)});function Nh(e){return dc(Yi,e)}const fr=$("ZodUUID",(e,t)=>{Ev.init(e,t),Ne.init(e,t)});function $h(e){return Wf(fr,e)}function Eh(e){return Ff(fr,e)}function Ah(e){return Bf(fr,e)}function Ih(e){return Vf(fr,e)}const wo=$("ZodURL",(e,t)=>{Iv.init(e,t),Ne.init(e,t)});function Th(e){return eu(wo,e)}function xh(e){return eu(wo,{protocol:/^https?$/,hostname:Ww,...L(e)})}const Qa=$("ZodEmoji",(e,t)=>{Tv.init(e,t),Ne.init(e,t)});function Oh(e){return Kf(Qa,e)}const Ya=$("ZodNanoID",(e,t)=>{xv.init(e,t),Ne.init(e,t)});function Dh(e){return Jf(Ya,e)}const Xa=$("ZodCUID",(e,t)=>{Ov.init(e,t),Ne.init(e,t)});function Rh(e){return Hf(Xa,e)}const es=$("ZodCUID2",(e,t)=>{Dv.init(e,t),Ne.init(e,t)});function Uh(e){return Zf(es,e)}const ts=$("ZodULID",(e,t)=>{Rv.init(e,t),Ne.init(e,t)});function Ch(e){return Gf(ts,e)}const rs=$("ZodXID",(e,t)=>{Uv.init(e,t),Ne.init(e,t)});function Ph(e){return Qf(rs,e)}const ns=$("ZodKSUID",(e,t)=>{Cv.init(e,t),Ne.init(e,t)});function Lh(e){return Yf(ns,e)}const is=$("ZodIPv4",(e,t)=>{Mv.init(e,t),Ne.init(e,t)});function di(e){return Xf(is,e)}const du=$("ZodMAC",(e,t)=>{Wv.init(e,t),Ne.init(e,t)});function zh(e){return Bb(du,e)}const os=$("ZodIPv6",(e,t)=>{qv.init(e,t),Ne.init(e,t)});function as(e){return eh(os,e)}const ss=$("ZodCIDRv4",(e,t)=>{Fv.init(e,t),Ne.init(e,t)});function jh(e){return th(ss,e)}const cs=$("ZodCIDRv6",(e,t)=>{Bv.init(e,t),Ne.init(e,t)});function Mh(e){return rh(cs,e)}const us=$("ZodBase64",(e,t)=>{Vv.init(e,t),Ne.init(e,t)});function qh(e){return nh(us,e)}const ds=$("ZodBase64URL",(e,t)=>{Jv.init(e,t),Ne.init(e,t)});function Wh(e){return ih(ds,e)}const ls=$("ZodE164",(e,t)=>{Hv.init(e,t),Ne.init(e,t)});function Fh(e){return oh(ls,e)}const fs=$("ZodJWT",(e,t)=>{Gv.init(e,t),Ne.init(e,t)});function Bh(e){return ah(fs,e)}const vi=$("ZodCustomStringFormat",(e,t)=>{Qv.init(e,t),Ne.init(e,t)});function Vh(e,t,r={}){return Ha(vi,e,t,r)}function Kh(e){return Ha(vi,"hostname",qw,e)}function Jh(e){return Ha(vi,"hex",nv,e)}function Hh(e,t){const r=t?.enc??"hex",i=`${e}_${r}`,n=Qc[i];if(!n)throw new Error(`Unrecognized hash format: ${i}`);return Ha(vi,i,n,t)}const vo=$("ZodNumber",(e,t)=>{Df.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(i,n,o)=>T_(e,i,n),e.gt=(i,n)=>e.check(Xr(i,n)),e.gte=(i,n)=>e.check(Nt(i,n)),e.min=(i,n)=>e.check(Nt(i,n)),e.lt=(i,n)=>e.check(Yr(i,n)),e.lte=(i,n)=>e.check(Ft(i,n)),e.max=(i,n)=>e.check(Ft(i,n)),e.int=i=>e.check(ga(i)),e.safe=i=>e.check(ga(i)),e.positive=i=>e.check(Xr(0,i)),e.nonnegative=i=>e.check(Nt(0,i)),e.negative=i=>e.check(Yr(0,i)),e.nonpositive=i=>e.check(Ft(0,i)),e.multipleOf=(i,n)=>e.check(ui(i,n)),e.step=(i,n)=>e.check(ui(i,n)),e.finite=()=>e;const r=e._zod.bag;e.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,e.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,e.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),e.isFinite=!0,e.format=r.format??null});function tn(e){return Zb(vo,e)}const Mn=$("ZodNumberFormat",(e,t)=>{Yv.init(e,t),vo.init(e,t)});function ga(e){return Qb(Mn,e)}function Zh(e){return Yb(Mn,e)}function Gh(e){return Xb(Mn,e)}function Qh(e){return e_(Mn,e)}function Yh(e){return t_(Mn,e)}const bo=$("ZodBoolean",(e,t)=>{Rf.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>x_(e,r,i)});function Bt(e){return r_(bo,e)}const _o=$("ZodBigInt",(e,t)=>{Uf.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(i,n,o)=>O_(e,i),e.gte=(i,n)=>e.check(Nt(i,n)),e.min=(i,n)=>e.check(Nt(i,n)),e.gt=(i,n)=>e.check(Xr(i,n)),e.gte=(i,n)=>e.check(Nt(i,n)),e.min=(i,n)=>e.check(Nt(i,n)),e.lt=(i,n)=>e.check(Yr(i,n)),e.lte=(i,n)=>e.check(Ft(i,n)),e.max=(i,n)=>e.check(Ft(i,n)),e.positive=i=>e.check(Xr(BigInt(0),i)),e.negative=i=>e.check(Yr(BigInt(0),i)),e.nonpositive=i=>e.check(Ft(BigInt(0),i)),e.nonnegative=i=>e.check(Nt(BigInt(0),i)),e.multipleOf=(i,n)=>e.check(ui(i,n));const r=e._zod.bag;e.minValue=r.minimum??null,e.maxValue=r.maximum??null,e.format=r.format??null});function Xh(e){return i_(_o,e)}const hs=$("ZodBigIntFormat",(e,t)=>{Xv.init(e,t),_o.init(e,t)});function ep(e){return a_(hs,e)}function tp(e){return s_(hs,e)}const lu=$("ZodSymbol",(e,t)=>{eb.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>D_(e,r)});function rp(e){return c_(lu,e)}const fu=$("ZodUndefined",(e,t)=>{tb.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>U_(e,r)});function np(e){return u_(fu,e)}const hu=$("ZodNull",(e,t)=>{rb.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>R_(e,r,i)});function pu(e){return d_(hu,e)}const mu=$("ZodAny",(e,t)=>{nb.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>L_()});function rn(){return l_(mu)}const gu=$("ZodUnknown",(e,t)=>{ib.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>z_()});function Un(){return f_(gu)}const yu=$("ZodNever",(e,t)=>{ob.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>P_(e,r,i)});function ps(e){return h_(yu,e)}const wu=$("ZodVoid",(e,t)=>{ab.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>C_(e,r)});function ip(e){return p_(wu,e)}const ms=$("ZodDate",(e,t)=>{sb.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(i,n,o)=>j_(e,i),e.min=(i,n)=>e.check(Nt(i,n)),e.max=(i,n)=>e.check(Ft(i,n));const r=e._zod.bag;e.minDate=r.minimum?new Date(r.minimum):null,e.maxDate=r.maximum?new Date(r.maximum):null});function nn(e){return m_(ms,e)}const vu=$("ZodArray",(e,t)=>{cb.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>Q_(e,r,i,n),e.element=t.element,e.min=(r,i)=>e.check(Rn(r,i)),e.nonempty=r=>e.check(Rn(1,r)),e.max=(r,i)=>e.check(mo(r,i)),e.length=(r,i)=>e.check(go(r,i)),e.unwrap=()=>e.element});function Ar(e,t){return w_(vu,e,t)}function op(e){const t=e._zod.def.shape;return No(Object.keys(t))}const Ir=$("ZodObject",(e,t)=>{fb.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>Y_(e,r,i,n),ae(e,"shape",()=>t.shape),e.keyof=()=>No(Object.keys(e._zod.def.shape)),e.catchall=r=>e.clone({...e._zod.def,catchall:r}),e.passthrough=()=>e.clone({...e._zod.def,catchall:Un()}),e.loose=()=>e.clone({...e._zod.def,catchall:Un()}),e.strict=()=>e.clone({...e._zod.def,catchall:ps()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=r=>hw(e,r),e.safeExtend=r=>pw(e,r),e.merge=r=>mw(e,r),e.pick=r=>lw(e,r),e.omit=r=>fw(e,r),e.partial=(...r)=>gw(Tn,e,r[0]),e.required=(...r)=>yw(ws,e,r[0])});function le(e,t){const r={type:"object",shape:e??{},...L(t)};return new Ir(r)}function ap(e,t){return new Ir({type:"object",shape:e,catchall:ps(),...L(t)})}function bu(e,t){return new Ir({type:"object",shape:e,catchall:Un(),...L(t)})}const So=$("ZodUnion",(e,t)=>{Yc.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>ch(e,r,i,n),e.options=t.options});function gs(e,t){return new So({type:"union",options:e,...L(t)})}const _u=$("ZodXor",(e,t)=>{So.init(e,t),hb.init(e,t),e._zod.processJSONSchema=(r,i,n)=>ch(e,r,i,n),e.options=t.options});function sp(e,t){return new _u({type:"union",options:e,inclusive:!1,...L(t)})}const Su=$("ZodDiscriminatedUnion",(e,t)=>{So.init(e,t),pb.init(e,t)});function cp(e,t,r){return new Su({type:"union",options:t,discriminator:e,...L(r)})}const ku=$("ZodIntersection",(e,t)=>{mb.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>X_(e,r,i,n)});function Nu(e,t){return new ku({type:"intersection",left:e,right:t})}const $u=$("ZodTuple",(e,t)=>{Cf.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>eS(e,r,i,n),e.rest=r=>e.clone({...e._zod.def,rest:r})});function Eu(e,t,r){const i=t instanceof te,n=i?r:t,o=i?t:null;return new $u({type:"tuple",items:e,rest:o,...L(n)})}const ko=$("ZodRecord",(e,t)=>{gb.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>tS(e,r,i,n),e.keyType=t.keyType,e.valueType=t.valueType});function qn(e,t,r){return new ko({type:"record",keyType:e,valueType:t,...L(r)})}function up(e,t,r){const i=Ht(e);return i._zod.values=void 0,new ko({type:"record",keyType:i,valueType:t,...L(r)})}function dp(e,t,r){return new ko({type:"record",keyType:e,valueType:t,mode:"loose",...L(r)})}const Au=$("ZodMap",(e,t)=>{yb.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>Z_(e,r),e.keyType=t.keyType,e.valueType=t.valueType,e.min=(...r)=>e.check(en(...r)),e.nonempty=r=>e.check(en(1,r)),e.max=(...r)=>e.check(wi(...r)),e.size=(...r)=>e.check(po(...r))});function lp(e,t,r){return new Au({type:"map",keyType:e,valueType:t,...L(r)})}const Iu=$("ZodSet",(e,t)=>{wb.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>G_(e,r),e.min=(...r)=>e.check(en(...r)),e.nonempty=r=>e.check(en(1,r)),e.max=(...r)=>e.check(wi(...r)),e.size=(...r)=>e.check(po(...r))});function fp(e,t){return new Iu({type:"set",valueType:e,...L(t)})}const li=$("ZodEnum",(e,t)=>{vb.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(i,n,o)=>M_(e,i,n),e.enum=t.entries,e.options=Object.values(t.entries);const r=new Set(Object.keys(t.entries));e.extract=(i,n)=>{const o={};for(const a of i)if(r.has(a))o[a]=t.entries[a];else throw new Error(`Key ${a} not found in enum`);return new li({...t,checks:[],...L(n),entries:o})},e.exclude=(i,n)=>{const o={...t.entries};for(const a of i)if(r.has(a))delete o[a];else throw new Error(`Key ${a} not found in enum`);return new li({...t,checks:[],...L(n),entries:o})}});function No(e,t){const r=Array.isArray(e)?Object.fromEntries(e.map(i=>[i,i])):e;return new li({type:"enum",entries:r,...L(t)})}function hp(e,t){return new li({type:"enum",entries:e,...L(t)})}const Tu=$("ZodLiteral",(e,t)=>{bb.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>q_(e,r,i),e.values=new Set(t.values),Object.defineProperty(e,"value",{get(){if(t.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return t.values[0]}})});function pp(e,t){return new Tu({type:"literal",values:Array.isArray(e)?e:[e],...L(t)})}const xu=$("ZodFile",(e,t)=>{_b.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>B_(e,r,i),e.min=(r,i)=>e.check(en(r,i)),e.max=(r,i)=>e.check(wi(r,i)),e.mime=(r,i)=>e.check(Wa(Array.isArray(r)?r:[r],i))});function mp(e){return v_(xu,e)}const Ou=$("ZodTransform",(e,t)=>{Sb.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>H_(e,r),e._zod.parse=(r,i)=>{if(i.direction==="backward")throw new Bc(e.constructor.name);r.addIssue=o=>{if(typeof o=="string")r.issues.push(Ji(o,r.value,t));else{const a=o;a.fatal&&(a.continue=!1),a.code??(a.code="custom"),a.input??(a.input=r.value),a.inst??(a.inst=e),r.issues.push(Ji(a))}};const n=t.transform(r.value,r);return n instanceof Promise?n.then(o=>(r.value=o,r)):(r.value=n,r)}});function ys(e){return new Ou({type:"transform",transform:e})}const Tn=$("ZodOptional",(e,t)=>{Pf.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>uh(e,r,i,n),e.unwrap=()=>e._zod.def.innerType});function on(e){return new Tn({type:"optional",innerType:e})}const Du=$("ZodExactOptional",(e,t)=>{kb.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>uh(e,r,i,n),e.unwrap=()=>e._zod.def.innerType});function Ru(e){return new Du({type:"optional",innerType:e})}const Uu=$("ZodNullable",(e,t)=>{Nb.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>rS(e,r,i,n),e.unwrap=()=>e._zod.def.innerType});function Xi(e){return new Uu({type:"nullable",innerType:e})}function gp(e){return on(Xi(e))}const Cu=$("ZodDefault",(e,t)=>{$b.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>iS(e,r,i,n),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});function Pu(e,t){return new Cu({type:"default",innerType:e,get defaultValue(){return typeof t=="function"?t():Kc(t)}})}const Lu=$("ZodPrefault",(e,t)=>{Eb.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>oS(e,r,i,n),e.unwrap=()=>e._zod.def.innerType});function zu(e,t){return new Lu({type:"prefault",innerType:e,get defaultValue(){return typeof t=="function"?t():Kc(t)}})}const ws=$("ZodNonOptional",(e,t)=>{Ab.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>nS(e,r,i,n),e.unwrap=()=>e._zod.def.innerType});function ju(e,t){return new ws({type:"nonoptional",innerType:e,...L(t)})}const Mu=$("ZodSuccess",(e,t)=>{Ib.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>V_(e,r,i),e.unwrap=()=>e._zod.def.innerType});function yp(e){return new Mu({type:"success",innerType:e})}const qu=$("ZodCatch",(e,t)=>{Tb.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>aS(e,r,i,n),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});function Wu(e,t){return new qu({type:"catch",innerType:e,catchValue:typeof t=="function"?t:()=>t})}const Fu=$("ZodNaN",(e,t)=>{xb.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>W_(e,r)});function wp(e){return y_(Fu,e)}const vs=$("ZodPipe",(e,t)=>{Ob.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>sS(e,r,i,n),e.in=t.in,e.out=t.out});function eo(e,t){return new vs({type:"pipe",in:e,out:t})}const bs=$("ZodCodec",(e,t)=>{vs.init(e,t),Lf.init(e,t)});function vp(e,t,r){return new bs({type:"pipe",in:e,out:t,transform:r.decode,reverseTransform:r.encode})}const Bu=$("ZodReadonly",(e,t)=>{Db.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>cS(e,r,i,n),e.unwrap=()=>e._zod.def.innerType});function Vu(e){return new Bu({type:"readonly",innerType:e})}const Ku=$("ZodTemplateLiteral",(e,t)=>{Rb.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>F_(e,r,i)});function bp(e,t){return new Ku({type:"template_literal",parts:e,...L(t)})}const Ju=$("ZodLazy",(e,t)=>{Pb.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>dS(e,r,i,n),e.unwrap=()=>e._zod.def.getter()});function Hu(e){return new Ju({type:"lazy",getter:e})}const Zu=$("ZodPromise",(e,t)=>{Cb.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>uS(e,r,i,n),e.unwrap=()=>e._zod.def.innerType});function _p(e){return new Zu({type:"promise",innerType:e})}const Gu=$("ZodFunction",(e,t)=>{Ub.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>J_(e,r)});function to(e){return new Gu({type:"function",input:Array.isArray(e?.input)?Eu(e?.input):e?.input??Ar(Un()),output:e?.output??Un()})}const $o=$("ZodCustom",(e,t)=>{Lb.init(e,t),ne.init(e,t),e._zod.processJSONSchema=(r,i,n)=>K_(e,r)});function Sp(e){const t=new ze({check:"custom"});return t._zod.check=e,t}function kp(e,t){return b_($o,e??(()=>!0),t)}function Qu(e,t={}){return __($o,e,t)}function Yu(e){return S_(e)}const Np=N_,$p=$_;function Ep(e,t={}){const r=new $o({type:"custom",check:"custom",fn:i=>i instanceof e,abort:!0,...L(t)});return r._zod.bag.Class=e,r._zod.check=i=>{i.value instanceof e||i.issues.push({code:"invalid_type",expected:e.name,input:i.value,inst:r,path:[...r._zod.def.path??[]]})},r}const Ap=(...e)=>E_({Codec:bs,Boolean:bo,String:yo},...e);function ya(e){const t=Hu(()=>gs([M(e),tn(),Bt(),pu(),Ar(t),qn(M(),t)]));return t}function Ip(e,t){return eo(ys(e),t)}const g0=Object.freeze(Object.defineProperty({__proto__:null,ZodAny:mu,ZodArray:vu,ZodBase64:us,ZodBase64URL:ds,ZodBigInt:_o,ZodBigIntFormat:hs,ZodBoolean:bo,ZodCIDRv4:ss,ZodCIDRv6:cs,ZodCUID:Xa,ZodCUID2:es,ZodCatch:qu,ZodCodec:bs,ZodCustom:$o,ZodCustomStringFormat:vi,ZodDate:ms,ZodDefault:Cu,ZodDiscriminatedUnion:Su,ZodE164:ls,ZodEmail:Ga,ZodEmoji:Qa,ZodEnum:li,ZodExactOptional:Du,ZodFile:xu,ZodFunction:Gu,ZodGUID:Yi,ZodIPv4:is,ZodIPv6:os,ZodIntersection:ku,ZodJWT:fs,ZodKSUID:ns,ZodLazy:Ju,ZodLiteral:Tu,ZodMAC:du,ZodMap:Au,ZodNaN:Fu,ZodNanoID:Ya,ZodNever:yu,ZodNonOptional:ws,ZodNull:hu,ZodNullable:Uu,ZodNumber:vo,ZodNumberFormat:Mn,ZodObject:Ir,ZodOptional:Tn,ZodPipe:vs,ZodPrefault:Lu,ZodPromise:Zu,ZodReadonly:Bu,ZodRecord:ko,ZodSet:Iu,ZodString:yo,ZodStringFormat:Ne,ZodSuccess:Mu,ZodSymbol:lu,ZodTemplateLiteral:Ku,ZodTransform:Ou,ZodTuple:$u,ZodType:ne,ZodULID:ts,ZodURL:wo,ZodUUID:fr,ZodUndefined:fu,ZodUnion:So,ZodUnknown:gu,ZodVoid:wu,ZodXID:rs,ZodXor:_u,_ZodString:Za,_default:Pu,_function:to,any:rn,array:Ar,base64:qh,base64url:Wh,bigint:Xh,boolean:Bt,catch:Wu,check:Sp,cidrv4:jh,cidrv6:Mh,codec:vp,cuid:Rh,cuid2:Uh,custom:kp,date:nn,describe:Np,discriminatedUnion:cp,e164:Fh,email:Ur,emoji:Oh,enum:No,exactOptional:Ru,file:mp,float32:Zh,float64:Gh,function:to,guid:Nh,hash:Hh,hex:Jh,hostname:Kh,httpUrl:xh,instanceof:Ep,int:ga,int32:Qh,int64:ep,intersection:Nu,ipv4:di,ipv6:as,json:ya,jwt:Bh,keyof:op,ksuid:Lh,lazy:Hu,literal:pp,looseObject:bu,looseRecord:dp,mac:zh,map:lp,meta:$p,nan:wp,nanoid:Dh,nativeEnum:hp,never:ps,nonoptional:ju,null:pu,nullable:Xi,nullish:gp,number:tn,object:le,optional:on,partialRecord:up,pipe:eo,prefault:zu,preprocess:Ip,promise:_p,readonly:Vu,record:qn,refine:Qu,set:fp,strictObject:ap,string:M,stringFormat:Vh,stringbool:Ap,success:yp,superRefine:Yu,symbol:rp,templateLiteral:bp,transform:ys,tuple:Eu,uint32:Yh,uint64:tp,ulid:Ch,undefined:np,union:gs,unknown:Un,url:Th,uuid:$h,uuidv4:Eh,uuidv6:Ah,uuidv7:Ih,void:ip,xid:Ph,xor:sp},Symbol.toStringTag,{value:"Module"})),wS={invalid_type:"invalid_type",too_big:"too_big",too_small:"too_small",invalid_format:"invalid_format",not_multiple_of:"not_multiple_of",unrecognized_keys:"unrecognized_keys",invalid_union:"invalid_union",invalid_key:"invalid_key",invalid_element:"invalid_element",invalid_value:"invalid_value",custom:"custom"};function vS(e){pt({customError:e})}function bS(){return pt().customError}var lc;lc||(lc={});const F={...g0,...m0,iso:lh},y0=new Set(["$schema","$ref","$defs","definitions","$id","id","$comment","$anchor","$vocabulary","$dynamicRef","$dynamicAnchor","type","enum","const","anyOf","oneOf","allOf","not","properties","required","additionalProperties","patternProperties","propertyNames","minProperties","maxProperties","items","prefixItems","additionalItems","minItems","maxItems","uniqueItems","contains","minContains","maxContains","minLength","maxLength","pattern","format","minimum","maximum","exclusiveMinimum","exclusiveMaximum","multipleOf","description","default","contentEncoding","contentMediaType","contentSchema","unevaluatedItems","unevaluatedProperties","if","then","else","dependentSchemas","dependentRequired","nullable","readOnly"]);function w0(e,t){const r=e.$schema;return r==="https://json-schema.org/draft/2020-12/schema"?"draft-2020-12":r==="http://json-schema.org/draft-07/schema#"?"draft-7":r==="http://json-schema.org/draft-04/schema#"?"draft-4":t??"draft-2020-12"}function v0(e,t){if(!e.startsWith("#"))throw new Error("External $ref is not supported, only local refs (#/...) are allowed");const r=e.slice(1).split("/").filter(Boolean);if(r.length===0)return t.rootSchema;const i=t.version==="draft-2020-12"?"$defs":"definitions";if(r[0]===i){const n=r[1];if(!n||!t.defs[n])throw new Error(`Reference not found: ${e}`);return t.defs[n]}throw new Error(`Reference not found: ${e}`)}function _S(e,t){if(e.not!==void 0){if(typeof e.not=="object"&&Object.keys(e.not).length===0)return F.never();throw new Error("not is not supported in Zod (except { not: {} } for never)")}if(e.unevaluatedItems!==void 0)throw new Error("unevaluatedItems is not supported");if(e.unevaluatedProperties!==void 0)throw new Error("unevaluatedProperties is not supported");if(e.if!==void 0||e.then!==void 0||e.else!==void 0)throw new Error("Conditional schemas (if/then/else) are not supported");if(e.dependentSchemas!==void 0||e.dependentRequired!==void 0)throw new Error("dependentSchemas and dependentRequired are not supported");if(e.$ref){const n=e.$ref;if(t.refs.has(n))return t.refs.get(n);if(t.processing.has(n))return F.lazy(()=>{if(!t.refs.has(n))throw new Error(`Circular reference not resolved: ${n}`);return t.refs.get(n)});t.processing.add(n);const o=v0(n,t),a=wt(o,t);return t.refs.set(n,a),t.processing.delete(n),a}if(e.enum!==void 0){const n=e.enum;if(t.version==="openapi-3.0"&&e.nullable===!0&&n.length===1&&n[0]===null)return F.null();if(n.length===0)return F.never();if(n.length===1)return F.literal(n[0]);if(n.every(a=>typeof a=="string"))return F.enum(n);const o=n.map(a=>F.literal(a));return o.length<2?o[0]:F.union([o[0],o[1],...o.slice(2)])}if(e.const!==void 0)return F.literal(e.const);const r=e.type;if(Array.isArray(r)){const n=r.map(o=>{const a={...e,type:o};return _S(a,t)});return n.length===0?F.never():n.length===1?n[0]:F.union(n)}if(!r)return F.any();let i;switch(r){case"string":{let n=F.string();if(e.format){const o=e.format;o==="email"?n=n.check(F.email()):o==="uri"||o==="uri-reference"?n=n.check(F.url()):o==="uuid"||o==="guid"?n=n.check(F.uuid()):o==="date-time"?n=n.check(F.iso.datetime()):o==="date"?n=n.check(F.iso.date()):o==="time"?n=n.check(F.iso.time()):o==="duration"?n=n.check(F.iso.duration()):o==="ipv4"?n=n.check(F.ipv4()):o==="ipv6"?n=n.check(F.ipv6()):o==="mac"?n=n.check(F.mac()):o==="cidr"?n=n.check(F.cidrv4()):o==="cidr-v6"?n=n.check(F.cidrv6()):o==="base64"?n=n.check(F.base64()):o==="base64url"?n=n.check(F.base64url()):o==="e164"?n=n.check(F.e164()):o==="jwt"?n=n.check(F.jwt()):o==="emoji"?n=n.check(F.emoji()):o==="nanoid"?n=n.check(F.nanoid()):o==="cuid"?n=n.check(F.cuid()):o==="cuid2"?n=n.check(F.cuid2()):o==="ulid"?n=n.check(F.ulid()):o==="xid"?n=n.check(F.xid()):o==="ksuid"&&(n=n.check(F.ksuid()))}typeof e.minLength=="number"&&(n=n.min(e.minLength)),typeof e.maxLength=="number"&&(n=n.max(e.maxLength)),e.pattern&&(n=n.regex(new RegExp(e.pattern))),i=n;break}case"number":case"integer":{let n=r==="integer"?F.number().int():F.number();typeof e.minimum=="number"&&(n=n.min(e.minimum)),typeof e.maximum=="number"&&(n=n.max(e.maximum)),typeof e.exclusiveMinimum=="number"?n=n.gt(e.exclusiveMinimum):e.exclusiveMinimum===!0&&typeof e.minimum=="number"&&(n=n.gt(e.minimum)),typeof e.exclusiveMaximum=="number"?n=n.lt(e.exclusiveMaximum):e.exclusiveMaximum===!0&&typeof e.maximum=="number"&&(n=n.lt(e.maximum)),typeof e.multipleOf=="number"&&(n=n.multipleOf(e.multipleOf)),i=n;break}case"boolean":{i=F.boolean();break}case"null":{i=F.null();break}case"object":{const n={},o=e.properties||{},a=new Set(e.required||[]);for(const[c,u]of Object.entries(o)){const d=wt(u,t);n[c]=a.has(c)?d:d.optional()}if(e.propertyNames){const c=wt(e.propertyNames,t),u=e.additionalProperties&&typeof e.additionalProperties=="object"?wt(e.additionalProperties,t):F.any();if(Object.keys(n).length===0){i=F.record(c,u);break}const d=F.object(n).passthrough(),l=F.looseRecord(c,u);i=F.intersection(d,l);break}if(e.patternProperties){const c=e.patternProperties,u=Object.keys(c),d=[];for(const f of u){const h=wt(c[f],t),g=F.string().regex(new RegExp(f));d.push(F.looseRecord(g,h))}const l=[];if(Object.keys(n).length>0&&l.push(F.object(n).passthrough()),l.push(...d),l.length===0)i=F.object({}).passthrough();else if(l.length===1)i=l[0];else{let f=F.intersection(l[0],l[1]);for(let h=2;h<l.length;h++)f=F.intersection(f,l[h]);i=f}break}const s=F.object(n);e.additionalProperties===!1?i=s.strict():typeof e.additionalProperties=="object"?i=s.catchall(wt(e.additionalProperties,t)):i=s.passthrough();break}case"array":{const n=e.prefixItems,o=e.items;if(n&&Array.isArray(n)){const a=n.map(c=>wt(c,t)),s=o&&typeof o=="object"&&!Array.isArray(o)?wt(o,t):void 0;s?i=F.tuple(a).rest(s):i=F.tuple(a),typeof e.minItems=="number"&&(i=i.check(F.minLength(e.minItems))),typeof e.maxItems=="number"&&(i=i.check(F.maxLength(e.maxItems)))}else if(Array.isArray(o)){const a=o.map(c=>wt(c,t)),s=e.additionalItems&&typeof e.additionalItems=="object"?wt(e.additionalItems,t):void 0;s?i=F.tuple(a).rest(s):i=F.tuple(a),typeof e.minItems=="number"&&(i=i.check(F.minLength(e.minItems))),typeof e.maxItems=="number"&&(i=i.check(F.maxLength(e.maxItems)))}else if(o!==void 0){const a=wt(o,t);let s=F.array(a);typeof e.minItems=="number"&&(s=s.min(e.minItems)),typeof e.maxItems=="number"&&(s=s.max(e.maxItems)),i=s}else i=F.array(F.any());break}default:throw new Error(`Unsupported type: ${r}`)}return e.description&&(i=i.describe(e.description)),e.default!==void 0&&(i=i.default(e.default)),i}function wt(e,t){if(typeof e=="boolean")return e?F.any():F.never();let r=_S(e,t);const i=e.type||e.enum!==void 0||e.const!==void 0;if(e.anyOf&&Array.isArray(e.anyOf)){const s=e.anyOf.map(u=>wt(u,t)),c=F.union(s);r=i?F.intersection(r,c):c}if(e.oneOf&&Array.isArray(e.oneOf)){const s=e.oneOf.map(u=>wt(u,t)),c=F.xor(s);r=i?F.intersection(r,c):c}if(e.allOf&&Array.isArray(e.allOf))if(e.allOf.length===0)r=i?r:F.any();else{let s=i?r:wt(e.allOf[0],t);const c=i?0:1;for(let u=c;u<e.allOf.length;u++)s=F.intersection(s,wt(e.allOf[u],t));r=s}e.nullable===!0&&t.version==="openapi-3.0"&&(r=F.nullable(r)),e.readOnly===!0&&(r=F.readonly(r));const n={},o=["$id","id","$comment","$anchor","$vocabulary","$dynamicRef","$dynamicAnchor"];for(const s of o)s in e&&(n[s]=e[s]);const a=["contentEncoding","contentMediaType","contentSchema"];for(const s of a)s in e&&(n[s]=e[s]);for(const s of Object.keys(e))y0.has(s)||(n[s]=e[s]);return Object.keys(n).length>0&&t.registry.add(r,n),r}function SS(e,t){if(typeof e=="boolean")return e?F.any():F.never();const r=w0(e,t?.defaultTarget),i=e.$defs||e.definitions||{},n={version:r,defs:i,refs:new Map,processing:new Set,rootSchema:e,registry:t?.registry??qt};return wt(e,n)}function Xu(e){return Fb(yo,e)}function b0(e){return Gb(vo,e)}function Nl(e){return n_(bo,e)}function _0(e){return o_(_o,e)}function S0(e){return g_(ms,e)}const kS=Object.freeze(Object.defineProperty({__proto__:null,bigint:_0,boolean:Nl,date:S0,number:b0,string:Xu},Symbol.toStringTag,{value:"Module"}));pt(zb());const Xm=Object.freeze(Object.defineProperty({__proto__:null,$brand:ff,$input:Mf,$output:jf,NEVER:lf,TimePrecision:sh,ZodAny:mu,ZodArray:vu,ZodBase64:us,ZodBase64URL:ds,ZodBigInt:_o,ZodBigIntFormat:hs,ZodBoolean:bo,ZodCIDRv4:ss,ZodCIDRv6:cs,ZodCUID:Xa,ZodCUID2:es,ZodCatch:qu,ZodCodec:bs,ZodCustom:$o,ZodCustomStringFormat:vi,ZodDate:ms,ZodDefault:Cu,ZodDiscriminatedUnion:Su,ZodE164:ls,ZodEmail:Ga,ZodEmoji:Qa,ZodEnum:li,ZodError:yS,ZodExactOptional:Du,ZodFile:xu,get ZodFirstPartyTypeKind(){return lc},ZodFunction:Gu,ZodGUID:Yi,ZodIPv4:is,ZodIPv6:os,ZodISODate:su,ZodISODateTime:au,ZodISODuration:uu,ZodISOTime:cu,ZodIntersection:ku,ZodIssueCode:wS,ZodJWT:fs,ZodKSUID:ns,ZodLazy:Ju,ZodLiteral:Tu,ZodMAC:du,ZodMap:Au,ZodNaN:Fu,ZodNanoID:Ya,ZodNever:yu,ZodNonOptional:ws,ZodNull:hu,ZodNullable:Uu,ZodNumber:vo,ZodNumberFormat:Mn,ZodObject:Ir,ZodOptional:Tn,ZodPipe:vs,ZodPrefault:Lu,ZodPromise:Zu,ZodReadonly:Bu,ZodRealError:xt,ZodRecord:ko,ZodSet:Iu,ZodString:yo,ZodStringFormat:Ne,ZodSuccess:Mu,ZodSymbol:lu,ZodTemplateLiteral:Ku,ZodTransform:Ou,ZodTuple:$u,ZodType:ne,ZodULID:ts,ZodURL:wo,ZodUUID:fr,ZodUndefined:fu,ZodUnion:So,ZodUnknown:gu,ZodVoid:wu,ZodXID:rs,ZodXor:_u,_ZodString:Za,_default:Pu,_function:to,any:rn,array:Ar,base64:qh,base64url:Wh,bigint:Xh,boolean:Bt,catch:Wu,check:Sp,cidrv4:jh,cidrv6:Mh,clone:Ht,codec:vp,coerce:kS,config:pt,core:lS,cuid:Rh,cuid2:Uh,custom:kp,date:nn,decode:yh,decodeAsync:vh,describe:Np,discriminatedUnion:cp,e164:Fh,email:Ur,emoji:Oh,encode:gh,encodeAsync:wh,endsWith:qa,enum:No,exactOptional:Ru,file:mp,flattenError:Zc,float32:Zh,float64:Gh,formatError:Gc,fromJSONSchema:SS,function:to,getErrorMap:bS,globalRegistry:qt,gt:Xr,gte:Nt,guid:Nh,hash:Hh,hex:Jh,hostname:Kh,httpUrl:xh,includes:ja,instanceof:Ep,int:ga,int32:Qh,int64:ep,intersection:Nu,ipv4:di,ipv6:as,iso:lh,json:ya,jwt:Bh,keyof:op,ksuid:Lh,lazy:Hu,length:go,literal:pp,locales:zf,looseObject:bu,looseRecord:dp,lowercase:La,lt:Yr,lte:Ft,mac:zh,map:lp,maxLength:mo,maxSize:wi,meta:$p,mime:Wa,minLength:Rn,minSize:en,multipleOf:ui,nan:wp,nanoid:Dh,nativeEnum:hp,negative:ru,never:ps,nonnegative:iu,nonoptional:ju,nonpositive:nu,normalize:Fa,null:pu,nullable:Xi,nullish:gp,number:tn,object:le,optional:on,overwrite:Rr,parse:fh,parseAsync:hh,partialRecord:up,pipe:eo,positive:tu,prefault:zu,preprocess:Ip,prettifyError:wf,promise:_p,property:ou,readonly:Vu,record:qn,refine:Qu,regex:Pa,regexes:Qc,registry:Xc,safeDecode:_h,safeDecodeAsync:kh,safeEncode:bh,safeEncodeAsync:Sh,safeParse:ph,safeParseAsync:mh,set:fp,setErrorMap:vS,size:po,slugify:Ja,startsWith:Ma,strictObject:ap,string:M,stringFormat:Vh,stringbool:Ap,success:yp,superRefine:Yu,symbol:rp,templateLiteral:bp,toJSONSchema:dh,toLowerCase:Va,toUpperCase:Ka,transform:ys,treeifyError:yf,trim:Ba,tuple:Eu,uint32:Yh,uint64:tp,ulid:Ch,undefined:np,union:gs,unknown:Un,uppercase:za,url:Th,util:mf,uuid:$h,uuidv4:Eh,uuidv6:Ah,uuidv7:Ih,void:ip,xid:Ph,xor:sp},Symbol.toStringTag,{value:"Module"})),k0=Object.freeze(Object.defineProperty({__proto__:null,$brand:ff,$input:Mf,$output:jf,NEVER:lf,TimePrecision:sh,ZodAny:mu,ZodArray:vu,ZodBase64:us,ZodBase64URL:ds,ZodBigInt:_o,ZodBigIntFormat:hs,ZodBoolean:bo,ZodCIDRv4:ss,ZodCIDRv6:cs,ZodCUID:Xa,ZodCUID2:es,ZodCatch:qu,ZodCodec:bs,ZodCustom:$o,ZodCustomStringFormat:vi,ZodDate:ms,ZodDefault:Cu,ZodDiscriminatedUnion:Su,ZodE164:ls,ZodEmail:Ga,ZodEmoji:Qa,ZodEnum:li,ZodError:yS,ZodExactOptional:Du,ZodFile:xu,get ZodFirstPartyTypeKind(){return lc},ZodFunction:Gu,ZodGUID:Yi,ZodIPv4:is,ZodIPv6:os,ZodISODate:su,ZodISODateTime:au,ZodISODuration:uu,ZodISOTime:cu,ZodIntersection:ku,ZodIssueCode:wS,ZodJWT:fs,ZodKSUID:ns,ZodLazy:Ju,ZodLiteral:Tu,ZodMAC:du,ZodMap:Au,ZodNaN:Fu,ZodNanoID:Ya,ZodNever:yu,ZodNonOptional:ws,ZodNull:hu,ZodNullable:Uu,ZodNumber:vo,ZodNumberFormat:Mn,ZodObject:Ir,ZodOptional:Tn,ZodPipe:vs,ZodPrefault:Lu,ZodPromise:Zu,ZodReadonly:Bu,ZodRealError:xt,ZodRecord:ko,ZodSet:Iu,ZodString:yo,ZodStringFormat:Ne,ZodSuccess:Mu,ZodSymbol:lu,ZodTemplateLiteral:Ku,ZodTransform:Ou,ZodTuple:$u,ZodType:ne,ZodULID:ts,ZodURL:wo,ZodUUID:fr,ZodUndefined:fu,ZodUnion:So,ZodUnknown:gu,ZodVoid:wu,ZodXID:rs,ZodXor:_u,_ZodString:Za,_default:Pu,_function:to,any:rn,array:Ar,base64:qh,base64url:Wh,bigint:Xh,boolean:Bt,catch:Wu,check:Sp,cidrv4:jh,cidrv6:Mh,clone:Ht,codec:vp,coerce:kS,config:pt,core:lS,cuid:Rh,cuid2:Uh,custom:kp,date:nn,decode:yh,decodeAsync:vh,default:Xm,describe:Np,discriminatedUnion:cp,e164:Fh,email:Ur,emoji:Oh,encode:gh,encodeAsync:wh,endsWith:qa,enum:No,exactOptional:Ru,file:mp,flattenError:Zc,float32:Zh,float64:Gh,formatError:Gc,fromJSONSchema:SS,function:to,getErrorMap:bS,globalRegistry:qt,gt:Xr,gte:Nt,guid:Nh,hash:Hh,hex:Jh,hostname:Kh,httpUrl:xh,includes:ja,instanceof:Ep,int:ga,int32:Qh,int64:ep,intersection:Nu,ipv4:di,ipv6:as,iso:lh,json:ya,jwt:Bh,keyof:op,ksuid:Lh,lazy:Hu,length:go,literal:pp,locales:zf,looseObject:bu,looseRecord:dp,lowercase:La,lt:Yr,lte:Ft,mac:zh,map:lp,maxLength:mo,maxSize:wi,meta:$p,mime:Wa,minLength:Rn,minSize:en,multipleOf:ui,nan:wp,nanoid:Dh,nativeEnum:hp,negative:ru,never:ps,nonnegative:iu,nonoptional:ju,nonpositive:nu,normalize:Fa,null:pu,nullable:Xi,nullish:gp,number:tn,object:le,optional:on,overwrite:Rr,parse:fh,parseAsync:hh,partialRecord:up,pipe:eo,positive:tu,prefault:zu,preprocess:Ip,prettifyError:wf,promise:_p,property:ou,readonly:Vu,record:qn,refine:Qu,regex:Pa,regexes:Qc,registry:Xc,safeDecode:_h,safeDecodeAsync:kh,safeEncode:bh,safeEncodeAsync:Sh,safeParse:ph,safeParseAsync:mh,set:fp,setErrorMap:vS,size:po,slugify:Ja,startsWith:Ma,strictObject:ap,string:M,stringFormat:Vh,stringbool:Ap,success:yp,superRefine:Yu,symbol:rp,templateLiteral:bp,toJSONSchema:dh,toLowerCase:Va,toUpperCase:Ka,transform:ys,treeifyError:yf,trim:Ba,tuple:Eu,uint32:Yh,uint64:tp,ulid:Ch,undefined:np,union:gs,unknown:Un,uppercase:za,url:Th,util:mf,uuid:$h,uuidv4:Eh,uuidv6:Ah,uuidv7:Ih,void:ip,xid:Ph,xor:sp,z:Xm},Symbol.toStringTag,{value:"Module"}));function N0(e){return di().safeParse(e).success||as().safeParse(e).success}function $0(e){return as().safeParse(e).success}function E0(e){const t=e.toLowerCase();if(t.startsWith("::ffff:")){const i=t.substring(7);if(di().safeParse(i).success)return i}const r=e.split(":");if(r.length===7&&r[5]?.toLowerCase()==="ffff"){const i=r[6];if(i&&di().safeParse(i).success)return i}if(t.includes("::ffff:")||t.includes(":ffff:")){const i=NS(e);if(i.length===8&&i[0]==="0000"&&i[1]==="0000"&&i[2]==="0000"&&i[3]==="0000"&&i[4]==="0000"&&i[5]==="ffff"&&i[6]&&i[7])return`${Number.parseInt(i[6].substring(0,2),16)}.${Number.parseInt(i[6].substring(2,4),16)}.${Number.parseInt(i[7].substring(0,2),16)}.${Number.parseInt(i[7].substring(2,4),16)}`}return null}function NS(e){if(e.includes("::")){const t=e.split("::"),r=t[0]?t[0].split(":"):[],i=t[1]?t[1].split(":"):[],n=8-r.length-i.length,o=Array(n).fill("0000"),a=r.map(c=>c.padStart(4,"0")),s=i.map(c=>c.padStart(4,"0"));return[...a,...o,...s]}return e.split(":").map(t=>t.padStart(4,"0"))}function A0(e,t){const r=NS(e);if(t<128){let i=t;return r.map(n=>{if(i<=0)return"0000";if(i>=16)return i-=16,n;const o=Number.parseInt(n,16)&(65535<<16-i&65535);return i=0,o.toString(16).padStart(4,"0")}).join(":").toLowerCase()}return r.join(":").toLowerCase()}function I0(e,t={}){if(di().safeParse(e).success||!$0(e))return e.toLowerCase();const r=E0(e);return r?r.toLowerCase():A0(e,t.ipv6Subnet||64)}function T0(e,t){return`${e}|${t}`}var x0={},$l={};const Js=Object.create(null),Lo=e=>x0||globalThis.Deno?.env.toObject()||globalThis.__env__||(e?Js:globalThis),Se=new Proxy(Js,{get(e,t){return Lo()[t]??Js[t]},has(e,t){return t in Lo()||t in Js},set(e,t,r){const i=Lo(!0);return i[t]=r,!0},deleteProperty(e,t){if(!t)return!1;const r=Lo(!0);return delete r[t],!0},ownKeys(){const e=Lo(!0);return Object.keys(e)}});function O0(e){return e?e!=="false":!1}const fc=typeof process<"u"&&$l&&"production"||"",ed=fc==="production",Tp=()=>fc==="dev"||fc==="development",_s=()=>fc==="test"||O0(Se.TEST);function ge(e,t){return typeof process<"u"&&$l?$l[e]??t:typeof Deno<"u"?Deno.env.get(e)??t:typeof Bun<"u"?Bun.env[e]??t:t}function eg(e,t=!0){const r=ge(e);return r?r!=="0"&&r.toLowerCase()!=="false"&&r!=="":t}const D0=Object.freeze({get BETTER_AUTH_SECRET(){return ge("BETTER_AUTH_SECRET")},get AUTH_SECRET(){return ge("AUTH_SECRET")},get BETTER_AUTH_TELEMETRY(){return ge("BETTER_AUTH_TELEMETRY")},get BETTER_AUTH_TELEMETRY_ID(){return ge("BETTER_AUTH_TELEMETRY_ID")},get NODE_ENV(){return ge("NODE_ENV","development")},get PACKAGE_VERSION(){return ge("PACKAGE_VERSION","0.0.0")},get BETTER_AUTH_TELEMETRY_ENDPOINT(){return ge("BETTER_AUTH_TELEMETRY_ENDPOINT","https://telemetry.better-auth.com/v1/track")}}),zo=1,nt=4,_r=8,Pt=24,tg={eterm:nt,cons25:nt,console:nt,cygwin:nt,dtterm:nt,gnome:nt,hurd:nt,jfbterm:nt,konsole:nt,kterm:nt,mlterm:nt,mosh:Pt,putty:nt,st:nt,"rxvt-unicode-24bit":Pt,terminator:Pt,"xterm-kitty":Pt},R0=new Map(Object.entries({APPVEYOR:_r,BUILDKITE:_r,CIRCLECI:Pt,DRONE:_r,GITEA_ACTIONS:Pt,GITHUB_ACTIONS:Pt,GITLAB_CI:_r,TRAVIS:_r})),U0=[/ansi/,/color/,/linux/,/direct/,/^con[0-9]*x[0-9]/,/^rxvt/,/^screen/,/^xterm/,/^vt100/,/^vt220/];function $S(){if(ge("FORCE_COLOR")!==void 0)switch(ge("FORCE_COLOR")){case"":case"1":case"true":return nt;case"2":return _r;case"3":return Pt;default:return zo}if(ge("NODE_DISABLE_COLORS")!==void 0&&ge("NODE_DISABLE_COLORS")!==""||ge("NO_COLOR")!==void 0&&ge("NO_COLOR")!==""||ge("TERM")==="dumb")return zo;if(ge("TMUX"))return Pt;if("TF_BUILD"in Se&&"AGENT_NAME"in Se)return nt;if("CI"in Se){for(const{0:e,1:t}of R0)if(e in Se)return t;return ge("CI_NAME")==="codeship"?_r:zo}if("TEAMCITY_VERSION"in Se)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.exec(ge("TEAMCITY_VERSION"))!==null?nt:zo;switch(ge("TERM_PROGRAM")){case"iTerm.app":return!ge("TERM_PROGRAM_VERSION")||/^[0-2]\./.exec(ge("TERM_PROGRAM_VERSION"))!==null?_r:Pt;case"HyperTerm":case"MacTerm":return Pt;case"Apple_Terminal":return _r}if(ge("COLORTERM")==="truecolor"||ge("COLORTERM")==="24bit")return Pt;if(ge("TERM")){if(/truecolor/.exec(ge("TERM"))!==null)return Pt;if(/^xterm-256/.exec(ge("TERM"))!==null)return _r;const e=ge("TERM").toLowerCase();if(tg[e])return tg[e];if(U0.some(t=>t.exec(e)!==null))return nt}return ge("COLORTERM")?nt:zo}const et={reset:"\x1B[0m",bright:"\x1B[1m",dim:"\x1B[2m",fg:{red:"\x1B[31m",green:"\x1B[32m",yellow:"\x1B[33m",blue:"\x1B[34m",magenta:"\x1B[35m"},bg:{black:"\x1B[40m"}},El=["debug","info","success","warn","error"];function td(e,t){return El.indexOf(t)>=El.indexOf(e)}const C0={info:et.fg.blue,success:et.fg.green,warn:et.fg.yellow,error:et.fg.red,debug:et.fg.magenta},P0=(e,t,r)=>{const i=new Date().toISOString();return r?`${et.dim}${i}${et.reset} ${C0[e]}${e.toUpperCase()}${et.reset} ${et.bright}[Better Auth]:${et.reset} ${t}`:`${i} ${e.toUpperCase()} [Better Auth]: ${t}`},wa=e=>{const t=e?.disabled!==!0,r=e?.level??"error",i=e?.disableColors!==void 0?!e.disableColors:$S()!==1,n=(o,a,s=[])=>{if(!t||!td(r,o))return;const c=P0(o,a,i);if(!e||typeof e.log!="function"){o==="error"?console.error(c,...s):o==="warn"?console.warn(c,...s):console.log(c,...s);return}e.log(o==="success"?"info":o,a,...s)};return{...Object.fromEntries(El.map(o=>[o,(...[a,...s])=>n(o,a,s)])),get level(){return r}}},ie=wa();function it(e){function t(r,i){if(typeof i=="string"&&/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d+)?Z$/.test(i)){const n=new Date(i);if(!isNaN(n.getTime()))return n}return i}try{return typeof e!="string"?e:JSON.parse(e,t)}catch(r){return ie.error("Error parsing JSON",{error:r}),null}}const G={USER_NOT_FOUND:"User not found",FAILED_TO_CREATE_USER:"Failed to create user",FAILED_TO_CREATE_SESSION:"Failed to create session",FAILED_TO_UPDATE_USER:"Failed to update user",FAILED_TO_GET_SESSION:"Failed to get session",INVALID_PASSWORD:"Invalid password",INVALID_EMAIL:"Invalid email",INVALID_EMAIL_OR_PASSWORD:"Invalid email or password",SOCIAL_ACCOUNT_ALREADY_LINKED:"Social account already linked",PROVIDER_NOT_FOUND:"Provider not found",INVALID_TOKEN:"Invalid token",ID_TOKEN_NOT_SUPPORTED:"id_token not supported",FAILED_TO_GET_USER_INFO:"Failed to get user info",USER_EMAIL_NOT_FOUND:"User email not found",EMAIL_NOT_VERIFIED:"Email not verified",PASSWORD_TOO_SHORT:"Password too short",PASSWORD_TOO_LONG:"Password too long",USER_ALREADY_EXISTS:"User already exists.",USER_ALREADY_EXISTS_USE_ANOTHER_EMAIL:"User already exists. Use another email.",EMAIL_CAN_NOT_BE_UPDATED:"Email can not be updated",CREDENTIAL_ACCOUNT_NOT_FOUND:"Credential account not found",SESSION_EXPIRED:"Session expired. Re-authenticate to perform this action.",FAILED_TO_UNLINK_LAST_ACCOUNT:"You can't unlink your last account",ACCOUNT_NOT_FOUND:"Account not found",USER_ALREADY_HAS_PASSWORD:"User already has a password. Provide that to delete the account.",CROSS_SITE_NAVIGATION_LOGIN_BLOCKED:"Cross-site navigation login blocked. This request appears to be a CSRF attack.",VERIFICATION_EMAIL_NOT_ENABLED:"Verification email isn't enabled",EMAIL_ALREADY_VERIFIED:"Email is already verified",EMAIL_MISMATCH:"Email mismatch",SESSION_NOT_FRESH:"Session is not fresh",LINKED_ACCOUNT_ALREADY_EXISTS:"Linked account already exists",INVALID_ORIGIN:"Invalid origin",INVALID_CALLBACK_URL:"Invalid callbackURL",INVALID_REDIRECT_URL:"Invalid redirectURL",INVALID_ERROR_CALLBACK_URL:"Invalid errorCallbackURL",INVALID_NEW_USER_CALLBACK_URL:"Invalid newUserCallbackURL",MISSING_OR_NULL_ORIGIN:"Missing or null Origin",CALLBACK_URL_REQUIRED:"callbackURL is required",FAILED_TO_CREATE_VERIFICATION:"Unable to create verification",FIELD_NOT_ALLOWED:"Field not allowed to be set",ASYNC_VALIDATION_NOT_SUPPORTED:"Async validation is not supported",VALIDATION_ERROR:"Validation Error",MISSING_FIELD:"Field is required"};var Y=class extends Error{constructor(e,t){super(e,t),this.name="BetterAuthError",this.message=e,this.stack=""}};const L0="0123456789abcdef",hc={encode:e=>{if(typeof e=="string"&&(e=new TextEncoder().encode(e)),e.byteLength===0)return"";const t=new Uint8Array(e);let r="";for(const i of t)r+=i.toString(16).padStart(2,"0");return r},decode:e=>{if(!e)return"";if(typeof e=="string"){if(e.length%2!==0)throw new Error("Invalid hexadecimal string");if(!new RegExp(`^[${L0}]+$`).test(e))throw new Error("Invalid hexadecimal string");const t=new Uint8Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=parseInt(e.slice(r,r+2),16);return new TextDecoder().decode(t)}return new TextDecoder().decode(e)}};function z0(e,t,r,i){Pc(e);const n=ky({dkLen:32,asyncTick:10},i),{c:o,dkLen:a,asyncTick:s}=n;if(Yt(o,"c"),Yt(a,"dkLen"),Yt(s,"asyncTick"),o<1)throw new Error("iterations (c) must be >= 1");const c=Tm(t,"password"),u=Tm(r,"salt"),d=new Uint8Array(a),l=Lc.create(e,c),f=l._cloneInto().update(u);return{c:o,dkLen:a,asyncTick:s,DK:d,PRF:l,PRFSalt:f}}function j0(e,t,r,i,n){return e.destroy(),t.destroy(),i&&i.destroy(),si(n),r}function ES(e,t,r,i){const{c:n,dkLen:o,DK:a,PRF:s,PRFSalt:c}=z0(e,t,r,i);let u;const d=new Uint8Array(4),l=Bs(d),f=new Uint8Array(s.outputLen);for(let h=1,g=0;g<o;h++,g+=s.outputLen){const m=a.subarray(g,g+s.outputLen);l.setInt32(0,h,!1),(u=c._cloneInto(u)).update(d).digestInto(f),m.set(f.subarray(0,m.length));for(let v=1;v<n;v++){s._cloneInto(u).update(f).digestInto(f);for(let b=0;b<m.length;b++)m[b]^=f[b]}}return j0(s,c,a,u,f)}function rg(e,t,r,i,n,o){let a=e[t++]^r[i++],s=e[t++]^r[i++],c=e[t++]^r[i++],u=e[t++]^r[i++],d=e[t++]^r[i++],l=e[t++]^r[i++],f=e[t++]^r[i++],h=e[t++]^r[i++],g=e[t++]^r[i++],m=e[t++]^r[i++],v=e[t++]^r[i++],b=e[t++]^r[i++],I=e[t++]^r[i++],x=e[t++]^r[i++],N=e[t++]^r[i++],y=e[t++]^r[i++],w=a,_=s,S=c,E=u,k=d,U=l,P=f,T=h,A=g,O=m,R=v,W=b,z=I,C=x,B=N,Z=y;for(let se=0;se<8;se+=2)k^=fe(w+z|0,7),A^=fe(k+w|0,9),z^=fe(A+k|0,13),w^=fe(z+A|0,18),O^=fe(U+_|0,7),C^=fe(O+U|0,9),_^=fe(C+O|0,13),U^=fe(_+C|0,18),B^=fe(R+P|0,7),S^=fe(B+R|0,9),P^=fe(S+B|0,13),R^=fe(P+S|0,18),E^=fe(Z+W|0,7),T^=fe(E+Z|0,9),W^=fe(T+E|0,13),Z^=fe(W+T|0,18),_^=fe(w+E|0,7),S^=fe(_+w|0,9),E^=fe(S+_|0,13),w^=fe(E+S|0,18),P^=fe(U+k|0,7),T^=fe(P+U|0,9),k^=fe(T+P|0,13),U^=fe(k+T|0,18),W^=fe(R+O|0,7),A^=fe(W+R|0,9),O^=fe(A+W|0,13),R^=fe(O+A|0,18),z^=fe(Z+B|0,7),C^=fe(z+Z|0,9),B^=fe(C+z|0,13),Z^=fe(B+C|0,18);n[o++]=a+w|0,n[o++]=s+_|0,n[o++]=c+S|0,n[o++]=u+E|0,n[o++]=d+k|0,n[o++]=l+U|0,n[o++]=f+P|0,n[o++]=h+T|0,n[o++]=g+A|0,n[o++]=m+O|0,n[o++]=v+R|0,n[o++]=b+W|0,n[o++]=I+z|0,n[o++]=x+C|0,n[o++]=N+B|0,n[o++]=y+Z|0}function Fd(e,t,r,i,n){let o=i+0,a=i+16*n;for(let s=0;s<16;s++)r[a+s]=e[t+(2*n-1)*16+s];for(let s=0;s<n;s++,o+=16,t+=16)rg(r,a,e,t,r,o),s>0&&(a+=16),rg(r,o,e,t+=16,r,a)}function M0(e,t,r){const i=ky({dkLen:32,asyncTick:10,maxmem:1073742848},r),{N:n,r:o,p:a,dkLen:s,asyncTick:c,maxmem:u,onProgress:d}=i;if(Yt(n,"N"),Yt(o,"r"),Yt(a,"p"),Yt(s,"dkLen"),Yt(c,"asyncTick"),Yt(u,"maxmem"),d!==void 0&&typeof d!="function")throw new Error("progressCb must be a function");const l=128*o,f=l/4,h=Math.pow(2,32);if(n<=1||(n&n-1)!==0||n>h)throw new Error('"N" expected a power of 2, and 2^1 <= N <= 2^32');if(a<1||a>(h-1)*32/l)throw new Error('"p" expected integer 1..((2^32 - 1) * 32) / (128 * r)');if(s<1||s>(h-1)*32)throw new Error('"dkLen" expected integer 1..(2^32 - 1) * 32');if(l*(n+a)>u)throw new Error('"maxmem" limit was hit, expected 128*r*(N+p) <= "maxmem"='+u);const m=ES(zc,e,t,{c:1,dkLen:l*a}),v=jd(m),b=jd(new Uint8Array(l*n)),I=jd(new Uint8Array(l));let x=()=>{};if(d){const N=2*n*a,y=Math.max(Math.floor(N/1e4),1);let w=0;x=()=>{w++,d&&(!(w%y)||w===N)&&d(w/N)}}return{N:n,r:o,p:a,dkLen:s,blockSize32:f,V:b,B32:v,B:m,tmp:I,blockMixCb:x,asyncTick:c}}function q0(e,t,r,i,n){const o=ES(zc,e,r,{c:1,dkLen:t});return si(r,i,n),o}async function W0(e,t,r){const{N:i,r:n,p:o,dkLen:a,blockSize32:s,V:c,B32:u,B:d,tmp:l,blockMixCb:f,asyncTick:h}=M0(e,t,r);Em(u);for(let g=0;g<o;g++){const m=s*g;for(let b=0;b<s;b++)c[b]=u[m+b];let v=0;await Im(i-1,h,()=>{Fd(c,v,c,v+=s,n),f()}),Fd(c,(i-1)*s,u,m,n),f(),await Im(i,h,()=>{const b=(u[m+s-16]&i-1)>>>0;for(let I=0;I<s;I++)l[I]=u[m+I]^c[b*s+I];Fd(l,0,u,m,n),f()})}return Em(u),q0(e,a,d,c,l)}const Ei={N:16384,r:16,p:1,dkLen:64};async function AS(e,t){return await W0(e.normalize("NFKC"),t,{N:Ei.N,p:Ei.p,r:Ei.r,dkLen:Ei.dkLen,maxmem:128*Ei.N*Ei.r*2})}const F0=async e=>{const t=hc.encode(crypto.getRandomValues(new Uint8Array(16))),r=await AS(e,t);return`${t}:${hc.encode(r)}`},B0=async({hash:e,password:t})=>{const[r,i]=e.split(":");if(!r||!i)throw new Y("Invalid password hash");return xA(await AS(t,r),LA(i))};function ii(){const e=typeof globalThis<"u"&&globalThis.crypto;if(e&&typeof e.subtle=="object"&&e.subtle!=null)return e.subtle;throw new Error("crypto.subtle must be defined")}function pc(e){return e?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"}function IS(e,t,r){let i="",n=0,o=0;for(const a of e)for(n=n<<8|a,o+=8;o>=6;)o-=6,i+=t[n>>o&63];if(o>0&&(i+=t[n<<6-o&63]),r){const a=(4-i.length%4)%4;i+="=".repeat(a)}return i}function TS(e,t){const r=new Map;for(let a=0;a<t.length;a++)r.set(t[a],a);const i=[];let n=0,o=0;for(const a of e){if(a==="=")break;const s=r.get(a);if(s===void 0)throw new Error(`Invalid Base64 character: ${a}`);n=n<<6|s,o+=6,o>=8&&(o-=8,i.push(n>>o&255))}return Uint8Array.from(i)}const an={encode(e,t={}){const r=pc(!1),i=typeof e=="string"?new TextEncoder().encode(e):new Uint8Array(e);return IS(i,r,t.padding??!0)},decode(e){typeof e!="string"&&(e=new TextDecoder().decode(e));const t=e.includes("-")||e.includes("_"),r=pc(t);return TS(e,r)}},rd={encode(e,t={}){const r=pc(!0),i=typeof e=="string"?new TextEncoder().encode(e):new Uint8Array(e);return IS(i,r,t.padding??!0)},decode(e){const t=e.includes("-")||e.includes("_"),r=pc(t);return TS(e,r)}};function xp(e,t){return{digest:async r=>{const i=new TextEncoder,n=typeof r=="string"?i.encode(r):r;return await ii().digest(e,n)}}}function V0(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Al(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}function Hs(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Xe(e,t,r=""){const i=V0(e),n=e?.length,o=t!==void 0;if(!i||o&&n!==t){const a=r&&`"${r}" `,s=o?` of length ${t}`:"",c=i?`length=${n}`:`type=${typeof e}`;throw new Error(a+"expected Uint8Array"+s+", got "+c)}return e}function ng(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function K0(e,t){Xe(e,void 0,"output");const r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function xn(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function ro(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function J0(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}const H0=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,xS=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Z0=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function G0(e){if(Xe(e),xS)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=Z0[e[r]];return t}const Lr={_0:48,_9:57,A:65,F:70,a:97,f:102};function ig(e){if(e>=Lr._0&&e<=Lr._9)return e-Lr._0;if(e>=Lr.A&&e<=Lr.F)return e-(Lr.A-10);if(e>=Lr.a&&e<=Lr.f)return e-(Lr.a-10)}function Q0(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(xS)return Uint8Array.fromHex(e);const t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const i=new Uint8Array(r);for(let n=0,o=0;n<r;n++,o+=2){const a=ig(e.charCodeAt(o)),s=ig(e.charCodeAt(o+1));if(a===void 0||s===void 0){const c=e[o]+e[o+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+o)}i[n]=a*16+s}return i}function Y0(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function X0(...e){let t=0;for(let i=0;i<e.length;i++){const n=e[i];Xe(n),t+=n.length}const r=new Uint8Array(t);for(let i=0,n=0;i<e.length;i++){const o=e[i];r.set(o,n),n+=o.length}return r}function eD(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}function tD(e,t){if(e.length!==t.length)return!1;let r=0;for(let i=0;i<e.length;i++)r|=e[i]^t[i];return r===0}const rD=(e,t)=>{function r(i,...n){if(Xe(i,void 0,"key"),!H0)throw new Error("Non little-endian hardware is not yet supported");if(e.nonceLength!==void 0){const d=n[0];Xe(d,e.varSizeNonce?void 0:e.nonceLength,"nonce")}const o=e.tagLength;o&&n[1]!==void 0&&Xe(n[1],void 0,"AAD");const a=t(i,...n),s=(d,l)=>{if(l!==void 0){if(d!==2)throw new Error("cipher output not supported");Xe(l,void 0,"output")}};let c=!1;return{encrypt(d,l){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,Xe(d),s(a.encrypt.length,l),a.encrypt(d,l)},decrypt(d,l){if(Xe(d),o&&d.length<o)throw new Error('"ciphertext" expected length bigger than tagLength='+o);return s(a.decrypt.length,l),a.decrypt(d,l)}}}return Object.assign(r,e),r};function og(e,t,r=!0){if(t===void 0)return new Uint8Array(e);if(t.length!==e)throw new Error('"output" expected Uint8Array of length '+e+", got: "+t.length);if(r&&!iD(t))throw new Error("invalid output, must be aligned");return t}function nD(e,t,r){Al(r);const i=new Uint8Array(16),n=J0(i);return n.setBigUint64(0,BigInt(t),r),n.setBigUint64(8,BigInt(e),r),i}function iD(e){return e.byteOffset%4===0}function mc(e){return Uint8Array.from(e)}function oD(e=32){const t=typeof globalThis=="object"?globalThis.crypto:null;if(typeof t?.getRandomValues!="function")throw new Error("crypto.getRandomValues must be defined");return t.getRandomValues(new Uint8Array(e))}function OS(e,t=oD){const{nonceLength:r}=e;Hs(r);const i=(n,o)=>{const a=X0(n,o);return o.fill(0),a};return((n,...o)=>({encrypt(a){Xe(a);const s=t(r),c=e(n,s,...o).encrypt(a);return c instanceof Promise?c.then(u=>i(s,u)):i(s,c)},decrypt(a){Xe(a);const s=a.subarray(0,r),c=a.subarray(r);return e(n,s,...o).decrypt(c)}}))}const DS=e=>Uint8Array.from(e.split(""),t=>t.charCodeAt(0)),aD=DS("expand 16-byte k"),sD=DS("expand 32-byte k"),cD=xn(aD),uD=xn(sD);function J(e,t){return e<<t|e>>>32-t}function Il(e){return e.byteOffset%4===0}const Ps=64,dD=16,RS=2**32-1,ag=Uint32Array.of();function lD(e,t,r,i,n,o,a,s){const c=n.length,u=new Uint8Array(Ps),d=xn(u),l=Il(n)&&Il(o),f=l?xn(n):ag,h=l?xn(o):ag;for(let g=0;g<c;a++){if(e(t,r,i,d,a,s),a>=RS)throw new Error("arx: counter overflow");const m=Math.min(Ps,c-g);if(l&&m===Ps){const v=g/4;if(g%4!==0)throw new Error("arx: invalid block position");for(let b=0,I;b<dD;b++)I=v+b,h[I]=f[I]^d[b];g+=Ps;continue}for(let v=0,b;v<m;v++)b=g+v,o[b]=n[b]^u[v];g+=m}}function fD(e,t){const{allowShortKeys:r,extendNonceFn:i,counterLength:n,counterRight:o,rounds:a}=eD({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return Hs(n),Hs(a),Al(o),Al(r),(s,c,u,d,l=0)=>{Xe(s,void 0,"key"),Xe(c,void 0,"nonce"),Xe(u,void 0,"data");const f=u.length;if(d===void 0&&(d=new Uint8Array(f)),Xe(d,void 0,"output"),Hs(l),l<0||l>=RS)throw new Error("arx: counter overflow");if(d.length<f)throw new Error(`arx: output (${d.length}) is shorter than data (${f})`);const h=[];let g=s.length,m,v;if(g===32)h.push(m=mc(s)),v=uD;else if(g===16&&r)m=new Uint8Array(32),m.set(s),m.set(s,16),v=cD,h.push(m);else throw Xe(s,32,"arx key"),new Error("invalid key size");Il(c)||h.push(c=mc(c));const b=xn(m);if(i){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");i(v,b,xn(c.subarray(0,16)),b),c=c.subarray(16)}const I=16-n;if(I!==c.length)throw new Error(`arx: nonce must be ${I} or 16 bytes`);if(I!==12){const N=new Uint8Array(12);N.set(c,o?0:12-c.length),c=N,h.push(c)}const x=xn(c);return lD(e,v,b,x,u,d,l,a),ro(...h),d}}function ft(e,t){return e[t++]&255|(e[t++]&255)<<8}class hD{blockLen=16;outputLen=16;buffer=new Uint8Array(16);r=new Uint16Array(10);h=new Uint16Array(10);pad=new Uint16Array(8);pos=0;finished=!1;constructor(t){t=mc(Xe(t,32,"key"));const r=ft(t,0),i=ft(t,2),n=ft(t,4),o=ft(t,6),a=ft(t,8),s=ft(t,10),c=ft(t,12),u=ft(t,14);this.r[0]=r&8191,this.r[1]=(r>>>13|i<<3)&8191,this.r[2]=(i>>>10|n<<6)&7939,this.r[3]=(n>>>7|o<<9)&8191,this.r[4]=(o>>>4|a<<12)&255,this.r[5]=a>>>1&8190,this.r[6]=(a>>>14|s<<2)&8191,this.r[7]=(s>>>11|c<<5)&8065,this.r[8]=(c>>>8|u<<8)&8191,this.r[9]=u>>>5&127;for(let d=0;d<8;d++)this.pad[d]=ft(t,16+2*d)}process(t,r,i=!1){const n=i?0:2048,{h:o,r:a}=this,s=a[0],c=a[1],u=a[2],d=a[3],l=a[4],f=a[5],h=a[6],g=a[7],m=a[8],v=a[9],b=ft(t,r+0),I=ft(t,r+2),x=ft(t,r+4),N=ft(t,r+6),y=ft(t,r+8),w=ft(t,r+10),_=ft(t,r+12),S=ft(t,r+14);let E=o[0]+(b&8191),k=o[1]+((b>>>13|I<<3)&8191),U=o[2]+((I>>>10|x<<6)&8191),P=o[3]+((x>>>7|N<<9)&8191),T=o[4]+((N>>>4|y<<12)&8191),A=o[5]+(y>>>1&8191),O=o[6]+((y>>>14|w<<2)&8191),R=o[7]+((w>>>11|_<<5)&8191),W=o[8]+((_>>>8|S<<8)&8191),z=o[9]+(S>>>5|n),C=0,B=C+E*s+k*(5*v)+U*(5*m)+P*(5*g)+T*(5*h);C=B>>>13,B&=8191,B+=A*(5*f)+O*(5*l)+R*(5*d)+W*(5*u)+z*(5*c),C+=B>>>13,B&=8191;let Z=C+E*c+k*s+U*(5*v)+P*(5*m)+T*(5*g);C=Z>>>13,Z&=8191,Z+=A*(5*h)+O*(5*f)+R*(5*l)+W*(5*d)+z*(5*u),C+=Z>>>13,Z&=8191;let se=C+E*u+k*c+U*s+P*(5*v)+T*(5*m);C=se>>>13,se&=8191,se+=A*(5*g)+O*(5*h)+R*(5*f)+W*(5*l)+z*(5*d),C+=se>>>13,se&=8191;let ue=C+E*d+k*u+U*c+P*s+T*(5*v);C=ue>>>13,ue&=8191,ue+=A*(5*m)+O*(5*g)+R*(5*h)+W*(5*f)+z*(5*l),C+=ue>>>13,ue&=8191;let Qe=C+E*l+k*d+U*u+P*c+T*s;C=Qe>>>13,Qe&=8191,Qe+=A*(5*v)+O*(5*m)+R*(5*g)+W*(5*h)+z*(5*f),C+=Qe>>>13,Qe&=8191;let Fn=C+E*f+k*l+U*d+P*u+T*c;C=Fn>>>13,Fn&=8191,Fn+=A*s+O*(5*v)+R*(5*m)+W*(5*g)+z*(5*h),C+=Fn>>>13,Fn&=8191;let hn=C+E*h+k*f+U*l+P*d+T*u;C=hn>>>13,hn&=8191,hn+=A*c+O*s+R*(5*v)+W*(5*m)+z*(5*g),C+=hn>>>13,hn&=8191;let Si=C+E*g+k*h+U*f+P*l+T*d;C=Si>>>13,Si&=8191,Si+=A*u+O*c+R*s+W*(5*v)+z*(5*m),C+=Si>>>13,Si&=8191;let ki=C+E*m+k*g+U*h+P*f+T*l;C=ki>>>13,ki&=8191,ki+=A*d+O*u+R*c+W*s+z*(5*v),C+=ki>>>13,ki&=8191;let Ni=C+E*v+k*m+U*g+P*h+T*f;C=Ni>>>13,Ni&=8191,Ni+=A*l+O*d+R*u+W*c+z*s,C+=Ni>>>13,Ni&=8191,C=(C<<2)+C|0,C=C+B|0,B=C&8191,C=C>>>13,Z+=C,o[0]=B,o[1]=Z,o[2]=se,o[3]=ue,o[4]=Qe,o[5]=Fn,o[6]=hn,o[7]=Si,o[8]=ki,o[9]=Ni}finalize(){const{h:t,pad:r}=this,i=new Uint16Array(10);let n=t[1]>>>13;t[1]&=8191;for(let s=2;s<10;s++)t[s]+=n,n=t[s]>>>13,t[s]&=8191;t[0]+=n*5,n=t[0]>>>13,t[0]&=8191,t[1]+=n,n=t[1]>>>13,t[1]&=8191,t[2]+=n,i[0]=t[0]+5,n=i[0]>>>13,i[0]&=8191;for(let s=1;s<10;s++)i[s]=t[s]+n,n=i[s]>>>13,i[s]&=8191;i[9]-=8192;let o=(n^1)-1;for(let s=0;s<10;s++)i[s]&=o;o=~o;for(let s=0;s<10;s++)t[s]=t[s]&o|i[s];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let a=t[0]+r[0];t[0]=a&65535;for(let s=1;s<8;s++)a=(t[s]+r[s]|0)+(a>>>16)|0,t[s]=a&65535;ro(i)}update(t){ng(this),Xe(t),t=mc(t);const{buffer:r,blockLen:i}=this,n=t.length;for(let o=0;o<n;){const a=Math.min(i-this.pos,n-o);if(a===i){for(;i<=n-o;o+=i)this.process(t,o);continue}r.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){ro(this.h,this.r,this.buffer,this.pad)}digestInto(t){ng(this),K0(t,this),this.finished=!0;const{buffer:r,h:i}=this;let{pos:n}=this;if(n){for(r[n++]=1;n<16;n++)r[n]=0;this.process(r,0,!0)}this.finalize();let o=0;for(let a=0;a<8;a++)t[o++]=i[a]>>>0,t[o++]=i[a]>>>8;return t}digest(){const{buffer:t,outputLen:r}=this;this.digestInto(t);const i=t.slice(0,r);return this.destroy(),i}}function pD(e){const t=(i,n)=>e(n).update(i).digest(),r=e(new Uint8Array(32));return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=i=>e(i),t}const mD=pD(e=>new hD(e));function gD(e,t,r,i,n,o=20){let a=e[0],s=e[1],c=e[2],u=e[3],d=t[0],l=t[1],f=t[2],h=t[3],g=t[4],m=t[5],v=t[6],b=t[7],I=n,x=r[0],N=r[1],y=r[2],w=a,_=s,S=c,E=u,k=d,U=l,P=f,T=h,A=g,O=m,R=v,W=b,z=I,C=x,B=N,Z=y;for(let ue=0;ue<o;ue+=2)w=w+k|0,z=J(z^w,16),A=A+z|0,k=J(k^A,12),w=w+k|0,z=J(z^w,8),A=A+z|0,k=J(k^A,7),_=_+U|0,C=J(C^_,16),O=O+C|0,U=J(U^O,12),_=_+U|0,C=J(C^_,8),O=O+C|0,U=J(U^O,7),S=S+P|0,B=J(B^S,16),R=R+B|0,P=J(P^R,12),S=S+P|0,B=J(B^S,8),R=R+B|0,P=J(P^R,7),E=E+T|0,Z=J(Z^E,16),W=W+Z|0,T=J(T^W,12),E=E+T|0,Z=J(Z^E,8),W=W+Z|0,T=J(T^W,7),w=w+U|0,Z=J(Z^w,16),R=R+Z|0,U=J(U^R,12),w=w+U|0,Z=J(Z^w,8),R=R+Z|0,U=J(U^R,7),_=_+P|0,z=J(z^_,16),W=W+z|0,P=J(P^W,12),_=_+P|0,z=J(z^_,8),W=W+z|0,P=J(P^W,7),S=S+T|0,C=J(C^S,16),A=A+C|0,T=J(T^A,12),S=S+T|0,C=J(C^S,8),A=A+C|0,T=J(T^A,7),E=E+k|0,B=J(B^E,16),O=O+B|0,k=J(k^O,12),E=E+k|0,B=J(B^E,8),O=O+B|0,k=J(k^O,7);let se=0;i[se++]=a+w|0,i[se++]=s+_|0,i[se++]=c+S|0,i[se++]=u+E|0,i[se++]=d+k|0,i[se++]=l+U|0,i[se++]=f+P|0,i[se++]=h+T|0,i[se++]=g+A|0,i[se++]=m+O|0,i[se++]=v+R|0,i[se++]=b+W|0,i[se++]=I+z|0,i[se++]=x+C|0,i[se++]=N+B|0,i[se++]=y+Z|0}function yD(e,t,r,i){let n=e[0],o=e[1],a=e[2],s=e[3],c=t[0],u=t[1],d=t[2],l=t[3],f=t[4],h=t[5],g=t[6],m=t[7],v=r[0],b=r[1],I=r[2],x=r[3];for(let y=0;y<20;y+=2)n=n+c|0,v=J(v^n,16),f=f+v|0,c=J(c^f,12),n=n+c|0,v=J(v^n,8),f=f+v|0,c=J(c^f,7),o=o+u|0,b=J(b^o,16),h=h+b|0,u=J(u^h,12),o=o+u|0,b=J(b^o,8),h=h+b|0,u=J(u^h,7),a=a+d|0,I=J(I^a,16),g=g+I|0,d=J(d^g,12),a=a+d|0,I=J(I^a,8),g=g+I|0,d=J(d^g,7),s=s+l|0,x=J(x^s,16),m=m+x|0,l=J(l^m,12),s=s+l|0,x=J(x^s,8),m=m+x|0,l=J(l^m,7),n=n+u|0,x=J(x^n,16),g=g+x|0,u=J(u^g,12),n=n+u|0,x=J(x^n,8),g=g+x|0,u=J(u^g,7),o=o+d|0,v=J(v^o,16),m=m+v|0,d=J(d^m,12),o=o+d|0,v=J(v^o,8),m=m+v|0,d=J(d^m,7),a=a+l|0,b=J(b^a,16),f=f+b|0,l=J(l^f,12),a=a+l|0,b=J(b^a,8),f=f+b|0,l=J(l^f,7),s=s+c|0,I=J(I^s,16),h=h+I|0,c=J(c^h,12),s=s+c|0,I=J(I^s,8),h=h+I|0,c=J(c^h,7);let N=0;i[N++]=n,i[N++]=o,i[N++]=a,i[N++]=s,i[N++]=v,i[N++]=b,i[N++]=I,i[N++]=x}const wD=fD(gD,{counterRight:!1,counterLength:8,extendNonceFn:yD,allowShortKeys:!1}),vD=new Uint8Array(16),sg=(e,t)=>{e.update(t);const r=t.length%16;r&&e.update(vD.subarray(r))},bD=new Uint8Array(32);function cg(e,t,r,i,n){n!==void 0&&Xe(n,void 0,"AAD");const o=e(t,r,bD),a=nD(i.length,n?n.length:0,!0),s=mD.create(o);n&&sg(s,n),sg(s,i),s.update(a);const c=s.digest();return ro(o,a),c}const _D=e=>(t,r,i)=>({encrypt(o,a){const s=o.length;a=og(s+16,a,!1),a.set(o);const c=a.subarray(0,-16);e(t,r,c,c,1);const u=cg(e,t,r,c,i);return a.set(u,s),ro(u),a},decrypt(o,a){a=og(o.length-16,a,!1);const s=o.subarray(0,-16),c=o.subarray(-16),u=cg(e,t,r,s,i);if(!tD(c,u))throw new Error("invalid tag");return a.set(o.subarray(0,-16)),e(t,r,a,a,1),ro(u),a}}),US=rD({blockSize:64,nonceLength:24,tagLength:16},_D(wD)),CS=async({key:e,data:t})=>{const r=await xp("SHA-256").digest(e),i=Y0(t);return G0(OS(US)(new Uint8Array(r)).encrypt(i))},PS=async({key:e,data:t})=>{const r=await xp("SHA-256").digest(e),i=Q0(t),n=OS(US)(new Uint8Array(r));return new TextDecoder().decode(n.decrypt(i))},no=(e,t="ms")=>new Date(Date.now()+(t==="sec"?e*1e3:e)),Cn=e=>{const t=(e.plugins??[]).reduce((d,l)=>{const f=l.schema;if(!f)return d;for(const[h,g]of Object.entries(f))d[h]={fields:{...d[h]?.fields,...g.fields},modelName:g.modelName||h};return d},{}),r=e.rateLimit?.storage==="database",i={rateLimit:{modelName:e.rateLimit?.modelName||"rateLimit",fields:{key:{type:"string",fieldName:e.rateLimit?.fields?.key||"key"},count:{type:"number",fieldName:e.rateLimit?.fields?.count||"count"},lastRequest:{type:"number",bigint:!0,fieldName:e.rateLimit?.fields?.lastRequest||"lastRequest"}}}},{user:n,session:o,account:a,verification:s,...c}=t,u={session:{modelName:e.session?.modelName||"session",fields:{expiresAt:{type:"date",required:!0,fieldName:e.session?.fields?.expiresAt||"expiresAt"},token:{type:"string",required:!0,fieldName:e.session?.fields?.token||"token",unique:!0},createdAt:{type:"date",required:!0,fieldName:e.session?.fields?.createdAt||"createdAt",defaultValue:()=>new Date},updatedAt:{type:"date",required:!0,fieldName:e.session?.fields?.updatedAt||"updatedAt",onUpdate:()=>new Date},ipAddress:{type:"string",required:!1,fieldName:e.session?.fields?.ipAddress||"ipAddress"},userAgent:{type:"string",required:!1,fieldName:e.session?.fields?.userAgent||"userAgent"},userId:{type:"string",fieldName:e.session?.fields?.userId||"userId",references:{model:e.user?.modelName||"user",field:"id",onDelete:"cascade"},required:!0,index:!0},...o?.fields,...e.session?.additionalFields},order:2}};return{user:{modelName:e.user?.modelName||"user",fields:{name:{type:"string",required:!0,fieldName:e.user?.fields?.name||"name",sortable:!0},email:{type:"string",unique:!0,required:!0,fieldName:e.user?.fields?.email||"email",sortable:!0},emailVerified:{type:"boolean",defaultValue:!1,required:!0,fieldName:e.user?.fields?.emailVerified||"emailVerified",input:!1},image:{type:"string",required:!1,fieldName:e.user?.fields?.image||"image"},createdAt:{type:"date",defaultValue:()=>new Date,required:!0,fieldName:e.user?.fields?.createdAt||"createdAt"},updatedAt:{type:"date",defaultValue:()=>new Date,onUpdate:()=>new Date,required:!0,fieldName:e.user?.fields?.updatedAt||"updatedAt"},...n?.fields,...e.user?.additionalFields},order:1},...!e.secondaryStorage||e.session?.storeSessionInDatabase?u:{},account:{modelName:e.account?.modelName||"account",fields:{accountId:{type:"string",required:!0,fieldName:e.account?.fields?.accountId||"accountId"},providerId:{type:"string",required:!0,fieldName:e.account?.fields?.providerId||"providerId"},userId:{type:"string",references:{model:e.user?.modelName||"user",field:"id",onDelete:"cascade"},required:!0,fieldName:e.account?.fields?.userId||"userId",index:!0},accessToken:{type:"string",required:!1,returned:!1,fieldName:e.account?.fields?.accessToken||"accessToken"},refreshToken:{type:"string",required:!1,returned:!1,fieldName:e.account?.fields?.refreshToken||"refreshToken"},idToken:{type:"string",required:!1,returned:!1,fieldName:e.account?.fields?.idToken||"idToken"},accessTokenExpiresAt:{type:"date",required:!1,returned:!1,fieldName:e.account?.fields?.accessTokenExpiresAt||"accessTokenExpiresAt"},refreshTokenExpiresAt:{type:"date",required:!1,returned:!1,fieldName:e.account?.fields?.refreshTokenExpiresAt||"refreshTokenExpiresAt"},scope:{type:"string",required:!1,fieldName:e.account?.fields?.scope||"scope"},password:{type:"string",required:!1,returned:!1,fieldName:e.account?.fields?.password||"password"},createdAt:{type:"date",required:!0,fieldName:e.account?.fields?.createdAt||"createdAt",defaultValue:()=>new Date},updatedAt:{type:"date",required:!0,fieldName:e.account?.fields?.updatedAt||"updatedAt",onUpdate:()=>new Date},...a?.fields,...e.account?.additionalFields},order:3},verification:{modelName:e.verification?.modelName||"verification",fields:{identifier:{type:"string",required:!0,fieldName:e.verification?.fields?.identifier||"identifier",index:!0},value:{type:"string",required:!0,fieldName:e.verification?.fields?.value||"value"},expiresAt:{type:"date",required:!0,fieldName:e.verification?.fields?.expiresAt||"expiresAt"},createdAt:{type:"date",required:!0,defaultValue:()=>new Date,fieldName:e.verification?.fields?.createdAt||"createdAt"},updatedAt:{type:"date",required:!0,defaultValue:()=>new Date,onUpdate:()=>new Date,fieldName:e.verification?.fields?.updatedAt||"updatedAt"},...s?.fields,...e.verification?.additionalFields},order:4},...c,...r?i:{}}},Ss=le({id:M(),createdAt:nn().default(()=>new Date),updatedAt:nn().default(()=>new Date)}),SD=Ss.extend({providerId:M(),accountId:M(),userId:Xu(),accessToken:M().nullish(),refreshToken:M().nullish(),idToken:M().nullish(),accessTokenExpiresAt:nn().nullish(),refreshTokenExpiresAt:nn().nullish(),scope:M().nullish(),password:M().nullish()}),kD=le({key:M(),count:tn(),lastRequest:tn()}),ND=Ss.extend({userId:Xu(),expiresAt:nn(),token:M(),ipAddress:M().nullish(),userAgent:M().nullish()}),$D=Ss.extend({email:M().transform(e=>e.toLowerCase()),emailVerified:Bt().default(!1),name:M(),image:M().nullish()}),ED=Ss.extend({value:M(),expiresAt:nn(),identifier:M()}),AD=Object.freeze(Object.defineProperty({__proto__:null,accountSchema:SD,coreSchema:Ss,getAuthTables:Cn,rateLimitSchema:kD,sessionSchema:ND,userSchema:$D,verificationSchema:ED},Symbol.toStringTag,{value:"Module"}));function ID(){const e=Object.getOwnPropertyDescriptor(Error,"stackTraceLimit");return e===void 0?Object.isExtensible(Error):Object.prototype.hasOwnProperty.call(e,"writable")?e.writable:e.set!==void 0}function TD(e){const t=e.split(`
    at `);return t.length<=1?e:(t.splice(1,1),t.join(`
    at `))}function xD(e,t){class r extends e{#e;constructor(...n){if(ID()){const a=Error.stackTraceLimit;Error.stackTraceLimit=0,super(...n),Error.stackTraceLimit=a}else super(...n);const o=new Error().stack;o&&(this.#e=TD(o.replace(/^Error/,this.name)))}get errorStack(){return this.#e}}return Object.defineProperty(r.prototype,"constructor",{get(){return t},enumerable:!1,configurable:!0}),r}const OD={OK:200,CREATED:201,ACCEPTED:202,NO_CONTENT:204,MULTIPLE_CHOICES:300,MOVED_PERMANENTLY:301,FOUND:302,SEE_OTHER:303,NOT_MODIFIED:304,TEMPORARY_REDIRECT:307,BAD_REQUEST:400,UNAUTHORIZED:401,PAYMENT_REQUIRED:402,FORBIDDEN:403,NOT_FOUND:404,METHOD_NOT_ALLOWED:405,NOT_ACCEPTABLE:406,PROXY_AUTHENTICATION_REQUIRED:407,REQUEST_TIMEOUT:408,CONFLICT:409,GONE:410,LENGTH_REQUIRED:411,PRECONDITION_FAILED:412,PAYLOAD_TOO_LARGE:413,URI_TOO_LONG:414,UNSUPPORTED_MEDIA_TYPE:415,RANGE_NOT_SATISFIABLE:416,EXPECTATION_FAILED:417,"I'M_A_TEAPOT":418,MISDIRECTED_REQUEST:421,UNPROCESSABLE_ENTITY:422,LOCKED:423,FAILED_DEPENDENCY:424,TOO_EARLY:425,UPGRADE_REQUIRED:426,PRECONDITION_REQUIRED:428,TOO_MANY_REQUESTS:429,REQUEST_HEADER_FIELDS_TOO_LARGE:431,UNAVAILABLE_FOR_LEGAL_REASONS:451,INTERNAL_SERVER_ERROR:500,NOT_IMPLEMENTED:501,BAD_GATEWAY:502,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,HTTP_VERSION_NOT_SUPPORTED:505,VARIANT_ALSO_NEGOTIATES:506,INSUFFICIENT_STORAGE:507,LOOP_DETECTED:508,NOT_EXTENDED:510,NETWORK_AUTHENTICATION_REQUIRED:511};var LS=class extends Error{constructor(e="INTERNAL_SERVER_ERROR",t=void 0,r={},i=typeof e=="number"?e:OD[e]){super(t?.message,t?.cause?{cause:t.cause}:void 0),this.status=e,this.body=t,this.headers=r,this.statusCode=i,this.name="APIError",this.status=e,this.headers=r,this.statusCode=i,this.body=t?{code:t?.message?.toUpperCase().replace(/ /g,"_").replace(/[^A-Z0-9_]/g,""),...t}:void 0}},zS=class extends LS{constructor(t,r){super(400,{message:t,code:"VALIDATION_ERROR"}),this.message=t,this.issues=r,this.issues=r}},ug=class extends Error{constructor(e){super(e),this.name="BetterCallError"}};const D=xD(LS,Error),DD=/^application\/([a-z0-9.+-]*\+)?json/i;async function RD(e,t){const r=e.headers.get("content-type")||"",i=r.toLowerCase();if(e.body){if(t&&t.length>0&&!t.some(n=>{const o=i.split(";")[0].trim(),a=n.toLowerCase().trim();return o===a||o.includes(a)}))throw i?new D(415,{message:`Content-Type "${r}" is not allowed. Allowed types: ${t.join(", ")}`,code:"UNSUPPORTED_MEDIA_TYPE"}):new D(415,{message:`Content-Type is required. Allowed types: ${t.join(", ")}`,code:"UNSUPPORTED_MEDIA_TYPE"});if(DD.test(i))return await e.json();if(i.includes("application/x-www-form-urlencoded")){const n=await e.formData(),o={};return n.forEach((a,s)=>{o[s]=a.toString()}),o}if(i.includes("multipart/form-data")){const n=await e.formData(),o={};return n.forEach((a,s)=>{o[s]=a}),o}return i.includes("text/plain")?await e.text():i.includes("application/octet-stream")?await e.arrayBuffer():i.includes("application/pdf")||i.includes("image/")||i.includes("video/")?await e.blob():i.includes("application/stream")||e.body instanceof ReadableStream?e.body:await e.text()}}function gc(e){return e instanceof D||e?.name==="APIError"}function UD(e){try{return e.includes("%")?decodeURIComponent(e):e}catch{return e}}async function CD(e){try{return{data:await e,error:null}}catch(t){return{data:null,error:t}}}function jS(e){return e instanceof Request||Object.prototype.toString.call(e)==="[object Request]"}function PD(e){if(e===void 0)return!1;const t=typeof e;return t==="string"||t==="number"||t==="boolean"||t===null?!0:t!=="object"?!1:Array.isArray(e)?!0:e.buffer?!1:e.constructor&&e.constructor.name==="Object"||typeof e.toJSON=="function"}function LD(e,t,r){let i=0;const n=new WeakMap;return JSON.stringify(e,(a,s)=>{if(typeof s=="bigint")return s.toString();if(typeof s=="object"&&s!==null){if(n.has(s))return`[Circular ref-${n.get(s)}]`;n.set(s,i++)}return s},r)}function zD(e){return!e||typeof e!="object"?!1:"_flag"in e&&e._flag==="json"}function oi(e,t){if(e instanceof Response)return t?.headers instanceof Headers&&t.headers.forEach((n,o)=>{e.headers.set(o,n)}),e;if(zD(e)){const n=e.body,o=e.routerResponse;if(o instanceof Response)return o;const a=new Headers;if(o?.headers){const s=new Headers(o.headers);for(const[c,u]of s.entries())s.set(c,u)}if(e.headers)for(const[s,c]of new Headers(e.headers).entries())a.set(s,c);if(t?.headers)for(const[s,c]of new Headers(t.headers).entries())a.set(s,c);return a.set("Content-Type","application/json"),new Response(JSON.stringify(n),{...o,headers:a,status:e.status??t?.status??o?.status,statusText:t?.statusText??o?.statusText})}if(gc(e))return oi(e.body,{status:t?.status??e.statusCode,statusText:e.status.toString(),headers:t?.headers||e.headers});let r=e,i=new Headers(t?.headers);return e?typeof e=="string"?(r=e,i.set("Content-Type","text/plain")):e instanceof ArrayBuffer||ArrayBuffer.isView(e)?(r=e,i.set("Content-Type","application/octet-stream")):e instanceof Blob?(r=e,i.set("Content-Type",e.type||"application/octet-stream")):e instanceof FormData?r=e:e instanceof URLSearchParams?(r=e,i.set("Content-Type","application/x-www-form-urlencoded")):e instanceof ReadableStream?(r=e,i.set("Content-Type","application/octet-stream")):PD(e)&&(r=LD(e),i.set("Content-Type","application/json")):(e===null&&(r=JSON.stringify(null)),i.set("content-type","application/json")),new Response(r,{...t,headers:i})}const Op={name:"HMAC",hash:"SHA-256"},MS=async e=>{const t=typeof e=="string"?new TextEncoder().encode(e):e;return await ii().importKey("raw",t,Op,!1,["sign","verify"])},jD=async(e,t,r)=>{try{const i=atob(e),n=new Uint8Array(i.length);for(let o=0,a=i.length;o<a;o++)n[o]=i.charCodeAt(o);return await ii().verify(Op,r,n,new TextEncoder().encode(t))}catch{return!1}},MD=async(e,t)=>{const r=await MS(t),i=await ii().sign(Op.name,r,new TextEncoder().encode(e));return btoa(String.fromCharCode(...new Uint8Array(i)))},qD=async(e,t)=>{const r=await MD(e,t);return e=`${e}.${r}`,e=encodeURIComponent(e),e},dg=(e,t)=>{let r=e;if(t)if(t==="secure")r="__Secure-"+e;else if(t==="host")r="__Host-"+e;else return;return r};function WD(e){if(typeof e!="string")throw new TypeError("argument str must be a string");const t=new Map;let r=0;for(;r<e.length;){const i=e.indexOf("=",r);if(i===-1)break;let n=e.indexOf(";",r);if(n===-1)n=e.length;else if(n<i){r=e.lastIndexOf(";",i-1)+1;continue}const o=e.slice(r,i).trim();if(!t.has(o)){let a=e.slice(i+1,n).trim();a.codePointAt(0)===34&&(a=a.slice(1,-1)),t.set(o,UD(a))}r=n+1}return t}const qS=(e,t,r={})=>{let i;if(r?.prefix==="secure"?i=`${`__Secure-${e}`}=${t}`:r?.prefix==="host"?i=`${`__Host-${e}`}=${t}`:i=`${e}=${t}`,e.startsWith("__Secure-")&&!r.secure&&(r.secure=!0),e.startsWith("__Host-")&&(r.secure||(r.secure=!0),r.path!=="/"&&(r.path="/"),r.domain&&(r.domain=void 0)),r&&typeof r.maxAge=="number"&&r.maxAge>=0){if(r.maxAge>3456e4)throw new Error("Cookies Max-Age SHOULD NOT be greater than 400 days (34560000 seconds) in duration.");i+=`; Max-Age=${Math.floor(r.maxAge)}`}if(r.domain&&r.prefix!=="host"&&(i+=`; Domain=${r.domain}`),r.path&&(i+=`; Path=${r.path}`),r.expires){if(r.expires.getTime()-Date.now()>3456e7)throw new Error("Cookies Expires SHOULD NOT be greater than 400 days (34560000 seconds) in the future.");i+=`; Expires=${r.expires.toUTCString()}`}return r.httpOnly&&(i+="; HttpOnly"),r.secure&&(i+="; Secure"),r.sameSite&&(i+=`; SameSite=${r.sameSite.charAt(0).toUpperCase()+r.sameSite.slice(1)}`),r.partitioned&&(r.secure||(r.secure=!0),i+="; Partitioned"),i},FD=(e,t,r)=>(t=encodeURIComponent(t),qS(e,t,r)),BD=async(e,t,r,i)=>(t=await qD(t,r),qS(e,t,i));async function VD(e,t={}){let r={body:t.body,query:t.query};if(e.body){const i=await e.body["~standard"].validate(t.body);if(i.issues)return{data:null,error:lg(i.issues,"body")};r.body=i.value}if(e.query){const i=await e.query["~standard"].validate(t.query);if(i.issues)return{data:null,error:lg(i.issues,"query")};r.query=i.value}return e.requireHeaders&&!t.headers?{data:null,error:{message:"Headers is required",issues:[]}}:e.requireRequest&&!t.request?{data:null,error:{message:"Request is required",issues:[]}}:{data:r,error:null}}function lg(e,t){return{message:e.map(r=>`[${r.path?.length?`${t}.`+r.path.map(i=>typeof i=="object"?i.key:i).join("."):t}] ${r.message}`).join("; "),issues:e}}const WS=async(e,{options:t,path:r})=>{const i=new Headers;let n;const{data:o,error:a}=await VD(t,e);if(a)throw new zS(a.message,a.issues);const s="headers"in e?e.headers instanceof Headers?e.headers:new Headers(e.headers):"request"in e&&jS(e.request)?e.request.headers:null,c=s?.get("cookie"),u=c?WD(c):void 0,d={...e,body:o.body,query:o.query,path:e.path||r||"virtual:",context:"context"in e&&e.context?e.context:{},returned:void 0,headers:e?.headers,request:e?.request,params:"params"in e?e.params:void 0,method:e.method??(Array.isArray(t.method)?t.method[0]:t.method==="*"?"GET":t.method),setHeader:(l,f)=>{i.set(l,f)},getHeader:l=>s?s.get(l):null,getCookie:(l,f)=>{const h=dg(l,f);return h&&u?.get(h)||null},getSignedCookie:async(l,f,h)=>{const g=dg(l,h);if(!g)return null;const m=u?.get(g);if(!m)return null;const v=m.lastIndexOf(".");if(v<1)return null;const b=m.substring(0,v),I=m.substring(v+1);return I.length!==44||!I.endsWith("=")?null:await jD(I,b,await MS(f))?b:!1},setCookie:(l,f,h)=>{const g=FD(l,f,h);return i.append("set-cookie",g),g},setSignedCookie:async(l,f,h,g)=>{const m=await BD(l,f,h,g);return i.append("set-cookie",m),m},redirect:l=>(i.set("location",l),new D("FOUND",void 0,i)),error:(l,f,h)=>new D(l,f,h),setStatus:l=>{n=l},json:(l,f)=>e.asResponse?{body:f?.body||l,routerResponse:f,_flag:"json"}:l,responseHeaders:i,get responseStatus(){return n}};for(const l of t.use||[]){const f=await l({...d,returnHeaders:!0,asResponse:!1});f.response&&Object.assign(d.context,f.response),f.headers&&f.headers.forEach((h,g)=>{d.responseHeaders.set(g,h)})}return d};function va(e,t,r){const i=typeof e=="string"?e:void 0,n=typeof t=="object"?t:e,o=typeof t=="function"?t:r;if((n.method==="GET"||n.method==="HEAD")&&n.body)throw new ug("Body is not allowed with GET or HEAD methods");if(i&&/\/{2,}/.test(i))throw new ug("Path cannot contain consecutive slashes");const a=async(...s)=>{const c=s[0]||{},{data:u,error:d}=await CD(WS(c,{options:n,path:i}));if(d)throw d instanceof zS?(n.onValidationError&&await n.onValidationError({message:d.message,issues:d.issues}),new D(400,{message:d.message,code:"VALIDATION_ERROR"})):d;const l=await o(u).catch(async g=>{if(gc(g)){const m=n.onAPIError;if(m&&await m(g),c.asResponse)return g}throw g}),f=u.responseHeaders,h=u.responseStatus;return c.asResponse?oi(l,{headers:f,status:h}):c.returnHeaders?c.returnStatus?{headers:f,response:l,status:h}:{headers:f,response:l}:c.returnStatus?{response:l,status:h}:l};return a.options=n,a.path=i,a}va.create=e=>(t,r,i)=>va(t,{...r,use:[...r?.use||[],...e?.use||[]]},i);function zi(e,t){const r=async i=>{const n=i,o=typeof e=="function"?e:t,a=await WS(n,{options:typeof e=="function"?{}:e,path:"/"});if(!o)throw new Error("handler must be defined");const s=await o(a),c=a.responseHeaders;return n.returnHeaders?{headers:c,response:s}:s};return r.options=typeof e=="function"?{}:e,r}zi.create=e=>{function t(r,i){if(typeof r=="function")return zi({use:e?.use},r);if(!i)throw new Error("Middleware handler is required");return zi({...r,method:"*",use:[...e?.use||[],...r.use||[]]},i)}return t};const Bd={};function FS(e){switch(e.constructor.name){case"ZodString":return"string";case"ZodNumber":return"number";case"ZodBoolean":return"boolean";case"ZodObject":return"object";case"ZodArray":return"array";default:return"string"}}function fg(e){const t=[];return e.metadata?.openapi?.parameters?(t.push(...e.metadata.openapi.parameters),t):(e.query instanceof Ir&&Object.entries(e.query.shape).forEach(([r,i])=>{i instanceof Ir&&t.push({name:r,in:"query",schema:{type:FS(i),..."minLength"in i&&i.minLength?{minLength:i.minLength}:{},description:i.description}})}),t)}function KD(e){if(e.metadata?.openapi?.requestBody)return e.metadata.openapi.requestBody;if(e.body&&(e.body instanceof Ir||e.body instanceof Tn)){const t=e.body.shape;if(!t)return;const r={},i=[];return Object.entries(t).forEach(([n,o])=>{o instanceof Ir&&(r[n]={type:FS(o),description:o.description},o instanceof Tn||i.push(n))}),{required:e.body instanceof Tn?!1:!!e.body,content:{"application/json":{schema:{type:"object",properties:r,required:i}}}}}}function hg(e){return{400:{content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}},required:["message"]}}},description:"Bad Request. Usually due to missing parameters, or invalid parameters."},401:{content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}},required:["message"]}}},description:"Unauthorized. Due to missing or invalid authentication."},403:{content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}}}}},description:"Forbidden. You do not have permission to access this resource or to perform this action."},404:{content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}}}}},description:"Not Found. The requested resource was not found."},429:{content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}}}}},description:"Too Many Requests. You have exceeded the rate limit. Try again later."},500:{content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}}}}},description:"Internal Server Error. This is a problem with the server that you cannot fix."},...e}}async function JD(e,t){const r={schemas:{}};return Object.entries(e).forEach(([i,n])=>{const o=n.options;if(!(!n.path||o.metadata?.SERVER_ONLY)&&(o.method==="GET"&&(Bd[n.path]={get:{tags:["Default",...o.metadata?.openapi?.tags||[]],description:o.metadata?.openapi?.description,operationId:o.metadata?.openapi?.operationId,security:[{bearerAuth:[]}],parameters:fg(o),responses:hg(o.metadata?.openapi?.responses)}}),o.method==="POST")){const a=KD(o);Bd[n.path]={post:{tags:["Default",...o.metadata?.openapi?.tags||[]],description:o.metadata?.openapi?.description,operationId:o.metadata?.openapi?.operationId,security:[{bearerAuth:[]}],parameters:fg(o),...a?{requestBody:a}:{requestBody:{content:{"application/json":{schema:{type:"object",properties:{}}}}}},responses:hg(o.metadata?.openapi?.responses)}}}}),{openapi:"3.1.1",info:{title:"Better Auth",description:"API Reference for your Better Auth Instance",version:"1.1.0"},components:r,security:[{apiKeyCookie:[]}],servers:[{url:t?.url}],tags:[{name:"Default",description:"Default endpoints that are included with Better Auth by default. These endpoints are not part of any plugin."}],paths:Bd}}const HD=(e,t)=>`<!doctype html>
<html>
  <head>
    <title>Scalar API Reference</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1" />
  </head>
  <body>
    <script
      id="api-reference"
      type="application/json">
    ${JSON.stringify(e)}
    <\/script>
	 <script>
      var configuration = {
	  	favicon: ${t?.logo?`data:image/svg+xml;utf8,${encodeURIComponent(t.logo)}`:void 0} ,
	   	theme: ${t?.theme||"saturn"},
        metaData: {
			title: ${t?.title||"Open API Reference"},
			description: ${t?.description||"Better Call Open API"},
		}
      }
      document.getElementById('api-reference').dataset.configuration =
        JSON.stringify(configuration)
    <\/script>
	  <script src="https://cdn.jsdelivr.net/npm/@scalar/api-reference"><\/script>
  </body>
</html>`,yc=(()=>{const e=function(){};return e.prototype=Object.create(null),Object.freeze(e.prototype),e})();function pg(){return{root:{key:""},static:new yc}}function Dp(e){const[t,...r]=e.split("/");return r[r.length-1]===""?r.slice(0,-1):r}function BS(e,t){const r=new yc;for(const[i,n]of t){const o=i<0?e.slice(-1*i).join("/"):e[i];if(typeof n=="string")r[n]=o;else{const a=o.match(n);if(a)for(const s in a.groups)r[s]=a.groups[s]}}return r}function mg(e,t="",r,i){t=t.toUpperCase(),r.charCodeAt(0)!==47&&(r=`/${r}`);const n=Dp(r);let o=e.root,a=0;const s=[],c=[];for(let d=0;d<n.length;d++){const l=n[d];if(l.startsWith("**")){o.wildcard||(o.wildcard={key:"**"}),o=o.wildcard,s.push([-d,l.split(":")[1]||"_",l.length===2]);break}if(l==="*"||l.includes(":")){if(o.param||(o.param={key:"*"}),o=o.param,l==="*")s.push([d,`_${a++}`,!0]);else if(l.includes(":",1)){const h=ZD(l);c[d]=h,o.hasRegexParam=!0,s.push([d,h,!1])}else s.push([d,l.slice(1),!1]);continue}const f=o.static?.[l];if(f)o=f;else{const h={key:l};o.static||(o.static=new yc),o.static[l]=h,o=h}}const u=s.length>0;o.methods||(o.methods=new yc),o.methods[t]??=[],o.methods[t].push({data:i||null,paramsRegexp:c,paramsMap:u?s:void 0}),u||(e.static[r]=o)}function ZD(e){const t=e.replace(/:(\w+)/g,(r,i)=>`(?<${i}>[^/]+)`).replace(/\./g,"\\.");return new RegExp(`^${t}$`)}function GD(e,t="",r,i){r.charCodeAt(r.length-1)===47&&(r=r.slice(0,-1));const n=e.static[r];if(n&&n.methods){const s=n.methods[t]||n.methods[""];if(s!==void 0)return s[0]}const o=Dp(r),a=Tl(e,e.root,t,o,0)?.[0];if(a!==void 0)return{data:a.data,params:a.paramsMap?BS(o,a.paramsMap):void 0}}function Tl(e,t,r,i,n){if(n===i.length){if(t.methods){const a=t.methods[r]||t.methods[""];if(a)return a}if(t.param&&t.param.methods){const a=t.param.methods[r]||t.param.methods[""];if(a){const s=a[0].paramsMap;if(s?.[s?.length-1]?.[2])return a}}if(t.wildcard&&t.wildcard.methods){const a=t.wildcard.methods[r]||t.wildcard.methods[""];if(a){const s=a[0].paramsMap;if(s?.[s?.length-1]?.[2])return a}}return}const o=i[n];if(t.static){const a=t.static[o];if(a){const s=Tl(e,a,r,i,n+1);if(s)return s}}if(t.param){const a=Tl(e,t.param,r,i,n+1);if(a){if(t.param.hasRegexParam){const s=a.find(c=>c.paramsRegexp[n]?.test(o))||a.find(c=>!c.paramsRegexp[n]);return s?[s]:void 0}return a}}if(t.wildcard&&t.wildcard.methods)return t.wildcard.methods[r]||t.wildcard.methods[""]}function QD(e,t="",r,i){r.charCodeAt(r.length-1)===47&&(r=r.slice(0,-1));const n=Dp(r);return xl(e,e.root,t,n,0).map(a=>({data:a.data,params:a.paramsMap?BS(n,a.paramsMap):void 0}))}function xl(e,t,r,i,n,o=[]){const a=i[n];if(t.wildcard&&t.wildcard.methods){const c=t.wildcard.methods[r]||t.wildcard.methods[""];c&&o.push(...c)}if(t.param&&(xl(e,t.param,r,i,n+1,o),n===i.length&&t.param.methods)){const c=t.param.methods[r]||t.param.methods[""];if(c){const u=c[0].paramsMap;u?.[u?.length-1]?.[2]&&o.push(...c)}}const s=t.static?.[a];if(s&&xl(e,s,r,i,n+1,o),n===i.length&&t.methods){const c=t.methods[r]||t.methods[""];c&&o.push(...c)}return o}const YD=(e,t)=>{if(!t?.openapi?.disabled){const o={path:"/api/reference",...t?.openapi};e.openapi=va(o.path,{method:"GET"},async a=>{const s=await JD(e);return new Response(HD(s,o.scalar),{headers:{"Content-Type":"text/html"}})})}const r=pg(),i=pg();for(const o of Object.values(e)){if(!o.options||!o.path||o.options?.metadata?.SERVER_ONLY)continue;const a=Array.isArray(o.options?.method)?o.options.method:[o.options?.method];for(const s of a)mg(r,s,o.path,o)}if(t?.routerMiddleware?.length)for(const{path:o,middleware:a}of t.routerMiddleware)mg(i,"*",o,a);const n=async o=>{const a=new URL(o.url),s=a.pathname,c=t?.basePath&&t.basePath!=="/"?s.split(t.basePath).reduce((f,h,g)=>(g!==0&&(g>1?f.push(`${t.basePath}${h}`):f.push(h)),f),[]).join(""):a.pathname;if(!c?.length)return new Response(null,{status:404,statusText:"Not Found"});if(/\/{2,}/.test(c))return new Response(null,{status:404,statusText:"Not Found"});const u=GD(r,o.method,c);if(c.endsWith("/")!==u?.data?.path?.endsWith("/")&&!t?.skipTrailingSlashes)return new Response(null,{status:404,statusText:"Not Found"});if(!u?.data)return new Response(null,{status:404,statusText:"Not Found"});const d={};a.searchParams.forEach((f,h)=>{h in d?Array.isArray(d[h])?d[h].push(f):d[h]=[d[h],f]:d[h]=f});const l=u.data;try{const f=l.options.metadata?.allowedMediaTypes||t?.allowedMediaTypes,h={path:c,method:o.method,headers:o.headers,params:u.params?JSON.parse(JSON.stringify(u.params)):{},request:o,body:l.options.disableBody?void 0:await RD(l.options.cloneRequest?o.clone():o,f),query:d,_flag:"router",asResponse:!0,context:t?.routerContext},g=QD(i,"*",c);if(g?.length)for(const{data:m,params:v}of g){const b=await m({...h,params:v,asResponse:!1});if(b instanceof Response)return b}return await l(h)}catch(f){if(t?.onError)try{const h=await t.onError(f);if(h instanceof Response)return oi(h)}catch(h){if(gc(h))return oi(h);throw h}if(t?.throwError)throw f;return gc(f)?oi(f):(console.error("# SERVER_ERROR: ",f),new Response(null,{status:500,statusText:"Internal Server Error"}))}};return{handler:async o=>{const a=await t?.onRequest?.(o);if(a instanceof Response)return a;const s=await n(jS(a)?a:o),c=await t?.onResponse?.(s);return c instanceof Response?c:s},endpoints:e}},Vd=new WeakMap;function Rp(e,t){const r=t.fields,i={};for(const n in e){const o=r[n];if(!o){i[n]=e[n];continue}o.returned===!1&&n!=="id"||(i[n]=e[n])}return i}function bi(e,t,r){const i=`${t}:${r}`;Vd.has(e)||Vd.set(e,new Map);const n=Vd.get(e);if(n.has(i))return n.get(i);const o=r==="output"?Cn(e)[t]?.fields??{}:{},a=t==="user"||t==="session"||t==="account"?e[t]?.additionalFields:void 0;let s={...o,...a??{}};for(const c of e.plugins||[])c.schema&&c.schema[t]&&(s={...s,...c.schema[t].fields});return n.set(i,s),s}function ht(e,t){return Rp(t,{fields:bi(e,"user","output")})}function Xt(e,t){return Rp(t,{fields:bi(e,"session","output")})}function VS(e,t){const{accessToken:r,refreshToken:i,idToken:n,accessTokenExpiresAt:o,refreshTokenExpiresAt:a,password:s,...c}=Rp(t,{fields:bi(e,"account","output")});return c}function ks(e,t){const r=t.action||"create",i=t.fields,n=Object.assign(Object.create(null),null);for(const o in i){if(o in e){if(i[o].input===!1){if(i[o].defaultValue!==void 0&&r!=="update"){n[o]=i[o].defaultValue;continue}if(e[o])throw new D("BAD_REQUEST",{message:`${o} is not allowed to be set`});continue}if(i[o].validator?.input&&e[o]!==void 0){const a=i[o].validator.input["~standard"].validate(e[o]);if(a instanceof Promise)throw new D("INTERNAL_SERVER_ERROR",{message:"Async validation is not supported for additional fields"});if("issues"in a&&a.issues)throw new D("BAD_REQUEST",{message:a.issues[0]?.message||"Validation Error"});n[o]=a.value;continue}if(i[o].transform?.input&&e[o]!==void 0){n[o]=i[o].transform?.input(e[o]);continue}n[o]=e[o];continue}if(i[o].defaultValue!==void 0&&r==="create"){if(typeof i[o].defaultValue=="function"){n[o]=i[o].defaultValue();continue}n[o]=i[o].defaultValue;continue}if(i[o].required&&r==="create")throw new D("BAD_REQUEST",{message:`${o} is required`})}return n}function Up(e,t={},r){return ks(t,{fields:bi(e,"user","input"),action:r})}function XD(e,t){const r=bi(e,"user","input");return ks(t||{},{fields:r})}function eR(e,t){return ks(t,{fields:bi(e,"account","input")})}function KS(e,t){return ks(t,{fields:bi(e,"session","input")})}function tR(e,t){if(!t)return e;for(const r in t){const i=t[r]?.modelName;i&&(e[r].modelName=i);for(const n in e[r].fields){const o=t[r]?.fields?.[n];o&&(e[r].fields[n].fieldName=o)}}return e}const Cp=4096,Ol=200,Kd=Cp-Ol;function rR(e){const t=e.headers?.get("cookie");if(!t)return{};const r={},i=t.split("; ");for(const n of i){const[o,...a]=n.split("=");o&&a.length>0&&(r[o]=a.join("="))}return r}function gg(e){const t=e.split("."),r=t[t.length-1],i=parseInt(r||"0",10);return isNaN(i)?0:i}function nR(e,t){const r={},i=rR(t);for(const[n,o]of Object.entries(i))n.startsWith(e)&&(r[n]=o);return r}function iR(e){return Object.keys(e).sort((t,r)=>gg(t)-gg(r)).map(t=>e[t]).join("")}function oR(e,t,r,i){const n=Math.ceil(t.value.length/Kd);if(n===1)return r[t.name]=t.value,[t];const o=[];for(let a=0;a<n;a++){const s=`${t.name}.${a}`,c=a*Kd,u=t.value.substring(c,c+Kd);o.push({...t,name:s,value:u}),r[s]=u}return i.debug(`CHUNKING_${e.toUpperCase()}_COOKIE`,{message:`${e} cookie exceeds allowed ${Cp} bytes.`,emptyCookieSize:Ol,valueSize:t.value.length,chunkCount:n,chunks:o.map(a=>a.value.length+Ol)}),o}function yg(e,t){const r={};for(const i in e)r[i]={name:i,value:"",attributes:{...t,maxAge:0}};return r}const JS=e=>(t,r,i)=>{const n=nR(t,i),o=i.context.logger;return{getValue(){return iR(n)},hasChunks(){return Object.keys(n).length>0},chunk(a,s){const c=yg(n,r);for(const l in n)delete n[l];const u=c,d=oR(e,{name:t,value:a,attributes:{...r,...s}},n,o);for(const l of d)u[l.name]=l;return Object.values(u)},clean(){const a=yg(n,r);for(const s in n)delete n[s];return Object.values(a)},setCookies(a){for(const s of a)i.setCookie(s.name,s.value,s.attributes)}}},Dl=JS("Session"),Rl=JS("Account");function HS(e,t){const r=e.getCookie(t);if(r)return r;const i=[],n=e.headers?.get("cookie");if(!n)return null;const o={},a=n.split("; ");for(const s of a){const[c,...u]=s.split("=");c&&u.length>0&&(o[c]=u.join("="))}for(const[s,c]of Object.entries(o))if(s.startsWith(t+".")){const u=s.split(".").at(-1),d=parseInt(u||"0",10);isNaN(d)||i.push({index:d,value:c})}return i.length>0?(i.sort((s,c)=>s.index-c.index),i.map(s=>s.value).join("")):null}async function wc(e,t){const r=e.context.authCookies.accountData,i={maxAge:300,...r.attributes},n=await tw(t,e.context.secret,"better-auth-account",i.maxAge);if(n.length>Cp){const o=Rl(r.name,i,e),a=o.chunk(n,i);o.setCookies(a)}else{const o=Rl(r.name,i,e);if(o.hasChunks()){const a=o.clean();o.setCookies(a)}e.setCookie(r.name,n,i)}}async function Pp(e){const t=HS(e,e.context.authCookies.accountData.name);if(t){const r=it(await rw(t,e.context.secret,"better-auth-account"));if(r)return r}return null}const aR=on(le({disableCookieCache:Nl().meta({description:"Disable cookie cache and fetch session from database"}).optional(),disableRefresh:Nl().meta({description:"Disable session refresh. Useful for checking session status, without updating the session"}).optional()})),ZS=1e3,GS=ZS*60,QS=GS*60,nd=QS*24,sR=nd*7,cR=nd*30,uR=nd*365.25,dR=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|months?|mo|years?|yrs?|y)(?: (ago|from now))?$/i;function lR(e){const t=dR.exec(e);if(!t||t[4]&&t[1])throw new TypeError(`Invalid time string format: "${e}". Use formats like "7d", "30m", "1 hour", etc.`);const r=parseFloat(t[2]),i=t[3].toLowerCase();let n;switch(i){case"years":case"year":case"yrs":case"yr":case"y":n=r*uR;break;case"months":case"month":case"mo":n=r*cR;break;case"weeks":case"week":case"w":n=r*sR;break;case"days":case"day":case"d":n=r*nd;break;case"hours":case"hour":case"hrs":case"hr":case"h":n=r*QS;break;case"minutes":case"minute":case"mins":case"min":case"m":n=r*GS;break;case"seconds":case"second":case"secs":case"sec":case"s":n=r*ZS;break;default:throw new TypeError(`Unknown time unit: "${i}"`)}return t[1]==="-"||t[4]==="ago"?-n:n}function fR(e){return Math.round(lR(e)/1e3)}const hR="__Secure-";function pR(e){const t=new Map;return e.split(", ").forEach(r=>{const[i,...n]=r.split(";").map(u=>u.trim()),[o,...a]=(i||"").split("="),s=a.join("=");if(!o||s===void 0)return;const c={value:s};n.forEach(u=>{const[d,...l]=u.split("="),f=l.join("="),h=d.trim().toLowerCase();switch(h){case"max-age":c["max-age"]=f?parseInt(f.trim(),10):void 0;break;case"expires":c.expires=f?new Date(f.trim()):void 0;break;case"domain":c.domain=f?f.trim():void 0;break;case"path":c.path=f?f.trim():void 0;break;case"secure":c.secure=!0;break;case"httponly":c.httponly=!0;break;case"samesite":c.samesite=f?f.trim().toLowerCase():void 0;break;default:c[h]=f?f.trim():!0;break}}),t.set(o,c)}),t}const Jd=new Map,mR=new TextEncoder,gR={decode:(e,t="utf-8")=>(Jd.has(t)||Jd.set(t,new TextDecoder(t)),Jd.get(t).decode(e)),encode:mR.encode},YS=(e="SHA-256",t="none")=>{const r={importKey:async(i,n)=>ii().importKey("raw",typeof i=="string"?new TextEncoder().encode(i):i,{name:"HMAC",hash:{name:e}},!1,[n]),sign:async(i,n)=>{typeof i=="string"&&(i=await r.importKey(i,"sign"));const o=await ii().sign("HMAC",i,typeof n=="string"?new TextEncoder().encode(n):n);return t==="hex"?hc.encode(o):t==="base64"||t==="base64url"||t==="base64urlnopad"?rd.encode(o,{padding:t!=="base64urlnopad"}):o},verify:async(i,n,o)=>(typeof i=="string"&&(i=await r.importKey(i,"verify")),t==="hex"&&(o=hc.decode(o)),(t==="base64"||t==="base64url"||t==="base64urlnopad")&&(o=await an.decode(o)),ii().verify("HMAC",i,typeof o=="string"?new TextEncoder().encode(o):o,typeof n=="string"?new TextEncoder().encode(n):n))};return r};function XS(e){const t=(e.advanced?.useSecureCookies!==void 0?e.advanced?.useSecureCookies:e.baseURL?e.baseURL.startsWith("https://"):ed)?hR:"",r=!!e.advanced?.crossSubDomainCookies?.enabled,i=r?e.advanced?.crossSubDomainCookies?.domain||(e.baseURL?new URL(e.baseURL).hostname:void 0):void 0;if(r&&!i)throw new Y("baseURL is required when crossSubdomainCookies are enabled");function n(o,a={}){const s=e.advanced?.cookiePrefix||"better-auth",c=e.advanced?.cookies?.[o]?.name||`${s}.${o}`,u=e.advanced?.cookies?.[o]?.attributes;return{name:`${t}${c}`,attributes:{secure:!!t,sameSite:"lax",path:"/",httpOnly:!0,...r?{domain:i}:{},...e.advanced?.defaultCookieAttributes,...a,...u}}}return n}function yR(e){const t=XS(e),r=t("session_token",{maxAge:e.session?.expiresIn||fR("7d")}),i=t("session_data",{maxAge:e.session?.cookieCache?.maxAge||300}),n=t("account_data",{maxAge:e.session?.cookieCache?.maxAge||300}),o=t("dont_remember");return{sessionToken:{name:r.name,attributes:r.attributes},sessionData:{name:i.name,attributes:i.attributes},dontRememberToken:{name:o.name,attributes:o.attributes},accountData:{name:n.name,attributes:n.attributes}}}async function Ul(e,t,r){if(e.context.options.session?.cookieCache?.enabled){const i=Object.entries(t.session).reduce((f,[h,g])=>{const m=e.context.options.session?.additionalFields?.[h];return(!m||m.returned!==!1)&&(f[h]=g),f},{}),n=ht(e.context.options,t.user),o=e.context.options.session?.cookieCache?.version;let a="1";if(o){if(typeof o=="string")a=o;else if(typeof o=="function"){const f=o(t.session,t.user);a=f instanceof Promise?await f:f}}const s={session:i,user:n,updatedAt:Date.now(),version:a},c={...e.context.authCookies.sessionData.attributes,maxAge:r?void 0:e.context.authCookies.sessionData.attributes.maxAge},u=no(c.maxAge||60,"sec").getTime(),d=e.context.options.session?.cookieCache?.strategy||"compact";let l;if(d==="jwe"?l=await tw(s,e.context.secret,"better-auth-session",c.maxAge||300):d==="jwt"?l=await Qy(s,e.context.secret,c.maxAge||300):l=rd.encode(JSON.stringify({session:s,expiresAt:u,signature:await YS("SHA-256","base64urlnopad").sign(e.context.secret,JSON.stringify({...s,expiresAt:u}))}),{padding:!1}),l.length>4093){const f=Dl(e.context.authCookies.sessionData.name,c,e),h=f.chunk(l,c);f.setCookies(h)}else{const f=Dl(e.context.authCookies.sessionData.name,c,e);if(f.hasChunks()){const h=f.clean();f.setCookies(h)}e.setCookie(e.context.authCookies.sessionData.name,l,c)}}}async function tr(e,t,r,i){const n=await e.getSignedCookie(e.context.authCookies.dontRememberToken.name,e.context.secret);r=r!==void 0?r:!!n;const o=e.context.authCookies.sessionToken.attributes,a=r?void 0:e.context.sessionConfig.expiresIn;await e.setSignedCookie(e.context.authCookies.sessionToken.name,t.session.token,e.context.secret,{...o,maxAge:a,...i}),r&&await e.setSignedCookie(e.context.authCookies.dontRememberToken.name,"true",e.context.secret,e.context.authCookies.dontRememberToken.attributes),await Ul(e,t,r),e.context.setNewSession(t),e.context.options.secondaryStorage&&await e.context.secondaryStorage?.set(t.session.token,JSON.stringify({user:t.user,session:t.session}),Math.floor((new Date(t.session.expiresAt).getTime()-Date.now())/1e3))}function er(e,t){e.setCookie(t.name,"",{...t.attributes,maxAge:0})}function ba(e,t){if(er(e,e.context.authCookies.sessionToken),er(e,e.context.authCookies.sessionData),e.context.options.account?.storeAccountCookie){er(e,e.context.authCookies.accountData);const n=Rl(e.context.authCookies.accountData.name,e.context.authCookies.accountData.attributes,e),o=n.clean();n.setCookies(o)}e.context.oauthConfig.storeStateStrategy==="cookie"&&er(e,e.context.createAuthCookie("oauth_state"));const r=Dl(e.context.authCookies.sessionData.name,e.context.authCookies.sessionData.attributes,e),i=r.clean();r.setCookies(i),er(e,e.context.authCookies.dontRememberToken)}async function ek(e,t,r){const i=e.body?.callbackURL||e.context.options.baseURL;if(!i)throw new D("BAD_REQUEST",{message:"callbackURL is required"});const n=ul(128),o=ul(32),a=e.context.oauthConfig.storeStateStrategy,s={...r||{},callbackURL:i,codeVerifier:n,errorURL:e.body?.errorCallbackURL,newUserURL:e.body?.newUserCallbackURL,link:t,expiresAt:Date.now()+600*1e3,requestSignUp:e.body?.requestSignUp,state:o};if(await Sy(s),a==="cookie"){const l=await CS({key:e.context.secret,data:JSON.stringify(s)}),f=e.context.createAuthCookie("oauth_state",{maxAge:600*1e3});return e.setCookie(f.name,l,f.attributes),{state:o,codeVerifier:n}}const c=e.context.createAuthCookie("state",{maxAge:300*1e3});await e.setSignedCookie(c.name,o,e.context.secret,c.attributes);const u=new Date;u.setMinutes(u.getMinutes()+10);const d=await e.context.internalAdapter.createVerificationValue({value:JSON.stringify(s),identifier:o,expiresAt:u});if(!d)throw e.context.logger.error("Unable to create verification. Make sure the database adapter is properly working and there is a verification table in the database"),new D("INTERNAL_SERVER_ERROR",{message:"Unable to create verification"});return{state:d.identifier,codeVerifier:n}}async function wR(e){const t=e.query.state||e.body.state,r=e.context.oauthConfig.storeStateStrategy,i=bu({callbackURL:M(),codeVerifier:M(),errorURL:M().optional(),newUserURL:M().optional(),expiresAt:tn(),link:le({email:M(),userId:Xu()}).optional(),requestSignUp:Bt().optional(),state:M().optional()});let n;const o=e.context.oauthConfig?.skipStateCookieCheck;if(r==="cookie"){const a=e.context.createAuthCookie("oauth_state"),s=e.getCookie(a.name);if(!s){e.context.logger.error("State Mismatch. OAuth state cookie not found",{state:t});const c=e.context.options.onAPIError?.errorURL||`${e.context.baseURL}/error`;throw e.redirect(`${c}?error=please_restart_the_process`)}try{const c=await PS({key:e.context.secret,data:s});n=i.parse(JSON.parse(c))}catch(c){e.context.logger.error("Failed to decrypt or parse OAuth state cookie",{error:c});const u=e.context.options.onAPIError?.errorURL||`${e.context.baseURL}/error`;throw e.redirect(`${u}?error=please_restart_the_process`)}if(!e.context.oauthConfig?.skipStateCookieCheck&&n.state&&n.state!==t){e.context.logger.error("State Mismatch. State parameter does not match",{expected:n.state,received:t});const c=e.context.options.onAPIError?.errorURL||`${e.context.baseURL}/error`;throw e.redirect(`${c}?error=state_mismatch`)}er(e,a)}else{const a=await e.context.internalAdapter.findVerificationValue(t);if(!a){e.context.logger.error("State Mismatch. Verification not found",{state:t});const u=e.context.options.onAPIError?.errorURL||`${e.context.baseURL}/error`;throw e.redirect(`${u}?error=please_restart_the_process`)}n=i.parse(JSON.parse(a.value));const s=e.context.createAuthCookie("state"),c=await e.getSignedCookie(s.name,e.context.secret);if(!o&&(!c||c!==t)){const u=e.context.options.onAPIError?.errorURL||`${e.context.baseURL}/error`;throw e.redirect(`${u}?error=state_mismatch`)}er(e,s),await e.context.internalAdapter.deleteVerificationValue(a.id)}if(n.errorURL||(n.errorURL=e.context.options.onAPIError?.errorURL||`${e.context.baseURL}/error`),n.expiresAt<Date.now()){const a=e.context.options.onAPIError?.errorURL||`${e.context.baseURL}/error`;throw e.redirect(`${a}?error=please_restart_the_process`)}return n&&await Sy(n),n}const Lp={scope:"server"},vR="127.0.0.1";function tk(e,t){if(t.advanced?.ipAddress?.disableIpTracking)return null;const r="headers"in e?e.headers:e,i=t.advanced?.ipAddress?.ipAddressHeaders||["x-forwarded-for"];for(const n of i){const o="get"in r?r.get(n):r[n];if(typeof o=="string"){const a=o.split(",")[0].trim();if(N0(a))return I0(a,{ipv6Subnet:t.advanced?.ipAddress?.ipv6Subnet})}}return _s()||Tp()?vR:null}function bR(e){try{return(new URL(e).pathname.replace(/\/+$/,"")||"/")!=="/"}catch{throw new Y(`Invalid base URL: ${e}. Please provide a valid base URL.`)}}function _R(e){try{const t=new URL(e);if(t.protocol!=="http:"&&t.protocol!=="https:")throw new Y(`Invalid base URL: ${e}. URL must include 'http://' or 'https://'`)}catch(t){throw t instanceof Y?t:new Y(`Invalid base URL: ${e}. Please provide a valid base URL.`,{cause:t})}}function jo(e,t="/api/auth"){if(_R(e),bR(e))return e;const r=e.replace(/\/+$/,"");return!t||t==="/"?r:(t=t.startsWith("/")?t:`/${t}`,`${r}${t}`)}function wg(e,t){return!e||e.trim()===""?!1:t==="proto"?e==="http"||e==="https":t==="host"?[/\.\./,/\0/,/[\s]/,/^[.]/,/[<>'"]/,/javascript:/i,/file:/i,/data:/i].some(r=>r.test(e))?!1:/^[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?$/.test(e)||/^(\d{1,3}\.){3}\d{1,3}(:[0-9]{1,5})?$/.test(e)||/^\[[0-9a-fA-F:]+\](:[0-9]{1,5})?$/.test(e)||/^localhost(:[0-9]{1,5})?$/i.test(e):!1}function zp(e,t,r,i,n){if(e)return jo(e,t);{const s=Se.BETTER_AUTH_URL||Se.NEXT_PUBLIC_BETTER_AUTH_URL||Se.PUBLIC_BETTER_AUTH_URL||Se.NUXT_PUBLIC_BETTER_AUTH_URL||Se.NUXT_PUBLIC_AUTH_URL||(Se.BASE_URL!=="/"?Se.BASE_URL:void 0);if(s)return jo(s,t)}const o=r?.headers.get("x-forwarded-host"),a=r?.headers.get("x-forwarded-proto");if(o&&a&&n&&wg(a,"proto")&&wg(o,"host"))try{return jo(`${a}://${o}`,t)}catch{}if(r){const s=vc(r.url);if(!s)throw new Y("Could not get origin from request. Please provide a valid base URL.");return jo(s,t)}if(typeof window<"u"&&window.location)return jo(window.location.origin,t)}function vc(e){try{const t=new URL(e);return t.origin==="null"?null:t.origin}catch{return null}}function SR(e){try{return new URL(e).protocol}catch{return null}}function kR(e){try{return new URL(e).host}catch{return null}}function Cl(e){return e==="-"||e==="^"||e==="$"||e==="+"||e==="."||e==="("||e===")"||e==="|"||e==="["||e==="]"||e==="{"||e==="}"||e==="*"||e==="?"||e==="\\"?`\\${e}`:e}function NR(e){let t="";for(let r=0;r<e.length;r++)t+=Cl(e[r]);return t}function rk(e,t=!0){if(Array.isArray(e))return`(?:${e.map(u=>`^${rk(u,t)}$`).join("|")})`;let r="",i="",n=".";t===!0?(r="/",i="[/\\\\]",n="[^/\\\\]"):t&&(r=t,i=NR(r),i.length>1?(i=`(?:${i})`,n=`((?!${i}).)`):n=`[^${i}]`);const o=t?`${i}+?`:"",a=t?`${i}*?`:"",s=t?e.split(r):[e];let c="";for(let u=0;u<s.length;u++){const d=s[u],l=s[u+1];let f="";if(!(!d&&u>0)){if(t&&(u===s.length-1?f=a:l!=="**"?f=o:f=""),t&&d==="**"){f&&(c+=u===0?"":f,c+=`(?:${n}*?${f})*?`);continue}for(let h=0;h<d.length;h++){const g=d[h];g==="\\"?h<d.length-1&&(c+=Cl(d[h+1]),h++):g==="?"?c+=n:g==="*"?c+=`${n}*?`:c+=Cl(g)}c+=f}}return c}function $R(e,t){if(typeof t!="string")throw new TypeError(`Sample must be a string, but ${typeof t} given`);return e.test(t)}function Pl(e,t){if(typeof e!="string"&&!Array.isArray(e))throw new TypeError(`The first argument must be a single pattern string or an array of patterns, but ${typeof e} given`);if((typeof t=="string"||typeof t=="boolean")&&(t={separator:t}),arguments.length===2&&!(typeof t>"u"||typeof t=="object"&&t!==null&&!Array.isArray(t)))throw new TypeError(`The second argument must be an options object or a string/boolean separator, but ${typeof t} given`);if(t=t||{},t.separator==="\\")throw new Error("\\ is not a valid separator because it is used for escaping. Try setting the separator to `true` instead");const r=rk(e,t.separator),i=new RegExp(`^${r}$`,t.flags),n=$R.bind(null,i);return n.options=t,n.pattern=e,n.regexp=i,n}const nk=(e,t,r)=>{if(e.startsWith("/"))return r?.allowRelativePaths?e.startsWith("/")&&/^\/(?!\/|\\|%2f|%5c)[\w\-.\+/@]*(?:\?[\w\-.\+/=&%@]*)?$/.test(e):!1;if(t.includes("*")||t.includes("?")){if(t.includes("://"))return Pl(t)(vc(e)||e);const n=kR(e);return n?Pl(t)(n):!1}const i=SR(e);return i==="http:"||i==="https:"||!i?t===vc(e):e.startsWith(t)},ik=zi(async()=>({})),ln=zi.create({use:[ik,zi(async()=>({}))]}),vg=[ik];function me(e,t,r){const i=typeof e=="string"?e:void 0,n=typeof t=="object"?t:e,o=typeof t=="function"?t:r;return i?va(i,{...n,use:[...n?.use||[],...vg]},async a=>tc(a,()=>o(a))):va({...n,use:[...n?.use||[],...vg]},async a=>tc(a,()=>o(a)))}function ok(e){return e.context.skipOriginCheck&&e.context.options.advanced?.disableCSRFCheck===void 0}const ER=nw(function(){},"disableOriginCheck: true currently also disables CSRF checks. In a future version, disableOriginCheck will ONLY disable URL validation. To keep CSRF disabled, add disableCSRFCheck: true to your config."),AR=ln(async e=>{if(e.request?.method==="GET"||e.request?.method==="OPTIONS"||e.request?.method==="HEAD"||!e.request||(await Ll(e),e.context.skipOriginCheck))return;const{body:t,query:r}=e,i=t?.callbackURL||r?.callbackURL,n=t?.redirectTo,o=t?.errorCallbackURL,a=t?.newUserCallbackURL,s=(c,u)=>{if(c&&!e.context.isTrustedOrigin(c,{allowRelativePaths:u!=="origin"}))throw e.context.logger.error(`Invalid ${u}: ${c}`),e.context.logger.info(`If it's a valid URL, please add ${c} to trustedOrigins in your auth config
`,`Current list of trustedOrigins: ${e.context.trustedOrigins}`),new D("FORBIDDEN",{message:`Invalid ${u}`})};i&&s(i,"callbackURL"),n&&s(n,"redirectURL"),o&&s(o,"errorCallbackURL"),a&&s(a,"newUserCallbackURL")}),jp=e=>ln(async t=>{if(!t.request||t.context.skipOriginCheck)return;const r=e(t),i=(o,a)=>{if(o&&!t.context.isTrustedOrigin(o,{allowRelativePaths:a!=="origin"}))throw t.context.logger.error(`Invalid ${a}: ${o}`),t.context.logger.info(`If it's a valid URL, please add ${o} to trustedOrigins in your auth config
`,`Current list of trustedOrigins: ${t.context.trustedOrigins}`),new D("FORBIDDEN",{message:`Invalid ${a}`})},n=Array.isArray(r)?r:[r];for(const o of n)i(o,"callbackURL")});async function Ll(e,t=!1){const r=e.request?.headers;if(!r||!e.request)return;const i=r.get("origin")||r.get("referer")||"",n=r.has("cookie");if(e.context.skipCSRFCheck)return;if(ok(e)){e.context.options.advanced?.disableOriginCheck===!0&&ER();return}if(!(t||n))return;if(!i||i==="null")throw new D("FORBIDDEN",{message:G.MISSING_OR_NULL_ORIGIN});const o=Array.isArray(e.context.options.trustedOrigins)?e.context.trustedOrigins:[...e.context.trustedOrigins,...(await e.context.options.trustedOrigins?.(e.request))?.filter(a=>!!a)||[]];if(!o.some(a=>nk(i,a)))throw e.context.logger.error(`Invalid origin: ${i}`),e.context.logger.info(`If it's a valid URL, please add ${i} to trustedOrigins in your auth config
`,`Current list of trustedOrigins: ${o}`),new D("FORBIDDEN",{message:"Invalid origin"})}const ak=ln(async e=>{e.request&&await IR(e)});async function IR(e){const t=e.request;if(!t||e.context.skipCSRFCheck||ok(e))return;const r=t.headers;if(r.has("cookie"))return await Ll(e);const i=r.get("Sec-Fetch-Site"),n=r.get("Sec-Fetch-Mode"),o=r.get("Sec-Fetch-Dest");if(i&&i.trim()||n&&n.trim()||o&&o.trim()){if(i==="cross-site"&&n==="navigate")throw e.context.logger.error("Blocked cross-site navigation login attempt (CSRF protection)",{secFetchSite:i,secFetchMode:n,secFetchDest:o}),new D("FORBIDDEN",{message:G.CROSS_SITE_NAVIGATION_LOGIN_BLOCKED});return await Ll(e,!0)}}function TR(e,t,r){const i=Date.now(),n=t*1e3;return i-r.lastRequest<n&&r.count>=e}function xR(e){return new Response(JSON.stringify({message:"Too many requests. Please try again later."}),{status:429,statusText:"Too Many Requests",headers:{"X-Retry-After":e.toString()}})}function OR(e,t){const r=Date.now(),i=t*1e3;return Math.ceil((e+i-r)/1e3)}function DR(e){const t="rateLimit",r=e.adapter;return{get:async i=>{const n=(await r.findMany({model:t,where:[{field:"key",value:i}]}))[0];return typeof n?.lastRequest=="bigint"&&(n.lastRequest=Number(n.lastRequest)),n},set:async(i,n,o)=>{try{o?await r.updateMany({model:t,where:[{field:"key",value:i}],update:{count:n.count,lastRequest:n.lastRequest}}):await r.create({model:t,data:{key:i,count:n.count,lastRequest:n.lastRequest}})}catch(a){e.logger.error("Error setting rate limit",a)}}}}const Hd=new Map;function RR(e,t){if(e.options.rateLimit?.customStorage)return e.options.rateLimit.customStorage;const r=e.rateLimit.storage;return r==="secondary-storage"?{get:async i=>{const n=await e.options.secondaryStorage?.get(i);return n?it(n):void 0},set:async(i,n,o)=>{const a=t?.window??e.options.rateLimit?.window??10;await e.options.secondaryStorage?.set?.(i,JSON.stringify(n),a)}}:r==="memory"?{async get(i){const n=Hd.get(i);if(n){if(Date.now()>=n.expiresAt){Hd.delete(i);return}return n.data}},async set(i,n,o){const a=t?.window??e.options.rateLimit?.window??10,s=Date.now()+a*1e3;Hd.set(i,{data:n,expiresAt:s})}}:DR(e)}async function UR(e,t){if(!t.rateLimit.enabled)return;const r=new URL(e.url).pathname.replace(t.options.basePath||"/api/auth","").replace(/\/+$/,"");let i=t.rateLimit.window,n=t.rateLimit.max;const o=tk(e,t.options);if(!o)return;const a=T0(o,r),s=CR().find(l=>l.pathMatcher(r));s&&(i=s.window,n=s.max);for(const l of t.options.plugins||[])if(l.rateLimit){const f=l.rateLimit.find(h=>h.pathMatcher(r));if(f){i=f.window,n=f.max;break}}if(t.rateLimit.customRules){const l=Object.keys(t.rateLimit.customRules).find(f=>f.includes("*")?Pl(f)(r):f===r);if(l){const f=t.rateLimit.customRules[l],h=typeof f=="function"?await f(e):f;if(h&&(i=h.window,n=h.max),h===!1)return}}const c=RR(t,{window:i}),u=await c.get(a),d=Date.now();if(!u)await c.set(a,{key:a,count:1,lastRequest:d});else{const l=d-u.lastRequest;if(TR(n,i,u))return xR(OR(u.lastRequest,i));l>i*1e3?await c.set(a,{...u,count:1,lastRequest:d},!0):await c.set(a,{...u,count:u.count+1,lastRequest:d},!0)}}function CR(){return[{pathMatcher(e){return e.startsWith("/sign-in")||e.startsWith("/sign-up")||e.startsWith("/change-password")||e.startsWith("/change-email")},window:10,max:3}]}var sk=Object.defineProperty,PR=Object.getOwnPropertyDescriptor,LR=Object.getOwnPropertyNames,zR=Object.prototype.hasOwnProperty,jR=(e,t)=>{let r={};for(var i in e)sk(r,i,{get:e[i],enumerable:!0});return r},MR=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(var n=LR(t),o=0,a=n.length,s;o<a;o++)s=n[o],!zR.call(e,s)&&s!==r&&sk(e,s,{get:(c=>t[c]).bind(null,s),enumerable:!(i=PR(t,s))||i.enumerable});return e},qR=(e,t,r,i)=>{MR(e,t,"default")};async function ck(e,t){let r;if(e.database)typeof e.database=="function"?r=e.database(e):r=await t(e);else{const i=Cn(e),n=Object.keys(i).reduce((a,s)=>(a[s]=[],a),{}),{memoryAdapter:o}=await Wi(async()=>{const{memoryAdapter:a}=await import("./index-BsuW_iby.js");return{memoryAdapter:a}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]),import.meta.url);r=o(n)(e)}return r.transaction||(ie.warn("Adapter does not correctly implement transaction function, patching it automatically. Please update your adapter implementation."),r.transaction=async i=>i(r)),r}async function uk(e){return ck(e,async t=>{const{createKyselyAdapter:r}=await Wi(async()=>{const{createKyselyAdapter:s}=await import("./index-BmDXe60s.js");return{createKyselyAdapter:s}},__vite__mapDeps([12,1,2,3,4,5,6,7,8,9,10,11]),import.meta.url),{kysely:i,databaseType:n,transaction:o}=await r(t);if(!i)throw new Y("Failed to initialize database adapter");const{kyselyAdapter:a}=await Wi(async()=>{const{kyselyAdapter:s}=await import("./index-BmDXe60s.js");return{kyselyAdapter:s}},__vite__mapDeps([12,1,2,3,4,5,6,7,8,9,10,11]),import.meta.url);return a(i,{type:n||"sqlite",debugLogs:t.database&&"debugLogs"in t.database?t.database.debugLogs:!1,transaction:o})(t)})}const WR=(e,t)=>({type:e,...t});function FR(e,t){const r=t.id?{id:t.id}:{};for(const i in e){const n=e[i],o=t[i];o!==void 0&&(r[n.fieldName||i]=o)}return r}function BR(e,t){if(!t)return null;const r={id:t.id};for(const[i,n]of Object.entries(e))r[i]=t[n.fieldName||i];return r}function dk(e,t){const r=t.hooks;async function i(c,u,d){const l=await xi().catch(()=>null);let f=c;for(const m of r||[]){const v=m[u]?.create?.before;if(v){const b=await v(f,l);if(b===!1)return null;typeof b=="object"&&"data"in b&&(f={...f,...b.data})}}const h=d?await d.fn(f):null,g=!d||d.executeMainFn?await(await je(e)).create({model:u,data:f,forceAllowId:!0}):h;for(const m of r||[]){const v=m[u]?.create?.after;v&&await v(g,l)}return g}async function n(c,u,d,l){const f=await xi().catch(()=>null);let h=c;for(const v of r||[]){const b=v[d]?.update?.before;if(b){const I=await b(c,f);if(I===!1)return null;typeof I=="object"&&"data"in I&&(h={...h,...I.data})}}const g=l?await l.fn(h):null,m=!l||l.executeMainFn?await(await je(e)).update({model:d,update:h,where:u}):g;for(const v of r||[]){const b=v[d]?.update?.after;b&&await b(m,f)}return m}async function o(c,u,d,l){const f=await xi().catch(()=>null);let h=c;for(const v of r||[]){const b=v[d]?.update?.before;if(b){const I=await b(c,f);if(I===!1)return null;typeof I=="object"&&"data"in I&&(h={...h,...I.data})}}const g=l?await l.fn(h):null,m=!l||l.executeMainFn?await(await je(e)).updateMany({model:d,update:h,where:u}):g;for(const v of r||[]){const b=v[d]?.update?.after;b&&await b(m,f)}return m}async function a(c,u,d){const l=await xi().catch(()=>null);let f=null;try{f=(await(await je(e)).findMany({model:u,where:c,limit:1}))[0]||null}catch{}if(f)for(const m of r||[]){const v=m[u]?.delete?.before;if(v&&await v(f,l)===!1)return null}const h=d?await d.fn(c):null,g=!d||d.executeMainFn?await(await je(e)).delete({model:u,where:c}):h;if(f)for(const m of r||[]){const v=m[u]?.delete?.after;v&&await v(f,l)}return g}async function s(c,u,d){const l=await xi().catch(()=>null);let f=[];try{f=await(await je(e)).findMany({model:u,where:c})}catch{}for(const m of f)for(const v of r||[]){const b=v[u]?.delete?.before;if(b&&await b(m,l)===!1)return null}const h=d?await d.fn(c):null,g=!d||d.executeMainFn?await(await je(e)).deleteMany({model:u,where:c}):h;for(const m of f)for(const v of r||[]){const b=v[u]?.delete?.after;b&&await b(m,l)}return g}return{createWithHooks:i,updateWithHooks:n,updateManyWithHooks:o,deleteWithHooks:a,deleteManyWithHooks:s}}const Mp=(e,t)=>{const r=t.logger,i=t.options,n=i.secondaryStorage,o=i.session?.expiresIn||3600*24*7,{createWithHooks:a,updateWithHooks:s,updateManyWithHooks:c,deleteWithHooks:u,deleteManyWithHooks:d}=dk(e,t);async function l(f){if(!n)return;const h=await n.get(`active-sessions-${f.id}`);if(!h)return;const g=Date.now(),m=(it(h)||[]).filter(v=>v.expiresAt>g);await Promise.all(m.map(async({token:v})=>{const b=await n.get(v);if(!b)return;const I=it(b);if(!I)return;const x=Math.max(Math.floor(new Date(I.session.expiresAt).getTime()-g)/1e3,0);await n.set(v,JSON.stringify({session:I.session,user:f}),Math.floor(x))}))}return{createOAuthUser:async(f,h)=>_y(e,async()=>{const g=await a({createdAt:new Date,updatedAt:new Date,...f},"user",void 0);return{user:g,account:await a({...h,userId:g.id,createdAt:new Date,updatedAt:new Date},"account",void 0)}}),createUser:async f=>await a({createdAt:new Date,updatedAt:new Date,...f,email:f.email?.toLowerCase()},"user",void 0),createAccount:async f=>await a({createdAt:new Date,updatedAt:new Date,...f},"account",void 0),listSessions:async f=>{if(n){const h=await n.get(`active-sessions-${f}`);if(!h)return[];const g=it(h)||[],m=Date.now(),v=new Set,b=[];for(const{token:I,expiresAt:x}of g){if(x<=m||v.has(I))continue;v.add(I);const N=await n.get(I);if(!N)continue;const y=it(N);y&&b.push(Xt(t.options,{...y.session,expiresAt:new Date(y.session.expiresAt)}))}return b}return await(await je(e)).findMany({model:"session",where:[{field:"userId",value:f}]})},listUsers:async(f,h,g,m)=>await(await je(e)).findMany({model:"user",limit:f,offset:h,sortBy:g,where:m}),countTotalUsers:async f=>{const h=await(await je(e)).count({model:"user",where:f});return typeof h=="string"?parseInt(h):h},deleteUser:async f=>{(!n||i.session?.storeSessionInDatabase)&&await d([{field:"userId",value:f}],"session",void 0),await d([{field:"userId",value:f}],"account",void 0),await u([{field:"id",value:f}],"user",void 0)},createSession:async(f,h,g,m)=>{const v=await xi().catch(()=>null),b=v?.headers||v?.request?.headers,{id:I,...x}=g||{},N=KS(v?.context.options??i,{}),y={ipAddress:(v?.request||v?.headers)&&tk(v?.request||v?.headers,v?.context.options)||"",userAgent:b?.get("user-agent")||"",...x,expiresAt:no(h?3600*24:o,"sec"),userId:f,token:pa(32),createdAt:new Date,updatedAt:new Date,...N,...m?x:{}};return await a(y,"session",n?{fn:async w=>{const _=await n.get(`active-sessions-${f}`);let S=[];const E=Date.now();_&&(S=it(_)||[],S=S.filter(O=>O.expiresAt>E&&O.token!==y.token));const k=[...S,{token:y.token,expiresAt:y.expiresAt.getTime()}].sort((O,R)=>O.expiresAt-R.expiresAt),U=k.at(-1)?.expiresAt??y.expiresAt.getTime(),P=Math.max(Math.floor((U-E)/1e3),0);P>0&&await n.set(`active-sessions-${f}`,JSON.stringify(k),P);const T=await e.findOne({model:"user",where:[{field:"id",value:f}]}),A=Math.max(Math.floor((y.expiresAt.getTime()-E)/1e3),0);return A>0&&await n.set(y.token,JSON.stringify({session:w,user:T}),A),w},executeMainFn:i.session?.storeSessionInDatabase}:void 0)},findSession:async f=>{if(n){const v=await n.get(f);if(!v&&!i.session?.storeSessionInDatabase)return null;if(v){const b=it(v);return b?{session:Xt(t.options,{...b.session,expiresAt:new Date(b.session.expiresAt),createdAt:new Date(b.session.createdAt),updatedAt:new Date(b.session.updatedAt)}),user:ht(t.options,{...b.user,createdAt:new Date(b.user.createdAt),updatedAt:new Date(b.user.updatedAt)})}:null}}const h=await(await je(e)).findOne({model:"session",where:[{value:f,field:"token"}],join:{user:!0}});if(!h)return null;const{user:g,...m}=h;return g?{session:Xt(t.options,m),user:ht(t.options,g)}:null},findSessions:async f=>{if(n){const g=[];for(const m of f){const v=await n.get(m);if(v){const b=it(v);if(!b)return[];const I={session:{...b.session,expiresAt:new Date(b.session.expiresAt)},user:{...b.user,createdAt:new Date(b.user.createdAt),updatedAt:new Date(b.user.updatedAt)}};g.push(I)}}return g}const h=await(await je(e)).findMany({model:"session",where:[{field:"token",value:f,operator:"in"}],join:{user:!0}});return h.length?h.some(g=>!g.user)?[]:h.map(g=>{const{user:m,...v}=g;return{session:v,user:m}}):[]},updateSession:async(f,h)=>await s(h,[{field:"token",value:f}],"session",n?{async fn(g){const m=await n.get(f);if(!m)return null;const v=it(m);if(!v)return null;const b={...v.session,...g,expiresAt:new Date(g.expiresAt??v.session.expiresAt),createdAt:new Date(v.session.createdAt),updatedAt:new Date(g.updatedAt??v.session.updatedAt)},I=Xt(t.options,b),x=Date.now(),N=new Date(I.expiresAt).getTime(),y=Math.max(Math.floor((N-x)/1e3),0);if(y>0){await n.set(f,JSON.stringify({session:I,user:v.user}),y);const w=`active-sessions-${I.userId}`,_=await n.get(w),S=(_?it(_)||[]:[]).filter(k=>k.token!==f&&k.expiresAt>x).concat([{token:f,expiresAt:N}]).sort((k,U)=>k.expiresAt-U.expiresAt),E=S.at(-1)?.expiresAt;E&&E>x?await n.set(w,JSON.stringify(S),Math.floor((E-x)/1e3)):await n.delete(w)}return I},executeMainFn:i.session?.storeSessionInDatabase}:void 0),deleteSession:async f=>{if(n){const h=await n.get(f);if(h){const{session:g}=it(h)??{};if(!g){r.error("Session not found in secondary storage");return}const m=g.userId,v=await n.get(`active-sessions-${m}`);if(v){const b=it(v)||[],I=Date.now(),x=b.filter(y=>y.expiresAt>I&&y.token!==f),N=x.sort((y,w)=>y.expiresAt-w.expiresAt).at(-1)?.expiresAt;x.length>0&&N&&N>Date.now()?await n.set(`active-sessions-${m}`,JSON.stringify(x),Math.floor((N-I)/1e3)):await n.delete(`active-sessions-${m}`)}else r.error("Active sessions list not found in secondary storage")}if(await n.delete(f),!i.session?.storeSessionInDatabase||t.options.session?.preserveSessionInDatabase)return}await u([{field:"token",value:f}],"session",void 0)},deleteAccounts:async f=>{await d([{field:"userId",value:f}],"account",void 0)},deleteAccount:async f=>{await u([{field:"id",value:f}],"account",void 0)},deleteSessions:async f=>{if(n){if(typeof f=="string"){const h=await n.get(`active-sessions-${f}`),g=h?it(h):[];if(!g)return;for(const m of g)await n.delete(m.token);await n.delete(`active-sessions-${f}`)}else for(const h of f)await n.get(h)&&await n.delete(h);if(!i.session?.storeSessionInDatabase||t.options.session?.preserveSessionInDatabase)return}await d([{field:Array.isArray(f)?"token":"userId",value:f,operator:Array.isArray(f)?"in":void 0}],"session",void 0)},findOAuthUser:async(f,h,g)=>{const m=await(await je(e)).findOne({model:"account",where:[{value:h,field:"accountId"},{value:g,field:"providerId"}],join:{user:!0}});if(m){if(m.user)return{user:m.user,linkedAccount:m,accounts:[m]};{const v=await(await je(e)).findOne({model:"user",where:[{value:f.toLowerCase(),field:"email"}]});return v?{user:v,linkedAccount:m,accounts:[m]}:null}}else{const v=await(await je(e)).findOne({model:"user",where:[{value:f.toLowerCase(),field:"email"}]});return v?{user:v,linkedAccount:null,accounts:await(await je(e)).findMany({model:"account",where:[{value:v.id,field:"userId"}]})||[]}:null}},findUserByEmail:async(f,h)=>{const g=await(await je(e)).findOne({model:"user",where:[{value:f.toLowerCase(),field:"email"}],join:{...h?.includeAccounts?{account:!0}:{}}});if(!g)return null;const{account:m,...v}=g;return{user:v,accounts:m??[]}},findUserById:async f=>f?await(await je(e)).findOne({model:"user",where:[{field:"id",value:f}]}):null,linkAccount:async f=>await a({createdAt:new Date,updatedAt:new Date,...f},"account",void 0),updateUser:async(f,h)=>{const g=await s(h,[{field:"id",value:f}],"user",void 0);return await l(g),g},updateUserByEmail:async(f,h)=>{const g=await s(h,[{field:"email",value:f.toLowerCase()}],"user",void 0);return await l(g),g},updatePassword:async(f,h)=>{await c({password:h},[{field:"userId",value:f},{field:"providerId",value:"credential"}],"account",void 0)},findAccounts:async f=>await(await je(e)).findMany({model:"account",where:[{field:"userId",value:f}]}),findAccount:async f=>await(await je(e)).findOne({model:"account",where:[{field:"accountId",value:f}]}),findAccountByProviderId:async(f,h)=>await(await je(e)).findOne({model:"account",where:[{field:"accountId",value:f},{field:"providerId",value:h}]}),findAccountByUserId:async f=>await(await je(e)).findMany({model:"account",where:[{field:"userId",value:f}]}),updateAccount:async(f,h)=>await s(h,[{field:"id",value:f}],"account",void 0),createVerificationValue:async f=>await a({createdAt:new Date,updatedAt:new Date,...f},"verification",void 0),findVerificationValue:async f=>{const h=await(await je(e)).findMany({model:"verification",where:[{field:"identifier",value:f}],sortBy:{field:"createdAt",direction:"desc"},limit:1});return i.verification?.disableCleanup||await d([{field:"expiresAt",value:new Date,operator:"lt"}],"verification",void 0),h[0]},deleteVerificationValue:async f=>{await u([{field:"id",value:f}],"verification",void 0)},deleteVerificationByIdentifier:async f=>{await u([{field:"identifier",value:f}],"verification",void 0)},updateVerificationValue:async(f,h)=>await s(h,[{field:"id",value:f}],"verification",void 0)}};function VR({fields:e,isClientSide:t}){const r=Object.keys(e).reduce((i,n)=>{const o=e[n];if(!o||t&&o.input===!1)return i;let a;return o.type==="json"?a=ya?ya():rn():o.type==="string[]"||o.type==="number[]"?a=Ar(o.type==="string[]"?M():tn()):Array.isArray(o.type)?a=rn():a=k0[o.type](),o?.required===!1&&(a=a.optional()),!t&&o?.returned===!1?i:{...i,[n]:a}},{});return le(r)}function lk(e){const t=(0,uN.getAuthTables)(e),r={};for(const i in t){const n=t[i],o=n.fields,a={};if(Object.entries(o).forEach(([s,c])=>{if(a[c.fieldName||s]=c,c.references){const u=t[c.references.model];u&&(a[c.fieldName||s].references={...c.references,model:u.modelName,field:c.references.field})}}),r[n.modelName]){r[n.modelName].fields={...r[n.modelName].fields,...a};continue}r[n.modelName]={fields:a,order:n.order||1/0}}return r}function Hr(e){return typeof e>"u"||e===void 0}function mt(e){return typeof e=="string"}function io(e){return typeof e=="number"}function _a(e){return typeof e=="boolean"}function id(e){return e===null}function fk(e){return e instanceof Date}function od(e){return typeof e=="bigint"}function KR(e){return typeof Buffer<"u"&&Buffer.isBuffer(e)}function St(e){return typeof e=="function"}function zt(e){return typeof e=="object"&&e!==null}function p(e){return Object.freeze(e)}function Ls(e){return sn(e)?e:[e]}function sn(e){return Array.isArray(e)}function Lt(e){return e}const ye=p({is(e){return e.kind==="AlterTableNode"},create(e){return p({kind:"AlterTableNode",table:e})},cloneWithTableProps(e,t){return p({...e,...t})},cloneWithColumnAlteration(e,t){return p({...e,columnAlterations:e.columnAlterations?[...e.columnAlterations,t]:[t]})}}),ve=p({is(e){return e.kind==="IdentifierNode"},create(e){return p({kind:"IdentifierNode",name:e})}}),jr=p({is(e){return e.kind==="CreateIndexNode"},create(e){return p({kind:"CreateIndexNode",name:ve.create(e)})},cloneWith(e,t){return p({...e,...t})},cloneWithColumns(e,t){return p({...e,columns:[...e.columns||[],...t]})}}),hk=p({is(e){return e.kind==="CreateSchemaNode"},create(e,t){return p({kind:"CreateSchemaNode",schema:ve.create(e),...t})},cloneWith(e,t){return p({...e,...t})}}),JR=["preserve rows","delete rows","drop"],Ot=p({is(e){return e.kind==="CreateTableNode"},create(e){return p({kind:"CreateTableNode",table:e,columns:p([])})},cloneWithColumn(e,t){return p({...e,columns:p([...e.columns,t])})},cloneWithConstraint(e,t){return p({...e,constraints:e.constraints?p([...e.constraints,t]):p([t])})},cloneWithFrontModifier(e,t){return p({...e,frontModifiers:e.frontModifiers?p([...e.frontModifiers,t]):p([t])})},cloneWithEndModifier(e,t){return p({...e,endModifiers:e.endModifiers?p([...e.endModifiers,t]):p([t])})},cloneWith(e,t){return p({...e,...t})}}),cn=p({is(e){return e.kind==="SchemableIdentifierNode"},create(e){return p({kind:"SchemableIdentifierNode",identifier:ve.create(e)})},createWithSchema(e,t){return p({kind:"SchemableIdentifierNode",schema:ve.create(e),identifier:ve.create(t)})}}),Yo=p({is(e){return e.kind==="DropIndexNode"},create(e,t){return p({kind:"DropIndexNode",name:cn.create(e),...t})},cloneWith(e,t){return p({...e,...t})}}),zl=p({is(e){return e.kind==="DropSchemaNode"},create(e,t){return p({kind:"DropSchemaNode",schema:ve.create(e),...t})},cloneWith(e,t){return p({...e,...t})}}),jl=p({is(e){return e.kind==="DropTableNode"},create(e,t){return p({kind:"DropTableNode",table:e,...t})},cloneWith(e,t){return p({...e,...t})}}),fn=p({is(e){return e.kind==="AliasNode"},create(e,t){return p({kind:"AliasNode",node:e,alias:t})}}),Vr=p({is(e){return e.kind==="TableNode"},create(e){return p({kind:"TableNode",table:cn.create(e)})},createWithSchema(e,t){return p({kind:"TableNode",table:cn.createWithSchema(e,t)})}});function At(e){return zt(e)&&St(e.toOperationNode)}function pk(e){return zt(e)&&"expressionType"in e&&At(e)}function HR(e){return zt(e)&&"expression"in e&&mt(e.alias)&&At(e)}const zr=p({is(e){return e.kind==="SelectModifierNode"},create(e,t){return p({kind:"SelectModifierNode",modifier:e,of:t})},createWithExpression(e){return p({kind:"SelectModifierNode",rawModifier:e})}}),Pn=p({is(e){return e.kind==="AndNode"},create(e,t){return p({kind:"AndNode",left:e,right:t})}}),Eo=p({is(e){return e.kind==="OrNode"},create(e,t){return p({kind:"OrNode",left:e,right:t})}}),Zd=p({is(e){return e.kind==="OnNode"},create(e){return p({kind:"OnNode",on:e})},cloneWithOperation(e,t,r){return p({...e,on:t==="And"?Pn.create(e.on,r):Eo.create(e.on,r)})}}),ai=p({is(e){return e.kind==="JoinNode"},create(e,t){return p({kind:"JoinNode",joinType:e,table:t,on:void 0})},createWithOn(e,t,r){return p({kind:"JoinNode",joinType:e,table:t,on:Zd.create(r)})},cloneWithOn(e,t){return p({...e,on:e.on?Zd.cloneWithOperation(e.on,"And",t):Zd.create(t)})}}),oo=p({is(e){return e.kind==="BinaryOperationNode"},create(e,t,r){return p({kind:"BinaryOperationNode",leftOperand:e,operator:t,rightOperand:r})}}),ZR=["=","==","!=","<>",">",">=","<","<=","in","not in","is","is not","like","not like","match","ilike","not ilike","@>","<@","^@","&&","?","?&","?|","!<","!>","<=>","!~","~","~*","!~*","@@","@@@","!!","<->","regexp","is distinct from","is not distinct from"],GR=["+","-","*","/","%","^","&","|","#","<<",">>"],mk=["->","->>"],QR=[...ZR,...GR,"&&","||"],YR=["exists","not exists"],XR=["not","-",...YR],eU=[...QR,...mk,...XR,"between","between symmetric"],Ln=p({is(e){return e.kind==="OperatorNode"},create(e){return p({kind:"OperatorNode",operator:e})}});function bg(e){return mt(e)&&mk.includes(e)}const Ke=p({is(e){return e.kind==="ColumnNode"},create(e){return p({kind:"ColumnNode",column:ve.create(e)})}}),qp=p({is(e){return e.kind==="SelectAllNode"},create(){return p({kind:"SelectAllNode"})}}),ad=p({is(e){return e.kind==="ReferenceNode"},create(e,t){return p({kind:"ReferenceNode",table:t,column:e})},createSelectAll(e){return p({kind:"ReferenceNode",table:e,column:qp.create()})}});class tU{#e;get dynamicReference(){return this.#e}get refType(){}constructor(t){this.#e=t}toOperationNode(){return bk(this.#e)}}function gk(e){return zt(e)&&At(e)&&mt(e.dynamicReference)}const Br=p({is(e){return e.kind==="OrderByItemNode"},create(e,t){return p({kind:"OrderByItemNode",orderBy:e,direction:t})},cloneWith(e,t){return p({...e,...t})}}),Le=p({is(e){return e.kind==="RawNode"},create(e,t){return p({kind:"RawNode",sqlFragments:p(e),parameters:p(t)})},createWithSql(e){return Le.create([e],[])},createWithChild(e){return Le.create(["",""],[e])},createWithChildren(e){return Le.create(new Array(e.length+1).fill(""),e)}}),rU={is(e){return e.kind==="CollateNode"},create(e){return p({kind:"CollateNode",collation:ve.create(e)})}};class Zn{#e;constructor(t){this.#e=p(t)}desc(){return new Zn({node:Br.cloneWith(this.#e.node,{direction:Le.createWithSql("desc")})})}asc(){return new Zn({node:Br.cloneWith(this.#e.node,{direction:Le.createWithSql("asc")})})}nullsLast(){return new Zn({node:Br.cloneWith(this.#e.node,{nulls:"last"})})}nullsFirst(){return new Zn({node:Br.cloneWith(this.#e.node,{nulls:"first"})})}collate(t){return new Zn({node:Br.cloneWith(this.#e.node,{collation:rU.create(t)})})}toOperationNode(){return this.#e.node}}const _g=new Set;function Ao(e){_g.has(e)||(_g.add(e),console.log(e))}function yk(e){return e==="asc"||e==="desc"}function fi(e){if(e.length===2)return[Gd(e[0],e[1])];if(e.length===1){const[t]=e;return Array.isArray(t)?(Ao("orderBy(array) is deprecated, use multiple orderBy calls instead."),t.map(r=>Gd(r))):[Gd(t)]}throw new Error(`Invalid number of arguments at order by! expected 1-2, received ${e.length}`)}function Gd(e,t){const r=nU(e);if(Br.is(r)){if(t)throw new Error("Cannot specify direction twice!");return r}return wk(r,t)}function nU(e){if(Es(e))return _i(e);if(gk(e))return e.toOperationNode();const[t,r]=e.split(" ");return r?(Ao("`orderBy('column asc')` is deprecated. Use `orderBy('column', 'asc')` instead."),wk(un(t),r)):un(e)}function wk(e,t){if(typeof t=="string"){if(!yk(t))throw new Error(`Invalid order by direction: ${t}`);return Br.create(e,Le.createWithSql(t))}if(pk(t))return Ao("`orderBy(..., expr)` is deprecated. Use `orderBy(..., 'asc')` or `orderBy(..., (ob) => ...)` instead."),Br.create(e,t.toOperationNode());const r=Br.create(e);return t?t(new Zn({node:r})).toOperationNode():r}const bc=p({is(e){return e.kind==="JSONReferenceNode"},create(e,t){return p({kind:"JSONReferenceNode",reference:e,traversal:t})},cloneWithTraversal(e,t){return p({...e,traversal:t})}}),vk=p({is(e){return e.kind==="JSONOperatorChainNode"},create(e){return p({kind:"JSONOperatorChainNode",operator:e,values:p([])})},cloneWithValue(e,t){return p({...e,values:p([...e.values,t])})}}),Xo=p({is(e){return e.kind==="JSONPathNode"},create(e){return p({kind:"JSONPathNode",inOperator:e,pathLegs:p([])})},cloneWithLeg(e,t){return p({...e,pathLegs:p([...e.pathLegs,t])})}});function bk(e){return mt(e)?un(e):e.toOperationNode()}function Sa(e){return sn(e)?e.map(t=>jt(t)):[jt(e)]}function jt(e){return Es(e)?_i(e):bk(e)}function iU(e,t){const r=un(e);if(bg(t))return bc.create(r,vk.create(Ln.create(t)));const i=t.slice(0,-1);if(bg(i))return bc.create(r,Xo.create(Ln.create(i)));throw new Error(`Invalid JSON operator: ${t}`)}function un(e){if(!e.includes("."))return ad.create(Ke.create(e));const r=e.split(".").map(Wp);if(r.length===3)return aU(r);if(r.length===2)return sU(r);throw new Error(`invalid column reference ${e}`)}function oU(e){const t=" as ";if(e.includes(t)){const[r,i]=e.split(t).map(Wp);return fn.create(un(r),ve.create(i))}else return un(e)}function _k(e){return Ke.create(e)}function _c(e){if(e.includes(" ")){const[r,i]=e.split(" ").map(Wp);if(!yk(i))throw new Error(`invalid order direction "${i}" next to "${r}"`);return fi([r,i])[0]}else return _k(e)}function aU(e){const[t,r,i]=e;return ad.create(Ke.create(i),Vr.createWithSchema(t,r))}function sU(e){const[t,r]=e;return ad.create(Ke.create(r),Vr.create(t))}function Wp(e){return e.trim()}const Sk=p({is(e){return e.kind==="PrimitiveValueListNode"},create(e){return p({kind:"PrimitiveValueListNode",values:p([...e])})}}),sd=p({is(e){return e.kind==="ValueListNode"},create(e){return p({kind:"ValueListNode",values:p(e)})}}),ir=p({is(e){return e.kind==="ValueNode"},create(e){return p({kind:"ValueNode",value:e})},createImmediate(e){return p({kind:"ValueNode",value:e,immediate:!0})}});function cU(e){return sn(e)?uU(e):Ge(e)}function Ge(e){return Es(e)?_i(e):ir.create(e)}function Fp(e){return io(e)||_a(e)||id(e)}function Bp(e){if(!Fp(e))throw new Error(`unsafe immediate value ${JSON.stringify(e)}`);return ir.createImmediate(e)}function uU(e){return e.some(Es)?sd.create(e.map(t=>Ge(t))):Sk.create(e)}const Kr=p({is(e){return e.kind==="ParensNode"},create(e){return p({kind:"ParensNode",node:e})}});function gt(e){if(e.length===3)return Vp(e[0],e[1],e[2]);if(e.length===1)return Ge(e[0]);throw new Error(`invalid arguments: ${JSON.stringify(e)}`)}function Vp(e,t,r){return dU(t)&&kk(r)?oo.create(jt(e),Ml(t),ir.createImmediate(r)):oo.create(jt(e),Ml(t),cU(r))}function Tr(e,t,r){return oo.create(jt(e),Ml(t),jt(r))}function Sg(e,t){return Sc(Object.entries(e).filter(([,r])=>!Hr(r)).map(([r,i])=>Vp(r,kk(i)?"is":"=",i)),t)}function Sc(e,t,r=!0){const i=t==="and"?Pn.create:Eo.create;if(e.length===0)return oo.create(ir.createImmediate(1),Ln.create("="),ir.createImmediate(t==="and"?1:0));let n=kg(e[0]);for(let o=1;o<e.length;++o)n=i(n,kg(e[o]));return e.length>1&&r?Kr.create(n):n}function dU(e){return e==="is"||e==="is not"}function kk(e){return id(e)||_a(e)}function Ml(e){if(mt(e)&&eU.includes(e))return Ln.create(e);if(At(e))return e.toOperationNode();throw new Error(`invalid operator ${JSON.stringify(e)}`)}function kg(e){return At(e)?e.toOperationNode():e}const ao=p({is(e){return e.kind==="OrderByNode"},create(e){return p({kind:"OrderByNode",items:p([...e])})},cloneWithItems(e,t){return p({...e,items:p([...e.items,...t])})}}),Ng=p({is(e){return e.kind==="PartitionByNode"},create(e){return p({kind:"PartitionByNode",items:p(e)})},cloneWithItems(e,t){return p({...e,items:p([...e.items,...t])})}}),ql=p({is(e){return e.kind==="OverNode"},create(){return p({kind:"OverNode"})},cloneWithOrderByItems(e,t){return p({...e,orderBy:e.orderBy?ao.cloneWithItems(e.orderBy,t):ao.create(t)})},cloneWithPartitionByItems(e,t){return p({...e,partitionBy:e.partitionBy?Ng.cloneWithItems(e.partitionBy,t):Ng.create(t)})}}),kc=p({is(e){return e.kind==="FromNode"},create(e){return p({kind:"FromNode",froms:p(e)})},cloneWithFroms(e,t){return p({...e,froms:p([...e.froms,...t])})}}),$g=p({is(e){return e.kind==="GroupByNode"},create(e){return p({kind:"GroupByNode",items:p(e)})},cloneWithItems(e,t){return p({...e,items:p([...e.items,...t])})}}),Eg=p({is(e){return e.kind==="HavingNode"},create(e){return p({kind:"HavingNode",having:e})},cloneWithOperation(e,t,r){return p({...e,having:t==="And"?Pn.create(e.having,r):Eo.create(e.having,r)})}}),ot=p({is(e){return e.kind==="InsertQueryNode"},create(e,t,r){return p({kind:"InsertQueryNode",into:e,...t&&{with:t},replace:r})},createWithoutInto(){return p({kind:"InsertQueryNode"})},cloneWith(e,t){return p({...e,...t})}}),Nk=p({is(e){return e.kind==="ListNode"},create(e){return p({kind:"ListNode",items:p(e)})}}),ji=p({is(e){return e.kind==="UpdateQueryNode"},create(e,t){return p({kind:"UpdateQueryNode",table:e.length===1?e[0]:Nk.create(e),...t&&{with:t}})},createWithoutTable(){return p({kind:"UpdateQueryNode"})},cloneWithFromItems(e,t){return p({...e,from:e.from?kc.cloneWithFroms(e.from,t):kc.create(t)})},cloneWithUpdates(e,t){return p({...e,updates:e.updates?p([...e.updates,...t]):t})},cloneWithLimit(e,t){return p({...e,limit:t})}}),Ag=p({is(e){return e.kind==="UsingNode"},create(e){return p({kind:"UsingNode",tables:p(e)})},cloneWithTables(e,t){return p({...e,tables:p([...e.tables,...t])})}}),ea=p({is(e){return e.kind==="DeleteQueryNode"},create(e,t){return p({kind:"DeleteQueryNode",from:kc.create(e),...t&&{with:t}})},cloneWithOrderByItems:(e,t)=>V.cloneWithOrderByItems(e,t),cloneWithoutOrderBy:e=>V.cloneWithoutOrderBy(e),cloneWithLimit(e,t){return p({...e,limit:t})},cloneWithoutLimit(e){return p({...e,limit:void 0})},cloneWithUsing(e,t){return p({...e,using:e.using!==void 0?Ag.cloneWithTables(e.using,t):Ag.create(t)})}}),It=p({is(e){return e.kind==="WhereNode"},create(e){return p({kind:"WhereNode",where:e})},cloneWithOperation(e,t,r){return p({...e,where:t==="And"?Pn.create(e.where,r):Eo.create(e.where,r)})}}),Ig=p({is(e){return e.kind==="ReturningNode"},create(e){return p({kind:"ReturningNode",selections:p(e)})},cloneWithSelections(e,t){return p({...e,selections:e.selections?p([...e.selections,...t]):p(t)})}}),lU=p({is(e){return e.kind==="ExplainNode"},create(e,t){return p({kind:"ExplainNode",format:e,options:t})}}),hi=p({is(e){return e.kind==="WhenNode"},create(e){return p({kind:"WhenNode",condition:e})},cloneWithResult(e,t){return p({...e,result:t})}}),kr=p({is(e){return e.kind==="MergeQueryNode"},create(e,t){return p({kind:"MergeQueryNode",into:e,...t&&{with:t}})},cloneWithUsing(e,t){return p({...e,using:t})},cloneWithWhen(e,t){return p({...e,whens:e.whens?p([...e.whens,t]):p([t])})},cloneWithThen(e,t){return p({...e,whens:e.whens?p([...e.whens.slice(0,-1),hi.cloneWithResult(e.whens[e.whens.length-1],t)]):void 0})}}),Tg=p({is(e){return e.kind==="OutputNode"},create(e){return p({kind:"OutputNode",selections:p(e)})},cloneWithSelections(e,t){return p({...e,selections:e.selections?p([...e.selections,...t]):p(t)})}}),V=p({is(e){return Ee.is(e)||ot.is(e)||ji.is(e)||ea.is(e)||kr.is(e)},cloneWithEndModifier(e,t){return p({...e,endModifiers:e.endModifiers?p([...e.endModifiers,t]):p([t])})},cloneWithWhere(e,t){return p({...e,where:e.where?It.cloneWithOperation(e.where,"And",t):It.create(t)})},cloneWithJoin(e,t){return p({...e,joins:e.joins?p([...e.joins,t]):p([t])})},cloneWithReturning(e,t){return p({...e,returning:e.returning?Ig.cloneWithSelections(e.returning,t):Ig.create(t)})},cloneWithoutReturning(e){return p({...e,returning:void 0})},cloneWithoutWhere(e){return p({...e,where:void 0})},cloneWithExplain(e,t,r){return p({...e,explain:lU.create(t,r?.toOperationNode())})},cloneWithTop(e,t){return p({...e,top:t})},cloneWithOutput(e,t){return p({...e,output:e.output?Tg.cloneWithSelections(e.output,t):Tg.create(t)})},cloneWithOrderByItems(e,t){return p({...e,orderBy:e.orderBy?ao.cloneWithItems(e.orderBy,t):ao.create(t)})},cloneWithoutOrderBy(e){return p({...e,orderBy:void 0})}}),Ee=p({is(e){return e.kind==="SelectQueryNode"},create(e){return p({kind:"SelectQueryNode",...e&&{with:e}})},createFrom(e,t){return p({kind:"SelectQueryNode",from:kc.create(e),...t&&{with:t}})},cloneWithSelections(e,t){return p({...e,selections:e.selections?p([...e.selections,...t]):p(t)})},cloneWithDistinctOn(e,t){return p({...e,distinctOn:e.distinctOn?p([...e.distinctOn,...t]):p(t)})},cloneWithFrontModifier(e,t){return p({...e,frontModifiers:e.frontModifiers?p([...e.frontModifiers,t]):p([t])})},cloneWithOrderByItems:(e,t)=>V.cloneWithOrderByItems(e,t),cloneWithGroupByItems(e,t){return p({...e,groupBy:e.groupBy?$g.cloneWithItems(e.groupBy,t):$g.create(t)})},cloneWithLimit(e,t){return p({...e,limit:t})},cloneWithOffset(e,t){return p({...e,offset:t})},cloneWithFetch(e,t){return p({...e,fetch:t})},cloneWithHaving(e,t){return p({...e,having:e.having?Eg.cloneWithOperation(e.having,"And",t):Eg.create(t)})},cloneWithSetOperations(e,t){return p({...e,setOperations:e.setOperations?p([...e.setOperations,...t]):p([...t])})},cloneWithoutSelections(e){return p({...e,selections:[]})},cloneWithoutLimit(e){return p({...e,limit:void 0})},cloneWithoutOffset(e){return p({...e,offset:void 0})},cloneWithoutOrderBy:e=>V.cloneWithoutOrderBy(e),cloneWithoutGroupBy(e){return p({...e,groupBy:void 0})}});class ta{#e;constructor(t){this.#e=p(t)}on(...t){return new ta({...this.#e,joinNode:ai.cloneWithOn(this.#e.joinNode,gt(t))})}onRef(t,r,i){return new ta({...this.#e,joinNode:ai.cloneWithOn(this.#e.joinNode,Tr(t,r,i))})}onTrue(){return new ta({...this.#e,joinNode:ai.cloneWithOn(this.#e.joinNode,Le.createWithSql("true"))})}$call(t){return t(this)}toOperationNode(){return this.#e.joinNode}}const fU=p({is(e){return e.kind==="PartitionByItemNode"},create(e){return p({kind:"PartitionByItemNode",partitionBy:e})}});function hU(e){return Sa(e).map(fU.create)}class ra{#e;constructor(t){this.#e=p(t)}orderBy(...t){return new ra({overNode:ql.cloneWithOrderByItems(this.#e.overNode,fi(t))})}clearOrderBy(){return new ra({overNode:V.cloneWithoutOrderBy(this.#e.overNode)})}partitionBy(t){return new ra({overNode:ql.cloneWithPartitionByItems(this.#e.overNode,hU(t))})}$call(t){return t(this)}toOperationNode(){return this.#e.overNode}}const na=p({is(e){return e.kind==="SelectionNode"},create(e){return p({kind:"SelectionNode",selection:e})},createSelectAll(){return p({kind:"SelectionNode",selection:qp.create()})},createSelectAllFromTable(e){return p({kind:"SelectionNode",selection:ad.createSelectAll(e)})}});function Vt(e){return St(e)?Vt(e(xo())):sn(e)?e.map(t=>xg(t)):[xg(e)]}function xg(e){return mt(e)?na.create(oU(e)):gk(e)?na.create(e.toOperationNode()):na.create(Pk(e))}function or(e){return e?Array.isArray(e)?e.map(Og):[Og(e)]:[na.createSelectAll()]}function Og(e){if(mt(e))return na.createSelectAllFromTable(Be(e));throw new Error(`invalid value selectAll expression: ${JSON.stringify(e)}`)}const pU=p({is(e){return e.kind==="ValuesNode"},create(e){return p({kind:"ValuesNode",values:p(e)})}}),mU=p({is(e){return e.kind==="DefaultInsertValueNode"},create(){return p({kind:"DefaultInsertValueNode"})}});function $k(e){const t=St(e)?e(xo()):e,r=sn(t)?t:p([t]);return gU(r)}function gU(e){const t=yU(e);return[p([...t.keys()].map(Ke.create)),pU.create(e.map(r=>wU(r,t)))]}function yU(e){const t=new Map;for(const r of e){const i=Object.keys(r);for(const n of i)!t.has(n)&&r[n]!==void 0&&t.set(n,t.size)}return t}function wU(e,t){const r=Object.keys(e),i=Array.from({length:t.size});let n=!1,o=r.length;for(const s of r){const c=t.get(s);if(Hr(c)){o--;continue}const u=e[s];(Hr(u)||Es(u))&&(n=!0),i[c]=u}if(o<t.size||n){const s=mU.create();return sd.create(i.map(c=>Hr(c)?s:Ge(c)))}return Sk.create(i)}const Ek=p({is(e){return e.kind==="ColumnUpdateNode"},create(e,t){return p({kind:"ColumnUpdateNode",column:e,value:t})}});function vU(...e){return e.length===2?[Ek.create(jt(e[0]),Ge(e[1]))]:Kp(e[0])}function Kp(e){const t=St(e)?e(xo()):e;return Object.entries(t).filter(([r,i])=>i!==void 0).map(([r,i])=>Ek.create(Ke.create(r),Ge(i)))}const bU=p({is(e){return e.kind==="OnDuplicateKeyNode"},create(e){return p({kind:"OnDuplicateKeyNode",updates:e})}});class _U{insertId;numInsertedOrUpdatedRows;constructor(t,r){this.insertId=t,this.numInsertedOrUpdatedRows=r}}class Ns extends Error{node;constructor(t){super("no result"),this.node=t}}function $s(e){return Object.prototype.hasOwnProperty.call(e,"prototype")}const Ut=p({is(e){return e.kind==="OnConflictNode"},create(){return p({kind:"OnConflictNode"})},cloneWith(e,t){return p({...e,...t})},cloneWithIndexWhere(e,t){return p({...e,indexWhere:e.indexWhere?It.cloneWithOperation(e.indexWhere,"And",t):It.create(t)})},cloneWithIndexOrWhere(e,t){return p({...e,indexWhere:e.indexWhere?It.cloneWithOperation(e.indexWhere,"Or",t):It.create(t)})},cloneWithUpdateWhere(e,t){return p({...e,updateWhere:e.updateWhere?It.cloneWithOperation(e.updateWhere,"And",t):It.create(t)})},cloneWithUpdateOrWhere(e,t){return p({...e,updateWhere:e.updateWhere?It.cloneWithOperation(e.updateWhere,"Or",t):It.create(t)})},cloneWithoutIndexWhere(e){return p({...e,indexWhere:void 0})},cloneWithoutUpdateWhere(e){return p({...e,updateWhere:void 0})}});class qr{#e;constructor(t){this.#e=p(t)}column(t){const r=Ke.create(t);return new qr({...this.#e,onConflictNode:Ut.cloneWith(this.#e.onConflictNode,{columns:this.#e.onConflictNode.columns?p([...this.#e.onConflictNode.columns,r]):p([r])})})}columns(t){const r=t.map(Ke.create);return new qr({...this.#e,onConflictNode:Ut.cloneWith(this.#e.onConflictNode,{columns:this.#e.onConflictNode.columns?p([...this.#e.onConflictNode.columns,...r]):p(r)})})}constraint(t){return new qr({...this.#e,onConflictNode:Ut.cloneWith(this.#e.onConflictNode,{constraint:ve.create(t)})})}expression(t){return new qr({...this.#e,onConflictNode:Ut.cloneWith(this.#e.onConflictNode,{indexExpression:t.toOperationNode()})})}where(...t){return new qr({...this.#e,onConflictNode:Ut.cloneWithIndexWhere(this.#e.onConflictNode,gt(t))})}whereRef(t,r,i){return new qr({...this.#e,onConflictNode:Ut.cloneWithIndexWhere(this.#e.onConflictNode,Tr(t,r,i))})}clearWhere(){return new qr({...this.#e,onConflictNode:Ut.cloneWithoutIndexWhere(this.#e.onConflictNode)})}doNothing(){return new SU({...this.#e,onConflictNode:Ut.cloneWith(this.#e.onConflictNode,{doNothing:!0})})}doUpdateSet(t){return new ia({...this.#e,onConflictNode:Ut.cloneWith(this.#e.onConflictNode,{updates:Kp(t)})})}$call(t){return t(this)}}class SU{#e;constructor(t){this.#e=p(t)}toOperationNode(){return this.#e.onConflictNode}}class ia{#e;constructor(t){this.#e=p(t)}where(...t){return new ia({...this.#e,onConflictNode:Ut.cloneWithUpdateWhere(this.#e.onConflictNode,gt(t))})}whereRef(t,r,i){return new ia({...this.#e,onConflictNode:Ut.cloneWithUpdateWhere(this.#e.onConflictNode,Tr(t,r,i))})}clearWhere(){return new ia({...this.#e,onConflictNode:Ut.cloneWithoutUpdateWhere(this.#e.onConflictNode)})}$call(t){return t(this)}toOperationNode(){return this.#e.onConflictNode}}const kU=p({is(e){return e.kind==="TopNode"},create(e,t){return p({kind:"TopNode",expression:e,modifiers:t})}});function Io(e,t){if(!io(e)&&!od(e))throw new Error(`Invalid top expression: ${e}`);if(!Hr(t)&&!NU(t))throw new Error(`Invalid top modifiers: ${t}`);return kU.create(e,t)}function NU(e){return e==="percent"||e==="with ties"||e==="percent with ties"}const Ai=p({is(e){return e.kind==="OrActionNode"},create(e){return p({kind:"OrActionNode",action:e})}});class be{#e;constructor(t){this.#e=p(t)}values(t){const[r,i]=$k(t);return new be({...this.#e,queryNode:ot.cloneWith(this.#e.queryNode,{columns:r,values:i})})}columns(t){return new be({...this.#e,queryNode:ot.cloneWith(this.#e.queryNode,{columns:p(t.map(Ke.create))})})}expression(t){return new be({...this.#e,queryNode:ot.cloneWith(this.#e.queryNode,{values:_i(t)})})}defaultValues(){return new be({...this.#e,queryNode:ot.cloneWith(this.#e.queryNode,{defaultValues:!0})})}modifyEnd(t){return new be({...this.#e,queryNode:V.cloneWithEndModifier(this.#e.queryNode,t.toOperationNode())})}ignore(){return new be({...this.#e,queryNode:ot.cloneWith(this.#e.queryNode,{orAction:Ai.create("ignore")})})}orIgnore(){return new be({...this.#e,queryNode:ot.cloneWith(this.#e.queryNode,{orAction:Ai.create("ignore")})})}orAbort(){return new be({...this.#e,queryNode:ot.cloneWith(this.#e.queryNode,{orAction:Ai.create("abort")})})}orFail(){return new be({...this.#e,queryNode:ot.cloneWith(this.#e.queryNode,{orAction:Ai.create("fail")})})}orReplace(){return new be({...this.#e,queryNode:ot.cloneWith(this.#e.queryNode,{orAction:Ai.create("replace")})})}orRollback(){return new be({...this.#e,queryNode:ot.cloneWith(this.#e.queryNode,{orAction:Ai.create("rollback")})})}top(t,r){return new be({...this.#e,queryNode:V.cloneWithTop(this.#e.queryNode,Io(t,r))})}onConflict(t){return new be({...this.#e,queryNode:ot.cloneWith(this.#e.queryNode,{onConflict:t(new qr({onConflictNode:Ut.create()})).toOperationNode()})})}onDuplicateKeyUpdate(t){return new be({...this.#e,queryNode:ot.cloneWith(this.#e.queryNode,{onDuplicateKey:bU.create(Kp(t))})})}returning(t){return new be({...this.#e,queryNode:V.cloneWithReturning(this.#e.queryNode,Vt(t))})}returningAll(){return new be({...this.#e,queryNode:V.cloneWithReturning(this.#e.queryNode,or())})}output(t){return new be({...this.#e,queryNode:V.cloneWithOutput(this.#e.queryNode,Vt(t))})}outputAll(t){return new be({...this.#e,queryNode:V.cloneWithOutput(this.#e.queryNode,or(t))})}clearReturning(){return new be({...this.#e,queryNode:V.cloneWithoutReturning(this.#e.queryNode)})}$call(t){return t(this)}$if(t,r){return t?r(this):new be({...this.#e})}$castTo(){return new be(this.#e)}$narrowType(){return new be(this.#e)}$assertType(){return new be(this.#e)}withPlugin(t){return new be({...this.#e,executor:this.#e.executor.withPlugin(t)})}toOperationNode(){return this.#e.executor.transformQuery(this.#e.queryNode,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){const t=this.compile(),r=await this.#e.executor.executeQuery(t),{adapter:i}=this.#e.executor,n=t.query;return n.returning&&i.supportsReturning||n.output&&i.supportsOutput?r.rows:[new _U(r.insertId,r.numAffectedRows??BigInt(0))]}async executeTakeFirst(){const[t]=await this.execute();return t}async executeTakeFirstOrThrow(t=Ns){const r=await this.executeTakeFirst();if(r===void 0)throw $s(t)?new t(this.toOperationNode()):t(this.toOperationNode());return r}async*stream(t=100){const r=this.compile(),i=this.#e.executor.stream(r,t);for await(const n of i)yield*n.rows}async explain(t,r){return await new be({...this.#e,queryNode:V.cloneWithExplain(this.#e.queryNode,t,r)}).execute()}}class $U{numDeletedRows;constructor(t){this.numDeletedRows=t}}const Jp=p({is(e){return e.kind==="LimitNode"},create(e){return p({kind:"LimitNode",limit:e})}});class Ce{#e;constructor(t){this.#e=p(t)}where(...t){return new Ce({...this.#e,queryNode:V.cloneWithWhere(this.#e.queryNode,gt(t))})}whereRef(t,r,i){return new Ce({...this.#e,queryNode:V.cloneWithWhere(this.#e.queryNode,Tr(t,r,i))})}clearWhere(){return new Ce({...this.#e,queryNode:V.cloneWithoutWhere(this.#e.queryNode)})}top(t,r){return new Ce({...this.#e,queryNode:V.cloneWithTop(this.#e.queryNode,Io(t,r))})}using(t){return new Ce({...this.#e,queryNode:ea.cloneWithUsing(this.#e.queryNode,Mi(t))})}innerJoin(...t){return this.#t("InnerJoin",t)}leftJoin(...t){return this.#t("LeftJoin",t)}rightJoin(...t){return this.#t("RightJoin",t)}fullJoin(...t){return this.#t("FullJoin",t)}#t(t,r){return new Ce({...this.#e,queryNode:V.cloneWithJoin(this.#e.queryNode,ud(t,r))})}returning(t){return new Ce({...this.#e,queryNode:V.cloneWithReturning(this.#e.queryNode,Vt(t))})}returningAll(t){return new Ce({...this.#e,queryNode:V.cloneWithReturning(this.#e.queryNode,or(t))})}output(t){return new Ce({...this.#e,queryNode:V.cloneWithOutput(this.#e.queryNode,Vt(t))})}outputAll(t){return new Ce({...this.#e,queryNode:V.cloneWithOutput(this.#e.queryNode,or(t))})}clearReturning(){return new Ce({...this.#e,queryNode:V.cloneWithoutReturning(this.#e.queryNode)})}clearLimit(){return new Ce({...this.#e,queryNode:ea.cloneWithoutLimit(this.#e.queryNode)})}orderBy(...t){return new Ce({...this.#e,queryNode:V.cloneWithOrderByItems(this.#e.queryNode,fi(t))})}clearOrderBy(){return new Ce({...this.#e,queryNode:V.cloneWithoutOrderBy(this.#e.queryNode)})}limit(t){return new Ce({...this.#e,queryNode:ea.cloneWithLimit(this.#e.queryNode,Jp.create(Ge(t)))})}modifyEnd(t){return new Ce({...this.#e,queryNode:V.cloneWithEndModifier(this.#e.queryNode,t.toOperationNode())})}$call(t){return t(this)}$if(t,r){return t?r(this):new Ce({...this.#e})}$castTo(){return new Ce(this.#e)}$narrowType(){return new Ce(this.#e)}$assertType(){return new Ce(this.#e)}withPlugin(t){return new Ce({...this.#e,executor:this.#e.executor.withPlugin(t)})}toOperationNode(){return this.#e.executor.transformQuery(this.#e.queryNode,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){const t=this.compile(),r=await this.#e.executor.executeQuery(t),{adapter:i}=this.#e.executor,n=t.query;return n.returning&&i.supportsReturning||n.output&&i.supportsOutput?r.rows:[new $U(r.numAffectedRows??BigInt(0))]}async executeTakeFirst(){const[t]=await this.execute();return t}async executeTakeFirstOrThrow(t=Ns){const r=await this.executeTakeFirst();if(r===void 0)throw $s(t)?new t(this.toOperationNode()):t(this.toOperationNode());return r}async*stream(t=100){const r=this.compile(),i=this.#e.executor.stream(r,t);for await(const n of i)yield*n.rows}async explain(t,r){return await new Ce({...this.#e,queryNode:V.cloneWithExplain(this.#e.queryNode,t,r)}).execute()}}class EU{numUpdatedRows;numChangedRows;constructor(t,r){this.numUpdatedRows=t,this.numChangedRows=r}}class xe{#e;constructor(t){this.#e=p(t)}where(...t){return new xe({...this.#e,queryNode:V.cloneWithWhere(this.#e.queryNode,gt(t))})}whereRef(t,r,i){return new xe({...this.#e,queryNode:V.cloneWithWhere(this.#e.queryNode,Tr(t,r,i))})}clearWhere(){return new xe({...this.#e,queryNode:V.cloneWithoutWhere(this.#e.queryNode)})}top(t,r){return new xe({...this.#e,queryNode:V.cloneWithTop(this.#e.queryNode,Io(t,r))})}from(t){return new xe({...this.#e,queryNode:ji.cloneWithFromItems(this.#e.queryNode,Mi(t))})}innerJoin(...t){return this.#t("InnerJoin",t)}leftJoin(...t){return this.#t("LeftJoin",t)}rightJoin(...t){return this.#t("RightJoin",t)}fullJoin(...t){return this.#t("FullJoin",t)}#t(t,r){return new xe({...this.#e,queryNode:V.cloneWithJoin(this.#e.queryNode,ud(t,r))})}orderBy(...t){return new xe({...this.#e,queryNode:V.cloneWithOrderByItems(this.#e.queryNode,fi(t))})}clearOrderBy(){return new xe({...this.#e,queryNode:V.cloneWithoutOrderBy(this.#e.queryNode)})}limit(t){return new xe({...this.#e,queryNode:ji.cloneWithLimit(this.#e.queryNode,Jp.create(Ge(t)))})}set(...t){return new xe({...this.#e,queryNode:ji.cloneWithUpdates(this.#e.queryNode,vU(...t))})}returning(t){return new xe({...this.#e,queryNode:V.cloneWithReturning(this.#e.queryNode,Vt(t))})}returningAll(t){return new xe({...this.#e,queryNode:V.cloneWithReturning(this.#e.queryNode,or(t))})}output(t){return new xe({...this.#e,queryNode:V.cloneWithOutput(this.#e.queryNode,Vt(t))})}outputAll(t){return new xe({...this.#e,queryNode:V.cloneWithOutput(this.#e.queryNode,or(t))})}modifyEnd(t){return new xe({...this.#e,queryNode:V.cloneWithEndModifier(this.#e.queryNode,t.toOperationNode())})}clearReturning(){return new xe({...this.#e,queryNode:V.cloneWithoutReturning(this.#e.queryNode)})}$call(t){return t(this)}$if(t,r){return t?r(this):new xe({...this.#e})}$castTo(){return new xe(this.#e)}$narrowType(){return new xe(this.#e)}$assertType(){return new xe(this.#e)}withPlugin(t){return new xe({...this.#e,executor:this.#e.executor.withPlugin(t)})}toOperationNode(){return this.#e.executor.transformQuery(this.#e.queryNode,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){const t=this.compile(),r=await this.#e.executor.executeQuery(t),{adapter:i}=this.#e.executor,n=t.query;return n.returning&&i.supportsReturning||n.output&&i.supportsOutput?r.rows:[new EU(r.numAffectedRows??BigInt(0),r.numChangedRows)]}async executeTakeFirst(){const[t]=await this.execute();return t}async executeTakeFirstOrThrow(t=Ns){const r=await this.executeTakeFirst();if(r===void 0)throw $s(t)?new t(this.toOperationNode()):t(this.toOperationNode());return r}async*stream(t=100){const r=this.compile(),i=this.#e.executor.stream(r,t);for await(const n of i)yield*n.rows}async explain(t,r){return await new xe({...this.#e,queryNode:V.cloneWithExplain(this.#e.queryNode,t,r)}).execute()}}const Dg=p({is(e){return e.kind==="CommonTableExpressionNameNode"},create(e,t){return p({kind:"CommonTableExpressionNameNode",table:Vr.create(e),columns:t?p(t.map(Ke.create)):void 0})}}),Nc=p({is(e){return e.kind==="CommonTableExpressionNode"},create(e,t){return p({kind:"CommonTableExpressionNode",name:e,expression:t})},cloneWith(e,t){return p({...e,...t})}});class $c{#e;constructor(t){this.#e=p(t)}materialized(){return new $c({...this.#e,node:Nc.cloneWith(this.#e.node,{materialized:!0})})}notMaterialized(){return new $c({...this.#e,node:Nc.cloneWith(this.#e.node,{materialized:!1})})}toOperationNode(){return this.#e.node}}function Rg(e,t){const r=t(LU()).toOperationNode();return St(e)?e(AU(r)).toOperationNode():Nc.create(Ak(e),r)}function AU(e){return t=>new $c({node:Nc.create(Ak(t),e)})}function Ak(e){if(e.includes("(")){const t=e.split(/[\(\)]/),r=t[0],i=t[1].split(",").map(n=>n.trim());return Dg.create(r,i)}else return Dg.create(e)}const zs=p({is(e){return e.kind==="WithNode"},create(e,t){return p({kind:"WithNode",expressions:p([e]),...t})},cloneWithExpression(e,t){return p({...e,expressions:p([...e.expressions,t])})}}),Ug=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"];function Ik(e){let t="";for(let r=0;r<e;++r)t+=IU();return t}function IU(){return Ug[~~(Math.random()*Ug.length)]}function ce(){return new TU}class TU{#e;get queryId(){return this.#e===void 0&&(this.#e=Ik(8)),this.#e}}class Tk{nodeStack=[];#e=p({AliasNode:this.transformAlias.bind(this),ColumnNode:this.transformColumn.bind(this),IdentifierNode:this.transformIdentifier.bind(this),SchemableIdentifierNode:this.transformSchemableIdentifier.bind(this),RawNode:this.transformRaw.bind(this),ReferenceNode:this.transformReference.bind(this),SelectQueryNode:this.transformSelectQuery.bind(this),SelectionNode:this.transformSelection.bind(this),TableNode:this.transformTable.bind(this),FromNode:this.transformFrom.bind(this),SelectAllNode:this.transformSelectAll.bind(this),AndNode:this.transformAnd.bind(this),OrNode:this.transformOr.bind(this),ValueNode:this.transformValue.bind(this),ValueListNode:this.transformValueList.bind(this),PrimitiveValueListNode:this.transformPrimitiveValueList.bind(this),ParensNode:this.transformParens.bind(this),JoinNode:this.transformJoin.bind(this),OperatorNode:this.transformOperator.bind(this),WhereNode:this.transformWhere.bind(this),InsertQueryNode:this.transformInsertQuery.bind(this),DeleteQueryNode:this.transformDeleteQuery.bind(this),ReturningNode:this.transformReturning.bind(this),CreateTableNode:this.transformCreateTable.bind(this),AddColumnNode:this.transformAddColumn.bind(this),ColumnDefinitionNode:this.transformColumnDefinition.bind(this),DropTableNode:this.transformDropTable.bind(this),DataTypeNode:this.transformDataType.bind(this),OrderByNode:this.transformOrderBy.bind(this),OrderByItemNode:this.transformOrderByItem.bind(this),GroupByNode:this.transformGroupBy.bind(this),GroupByItemNode:this.transformGroupByItem.bind(this),UpdateQueryNode:this.transformUpdateQuery.bind(this),ColumnUpdateNode:this.transformColumnUpdate.bind(this),LimitNode:this.transformLimit.bind(this),OffsetNode:this.transformOffset.bind(this),OnConflictNode:this.transformOnConflict.bind(this),OnDuplicateKeyNode:this.transformOnDuplicateKey.bind(this),CreateIndexNode:this.transformCreateIndex.bind(this),DropIndexNode:this.transformDropIndex.bind(this),ListNode:this.transformList.bind(this),PrimaryKeyConstraintNode:this.transformPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.transformUniqueConstraint.bind(this),ReferencesNode:this.transformReferences.bind(this),CheckConstraintNode:this.transformCheckConstraint.bind(this),WithNode:this.transformWith.bind(this),CommonTableExpressionNode:this.transformCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.transformCommonTableExpressionName.bind(this),HavingNode:this.transformHaving.bind(this),CreateSchemaNode:this.transformCreateSchema.bind(this),DropSchemaNode:this.transformDropSchema.bind(this),AlterTableNode:this.transformAlterTable.bind(this),DropColumnNode:this.transformDropColumn.bind(this),RenameColumnNode:this.transformRenameColumn.bind(this),AlterColumnNode:this.transformAlterColumn.bind(this),ModifyColumnNode:this.transformModifyColumn.bind(this),AddConstraintNode:this.transformAddConstraint.bind(this),DropConstraintNode:this.transformDropConstraint.bind(this),RenameConstraintNode:this.transformRenameConstraint.bind(this),ForeignKeyConstraintNode:this.transformForeignKeyConstraint.bind(this),CreateViewNode:this.transformCreateView.bind(this),RefreshMaterializedViewNode:this.transformRefreshMaterializedView.bind(this),DropViewNode:this.transformDropView.bind(this),GeneratedNode:this.transformGenerated.bind(this),DefaultValueNode:this.transformDefaultValue.bind(this),OnNode:this.transformOn.bind(this),ValuesNode:this.transformValues.bind(this),SelectModifierNode:this.transformSelectModifier.bind(this),CreateTypeNode:this.transformCreateType.bind(this),DropTypeNode:this.transformDropType.bind(this),ExplainNode:this.transformExplain.bind(this),DefaultInsertValueNode:this.transformDefaultInsertValue.bind(this),AggregateFunctionNode:this.transformAggregateFunction.bind(this),OverNode:this.transformOver.bind(this),PartitionByNode:this.transformPartitionBy.bind(this),PartitionByItemNode:this.transformPartitionByItem.bind(this),SetOperationNode:this.transformSetOperation.bind(this),BinaryOperationNode:this.transformBinaryOperation.bind(this),UnaryOperationNode:this.transformUnaryOperation.bind(this),UsingNode:this.transformUsing.bind(this),FunctionNode:this.transformFunction.bind(this),CaseNode:this.transformCase.bind(this),WhenNode:this.transformWhen.bind(this),JSONReferenceNode:this.transformJSONReference.bind(this),JSONPathNode:this.transformJSONPath.bind(this),JSONPathLegNode:this.transformJSONPathLeg.bind(this),JSONOperatorChainNode:this.transformJSONOperatorChain.bind(this),TupleNode:this.transformTuple.bind(this),MergeQueryNode:this.transformMergeQuery.bind(this),MatchedNode:this.transformMatched.bind(this),AddIndexNode:this.transformAddIndex.bind(this),CastNode:this.transformCast.bind(this),FetchNode:this.transformFetch.bind(this),TopNode:this.transformTop.bind(this),OutputNode:this.transformOutput.bind(this),OrActionNode:this.transformOrAction.bind(this),CollateNode:this.transformCollate.bind(this)});transformNode(t,r){if(!t)return t;this.nodeStack.push(t);const i=this.transformNodeImpl(t,r);return this.nodeStack.pop(),p(i)}transformNodeImpl(t,r){return this.#e[t.kind](t,r)}transformNodeList(t,r){return t&&p(t.map(i=>this.transformNode(i,r)))}transformSelectQuery(t,r){return{kind:"SelectQueryNode",from:this.transformNode(t.from,r),selections:this.transformNodeList(t.selections,r),distinctOn:this.transformNodeList(t.distinctOn,r),joins:this.transformNodeList(t.joins,r),groupBy:this.transformNode(t.groupBy,r),orderBy:this.transformNode(t.orderBy,r),where:this.transformNode(t.where,r),frontModifiers:this.transformNodeList(t.frontModifiers,r),endModifiers:this.transformNodeList(t.endModifiers,r),limit:this.transformNode(t.limit,r),offset:this.transformNode(t.offset,r),with:this.transformNode(t.with,r),having:this.transformNode(t.having,r),explain:this.transformNode(t.explain,r),setOperations:this.transformNodeList(t.setOperations,r),fetch:this.transformNode(t.fetch,r),top:this.transformNode(t.top,r)}}transformSelection(t,r){return{kind:"SelectionNode",selection:this.transformNode(t.selection,r)}}transformColumn(t,r){return{kind:"ColumnNode",column:this.transformNode(t.column,r)}}transformAlias(t,r){return{kind:"AliasNode",node:this.transformNode(t.node,r),alias:this.transformNode(t.alias,r)}}transformTable(t,r){return{kind:"TableNode",table:this.transformNode(t.table,r)}}transformFrom(t,r){return{kind:"FromNode",froms:this.transformNodeList(t.froms,r)}}transformReference(t,r){return{kind:"ReferenceNode",column:this.transformNode(t.column,r),table:this.transformNode(t.table,r)}}transformAnd(t,r){return{kind:"AndNode",left:this.transformNode(t.left,r),right:this.transformNode(t.right,r)}}transformOr(t,r){return{kind:"OrNode",left:this.transformNode(t.left,r),right:this.transformNode(t.right,r)}}transformValueList(t,r){return{kind:"ValueListNode",values:this.transformNodeList(t.values,r)}}transformParens(t,r){return{kind:"ParensNode",node:this.transformNode(t.node,r)}}transformJoin(t,r){return{kind:"JoinNode",joinType:t.joinType,table:this.transformNode(t.table,r),on:this.transformNode(t.on,r)}}transformRaw(t,r){return{kind:"RawNode",sqlFragments:p([...t.sqlFragments]),parameters:this.transformNodeList(t.parameters,r)}}transformWhere(t,r){return{kind:"WhereNode",where:this.transformNode(t.where,r)}}transformInsertQuery(t,r){return{kind:"InsertQueryNode",into:this.transformNode(t.into,r),columns:this.transformNodeList(t.columns,r),values:this.transformNode(t.values,r),returning:this.transformNode(t.returning,r),onConflict:this.transformNode(t.onConflict,r),onDuplicateKey:this.transformNode(t.onDuplicateKey,r),endModifiers:this.transformNodeList(t.endModifiers,r),with:this.transformNode(t.with,r),ignore:t.ignore,orAction:this.transformNode(t.orAction,r),replace:t.replace,explain:this.transformNode(t.explain,r),defaultValues:t.defaultValues,top:this.transformNode(t.top,r),output:this.transformNode(t.output,r)}}transformValues(t,r){return{kind:"ValuesNode",values:this.transformNodeList(t.values,r)}}transformDeleteQuery(t,r){return{kind:"DeleteQueryNode",from:this.transformNode(t.from,r),using:this.transformNode(t.using,r),joins:this.transformNodeList(t.joins,r),where:this.transformNode(t.where,r),returning:this.transformNode(t.returning,r),endModifiers:this.transformNodeList(t.endModifiers,r),with:this.transformNode(t.with,r),orderBy:this.transformNode(t.orderBy,r),limit:this.transformNode(t.limit,r),explain:this.transformNode(t.explain,r),top:this.transformNode(t.top,r),output:this.transformNode(t.output,r)}}transformReturning(t,r){return{kind:"ReturningNode",selections:this.transformNodeList(t.selections,r)}}transformCreateTable(t,r){return{kind:"CreateTableNode",table:this.transformNode(t.table,r),columns:this.transformNodeList(t.columns,r),constraints:this.transformNodeList(t.constraints,r),temporary:t.temporary,ifNotExists:t.ifNotExists,onCommit:t.onCommit,frontModifiers:this.transformNodeList(t.frontModifiers,r),endModifiers:this.transformNodeList(t.endModifiers,r),selectQuery:this.transformNode(t.selectQuery,r)}}transformColumnDefinition(t,r){return{kind:"ColumnDefinitionNode",column:this.transformNode(t.column,r),dataType:this.transformNode(t.dataType,r),references:this.transformNode(t.references,r),primaryKey:t.primaryKey,autoIncrement:t.autoIncrement,unique:t.unique,notNull:t.notNull,unsigned:t.unsigned,defaultTo:this.transformNode(t.defaultTo,r),check:this.transformNode(t.check,r),generated:this.transformNode(t.generated,r),frontModifiers:this.transformNodeList(t.frontModifiers,r),endModifiers:this.transformNodeList(t.endModifiers,r),nullsNotDistinct:t.nullsNotDistinct,identity:t.identity,ifNotExists:t.ifNotExists}}transformAddColumn(t,r){return{kind:"AddColumnNode",column:this.transformNode(t.column,r)}}transformDropTable(t,r){return{kind:"DropTableNode",table:this.transformNode(t.table,r),ifExists:t.ifExists,cascade:t.cascade}}transformOrderBy(t,r){return{kind:"OrderByNode",items:this.transformNodeList(t.items,r)}}transformOrderByItem(t,r){return{kind:"OrderByItemNode",orderBy:this.transformNode(t.orderBy,r),direction:this.transformNode(t.direction,r),collation:this.transformNode(t.collation,r),nulls:t.nulls}}transformGroupBy(t,r){return{kind:"GroupByNode",items:this.transformNodeList(t.items,r)}}transformGroupByItem(t,r){return{kind:"GroupByItemNode",groupBy:this.transformNode(t.groupBy,r)}}transformUpdateQuery(t,r){return{kind:"UpdateQueryNode",table:this.transformNode(t.table,r),from:this.transformNode(t.from,r),joins:this.transformNodeList(t.joins,r),where:this.transformNode(t.where,r),updates:this.transformNodeList(t.updates,r),returning:this.transformNode(t.returning,r),endModifiers:this.transformNodeList(t.endModifiers,r),with:this.transformNode(t.with,r),explain:this.transformNode(t.explain,r),limit:this.transformNode(t.limit,r),top:this.transformNode(t.top,r),output:this.transformNode(t.output,r),orderBy:this.transformNode(t.orderBy,r)}}transformColumnUpdate(t,r){return{kind:"ColumnUpdateNode",column:this.transformNode(t.column,r),value:this.transformNode(t.value,r)}}transformLimit(t,r){return{kind:"LimitNode",limit:this.transformNode(t.limit,r)}}transformOffset(t,r){return{kind:"OffsetNode",offset:this.transformNode(t.offset,r)}}transformOnConflict(t,r){return{kind:"OnConflictNode",columns:this.transformNodeList(t.columns,r),constraint:this.transformNode(t.constraint,r),indexExpression:this.transformNode(t.indexExpression,r),indexWhere:this.transformNode(t.indexWhere,r),updates:this.transformNodeList(t.updates,r),updateWhere:this.transformNode(t.updateWhere,r),doNothing:t.doNothing}}transformOnDuplicateKey(t,r){return{kind:"OnDuplicateKeyNode",updates:this.transformNodeList(t.updates,r)}}transformCreateIndex(t,r){return{kind:"CreateIndexNode",name:this.transformNode(t.name,r),table:this.transformNode(t.table,r),columns:this.transformNodeList(t.columns,r),unique:t.unique,using:this.transformNode(t.using,r),ifNotExists:t.ifNotExists,where:this.transformNode(t.where,r),nullsNotDistinct:t.nullsNotDistinct}}transformList(t,r){return{kind:"ListNode",items:this.transformNodeList(t.items,r)}}transformDropIndex(t,r){return{kind:"DropIndexNode",name:this.transformNode(t.name,r),table:this.transformNode(t.table,r),ifExists:t.ifExists,cascade:t.cascade}}transformPrimaryKeyConstraint(t,r){return{kind:"PrimaryKeyConstraintNode",columns:this.transformNodeList(t.columns,r),name:this.transformNode(t.name,r),deferrable:t.deferrable,initiallyDeferred:t.initiallyDeferred}}transformUniqueConstraint(t,r){return{kind:"UniqueConstraintNode",columns:this.transformNodeList(t.columns,r),name:this.transformNode(t.name,r),nullsNotDistinct:t.nullsNotDistinct,deferrable:t.deferrable,initiallyDeferred:t.initiallyDeferred}}transformForeignKeyConstraint(t,r){return{kind:"ForeignKeyConstraintNode",columns:this.transformNodeList(t.columns,r),references:this.transformNode(t.references,r),name:this.transformNode(t.name,r),onDelete:t.onDelete,onUpdate:t.onUpdate,deferrable:t.deferrable,initiallyDeferred:t.initiallyDeferred}}transformSetOperation(t,r){return{kind:"SetOperationNode",operator:t.operator,expression:this.transformNode(t.expression,r),all:t.all}}transformReferences(t,r){return{kind:"ReferencesNode",table:this.transformNode(t.table,r),columns:this.transformNodeList(t.columns,r),onDelete:t.onDelete,onUpdate:t.onUpdate}}transformCheckConstraint(t,r){return{kind:"CheckConstraintNode",expression:this.transformNode(t.expression,r),name:this.transformNode(t.name,r)}}transformWith(t,r){return{kind:"WithNode",expressions:this.transformNodeList(t.expressions,r),recursive:t.recursive}}transformCommonTableExpression(t,r){return{kind:"CommonTableExpressionNode",name:this.transformNode(t.name,r),materialized:t.materialized,expression:this.transformNode(t.expression,r)}}transformCommonTableExpressionName(t,r){return{kind:"CommonTableExpressionNameNode",table:this.transformNode(t.table,r),columns:this.transformNodeList(t.columns,r)}}transformHaving(t,r){return{kind:"HavingNode",having:this.transformNode(t.having,r)}}transformCreateSchema(t,r){return{kind:"CreateSchemaNode",schema:this.transformNode(t.schema,r),ifNotExists:t.ifNotExists}}transformDropSchema(t,r){return{kind:"DropSchemaNode",schema:this.transformNode(t.schema,r),ifExists:t.ifExists,cascade:t.cascade}}transformAlterTable(t,r){return{kind:"AlterTableNode",table:this.transformNode(t.table,r),renameTo:this.transformNode(t.renameTo,r),setSchema:this.transformNode(t.setSchema,r),columnAlterations:this.transformNodeList(t.columnAlterations,r),addConstraint:this.transformNode(t.addConstraint,r),dropConstraint:this.transformNode(t.dropConstraint,r),renameConstraint:this.transformNode(t.renameConstraint,r),addIndex:this.transformNode(t.addIndex,r),dropIndex:this.transformNode(t.dropIndex,r)}}transformDropColumn(t,r){return{kind:"DropColumnNode",column:this.transformNode(t.column,r)}}transformRenameColumn(t,r){return{kind:"RenameColumnNode",column:this.transformNode(t.column,r),renameTo:this.transformNode(t.renameTo,r)}}transformAlterColumn(t,r){return{kind:"AlterColumnNode",column:this.transformNode(t.column,r),dataType:this.transformNode(t.dataType,r),dataTypeExpression:this.transformNode(t.dataTypeExpression,r),setDefault:this.transformNode(t.setDefault,r),dropDefault:t.dropDefault,setNotNull:t.setNotNull,dropNotNull:t.dropNotNull}}transformModifyColumn(t,r){return{kind:"ModifyColumnNode",column:this.transformNode(t.column,r)}}transformAddConstraint(t,r){return{kind:"AddConstraintNode",constraint:this.transformNode(t.constraint,r)}}transformDropConstraint(t,r){return{kind:"DropConstraintNode",constraintName:this.transformNode(t.constraintName,r),ifExists:t.ifExists,modifier:t.modifier}}transformRenameConstraint(t,r){return{kind:"RenameConstraintNode",oldName:this.transformNode(t.oldName,r),newName:this.transformNode(t.newName,r)}}transformCreateView(t,r){return{kind:"CreateViewNode",name:this.transformNode(t.name,r),temporary:t.temporary,orReplace:t.orReplace,ifNotExists:t.ifNotExists,materialized:t.materialized,columns:this.transformNodeList(t.columns,r),as:this.transformNode(t.as,r)}}transformRefreshMaterializedView(t,r){return{kind:"RefreshMaterializedViewNode",name:this.transformNode(t.name,r),concurrently:t.concurrently,withNoData:t.withNoData}}transformDropView(t,r){return{kind:"DropViewNode",name:this.transformNode(t.name,r),ifExists:t.ifExists,materialized:t.materialized,cascade:t.cascade}}transformGenerated(t,r){return{kind:"GeneratedNode",byDefault:t.byDefault,always:t.always,identity:t.identity,stored:t.stored,expression:this.transformNode(t.expression,r)}}transformDefaultValue(t,r){return{kind:"DefaultValueNode",defaultValue:this.transformNode(t.defaultValue,r)}}transformOn(t,r){return{kind:"OnNode",on:this.transformNode(t.on,r)}}transformSelectModifier(t,r){return{kind:"SelectModifierNode",modifier:t.modifier,rawModifier:this.transformNode(t.rawModifier,r),of:this.transformNodeList(t.of,r)}}transformCreateType(t,r){return{kind:"CreateTypeNode",name:this.transformNode(t.name,r),enum:this.transformNode(t.enum,r)}}transformDropType(t,r){return{kind:"DropTypeNode",name:this.transformNode(t.name,r),ifExists:t.ifExists}}transformExplain(t,r){return{kind:"ExplainNode",format:t.format,options:this.transformNode(t.options,r)}}transformSchemableIdentifier(t,r){return{kind:"SchemableIdentifierNode",schema:this.transformNode(t.schema,r),identifier:this.transformNode(t.identifier,r)}}transformAggregateFunction(t,r){return{kind:"AggregateFunctionNode",func:t.func,aggregated:this.transformNodeList(t.aggregated,r),distinct:t.distinct,orderBy:this.transformNode(t.orderBy,r),withinGroup:this.transformNode(t.withinGroup,r),filter:this.transformNode(t.filter,r),over:this.transformNode(t.over,r)}}transformOver(t,r){return{kind:"OverNode",orderBy:this.transformNode(t.orderBy,r),partitionBy:this.transformNode(t.partitionBy,r)}}transformPartitionBy(t,r){return{kind:"PartitionByNode",items:this.transformNodeList(t.items,r)}}transformPartitionByItem(t,r){return{kind:"PartitionByItemNode",partitionBy:this.transformNode(t.partitionBy,r)}}transformBinaryOperation(t,r){return{kind:"BinaryOperationNode",leftOperand:this.transformNode(t.leftOperand,r),operator:this.transformNode(t.operator,r),rightOperand:this.transformNode(t.rightOperand,r)}}transformUnaryOperation(t,r){return{kind:"UnaryOperationNode",operator:this.transformNode(t.operator,r),operand:this.transformNode(t.operand,r)}}transformUsing(t,r){return{kind:"UsingNode",tables:this.transformNodeList(t.tables,r)}}transformFunction(t,r){return{kind:"FunctionNode",func:t.func,arguments:this.transformNodeList(t.arguments,r)}}transformCase(t,r){return{kind:"CaseNode",value:this.transformNode(t.value,r),when:this.transformNodeList(t.when,r),else:this.transformNode(t.else,r),isStatement:t.isStatement}}transformWhen(t,r){return{kind:"WhenNode",condition:this.transformNode(t.condition,r),result:this.transformNode(t.result,r)}}transformJSONReference(t,r){return{kind:"JSONReferenceNode",reference:this.transformNode(t.reference,r),traversal:this.transformNode(t.traversal,r)}}transformJSONPath(t,r){return{kind:"JSONPathNode",inOperator:this.transformNode(t.inOperator,r),pathLegs:this.transformNodeList(t.pathLegs,r)}}transformJSONPathLeg(t,r){return{kind:"JSONPathLegNode",type:t.type,value:t.value}}transformJSONOperatorChain(t,r){return{kind:"JSONOperatorChainNode",operator:this.transformNode(t.operator,r),values:this.transformNodeList(t.values,r)}}transformTuple(t,r){return{kind:"TupleNode",values:this.transformNodeList(t.values,r)}}transformMergeQuery(t,r){return{kind:"MergeQueryNode",into:this.transformNode(t.into,r),using:this.transformNode(t.using,r),whens:this.transformNodeList(t.whens,r),with:this.transformNode(t.with,r),top:this.transformNode(t.top,r),endModifiers:this.transformNodeList(t.endModifiers,r),output:this.transformNode(t.output,r),returning:this.transformNode(t.returning,r)}}transformMatched(t,r){return{kind:"MatchedNode",not:t.not,bySource:t.bySource}}transformAddIndex(t,r){return{kind:"AddIndexNode",name:this.transformNode(t.name,r),columns:this.transformNodeList(t.columns,r),unique:t.unique,using:this.transformNode(t.using,r),ifNotExists:t.ifNotExists}}transformCast(t,r){return{kind:"CastNode",expression:this.transformNode(t.expression,r),dataType:this.transformNode(t.dataType,r)}}transformFetch(t,r){return{kind:"FetchNode",rowCount:this.transformNode(t.rowCount,r),modifier:t.modifier}}transformTop(t,r){return{kind:"TopNode",expression:t.expression,modifiers:t.modifiers}}transformOutput(t,r){return{kind:"OutputNode",selections:this.transformNodeList(t.selections,r)}}transformDataType(t,r){return t}transformSelectAll(t,r){return t}transformIdentifier(t,r){return t}transformValue(t,r){return t}transformPrimitiveValueList(t,r){return t}transformOperator(t,r){return t}transformDefaultInsertValue(t,r){return t}transformOrAction(t,r){return t}transformCollate(t,r){return t}}const xU=p({AlterTableNode:!0,CreateIndexNode:!0,CreateSchemaNode:!0,CreateTableNode:!0,CreateTypeNode:!0,CreateViewNode:!0,RefreshMaterializedViewNode:!0,DeleteQueryNode:!0,DropIndexNode:!0,DropSchemaNode:!0,DropTableNode:!0,DropTypeNode:!0,DropViewNode:!0,InsertQueryNode:!0,RawNode:!0,SelectQueryNode:!0,UpdateQueryNode:!0,MergeQueryNode:!0}),OU={json_agg:!0,to_json:!0};class DU extends Tk{#e;#t=new Set;#r=new Set;constructor(t){super(),this.#e=t}transformNodeImpl(t,r){if(!this.#i(t))return super.transformNodeImpl(t,r);const i=this.#s(t);for(const a of i)this.#r.add(a);const n=this.#a(t);for(const a of n)this.#t.add(a);const o=super.transformNodeImpl(t,r);for(const a of n)this.#t.delete(a);for(const a of i)this.#r.delete(a);return o}transformSchemableIdentifier(t,r){const i=super.transformSchemableIdentifier(t,r);return i.schema||!this.#t.has(t.identifier.name)?i:{...i,schema:ve.create(this.#e)}}transformReferences(t,r){const i=super.transformReferences(t,r);return i.table.table.schema?i:{...i,table:Vr.createWithSchema(this.#e,i.table.table.identifier.name)}}transformAggregateFunction(t,r){return{...super.transformAggregateFunction({...t,aggregated:[]},r),aggregated:this.#n(t,r,"aggregated")}}transformFunction(t,r){return{...super.transformFunction({...t,arguments:[]},r),arguments:this.#n(t,r,"arguments")}}#n(t,r,i){return OU[t.func]?t[i].map(n=>!Vr.is(n)||n.table.schema?this.transformNode(n,r):{...n,table:this.transformIdentifier(n.table.identifier,r)}):this.transformNodeList(t[i],r)}#i(t){return t.kind in xU}#a(t){const r=new Set;if("name"in t&&t.name&&cn.is(t.name)&&this.#c(t.name,r),"from"in t&&t.from)for(const i of t.from.froms)this.#o(i,r);if("into"in t&&t.into&&this.#o(t.into,r),"table"in t&&t.table&&this.#o(t.table,r),"joins"in t&&t.joins)for(const i of t.joins)this.#o(i.table,r);return"using"in t&&t.using&&(ai.is(t.using)?this.#o(t.using.table,r):this.#o(t.using,r)),r}#s(t){const r=new Set;return"with"in t&&t.with&&this.#u(t.with,r),r}#o(t,r){if(Vr.is(t))this.#c(t.table,r);else if(fn.is(t)&&Vr.is(t.node))this.#c(t.node.table,r);else if(Nk.is(t))for(const i of t.items)this.#o(i,r)}#c(t,r){const i=t.identifier.name;!this.#t.has(i)&&!this.#r.has(i)&&r.add(i)}#u(t,r){for(const i of t.expressions){const n=i.name.table.table.identifier.name;this.#r.has(n)||r.add(n)}}}class To{#e;constructor(t){this.#e=new DU(t)}transformQuery(t){return this.#e.transformNode(t.node,t.queryId)}async transformResult(t){return t.result}}const RU=p({is(e){return e.kind==="MatchedNode"},create(e,t=!1){return p({kind:"MatchedNode",not:e,bySource:t})}});function Cg(e,t,r){return hi.create(Sc([RU.create(!e.isMatched,e.bySource),...t&&t.length>0?[t.length===3&&r?Tr(t[0],t[1],t[2]):gt(t)]:[]],"and",!1))}function oa(e){return mt(e)?Le.create([e],[]):At(e)?e.toOperationNode():e}class aa{#e;#t;#r;constructor(){this.#e=new Promise((t,r)=>{this.#r=r,this.#t=t})}get promise(){return this.#e}resolve=t=>{this.#t&&this.#t(t)};reject=t=>{this.#r&&this.#r(t)}}async function xk(e){const t=new aa,r=new aa;return e.provideConnection(async i=>(t.resolve(i),await r.promise)).catch(i=>t.reject(i)),p({connection:await t.promise,release:r.resolve})}const UU=p([]);class Ok{#e;constructor(t=UU){this.#e=t}get plugins(){return this.#e}transformQuery(t,r){for(const i of this.#e){const n=i.transformQuery({node:t,queryId:r});if(n.kind===t.kind)t=n;else throw new Error(["KyselyPlugin.transformQuery must return a node","of the same kind that was given to it.",`The plugin was given a ${t.kind}`,`but it returned a ${n.kind}`].join(" "))}return t}async executeQuery(t){return await this.provideConnection(async r=>{const i=await r.executeQuery(t);return"numUpdatedOrDeletedRows"in i&&Ao("kysely:warning: outdated driver/plugin detected! `QueryResult.numUpdatedOrDeletedRows` has been replaced with `QueryResult.numAffectedRows`."),await this.#t(i,t.queryId)})}async*stream(t,r){const{connection:i,release:n}=await xk(this);try{for await(const o of i.streamQuery(t,r))yield await this.#t(o,t.queryId)}finally{n()}}async#t(t,r){for(const i of this.#e)t=await i.transformResult({result:t,queryId:r});return t}}class Ui extends Ok{get adapter(){throw new Error("this query cannot be compiled to SQL")}compileQuery(){throw new Error("this query cannot be compiled to SQL")}provideConnection(){throw new Error("this query cannot be executed")}withConnectionProvider(){throw new Error("this query cannot have a connection provider")}withPlugin(t){return new Ui([...this.plugins,t])}withPlugins(t){return new Ui([...this.plugins,...t])}withPluginAtFront(t){return new Ui([t,...this.plugins])}withoutPlugins(){return new Ui([])}}const cd=new Ui;class CU{numChangedRows;constructor(t){this.numChangedRows=t}}class vn{#e;constructor(t){this.#e=p(t)}modifyEnd(t){return new vn({...this.#e,queryNode:V.cloneWithEndModifier(this.#e.queryNode,t.toOperationNode())})}top(t,r){return new vn({...this.#e,queryNode:V.cloneWithTop(this.#e.queryNode,Io(t,r))})}using(...t){return new Tt({...this.#e,queryNode:kr.cloneWithUsing(this.#e.queryNode,ud("Using",t))})}returning(t){return new vn({...this.#e,queryNode:V.cloneWithReturning(this.#e.queryNode,Vt(t))})}returningAll(t){return new vn({...this.#e,queryNode:V.cloneWithReturning(this.#e.queryNode,or(t))})}output(t){return new vn({...this.#e,queryNode:V.cloneWithOutput(this.#e.queryNode,Vt(t))})}outputAll(t){return new vn({...this.#e,queryNode:V.cloneWithOutput(this.#e.queryNode,or(t))})}}class Tt{#e;constructor(t){this.#e=p(t)}modifyEnd(t){return new Tt({...this.#e,queryNode:V.cloneWithEndModifier(this.#e.queryNode,t.toOperationNode())})}top(t,r){return new Tt({...this.#e,queryNode:V.cloneWithTop(this.#e.queryNode,Io(t,r))})}whenMatched(){return this.#t([])}whenMatchedAnd(...t){return this.#t(t)}whenMatchedAndRef(t,r,i){return this.#t([t,r,i],!0)}#t(t,r){return new Pg({...this.#e,queryNode:kr.cloneWithWhen(this.#e.queryNode,Cg({isMatched:!0},t,r))})}whenNotMatched(){return this.#r([])}whenNotMatchedAnd(...t){return this.#r(t)}whenNotMatchedAndRef(t,r,i){return this.#r([t,r,i],!0)}whenNotMatchedBySource(){return this.#r([],!1,!0)}whenNotMatchedBySourceAnd(...t){return this.#r(t,!1,!0)}whenNotMatchedBySourceAndRef(t,r,i){return this.#r([t,r,i],!0,!0)}returning(t){return new Tt({...this.#e,queryNode:V.cloneWithReturning(this.#e.queryNode,Vt(t))})}returningAll(t){return new Tt({...this.#e,queryNode:V.cloneWithReturning(this.#e.queryNode,or(t))})}output(t){return new Tt({...this.#e,queryNode:V.cloneWithOutput(this.#e.queryNode,Vt(t))})}outputAll(t){return new Tt({...this.#e,queryNode:V.cloneWithOutput(this.#e.queryNode,or(t))})}#r(t,r=!1,i=!1){const n={...this.#e,queryNode:kr.cloneWithWhen(this.#e.queryNode,Cg({isMatched:!1,bySource:i},t,r))},o=i?Pg:PU;return new o(n)}$call(t){return t(this)}$if(t,r){return t?r(this):new Tt({...this.#e})}toOperationNode(){return this.#e.executor.transformQuery(this.#e.queryNode,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){const t=this.compile(),r=await this.#e.executor.executeQuery(t),{adapter:i}=this.#e.executor,n=t.query;return n.returning&&i.supportsReturning||n.output&&i.supportsOutput?r.rows:[new CU(r.numAffectedRows)]}async executeTakeFirst(){const[t]=await this.execute();return t}async executeTakeFirstOrThrow(t=Ns){const r=await this.executeTakeFirst();if(r===void 0)throw $s(t)?new t(this.toOperationNode()):t(this.toOperationNode());return r}}class Pg{#e;constructor(t){this.#e=p(t)}thenDelete(){return new Tt({...this.#e,queryNode:kr.cloneWithThen(this.#e.queryNode,oa("delete"))})}thenDoNothing(){return new Tt({...this.#e,queryNode:kr.cloneWithThen(this.#e.queryNode,oa("do nothing"))})}thenUpdate(t){return new Tt({...this.#e,queryNode:kr.cloneWithThen(this.#e.queryNode,oa(t(new xe({queryId:this.#e.queryId,executor:cd,queryNode:ji.createWithoutTable()}))))})}thenUpdateSet(...t){return this.thenUpdate(r=>r.set(...t))}}class PU{#e;constructor(t){this.#e=p(t)}thenDoNothing(){return new Tt({...this.#e,queryNode:kr.cloneWithThen(this.#e.queryNode,oa("do nothing"))})}thenInsertValues(t){const[r,i]=$k(t);return new Tt({...this.#e,queryNode:kr.cloneWithThen(this.#e.queryNode,oa(ot.cloneWith(ot.createWithoutInto(),{columns:r,values:i})))})}}class $n{#e;constructor(t){this.#e=p(t)}selectFrom(t){return Wl({queryId:ce(),executor:this.#e.executor,queryNode:Ee.createFrom(Mi(t),this.#e.withNode)})}selectNoFrom(t){return Wl({queryId:ce(),executor:this.#e.executor,queryNode:Ee.cloneWithSelections(Ee.create(this.#e.withNode),Vt(t))})}insertInto(t){return new be({queryId:ce(),executor:this.#e.executor,queryNode:ot.create(Be(t),this.#e.withNode)})}replaceInto(t){return new be({queryId:ce(),executor:this.#e.executor,queryNode:ot.create(Be(t),this.#e.withNode,!0)})}deleteFrom(t){return new Ce({queryId:ce(),executor:this.#e.executor,queryNode:ea.create(Mi(t),this.#e.withNode)})}updateTable(t){return new xe({queryId:ce(),executor:this.#e.executor,queryNode:ji.create(Mi(t),this.#e.withNode)})}mergeInto(t){return new vn({queryId:ce(),executor:this.#e.executor,queryNode:kr.create(Lk(t),this.#e.withNode)})}with(t,r){const i=Rg(t,r);return new $n({...this.#e,withNode:this.#e.withNode?zs.cloneWithExpression(this.#e.withNode,i):zs.create(i)})}withRecursive(t,r){const i=Rg(t,r);return new $n({...this.#e,withNode:this.#e.withNode?zs.cloneWithExpression(this.#e.withNode,i):zs.create(i,{recursive:!0})})}withPlugin(t){return new $n({...this.#e,executor:this.#e.executor.withPlugin(t)})}withoutPlugins(){return new $n({...this.#e,executor:this.#e.executor.withoutPlugins()})}withSchema(t){return new $n({...this.#e,executor:this.#e.executor.withPluginAtFront(new To(t))})}}function LU(){return new $n({executor:cd})}function zU(e,t){return new ta({joinNode:ai.create(e,Na(t))})}function jU(){return new ra({overNode:ql.create()})}function ud(e,t){if(t.length===3)return qU(e,t[0],t[1],t[2]);if(t.length===2)return MU(e,t[0],t[1]);if(t.length===1)return WU(e,t[0]);throw new Error("not implemented")}function MU(e,t,r){return r(zU(e,t)).toOperationNode()}function qU(e,t,r,i){return ai.createWithOn(e,Na(t),Tr(r,"=",i))}function WU(e,t){return ai.create(e,Na(t))}const FU=p({is(e){return e.kind==="OffsetNode"},create(e){return p({kind:"OffsetNode",offset:e})}}),BU=p({is(e){return e.kind==="GroupByItemNode"},create(e){return p({kind:"GroupByItemNode",groupBy:e})}});function VU(e){return e=St(e)?e(xo()):e,Sa(e).map(BU.create)}const Dk=p({is(e){return e.kind==="SetOperationNode"},create(e,t,r){return p({kind:"SetOperationNode",operator:e,expression:t,all:r})}});function Ii(e,t,r){return St(t)&&(t=t(Zp())),sn(t)||(t=[t]),t.map(i=>Dk.create(e,_i(i),r))}class _e{#e;constructor(t){this.#e=t}get expressionType(){}as(t){return new Hp(this,t)}or(...t){return new Ec(Eo.create(this.#e,gt(t)))}and(...t){return new Ac(Pn.create(this.#e,gt(t)))}$castTo(){return new _e(this.#e)}$notNull(){return new _e(this.#e)}toOperationNode(){return this.#e}}class Hp{#e;#t;constructor(t,r){this.#e=t,this.#t=r}get expression(){return this.#e}get alias(){return this.#t}toOperationNode(){return fn.create(this.#e.toOperationNode(),At(this.#t)?this.#t.toOperationNode():ve.create(this.#t))}}class Ec{#e;constructor(t){this.#e=t}get expressionType(){}as(t){return new Hp(this,t)}or(...t){return new Ec(Eo.create(this.#e,gt(t)))}$castTo(){return new Ec(this.#e)}toOperationNode(){return Kr.create(this.#e)}}class Ac{#e;constructor(t){this.#e=t}get expressionType(){}as(t){return new Hp(this,t)}and(...t){return new Ac(Pn.create(this.#e,gt(t)))}$castTo(){return new Ac(this.#e)}toOperationNode(){return Kr.create(this.#e)}}const KU={is(e){return e.kind==="FetchNode"},create(e,t){return{kind:"FetchNode",rowCount:ir.create(e),modifier:t}}};function JU(e,t){if(!io(e)&&!od(e))throw new Error(`Invalid fetch row count: ${e}`);if(!HU(t))throw new Error(`Invalid fetch modifier: ${t}`);return KU.create(e,t)}function HU(e){return e==="only"||e==="with ties"}class re{#e;constructor(t){this.#e=p(t)}get expressionType(){}get isSelectQueryBuilder(){return!0}where(...t){return new re({...this.#e,queryNode:V.cloneWithWhere(this.#e.queryNode,gt(t))})}whereRef(t,r,i){return new re({...this.#e,queryNode:V.cloneWithWhere(this.#e.queryNode,Tr(t,r,i))})}having(...t){return new re({...this.#e,queryNode:Ee.cloneWithHaving(this.#e.queryNode,gt(t))})}havingRef(t,r,i){return new re({...this.#e,queryNode:Ee.cloneWithHaving(this.#e.queryNode,Tr(t,r,i))})}select(t){return new re({...this.#e,queryNode:Ee.cloneWithSelections(this.#e.queryNode,Vt(t))})}distinctOn(t){return new re({...this.#e,queryNode:Ee.cloneWithDistinctOn(this.#e.queryNode,Sa(t))})}modifyFront(t){return new re({...this.#e,queryNode:Ee.cloneWithFrontModifier(this.#e.queryNode,zr.createWithExpression(t.toOperationNode()))})}modifyEnd(t){return new re({...this.#e,queryNode:V.cloneWithEndModifier(this.#e.queryNode,zr.createWithExpression(t.toOperationNode()))})}distinct(){return new re({...this.#e,queryNode:Ee.cloneWithFrontModifier(this.#e.queryNode,zr.create("Distinct"))})}forUpdate(t){return new re({...this.#e,queryNode:V.cloneWithEndModifier(this.#e.queryNode,zr.create("ForUpdate",t?Ls(t).map(Be):void 0))})}forShare(t){return new re({...this.#e,queryNode:V.cloneWithEndModifier(this.#e.queryNode,zr.create("ForShare",t?Ls(t).map(Be):void 0))})}forKeyShare(t){return new re({...this.#e,queryNode:V.cloneWithEndModifier(this.#e.queryNode,zr.create("ForKeyShare",t?Ls(t).map(Be):void 0))})}forNoKeyUpdate(t){return new re({...this.#e,queryNode:V.cloneWithEndModifier(this.#e.queryNode,zr.create("ForNoKeyUpdate",t?Ls(t).map(Be):void 0))})}skipLocked(){return new re({...this.#e,queryNode:V.cloneWithEndModifier(this.#e.queryNode,zr.create("SkipLocked"))})}noWait(){return new re({...this.#e,queryNode:V.cloneWithEndModifier(this.#e.queryNode,zr.create("NoWait"))})}selectAll(t){return new re({...this.#e,queryNode:Ee.cloneWithSelections(this.#e.queryNode,or(t))})}innerJoin(...t){return this.#t("InnerJoin",t)}leftJoin(...t){return this.#t("LeftJoin",t)}rightJoin(...t){return this.#t("RightJoin",t)}fullJoin(...t){return this.#t("FullJoin",t)}crossJoin(...t){return this.#t("CrossJoin",t)}innerJoinLateral(...t){return this.#t("LateralInnerJoin",t)}leftJoinLateral(...t){return this.#t("LateralLeftJoin",t)}crossJoinLateral(...t){return this.#t("LateralCrossJoin",t)}crossApply(...t){return this.#t("CrossApply",t)}outerApply(...t){return this.#t("OuterApply",t)}#t(t,r){return new re({...this.#e,queryNode:V.cloneWithJoin(this.#e.queryNode,ud(t,r))})}orderBy(...t){return new re({...this.#e,queryNode:V.cloneWithOrderByItems(this.#e.queryNode,fi(t))})}groupBy(t){return new re({...this.#e,queryNode:Ee.cloneWithGroupByItems(this.#e.queryNode,VU(t))})}limit(t){return new re({...this.#e,queryNode:Ee.cloneWithLimit(this.#e.queryNode,Jp.create(Ge(t)))})}offset(t){return new re({...this.#e,queryNode:Ee.cloneWithOffset(this.#e.queryNode,FU.create(Ge(t)))})}fetch(t,r="only"){return new re({...this.#e,queryNode:Ee.cloneWithFetch(this.#e.queryNode,JU(t,r))})}top(t,r){return new re({...this.#e,queryNode:V.cloneWithTop(this.#e.queryNode,Io(t,r))})}union(t){return new re({...this.#e,queryNode:Ee.cloneWithSetOperations(this.#e.queryNode,Ii("union",t,!1))})}unionAll(t){return new re({...this.#e,queryNode:Ee.cloneWithSetOperations(this.#e.queryNode,Ii("union",t,!0))})}intersect(t){return new re({...this.#e,queryNode:Ee.cloneWithSetOperations(this.#e.queryNode,Ii("intersect",t,!1))})}intersectAll(t){return new re({...this.#e,queryNode:Ee.cloneWithSetOperations(this.#e.queryNode,Ii("intersect",t,!0))})}except(t){return new re({...this.#e,queryNode:Ee.cloneWithSetOperations(this.#e.queryNode,Ii("except",t,!1))})}exceptAll(t){return new re({...this.#e,queryNode:Ee.cloneWithSetOperations(this.#e.queryNode,Ii("except",t,!0))})}as(t){return new ZU(this,t)}clearSelect(){return new re({...this.#e,queryNode:Ee.cloneWithoutSelections(this.#e.queryNode)})}clearWhere(){return new re({...this.#e,queryNode:V.cloneWithoutWhere(this.#e.queryNode)})}clearLimit(){return new re({...this.#e,queryNode:Ee.cloneWithoutLimit(this.#e.queryNode)})}clearOffset(){return new re({...this.#e,queryNode:Ee.cloneWithoutOffset(this.#e.queryNode)})}clearOrderBy(){return new re({...this.#e,queryNode:V.cloneWithoutOrderBy(this.#e.queryNode)})}clearGroupBy(){return new re({...this.#e,queryNode:Ee.cloneWithoutGroupBy(this.#e.queryNode)})}$call(t){return t(this)}$if(t,r){return t?r(this):new re({...this.#e})}$castTo(){return new re(this.#e)}$narrowType(){return new re(this.#e)}$assertType(){return new re(this.#e)}$asTuple(){return new _e(this.toOperationNode())}$asScalar(){return new _e(this.toOperationNode())}withPlugin(t){return new re({...this.#e,executor:this.#e.executor.withPlugin(t)})}toOperationNode(){return this.#e.executor.transformQuery(this.#e.queryNode,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){const t=this.compile();return(await this.#e.executor.executeQuery(t)).rows}async executeTakeFirst(){const[t]=await this.execute();return t}async executeTakeFirstOrThrow(t=Ns){const r=await this.executeTakeFirst();if(r===void 0)throw $s(t)?new t(this.toOperationNode()):t(this.toOperationNode());return r}async*stream(t=100){const r=this.compile(),i=this.#e.executor.stream(r,t);for await(const n of i)yield*n.rows}async explain(t,r){return await new re({...this.#e,queryNode:V.cloneWithExplain(this.#e.queryNode,t,r)}).execute()}}function Wl(e){return new re(e)}class ZU{#e;#t;constructor(t,r){this.#e=t,this.#t=r}get expression(){return this.#e}get alias(){return this.#t}get isAliasedSelectQueryBuilder(){return!0}toOperationNode(){return fn.create(this.#e.toOperationNode(),ve.create(this.#t))}}const En=p({is(e){return e.kind==="AggregateFunctionNode"},create(e,t=[]){return p({kind:"AggregateFunctionNode",func:e,aggregated:t})},cloneWithDistinct(e){return p({...e,distinct:!0})},cloneWithOrderBy(e,t,r=!1){const i=r?"withinGroup":"orderBy";return p({...e,[i]:e[i]?ao.cloneWithItems(e[i],t):ao.create(t)})},cloneWithFilter(e,t){return p({...e,filter:e.filter?It.cloneWithOperation(e.filter,"And",t):It.create(t)})},cloneWithOrFilter(e,t){return p({...e,filter:e.filter?It.cloneWithOperation(e.filter,"Or",t):It.create(t)})},cloneWithOver(e,t){return p({...e,over:t})}}),Lg=p({is(e){return e.kind==="FunctionNode"},create(e,t){return p({kind:"FunctionNode",func:e,arguments:t})}});class Ct{#e;constructor(t){this.#e=p(t)}get expressionType(){}as(t){return new GU(this,t)}distinct(){return new Ct({...this.#e,aggregateFunctionNode:En.cloneWithDistinct(this.#e.aggregateFunctionNode)})}orderBy(...t){return new Ct({...this.#e,aggregateFunctionNode:V.cloneWithOrderByItems(this.#e.aggregateFunctionNode,fi(t))})}clearOrderBy(){return new Ct({...this.#e,aggregateFunctionNode:V.cloneWithoutOrderBy(this.#e.aggregateFunctionNode)})}withinGroupOrderBy(...t){return new Ct({...this.#e,aggregateFunctionNode:En.cloneWithOrderBy(this.#e.aggregateFunctionNode,fi(t),!0)})}filterWhere(...t){return new Ct({...this.#e,aggregateFunctionNode:En.cloneWithFilter(this.#e.aggregateFunctionNode,gt(t))})}filterWhereRef(t,r,i){return new Ct({...this.#e,aggregateFunctionNode:En.cloneWithFilter(this.#e.aggregateFunctionNode,Tr(t,r,i))})}over(t){const r=jU();return new Ct({...this.#e,aggregateFunctionNode:En.cloneWithOver(this.#e.aggregateFunctionNode,(t?t(r):r).toOperationNode())})}$call(t){return t(this)}$castTo(){return new Ct(this.#e)}$notNull(){return new Ct(this.#e)}toOperationNode(){return this.#e.aggregateFunctionNode}}class GU{#e;#t;constructor(t,r){this.#e=t,this.#t=r}get expression(){return this.#e}get alias(){return this.#t}toOperationNode(){return fn.create(this.#e.toOperationNode(),ve.create(this.#t))}}function Rk(){const e=(r,i)=>new _e(Lg.create(r,Sa(i??[]))),t=(r,i)=>new Ct({aggregateFunctionNode:En.create(r,i?Sa(i):void 0)});return Object.assign(e,{agg:t,avg(r){return t("avg",[r])},coalesce(...r){return e("coalesce",r)},count(r){return t("count",[r])},countAll(r){return new Ct({aggregateFunctionNode:En.create("count",or(r))})},max(r){return t("max",[r])},min(r){return t("min",[r])},sum(r){return t("sum",[r])},any(r){return e("any",[r])},jsonAgg(r){return new Ct({aggregateFunctionNode:En.create("json_agg",[mt(r)?Be(r):r.toOperationNode()])})},toJson(r){return new _e(Lg.create("to_json",[mt(r)?Be(r):r.toOperationNode()]))}})}const QU=p({is(e){return e.kind==="UnaryOperationNode"},create(e,t){return p({kind:"UnaryOperationNode",operator:e,operand:t})}});function YU(e,t){return QU.create(Ln.create(e),jt(t))}const Sr=p({is(e){return e.kind==="CaseNode"},create(e){return p({kind:"CaseNode",value:e})},cloneWithWhen(e,t){return p({...e,when:p(e.when?[...e.when,t]:[t])})},cloneWithThen(e,t){return p({...e,when:e.when?p([...e.when.slice(0,-1),hi.cloneWithResult(e.when[e.when.length-1],t)]):void 0})},cloneWith(e,t){return p({...e,...t})}});class Uk{#e;constructor(t){this.#e=p(t)}when(...t){return new Ck({...this.#e,node:Sr.cloneWithWhen(this.#e.node,hi.create(gt(t)))})}}class Ck{#e;constructor(t){this.#e=p(t)}then(t){return new XU({...this.#e,node:Sr.cloneWithThen(this.#e.node,Fp(t)?Bp(t):Ge(t))})}}class XU{#e;constructor(t){this.#e=p(t)}when(...t){return new Ck({...this.#e,node:Sr.cloneWithWhen(this.#e.node,hi.create(gt(t)))})}else(t){return new eC({...this.#e,node:Sr.cloneWith(this.#e.node,{else:Fp(t)?Bp(t):Ge(t)})})}end(){return new _e(Sr.cloneWith(this.#e.node,{isStatement:!1}))}endCase(){return new _e(Sr.cloneWith(this.#e.node,{isStatement:!0}))}}class eC{#e;constructor(t){this.#e=p(t)}end(){return new _e(Sr.cloneWith(this.#e.node,{isStatement:!1}))}endCase(){return new _e(Sr.cloneWith(this.#e.node,{isStatement:!0}))}}const zg=p({is(e){return e.kind==="JSONPathLegNode"},create(e,t){return p({kind:"JSONPathLegNode",type:e,value:t})}});class Fl{#e;constructor(t){this.#e=t}at(t){return this.#t("ArrayLocation",t)}key(t){return this.#t("Member",t)}#t(t,r){return bc.is(this.#e)?new ka(bc.cloneWithTraversal(this.#e,Xo.is(this.#e.traversal)?Xo.cloneWithLeg(this.#e.traversal,zg.create(t,r)):vk.cloneWithValue(this.#e.traversal,ir.createImmediate(r)))):new ka(Xo.cloneWithLeg(this.#e,zg.create(t,r)))}}class ka extends Fl{#e;constructor(t){super(t),this.#e=t}get expressionType(){}as(t){return new tC(this,t)}$castTo(){return new ka(this.#e)}$notNull(){return new ka(this.#e)}toOperationNode(){return this.#e}}class tC{#e;#t;constructor(t,r){this.#e=t,this.#t=r}get expression(){return this.#e}get alias(){return this.#t}toOperationNode(){return fn.create(this.#e.toOperationNode(),At(this.#t)?this.#t.toOperationNode():ve.create(this.#t))}}const jg=p({is(e){return e.kind==="TupleNode"},create(e){return p({kind:"TupleNode",values:p(e)})}}),rC=["varchar","char","text","integer","int2","int4","int8","smallint","bigint","boolean","real","double precision","float4","float8","decimal","numeric","binary","bytea","date","datetime","time","timetz","timestamp","timestamptz","serial","bigserial","uuid","json","jsonb","blob","varbinary","int4range","int4multirange","int8range","int8multirange","numrange","nummultirange","tsrange","tsmultirange","tstzrange","tstzmultirange","daterange","datemultirange"],nC=[/^varchar\(\d+\)$/,/^char\(\d+\)$/,/^decimal\(\d+, \d+\)$/,/^numeric\(\d+, \d+\)$/,/^binary\(\d+\)$/,/^datetime\(\d+\)$/,/^time\(\d+\)$/,/^timetz\(\d+\)$/,/^timestamp\(\d+\)$/,/^timestamptz\(\d+\)$/,/^varbinary\(\d+\)$/],iC=p({is(e){return e.kind==="DataTypeNode"},create(e){return p({kind:"DataTypeNode",dataType:e})}});function oC(e){return!!(rC.includes(e)||nC.some(t=>t.test(e)))}function pi(e){if(At(e))return e.toOperationNode();if(oC(e))return iC.create(e);throw new Error(`invalid column data type ${JSON.stringify(e)}`)}const aC=p({is(e){return e.kind==="CastNode"},create(e,t){return p({kind:"CastNode",expression:e,dataType:t})}});function Zp(e=cd){function t(n,o,a){return new _e(Vp(n,o,a))}function r(n,o){return new _e(YU(n,o))}const i=Object.assign(t,{fn:void 0,eb:void 0,selectFrom(n){return Wl({queryId:ce(),executor:e,queryNode:Ee.createFrom(Mi(n))})},case(n){return new Uk({node:Sr.create(Hr(n)?void 0:jt(n))})},ref(n,o){return Hr(o)?new _e(un(n)):new Fl(iU(n,o))},jsonPath(){return new Fl(Xo.create())},table(n){return new _e(Be(n))},val(n){return new _e(Ge(n))},refTuple(...n){return new _e(jg.create(n.map(jt)))},tuple(...n){return new _e(jg.create(n.map(Ge)))},lit(n){return new _e(Bp(n))},unary:r,not(n){return r("not",n)},exists(n){return r("exists",n)},neg(n){return r("-",n)},between(n,o,a){return new _e(oo.create(jt(n),Ln.create("between"),Pn.create(Ge(o),Ge(a))))},betweenSymmetric(n,o,a){return new _e(oo.create(jt(n),Ln.create("between symmetric"),Pn.create(Ge(o),Ge(a))))},and(n){return sn(n)?new _e(Sc(n,"and")):new _e(Sg(n,"and"))},or(n){return sn(n)?new _e(Sc(n,"or")):new _e(Sg(n,"or"))},parens(...n){const o=gt(n);return Kr.is(o)?new _e(o):new _e(Kr.create(o))},cast(n,o){return new _e(aC.create(jt(n),pi(o)))},withSchema(n){return Zp(e.withPluginAtFront(new To(n)))}});return i.fn=Rk(),i.eb=i,i}function xo(e){return Zp()}function _i(e){if(At(e))return e.toOperationNode();if(St(e))return e(xo()).toOperationNode();throw new Error(`invalid expression: ${JSON.stringify(e)}`)}function Pk(e){if(At(e))return e.toOperationNode();if(St(e))return e(xo()).toOperationNode();throw new Error(`invalid aliased expression: ${JSON.stringify(e)}`)}function Es(e){return pk(e)||HR(e)||St(e)}class sC{#e;get table(){return this.#e}constructor(t){this.#e=t}as(t){return new cC(this.#e,t)}}class cC{#e;#t;get table(){return this.#e}get alias(){return this.#t}constructor(t,r){this.#e=t,this.#t=r}toOperationNode(){return fn.create(Be(this.#e),ve.create(this.#t))}}function uC(e){return zt(e)&&At(e)&&mt(e.table)&&mt(e.alias)}function Mi(e){return sn(e)?e.map(t=>Na(t)):[Na(e)]}function Na(e){return mt(e)?Lk(e):uC(e)?e.toOperationNode():Pk(e)}function Lk(e){const t=" as ";if(e.includes(t)){const[r,i]=e.split(t).map(zk);return fn.create(Be(r),ve.create(i))}else return Be(e)}function Be(e){if(e.includes(".")){const[r,i]=e.split(".").map(zk);return Vr.createWithSchema(r,i)}else return Vr.create(e)}function zk(e){return e.trim()}const jk=p({is(e){return e.kind==="AddColumnNode"},create(e){return p({kind:"AddColumnNode",column:e})}}),Pe=p({is(e){return e.kind==="ColumnDefinitionNode"},create(e,t){return p({kind:"ColumnDefinitionNode",column:Ke.create(e),dataType:t})},cloneWithFrontModifier(e,t){return p({...e,frontModifiers:e.frontModifiers?p([...e.frontModifiers,t]):[t]})},cloneWithEndModifier(e,t){return p({...e,endModifiers:e.endModifiers?p([...e.endModifiers,t]):[t]})},cloneWith(e,t){return p({...e,...t})}}),Mk=p({is(e){return e.kind==="DropColumnNode"},create(e){return p({kind:"DropColumnNode",column:Ke.create(e)})}}),qk=p({is(e){return e.kind==="RenameColumnNode"},create(e,t){return p({kind:"RenameColumnNode",column:Ke.create(e),renameTo:Ke.create(t)})}}),Gp=p({is(e){return e.kind==="CheckConstraintNode"},create(e,t){return p({kind:"CheckConstraintNode",expression:e,name:t?ve.create(t):void 0})}}),dC=["no action","restrict","cascade","set null","set default"],Zs=p({is(e){return e.kind==="ReferencesNode"},create(e,t){return p({kind:"ReferencesNode",table:e,columns:p([...t])})},cloneWithOnDelete(e,t){return p({...e,onDelete:t})},cloneWithOnUpdate(e,t){return p({...e,onUpdate:t})}});function Wk(e){return At(e)?e.toOperationNode():ir.createImmediate(e)}const js=p({is(e){return e.kind==="GeneratedNode"},create(e){return p({kind:"GeneratedNode",...e})},createWithExpression(e){return p({kind:"GeneratedNode",always:!0,expression:e})},cloneWith(e,t){return p({...e,...t})}}),lC=p({is(e){return e.kind==="DefaultValueNode"},create(e){return p({kind:"DefaultValueNode",defaultValue:e})}});function Ic(e){if(dC.includes(e))return e;throw new Error(`invalid OnModifyForeignAction ${e}`)}class Oe{#e;constructor(t){this.#e=t}autoIncrement(){return new Oe(Pe.cloneWith(this.#e,{autoIncrement:!0}))}identity(){return new Oe(Pe.cloneWith(this.#e,{identity:!0}))}primaryKey(){return new Oe(Pe.cloneWith(this.#e,{primaryKey:!0}))}references(t){const r=un(t);if(!r.table||qp.is(r.column))throw new Error(`invalid call references('${t}'). The reference must have format table.column or schema.table.column`);return new Oe(Pe.cloneWith(this.#e,{references:Zs.create(r.table,[r.column])}))}onDelete(t){if(!this.#e.references)throw new Error("on delete constraint can only be added for foreign keys");return new Oe(Pe.cloneWith(this.#e,{references:Zs.cloneWithOnDelete(this.#e.references,Ic(t))}))}onUpdate(t){if(!this.#e.references)throw new Error("on update constraint can only be added for foreign keys");return new Oe(Pe.cloneWith(this.#e,{references:Zs.cloneWithOnUpdate(this.#e.references,Ic(t))}))}unique(){return new Oe(Pe.cloneWith(this.#e,{unique:!0}))}notNull(){return new Oe(Pe.cloneWith(this.#e,{notNull:!0}))}unsigned(){return new Oe(Pe.cloneWith(this.#e,{unsigned:!0}))}defaultTo(t){return new Oe(Pe.cloneWith(this.#e,{defaultTo:lC.create(Wk(t))}))}check(t){return new Oe(Pe.cloneWith(this.#e,{check:Gp.create(t.toOperationNode())}))}generatedAlwaysAs(t){return new Oe(Pe.cloneWith(this.#e,{generated:js.createWithExpression(t.toOperationNode())}))}generatedAlwaysAsIdentity(){return new Oe(Pe.cloneWith(this.#e,{generated:js.create({identity:!0,always:!0})}))}generatedByDefaultAsIdentity(){return new Oe(Pe.cloneWith(this.#e,{generated:js.create({identity:!0,byDefault:!0})}))}stored(){if(!this.#e.generated)throw new Error("stored() can only be called after generatedAlwaysAs");return new Oe(Pe.cloneWith(this.#e,{generated:js.cloneWith(this.#e.generated,{stored:!0})}))}modifyFront(t){return new Oe(Pe.cloneWithFrontModifier(this.#e,t.toOperationNode()))}nullsNotDistinct(){return new Oe(Pe.cloneWith(this.#e,{nullsNotDistinct:!0}))}ifNotExists(){return new Oe(Pe.cloneWith(this.#e,{ifNotExists:!0}))}modifyEnd(t){return new Oe(Pe.cloneWithEndModifier(this.#e,t.toOperationNode()))}$call(t){return t(this)}toOperationNode(){return this.#e}}const Fk=p({is(e){return e.kind==="ModifyColumnNode"},create(e){return p({kind:"ModifyColumnNode",column:e})}}),bn=p({is(e){return e.kind==="ForeignKeyConstraintNode"},create(e,t,r,i){return p({kind:"ForeignKeyConstraintNode",columns:e,references:Zs.create(t,r),name:i?ve.create(i):void 0})},cloneWith(e,t){return p({...e,...t})}});class Fr{#e;constructor(t){this.#e=t}onDelete(t){return new Fr(bn.cloneWith(this.#e,{onDelete:Ic(t)}))}onUpdate(t){return new Fr(bn.cloneWith(this.#e,{onUpdate:Ic(t)}))}deferrable(){return new Fr(bn.cloneWith(this.#e,{deferrable:!0}))}notDeferrable(){return new Fr(bn.cloneWith(this.#e,{deferrable:!1}))}initiallyDeferred(){return new Fr(bn.cloneWith(this.#e,{initiallyDeferred:!0}))}initiallyImmediate(){return new Fr(bn.cloneWith(this.#e,{initiallyDeferred:!1}))}$call(t){return t(this)}toOperationNode(){return this.#e}}const Gs=p({is(e){return e.kind==="AddConstraintNode"},create(e){return p({kind:"AddConstraintNode",constraint:e})}}),Gn=p({is(e){return e.kind==="UniqueConstraintNode"},create(e,t,r){return p({kind:"UniqueConstraintNode",columns:p(e.map(Ke.create)),name:t?ve.create(t):void 0,nullsNotDistinct:r})},cloneWith(e,t){return p({...e,...t})}}),Qs=p({is(e){return e.kind==="DropConstraintNode"},create(e){return p({kind:"DropConstraintNode",constraintName:ve.create(e)})},cloneWith(e,t){return p({...e,...t})}}),Mo=p({is(e){return e.kind==="AlterColumnNode"},create(e,t,r){return p({kind:"AlterColumnNode",column:Ke.create(e),[t]:r})}});class Bk{#e;constructor(t){this.#e=t}setDataType(t){return new qo(Mo.create(this.#e,"dataType",pi(t)))}setDefault(t){return new qo(Mo.create(this.#e,"setDefault",Wk(t)))}dropDefault(){return new qo(Mo.create(this.#e,"dropDefault",!0))}setNotNull(){return new qo(Mo.create(this.#e,"setNotNull",!0))}dropNotNull(){return new qo(Mo.create(this.#e,"dropNotNull",!0))}$call(t){return t(this)}}class qo{#e;constructor(t){this.#e=t}toOperationNode(){return this.#e}}class Ti{#e;constructor(t){this.#e=p(t)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}class _n{#e;constructor(t){this.#e=p(t)}onDelete(t){return new _n({...this.#e,constraintBuilder:this.#e.constraintBuilder.onDelete(t)})}onUpdate(t){return new _n({...this.#e,constraintBuilder:this.#e.constraintBuilder.onUpdate(t)})}deferrable(){return new _n({...this.#e,constraintBuilder:this.#e.constraintBuilder.deferrable()})}notDeferrable(){return new _n({...this.#e,constraintBuilder:this.#e.constraintBuilder.notDeferrable()})}initiallyDeferred(){return new _n({...this.#e,constraintBuilder:this.#e.constraintBuilder.initiallyDeferred()})}initiallyImmediate(){return new _n({...this.#e,constraintBuilder:this.#e.constraintBuilder.initiallyImmediate()})}$call(t){return t(this)}toOperationNode(){return this.#e.executor.transformQuery(ye.cloneWithTableProps(this.#e.node,{addConstraint:Gs.create(this.#e.constraintBuilder.toOperationNode())}),this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}class qi{#e;constructor(t){this.#e=p(t)}ifExists(){return new qi({...this.#e,node:ye.cloneWithTableProps(this.#e.node,{dropConstraint:Qs.cloneWith(this.#e.node.dropConstraint,{ifExists:!0})})})}cascade(){return new qi({...this.#e,node:ye.cloneWithTableProps(this.#e.node,{dropConstraint:Qs.cloneWith(this.#e.node.dropConstraint,{modifier:"cascade"})})})}restrict(){return new qi({...this.#e,node:ye.cloneWithTableProps(this.#e.node,{dropConstraint:Qs.cloneWith(this.#e.node.dropConstraint,{modifier:"restrict"})})})}$call(t){return t(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}const Ci=p({is(e){return e.kind==="PrimaryKeyConstraintNode"},create(e,t){return p({kind:"PrimaryKeyConstraintNode",columns:p(e.map(Ke.create)),name:t?ve.create(t):void 0})},cloneWith(e,t){return p({...e,...t})}}),Ri=p({is(e){return e.kind==="AddIndexNode"},create(e){return p({kind:"AddIndexNode",name:ve.create(e)})},cloneWith(e,t){return p({...e,...t})},cloneWithColumns(e,t){return p({...e,columns:[...e.columns||[],...t]})}});class Qn{#e;constructor(t){this.#e=p(t)}unique(){return new Qn({...this.#e,node:ye.cloneWithTableProps(this.#e.node,{addIndex:Ri.cloneWith(this.#e.node.addIndex,{unique:!0})})})}column(t){return new Qn({...this.#e,node:ye.cloneWithTableProps(this.#e.node,{addIndex:Ri.cloneWithColumns(this.#e.node.addIndex,[_c(t)])})})}columns(t){return new Qn({...this.#e,node:ye.cloneWithTableProps(this.#e.node,{addIndex:Ri.cloneWithColumns(this.#e.node.addIndex,t.map(_c))})})}expression(t){return new Qn({...this.#e,node:ye.cloneWithTableProps(this.#e.node,{addIndex:Ri.cloneWithColumns(this.#e.node.addIndex,[t.toOperationNode()])})})}using(t){return new Qn({...this.#e,node:ye.cloneWithTableProps(this.#e.node,{addIndex:Ri.cloneWith(this.#e.node.addIndex,{using:Le.createWithSql(t)})})})}$call(t){return t(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}class An{#e;constructor(t){this.#e=t}nullsNotDistinct(){return new An(Gn.cloneWith(this.#e,{nullsNotDistinct:!0}))}deferrable(){return new An(Gn.cloneWith(this.#e,{deferrable:!0}))}notDeferrable(){return new An(Gn.cloneWith(this.#e,{deferrable:!1}))}initiallyDeferred(){return new An(Gn.cloneWith(this.#e,{initiallyDeferred:!0}))}initiallyImmediate(){return new An(Gn.cloneWith(this.#e,{initiallyDeferred:!1}))}$call(t){return t(this)}toOperationNode(){return this.#e}}class ti{#e;constructor(t){this.#e=t}deferrable(){return new ti(Ci.cloneWith(this.#e,{deferrable:!0}))}notDeferrable(){return new ti(Ci.cloneWith(this.#e,{deferrable:!1}))}initiallyDeferred(){return new ti(Ci.cloneWith(this.#e,{initiallyDeferred:!0}))}initiallyImmediate(){return new ti(Ci.cloneWith(this.#e,{initiallyDeferred:!1}))}$call(t){return t(this)}toOperationNode(){return this.#e}}class Vk{#e;constructor(t){this.#e=t}$call(t){return t(this)}toOperationNode(){return this.#e}}const fC=p({is(e){return e.kind==="RenameConstraintNode"},create(e,t){return p({kind:"RenameConstraintNode",oldName:ve.create(e),newName:ve.create(t)})}});class hC{#e;constructor(t){this.#e=p(t)}renameTo(t){return new Ti({...this.#e,node:ye.cloneWithTableProps(this.#e.node,{renameTo:Be(t)})})}setSchema(t){return new Ti({...this.#e,node:ye.cloneWithTableProps(this.#e.node,{setSchema:ve.create(t)})})}alterColumn(t,r){const i=r(new Bk(t));return new dr({...this.#e,node:ye.cloneWithColumnAlteration(this.#e.node,i.toOperationNode())})}dropColumn(t){return new dr({...this.#e,node:ye.cloneWithColumnAlteration(this.#e.node,Mk.create(t))})}renameColumn(t,r){return new dr({...this.#e,node:ye.cloneWithColumnAlteration(this.#e.node,qk.create(t,r))})}addColumn(t,r,i=Lt){const n=i(new Oe(Pe.create(t,pi(r))));return new dr({...this.#e,node:ye.cloneWithColumnAlteration(this.#e.node,jk.create(n.toOperationNode()))})}modifyColumn(t,r,i=Lt){const n=i(new Oe(Pe.create(t,pi(r))));return new dr({...this.#e,node:ye.cloneWithColumnAlteration(this.#e.node,Fk.create(n.toOperationNode()))})}addUniqueConstraint(t,r,i=Lt){const n=i(new An(Gn.create(r,t)));return new Ti({...this.#e,node:ye.cloneWithTableProps(this.#e.node,{addConstraint:Gs.create(n.toOperationNode())})})}addCheckConstraint(t,r,i=Lt){const n=i(new Vk(Gp.create(r.toOperationNode(),t)));return new Ti({...this.#e,node:ye.cloneWithTableProps(this.#e.node,{addConstraint:Gs.create(n.toOperationNode())})})}addForeignKeyConstraint(t,r,i,n,o=Lt){const a=o(new Fr(bn.create(r.map(Ke.create),Be(i),n.map(Ke.create),t)));return new _n({...this.#e,constraintBuilder:a})}addPrimaryKeyConstraint(t,r,i=Lt){const n=i(new ti(Ci.create(r,t)));return new Ti({...this.#e,node:ye.cloneWithTableProps(this.#e.node,{addConstraint:Gs.create(n.toOperationNode())})})}dropConstraint(t){return new qi({...this.#e,node:ye.cloneWithTableProps(this.#e.node,{dropConstraint:Qs.create(t)})})}renameConstraint(t,r){return new qi({...this.#e,node:ye.cloneWithTableProps(this.#e.node,{renameConstraint:fC.create(t,r)})})}addIndex(t){return new Qn({...this.#e,node:ye.cloneWithTableProps(this.#e.node,{addIndex:Ri.create(t)})})}dropIndex(t){return new Ti({...this.#e,node:ye.cloneWithTableProps(this.#e.node,{dropIndex:Yo.create(t)})})}$call(t){return t(this)}}class dr{#e;constructor(t){this.#e=p(t)}alterColumn(t,r){const i=r(new Bk(t));return new dr({...this.#e,node:ye.cloneWithColumnAlteration(this.#e.node,i.toOperationNode())})}dropColumn(t){return new dr({...this.#e,node:ye.cloneWithColumnAlteration(this.#e.node,Mk.create(t))})}renameColumn(t,r){return new dr({...this.#e,node:ye.cloneWithColumnAlteration(this.#e.node,qk.create(t,r))})}addColumn(t,r,i=Lt){const n=i(new Oe(Pe.create(t,pi(r))));return new dr({...this.#e,node:ye.cloneWithColumnAlteration(this.#e.node,jk.create(n.toOperationNode()))})}modifyColumn(t,r,i=Lt){const n=i(new Oe(Pe.create(t,pi(r))));return new dr({...this.#e,node:ye.cloneWithColumnAlteration(this.#e.node,Fk.create(n.toOperationNode()))})}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}class Kk extends Tk{transformPrimitiveValueList(t){return sd.create(t.values.map(ir.createImmediate))}transformValue(t){return ir.createImmediate(t.value)}}class sr{#e;constructor(t){this.#e=p(t)}ifNotExists(){return new sr({...this.#e,node:jr.cloneWith(this.#e.node,{ifNotExists:!0})})}unique(){return new sr({...this.#e,node:jr.cloneWith(this.#e.node,{unique:!0})})}nullsNotDistinct(){return new sr({...this.#e,node:jr.cloneWith(this.#e.node,{nullsNotDistinct:!0})})}on(t){return new sr({...this.#e,node:jr.cloneWith(this.#e.node,{table:Be(t)})})}column(t){return new sr({...this.#e,node:jr.cloneWithColumns(this.#e.node,[_c(t)])})}columns(t){return new sr({...this.#e,node:jr.cloneWithColumns(this.#e.node,t.map(_c))})}expression(t){return new sr({...this.#e,node:jr.cloneWithColumns(this.#e.node,[t.toOperationNode()])})}using(t){return new sr({...this.#e,node:jr.cloneWith(this.#e.node,{using:Le.createWithSql(t)})})}where(...t){const r=new Kk;return new sr({...this.#e,node:V.cloneWithWhere(this.#e.node,r.transformNode(gt(t),this.#e.queryId))})}$call(t){return t(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}class Qp{#e;constructor(t){this.#e=p(t)}ifNotExists(){return new Qp({...this.#e,node:hk.cloneWith(this.#e.node,{ifNotExists:!0})})}$call(t){return t(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}function pC(e){if(JR.includes(e))return e;throw new Error(`invalid OnCommitAction ${e}`)}class Dt{#e;constructor(t){this.#e=p(t)}temporary(){return new Dt({...this.#e,node:Ot.cloneWith(this.#e.node,{temporary:!0})})}onCommit(t){return new Dt({...this.#e,node:Ot.cloneWith(this.#e.node,{onCommit:pC(t)})})}ifNotExists(){return new Dt({...this.#e,node:Ot.cloneWith(this.#e.node,{ifNotExists:!0})})}addColumn(t,r,i=Lt){const n=i(new Oe(Pe.create(t,pi(r))));return new Dt({...this.#e,node:Ot.cloneWithColumn(this.#e.node,n.toOperationNode())})}addPrimaryKeyConstraint(t,r,i=Lt){const n=i(new ti(Ci.create(r,t)));return new Dt({...this.#e,node:Ot.cloneWithConstraint(this.#e.node,n.toOperationNode())})}addUniqueConstraint(t,r,i=Lt){const n=i(new An(Gn.create(r,t)));return new Dt({...this.#e,node:Ot.cloneWithConstraint(this.#e.node,n.toOperationNode())})}addCheckConstraint(t,r,i=Lt){const n=i(new Vk(Gp.create(r.toOperationNode(),t)));return new Dt({...this.#e,node:Ot.cloneWithConstraint(this.#e.node,n.toOperationNode())})}addForeignKeyConstraint(t,r,i,n,o=Lt){const a=o(new Fr(bn.create(r.map(Ke.create),Be(i),n.map(Ke.create),t)));return new Dt({...this.#e,node:Ot.cloneWithConstraint(this.#e.node,a.toOperationNode())})}modifyFront(t){return new Dt({...this.#e,node:Ot.cloneWithFrontModifier(this.#e.node,t.toOperationNode())})}modifyEnd(t){return new Dt({...this.#e,node:Ot.cloneWithEndModifier(this.#e.node,t.toOperationNode())})}as(t){return new Dt({...this.#e,node:Ot.cloneWith(this.#e.node,{selectQuery:_i(t)})})}$call(t){return t(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}class sa{#e;constructor(t){this.#e=p(t)}on(t){return new sa({...this.#e,node:Yo.cloneWith(this.#e.node,{table:Be(t)})})}ifExists(){return new sa({...this.#e,node:Yo.cloneWith(this.#e.node,{ifExists:!0})})}cascade(){return new sa({...this.#e,node:Yo.cloneWith(this.#e.node,{cascade:!0})})}$call(t){return t(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}class Tc{#e;constructor(t){this.#e=p(t)}ifExists(){return new Tc({...this.#e,node:zl.cloneWith(this.#e.node,{ifExists:!0})})}cascade(){return new Tc({...this.#e,node:zl.cloneWith(this.#e.node,{cascade:!0})})}$call(t){return t(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}class xc{#e;constructor(t){this.#e=p(t)}ifExists(){return new xc({...this.#e,node:jl.cloneWith(this.#e.node,{ifExists:!0})})}cascade(){return new xc({...this.#e,node:jl.cloneWith(this.#e.node,{cascade:!0})})}$call(t){return t(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}const Sn=p({is(e){return e.kind==="CreateViewNode"},create(e){return p({kind:"CreateViewNode",name:cn.create(e)})},cloneWith(e,t){return p({...e,...t})}});class mC{#e=new Kk;transformQuery(t){return this.#e.transformNode(t.node,t.queryId)}transformResult(t){return Promise.resolve(t.result)}}class kn{#e;constructor(t){this.#e=p(t)}temporary(){return new kn({...this.#e,node:Sn.cloneWith(this.#e.node,{temporary:!0})})}materialized(){return new kn({...this.#e,node:Sn.cloneWith(this.#e.node,{materialized:!0})})}ifNotExists(){return new kn({...this.#e,node:Sn.cloneWith(this.#e.node,{ifNotExists:!0})})}orReplace(){return new kn({...this.#e,node:Sn.cloneWith(this.#e.node,{orReplace:!0})})}columns(t){return new kn({...this.#e,node:Sn.cloneWith(this.#e.node,{columns:t.map(_k)})})}as(t){const r=t.withPlugin(new mC).toOperationNode();return new kn({...this.#e,node:Sn.cloneWith(this.#e.node,{as:r})})}$call(t){return t(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}const Ys=p({is(e){return e.kind==="DropViewNode"},create(e){return p({kind:"DropViewNode",name:cn.create(e)})},cloneWith(e,t){return p({...e,...t})}});class ca{#e;constructor(t){this.#e=p(t)}materialized(){return new ca({...this.#e,node:Ys.cloneWith(this.#e.node,{materialized:!0})})}ifExists(){return new ca({...this.#e,node:Ys.cloneWith(this.#e.node,{ifExists:!0})})}cascade(){return new ca({...this.#e,node:Ys.cloneWith(this.#e.node,{cascade:!0})})}$call(t){return t(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}const Jk=p({is(e){return e.kind==="CreateTypeNode"},create(e){return p({kind:"CreateTypeNode",name:e})},cloneWithEnum(e,t){return p({...e,enum:sd.create(t.map(ir.createImmediate))})}});class Yp{#e;constructor(t){this.#e=p(t)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}asEnum(t){return new Yp({...this.#e,node:Jk.cloneWithEnum(this.#e.node,t)})}$call(t){return t(this)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}const Hk=p({is(e){return e.kind==="DropTypeNode"},create(e){return p({kind:"DropTypeNode",name:e})},cloneWith(e,t){return p({...e,...t})}});class Xp{#e;constructor(t){this.#e=p(t)}ifExists(){return new Xp({...this.#e,node:Hk.cloneWith(this.#e.node,{ifExists:!0})})}$call(t){return t(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}function Mg(e){if(e.includes(".")){const r=e.split(".").map(gC);if(r.length===2)return cn.createWithSchema(r[0],r[1]);throw new Error(`invalid schemable identifier ${e}`)}else return cn.create(e)}function gC(e){return e.trim()}const Xs=p({is(e){return e.kind==="RefreshMaterializedViewNode"},create(e){return p({kind:"RefreshMaterializedViewNode",name:cn.create(e)})},cloneWith(e,t){return p({...e,...t})}});class ua{#e;constructor(t){this.#e=p(t)}concurrently(){return new ua({...this.#e,node:Xs.cloneWith(this.#e.node,{concurrently:!0,withNoData:!1})})}withData(){return new ua({...this.#e,node:Xs.cloneWith(this.#e.node,{withNoData:!1})})}withNoData(){return new ua({...this.#e,node:Xs.cloneWith(this.#e.node,{withNoData:!0,concurrently:!1})})}$call(t){return t(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}class da{#e;constructor(t){this.#e=t}createTable(t){return new Dt({queryId:ce(),executor:this.#e,node:Ot.create(Be(t))})}dropTable(t){return new xc({queryId:ce(),executor:this.#e,node:jl.create(Be(t))})}createIndex(t){return new sr({queryId:ce(),executor:this.#e,node:jr.create(t)})}dropIndex(t){return new sa({queryId:ce(),executor:this.#e,node:Yo.create(t)})}createSchema(t){return new Qp({queryId:ce(),executor:this.#e,node:hk.create(t)})}dropSchema(t){return new Tc({queryId:ce(),executor:this.#e,node:zl.create(t)})}alterTable(t){return new hC({queryId:ce(),executor:this.#e,node:ye.create(Be(t))})}createView(t){return new kn({queryId:ce(),executor:this.#e,node:Sn.create(t)})}refreshMaterializedView(t){return new ua({queryId:ce(),executor:this.#e,node:Xs.create(t)})}dropView(t){return new ca({queryId:ce(),executor:this.#e,node:Ys.create(t)})}createType(t){return new Yp({queryId:ce(),executor:this.#e,node:Jk.create(Mg(t))})}dropType(t){return new Xp({queryId:ce(),executor:this.#e,node:Hk.create(Mg(t))})}withPlugin(t){return new da(this.#e.withPlugin(t))}withoutPlugins(){return new da(this.#e.withoutPlugins())}withSchema(t){return new da(this.#e.withPluginAtFront(new To(t)))}}class yC{ref(t){return new tU(t)}table(t){return new sC(t)}}class wC{#e;constructor(t){this.#e=t}async provideConnection(t){const r=await this.#e.acquireConnection();try{return await t(r)}finally{await this.#e.releaseConnection(r)}}}class Yn extends Ok{#e;#t;#r;constructor(t,r,i,n=[]){super(n),this.#e=t,this.#t=r,this.#r=i}get adapter(){return this.#t}compileQuery(t,r){return this.#e.compileQuery(t,r)}provideConnection(t){return this.#r.provideConnection(t)}withPlugins(t){return new Yn(this.#e,this.#t,this.#r,[...this.plugins,...t])}withPlugin(t){return new Yn(this.#e,this.#t,this.#r,[...this.plugins,t])}withPluginAtFront(t){return new Yn(this.#e,this.#t,this.#r,[t,...this.plugins])}withConnectionProvider(t){return new Yn(this.#e,this.#t,t,[...this.plugins])}withoutPlugins(){return new Yn(this.#e,this.#t,this.#r,[])}}function Qd(){return typeof performance<"u"&&St(performance.now)?performance.now():Date.now()}class vC{#e;#t;#r;#n;#i;#a=new WeakSet;constructor(t,r){this.#n=!1,this.#e=t,this.#t=r}async init(){if(this.#i)throw new Error("driver has already been destroyed");this.#r||(this.#r=this.#e.init().then(()=>{this.#n=!0}).catch(t=>(this.#r=void 0,Promise.reject(t)))),await this.#r}async acquireConnection(){if(this.#i)throw new Error("driver has already been destroyed");this.#n||await this.init();const t=await this.#e.acquireConnection();return this.#a.has(t)||(this.#s()&&this.#o(t),this.#a.add(t)),t}async releaseConnection(t){await this.#e.releaseConnection(t)}beginTransaction(t,r){return this.#e.beginTransaction(t,r)}commitTransaction(t){return this.#e.commitTransaction(t)}rollbackTransaction(t){return this.#e.rollbackTransaction(t)}savepoint(t,r,i){if(this.#e.savepoint)return this.#e.savepoint(t,r,i);throw new Error("The `savepoint` method is not supported by this driver")}rollbackToSavepoint(t,r,i){if(this.#e.rollbackToSavepoint)return this.#e.rollbackToSavepoint(t,r,i);throw new Error("The `rollbackToSavepoint` method is not supported by this driver")}releaseSavepoint(t,r,i){if(this.#e.releaseSavepoint)return this.#e.releaseSavepoint(t,r,i);throw new Error("The `releaseSavepoint` method is not supported by this driver")}async destroy(){this.#r&&(await this.#r,this.#i||(this.#i=this.#e.destroy().catch(t=>(this.#i=void 0,Promise.reject(t)))),await this.#i)}#s(){return this.#t.isLevelEnabled("query")||this.#t.isLevelEnabled("error")}#o(t){const r=t.executeQuery,i=t.streamQuery,n=this;t.executeQuery=async o=>{let a;const s=Qd();try{return await r.call(t,o)}catch(c){throw a=c,await n.#c(c,o,s),c}finally{a||await n.#u(o,s)}},t.streamQuery=async function*(o,a){let s;const c=Qd();try{for await(const u of i.call(t,o,a))yield u}catch(u){throw s=u,await n.#c(u,o,c),u}finally{s||await n.#u(o,c,!0)}}}async#c(t,r,i){await this.#t.error(()=>({level:"error",error:t,query:r,queryDurationMillis:this.#d(i)}))}async#u(t,r,i=!1){await this.#t.query(()=>({level:"query",isStream:i,query:t,queryDurationMillis:this.#d(r)}))}#d(t){return Qd()-t}}const bC=()=>{};class em{#e;#t;constructor(t){this.#e=t}async provideConnection(t){for(;this.#t;)await this.#t.catch(bC);return this.#t=this.#r(t).finally(()=>{this.#t=void 0}),this.#t}async#r(t){return await t(this.#e)}}const _C=["read only","read write"],SC=["read uncommitted","read committed","repeatable read","serializable","snapshot"];function Zk(e){if(e.accessMode&&!_C.includes(e.accessMode))throw new Error(`invalid transaction access mode ${e.accessMode}`);if(e.isolationLevel&&!SC.includes(e.isolationLevel))throw new Error(`invalid transaction isolation level ${e.isolationLevel}`)}p(["query","error"]);class kC{#e;#t;constructor(t){St(t)?(this.#t=t,this.#e=p({query:!0,error:!0})):(this.#t=NC,this.#e=p({query:t.includes("query"),error:t.includes("error")}))}isLevelEnabled(t){return this.#e[t]}async query(t){this.#e.query&&await this.#t(t())}async error(t){this.#e.error&&await this.#t(t())}}function NC(e){if(e.level==="query"){const t=`kysely:query:${e.isStream?"stream:":""}`;console.log(`${t} ${e.query.sql}`),console.log(`${t} duration: ${e.queryDurationMillis.toFixed(1)}ms`)}else e.level==="error"&&(e.error instanceof Error?console.error(`kysely:error: ${e.error.stack??e.error.message}`):console.error(`kysely:error: ${JSON.stringify({error:e.error,query:e.query.sql,queryDurationMillis:e.queryDurationMillis})}`))}function $C(e){return zt(e)&&St(e.compile)}Symbol.asyncDispose??=Symbol("Symbol.asyncDispose");class Jr extends $n{#e;constructor(t){let r,i;if(EC(t))r={executor:t.executor},i={...t};else{const n=t.dialect,o=n.createDriver(),a=n.createQueryCompiler(),s=n.createAdapter(),c=new kC(t.log??[]),u=new vC(o,c),d=new wC(u),l=new Yn(a,s,d,t.plugins??[]);r={executor:l},i={config:t,executor:l,dialect:n,driver:u}}super(r),this.#e=p(i)}get schema(){return new da(this.#e.executor)}get dynamic(){return new yC}get introspection(){return this.#e.dialect.createIntrospector(this.withoutPlugins())}case(t){return new Uk({node:Sr.create(Hr(t)?void 0:_i(t))})}get fn(){return Rk()}transaction(){return new Oc({...this.#e})}startTransaction(){return new Dc({...this.#e})}connection(){return new AC({...this.#e})}withPlugin(t){return new Jr({...this.#e,executor:this.#e.executor.withPlugin(t)})}withoutPlugins(){return new Jr({...this.#e,executor:this.#e.executor.withoutPlugins()})}withSchema(t){return new Jr({...this.#e,executor:this.#e.executor.withPluginAtFront(new To(t))})}withTables(){return new Jr({...this.#e})}async destroy(){await this.#e.driver.destroy()}get isTransaction(){return!1}getExecutor(){return this.#e.executor}executeQuery(t,r){r!==void 0&&Ao("Passing `queryId` in `db.executeQuery` is deprecated and will result in a compile-time error in the future.");const i=$C(t)?t.compile():t;return this.getExecutor().executeQuery(i)}async[Symbol.asyncDispose](){await this.destroy()}}class ri extends Jr{#e;constructor(t){super(t),this.#e=t}get isTransaction(){return!0}transaction(){throw new Error("calling the transaction method for a Transaction is not supported")}connection(){throw new Error("calling the connection method for a Transaction is not supported")}async destroy(){throw new Error("calling the destroy method for a Transaction is not supported")}withPlugin(t){return new ri({...this.#e,executor:this.#e.executor.withPlugin(t)})}withoutPlugins(){return new ri({...this.#e,executor:this.#e.executor.withoutPlugins()})}withSchema(t){return new ri({...this.#e,executor:this.#e.executor.withPluginAtFront(new To(t))})}withTables(){return new ri({...this.#e})}}function EC(e){return zt(e)&&zt(e.config)&&zt(e.driver)&&zt(e.executor)&&zt(e.dialect)}class AC{#e;constructor(t){this.#e=p(t)}async execute(t){return this.#e.executor.provideConnection(async r=>{const i=this.#e.executor.withConnectionProvider(new em(r)),n=new Jr({...this.#e,executor:i});return await t(n)})}}class Oc{#e;constructor(t){this.#e=p(t)}setAccessMode(t){return new Oc({...this.#e,accessMode:t})}setIsolationLevel(t){return new Oc({...this.#e,isolationLevel:t})}async execute(t){const{isolationLevel:r,accessMode:i,...n}=this.#e,o={isolationLevel:r,accessMode:i};return Zk(o),this.#e.executor.provideConnection(async a=>{const s=this.#e.executor.withConnectionProvider(new em(a)),c=new ri({...n,executor:s});let u=!1;try{await this.#e.driver.beginTransaction(a,o),u=!0;const d=await t(c);return await this.#e.driver.commitTransaction(a),d}catch(d){throw u&&await this.#e.driver.rollbackTransaction(a),d}})}}class Dc{#e;constructor(t){this.#e=p(t)}setAccessMode(t){return new Dc({...this.#e,accessMode:t})}setIsolationLevel(t){return new Dc({...this.#e,isolationLevel:t})}async execute(){const{isolationLevel:t,accessMode:r,...i}=this.#e,n={isolationLevel:t,accessMode:r};Zk(n);const o=await xk(this.#e.executor);return await this.#e.driver.beginTransaction(o.connection,n),new Wr({...i,connection:o,executor:this.#e.executor.withConnectionProvider(new em(o.connection))})}}class Wr extends ri{#e;#t;#r;constructor(t){const r={isCommitted:!1,isRolledBack:!1};t={...t,executor:new Nn(t.executor,r)};const{connection:i,...n}=t;super(n),this.#e=p(t),this.#r=r;const o=ce();this.#t=a=>t.executor.compileQuery(a,o)}get isCommitted(){return this.#r.isCommitted}get isRolledBack(){return this.#r.isRolledBack}commit(){return Xn(this.#r),new Wo(async()=>{await this.#e.driver.commitTransaction(this.#e.connection.connection),this.#r.isCommitted=!0,this.#e.connection.release()})}rollback(){return Xn(this.#r),new Wo(async()=>{await this.#e.driver.rollbackTransaction(this.#e.connection.connection),this.#r.isRolledBack=!0,this.#e.connection.release()})}savepoint(t){return Xn(this.#r),new Wo(async()=>(await this.#e.driver.savepoint?.(this.#e.connection.connection,t,this.#t),new Wr({...this.#e})))}rollbackToSavepoint(t){return Xn(this.#r),new Wo(async()=>(await this.#e.driver.rollbackToSavepoint?.(this.#e.connection.connection,t,this.#t),new Wr({...this.#e})))}releaseSavepoint(t){return Xn(this.#r),new Wo(async()=>(await this.#e.driver.releaseSavepoint?.(this.#e.connection.connection,t,this.#t),new Wr({...this.#e})))}withPlugin(t){return new Wr({...this.#e,executor:this.#e.executor.withPlugin(t)})}withoutPlugins(){return new Wr({...this.#e,executor:this.#e.executor.withoutPlugins()})}withSchema(t){return new Wr({...this.#e,executor:this.#e.executor.withPluginAtFront(new To(t))})}withTables(){return new Wr({...this.#e})}}class Wo{#e;constructor(t){this.#e=t}async execute(){return await this.#e()}}function Xn(e){if(e.isCommitted)throw new Error("Transaction is already committed");if(e.isRolledBack)throw new Error("Transaction is already rolled back")}class Nn{#e;#t;constructor(t,r){t instanceof Nn?this.#e=t.#e:this.#e=t,this.#t=r}get adapter(){return this.#e.adapter}get plugins(){return this.#e.plugins}transformQuery(t,r){return this.#e.transformQuery(t,r)}compileQuery(t,r){return this.#e.compileQuery(t,r)}provideConnection(t){return this.#e.provideConnection(t)}executeQuery(t){return Xn(this.#t),this.#e.executeQuery(t)}stream(t,r){return Xn(this.#t),this.#e.stream(t,r)}withConnectionProvider(t){return new Nn(this.#e.withConnectionProvider(t),this.#t)}withPlugin(t){return new Nn(this.#e.withPlugin(t),this.#t)}withPlugins(t){return new Nn(this.#e.withPlugins(t),this.#t)}withPluginAtFront(t){return new Nn(this.#e.withPluginAtFront(t),this.#t)}withoutPlugins(){return new Nn(this.#e.withoutPlugins(),this.#t)}}class la{#e;constructor(t){this.#e=p(t)}get expressionType(){}get isRawBuilder(){return!0}as(t){return new IC(this,t)}$castTo(){return new la({...this.#e})}$notNull(){return new la(this.#e)}withPlugin(t){return new la({...this.#e,plugins:this.#e.plugins!==void 0?p([...this.#e.plugins,t]):p([t])})}toOperationNode(){return this.#r(this.#t())}compile(t){return this.#n(this.#t(t))}async execute(t){const r=this.#t(t);return r.executeQuery(this.#n(r))}#t(t){const r=t!==void 0?t.getExecutor():cd;return this.#e.plugins!==void 0?r.withPlugins(this.#e.plugins):r}#r(t){return t.transformQuery(this.#e.rawNode,this.#e.queryId)}#n(t){return t.compileQuery(this.#r(t),this.#e.queryId)}}function gn(e){return new la(e)}class IC{#e;#t;constructor(t,r){this.#e=t,this.#t=r}get expression(){return this.#e}get alias(){return this.#t}get rawBuilder(){return this.#e}toOperationNode(){return fn.create(this.#e.toOperationNode(),At(this.#t)?this.#t.toOperationNode():ve.create(this.#t))}}const Ae=Object.assign((e,...t)=>gn({queryId:ce(),rawNode:Le.create(e,t?.map(qg)??[])}),{ref(e){return gn({queryId:ce(),rawNode:Le.createWithChild(un(e))})},val(e){return gn({queryId:ce(),rawNode:Le.createWithChild(Ge(e))})},value(e){return this.val(e)},table(e){return gn({queryId:ce(),rawNode:Le.createWithChild(Be(e))})},id(...e){const t=new Array(e.length+1).fill(".");return t[0]="",t[t.length-1]="",gn({queryId:ce(),rawNode:Le.create(t,e.map(ve.create))})},lit(e){return gn({queryId:ce(),rawNode:Le.createWithChild(ir.createImmediate(e))})},literal(e){return this.lit(e)},raw(e){return gn({queryId:ce(),rawNode:Le.createWithSql(e)})},join(e,t=Ae`, `){const r=new Array(Math.max(2*e.length-1,0)),i=t.toOperationNode();for(let n=0;n<e.length;++n)r[2*n]=qg(e[n]),n!==e.length-1&&(r[2*n+1]=i);return gn({queryId:ce(),rawNode:Le.createWithChildren(r)})}});function qg(e){return At(e)?e.toOperationNode():Ge(e)}class TC{nodeStack=[];get parentNode(){return this.nodeStack[this.nodeStack.length-2]}#e=p({AliasNode:this.visitAlias.bind(this),ColumnNode:this.visitColumn.bind(this),IdentifierNode:this.visitIdentifier.bind(this),SchemableIdentifierNode:this.visitSchemableIdentifier.bind(this),RawNode:this.visitRaw.bind(this),ReferenceNode:this.visitReference.bind(this),SelectQueryNode:this.visitSelectQuery.bind(this),SelectionNode:this.visitSelection.bind(this),TableNode:this.visitTable.bind(this),FromNode:this.visitFrom.bind(this),SelectAllNode:this.visitSelectAll.bind(this),AndNode:this.visitAnd.bind(this),OrNode:this.visitOr.bind(this),ValueNode:this.visitValue.bind(this),ValueListNode:this.visitValueList.bind(this),PrimitiveValueListNode:this.visitPrimitiveValueList.bind(this),ParensNode:this.visitParens.bind(this),JoinNode:this.visitJoin.bind(this),OperatorNode:this.visitOperator.bind(this),WhereNode:this.visitWhere.bind(this),InsertQueryNode:this.visitInsertQuery.bind(this),DeleteQueryNode:this.visitDeleteQuery.bind(this),ReturningNode:this.visitReturning.bind(this),CreateTableNode:this.visitCreateTable.bind(this),AddColumnNode:this.visitAddColumn.bind(this),ColumnDefinitionNode:this.visitColumnDefinition.bind(this),DropTableNode:this.visitDropTable.bind(this),DataTypeNode:this.visitDataType.bind(this),OrderByNode:this.visitOrderBy.bind(this),OrderByItemNode:this.visitOrderByItem.bind(this),GroupByNode:this.visitGroupBy.bind(this),GroupByItemNode:this.visitGroupByItem.bind(this),UpdateQueryNode:this.visitUpdateQuery.bind(this),ColumnUpdateNode:this.visitColumnUpdate.bind(this),LimitNode:this.visitLimit.bind(this),OffsetNode:this.visitOffset.bind(this),OnConflictNode:this.visitOnConflict.bind(this),OnDuplicateKeyNode:this.visitOnDuplicateKey.bind(this),CreateIndexNode:this.visitCreateIndex.bind(this),DropIndexNode:this.visitDropIndex.bind(this),ListNode:this.visitList.bind(this),PrimaryKeyConstraintNode:this.visitPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.visitUniqueConstraint.bind(this),ReferencesNode:this.visitReferences.bind(this),CheckConstraintNode:this.visitCheckConstraint.bind(this),WithNode:this.visitWith.bind(this),CommonTableExpressionNode:this.visitCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.visitCommonTableExpressionName.bind(this),HavingNode:this.visitHaving.bind(this),CreateSchemaNode:this.visitCreateSchema.bind(this),DropSchemaNode:this.visitDropSchema.bind(this),AlterTableNode:this.visitAlterTable.bind(this),DropColumnNode:this.visitDropColumn.bind(this),RenameColumnNode:this.visitRenameColumn.bind(this),AlterColumnNode:this.visitAlterColumn.bind(this),ModifyColumnNode:this.visitModifyColumn.bind(this),AddConstraintNode:this.visitAddConstraint.bind(this),DropConstraintNode:this.visitDropConstraint.bind(this),RenameConstraintNode:this.visitRenameConstraint.bind(this),ForeignKeyConstraintNode:this.visitForeignKeyConstraint.bind(this),CreateViewNode:this.visitCreateView.bind(this),RefreshMaterializedViewNode:this.visitRefreshMaterializedView.bind(this),DropViewNode:this.visitDropView.bind(this),GeneratedNode:this.visitGenerated.bind(this),DefaultValueNode:this.visitDefaultValue.bind(this),OnNode:this.visitOn.bind(this),ValuesNode:this.visitValues.bind(this),SelectModifierNode:this.visitSelectModifier.bind(this),CreateTypeNode:this.visitCreateType.bind(this),DropTypeNode:this.visitDropType.bind(this),ExplainNode:this.visitExplain.bind(this),DefaultInsertValueNode:this.visitDefaultInsertValue.bind(this),AggregateFunctionNode:this.visitAggregateFunction.bind(this),OverNode:this.visitOver.bind(this),PartitionByNode:this.visitPartitionBy.bind(this),PartitionByItemNode:this.visitPartitionByItem.bind(this),SetOperationNode:this.visitSetOperation.bind(this),BinaryOperationNode:this.visitBinaryOperation.bind(this),UnaryOperationNode:this.visitUnaryOperation.bind(this),UsingNode:this.visitUsing.bind(this),FunctionNode:this.visitFunction.bind(this),CaseNode:this.visitCase.bind(this),WhenNode:this.visitWhen.bind(this),JSONReferenceNode:this.visitJSONReference.bind(this),JSONPathNode:this.visitJSONPath.bind(this),JSONPathLegNode:this.visitJSONPathLeg.bind(this),JSONOperatorChainNode:this.visitJSONOperatorChain.bind(this),TupleNode:this.visitTuple.bind(this),MergeQueryNode:this.visitMergeQuery.bind(this),MatchedNode:this.visitMatched.bind(this),AddIndexNode:this.visitAddIndex.bind(this),CastNode:this.visitCast.bind(this),FetchNode:this.visitFetch.bind(this),TopNode:this.visitTop.bind(this),OutputNode:this.visitOutput.bind(this),OrActionNode:this.visitOrAction.bind(this),CollateNode:this.visitCollate.bind(this)});visitNode=t=>{this.nodeStack.push(t),this.#e[t.kind](t),this.nodeStack.pop()}}const xC=/'/g;class dd extends TC{#e="";#t=[];get numParameters(){return this.#t.length}compileQuery(t,r){return this.#e="",this.#t=[],this.nodeStack.splice(0,this.nodeStack.length),this.visitNode(t),p({query:t,queryId:r,sql:this.getSql(),parameters:[...this.#t]})}getSql(){return this.#e}visitSelectQuery(t){const r=this.parentNode!==void 0&&!Kr.is(this.parentNode)&&!ot.is(this.parentNode)&&!Ot.is(this.parentNode)&&!Sn.is(this.parentNode)&&!Dk.is(this.parentNode);this.parentNode===void 0&&t.explain&&(this.visitNode(t.explain),this.append(" ")),r&&this.append("("),t.with&&(this.visitNode(t.with),this.append(" ")),this.append("select"),t.distinctOn&&(this.append(" "),this.compileDistinctOn(t.distinctOn)),t.frontModifiers?.length&&(this.append(" "),this.compileList(t.frontModifiers," ")),t.top&&(this.append(" "),this.visitNode(t.top)),t.selections&&(this.append(" "),this.compileList(t.selections)),t.from&&(this.append(" "),this.visitNode(t.from)),t.joins&&(this.append(" "),this.compileList(t.joins," ")),t.where&&(this.append(" "),this.visitNode(t.where)),t.groupBy&&(this.append(" "),this.visitNode(t.groupBy)),t.having&&(this.append(" "),this.visitNode(t.having)),t.setOperations&&(this.append(" "),this.compileList(t.setOperations," ")),t.orderBy&&(this.append(" "),this.visitNode(t.orderBy)),t.limit&&(this.append(" "),this.visitNode(t.limit)),t.offset&&(this.append(" "),this.visitNode(t.offset)),t.fetch&&(this.append(" "),this.visitNode(t.fetch)),t.endModifiers?.length&&(this.append(" "),this.compileList(this.sortSelectModifiers([...t.endModifiers])," ")),r&&this.append(")")}visitFrom(t){this.append("from "),this.compileList(t.froms)}visitSelection(t){this.visitNode(t.selection)}visitColumn(t){this.visitNode(t.column)}compileDistinctOn(t){this.append("distinct on ("),this.compileList(t),this.append(")")}compileList(t,r=", "){const i=t.length-1;for(let n=0;n<=i;n++)this.visitNode(t[n]),n<i&&this.append(r)}visitWhere(t){this.append("where "),this.visitNode(t.where)}visitHaving(t){this.append("having "),this.visitNode(t.having)}visitInsertQuery(t){const r=this.parentNode!==void 0&&!Kr.is(this.parentNode)&&!Le.is(this.parentNode)&&!hi.is(this.parentNode);this.parentNode===void 0&&t.explain&&(this.visitNode(t.explain),this.append(" ")),r&&this.append("("),t.with&&(this.visitNode(t.with),this.append(" ")),this.append(t.replace?"replace":"insert"),t.ignore&&(Ao("`InsertQueryNode.ignore` is deprecated. Use `InsertQueryNode.orAction` instead."),this.append(" ignore")),t.orAction&&(this.append(" "),this.visitNode(t.orAction)),t.top&&(this.append(" "),this.visitNode(t.top)),t.into&&(this.append(" into "),this.visitNode(t.into)),t.columns&&(this.append(" ("),this.compileList(t.columns),this.append(")")),t.output&&(this.append(" "),this.visitNode(t.output)),t.values&&(this.append(" "),this.visitNode(t.values)),t.defaultValues&&(this.append(" "),this.append("default values")),t.onConflict&&(this.append(" "),this.visitNode(t.onConflict)),t.onDuplicateKey&&(this.append(" "),this.visitNode(t.onDuplicateKey)),t.returning&&(this.append(" "),this.visitNode(t.returning)),r&&this.append(")"),t.endModifiers?.length&&(this.append(" "),this.compileList(t.endModifiers," "))}visitValues(t){this.append("values "),this.compileList(t.values)}visitDeleteQuery(t){const r=this.parentNode!==void 0&&!Kr.is(this.parentNode)&&!Le.is(this.parentNode);this.parentNode===void 0&&t.explain&&(this.visitNode(t.explain),this.append(" ")),r&&this.append("("),t.with&&(this.visitNode(t.with),this.append(" ")),this.append("delete "),t.top&&(this.visitNode(t.top),this.append(" ")),this.visitNode(t.from),t.output&&(this.append(" "),this.visitNode(t.output)),t.using&&(this.append(" "),this.visitNode(t.using)),t.joins&&(this.append(" "),this.compileList(t.joins," ")),t.where&&(this.append(" "),this.visitNode(t.where)),t.orderBy&&(this.append(" "),this.visitNode(t.orderBy)),t.limit&&(this.append(" "),this.visitNode(t.limit)),t.returning&&(this.append(" "),this.visitNode(t.returning)),r&&this.append(")"),t.endModifiers?.length&&(this.append(" "),this.compileList(t.endModifiers," "))}visitReturning(t){this.append("returning "),this.compileList(t.selections)}visitAlias(t){this.visitNode(t.node),this.append(" as "),this.visitNode(t.alias)}visitReference(t){t.table&&(this.visitNode(t.table),this.append(".")),this.visitNode(t.column)}visitSelectAll(t){this.append("*")}visitIdentifier(t){this.append(this.getLeftIdentifierWrapper()),this.compileUnwrappedIdentifier(t),this.append(this.getRightIdentifierWrapper())}compileUnwrappedIdentifier(t){if(!mt(t.name))throw new Error("a non-string identifier was passed to compileUnwrappedIdentifier.");this.append(this.sanitizeIdentifier(t.name))}visitAnd(t){this.visitNode(t.left),this.append(" and "),this.visitNode(t.right)}visitOr(t){this.visitNode(t.left),this.append(" or "),this.visitNode(t.right)}visitValue(t){t.immediate?this.appendImmediateValue(t.value):this.appendValue(t.value)}visitValueList(t){this.append("("),this.compileList(t.values),this.append(")")}visitTuple(t){this.append("("),this.compileList(t.values),this.append(")")}visitPrimitiveValueList(t){this.append("(");const{values:r}=t;for(let i=0;i<r.length;++i)this.appendValue(r[i]),i!==r.length-1&&this.append(", ");this.append(")")}visitParens(t){this.append("("),this.visitNode(t.node),this.append(")")}visitJoin(t){this.append(DC[t.joinType]),this.append(" "),this.visitNode(t.table),t.on&&(this.append(" "),this.visitNode(t.on))}visitOn(t){this.append("on "),this.visitNode(t.on)}visitRaw(t){const{sqlFragments:r,parameters:i}=t;for(let n=0;n<r.length;++n)this.append(r[n]),i.length>n&&this.visitNode(i[n])}visitOperator(t){this.append(t.operator)}visitTable(t){this.visitNode(t.table)}visitSchemableIdentifier(t){t.schema&&(this.visitNode(t.schema),this.append(".")),this.visitNode(t.identifier)}visitCreateTable(t){this.append("create "),t.frontModifiers&&t.frontModifiers.length>0&&(this.compileList(t.frontModifiers," "),this.append(" ")),t.temporary&&this.append("temporary "),this.append("table "),t.ifNotExists&&this.append("if not exists "),this.visitNode(t.table),t.selectQuery?(this.append(" as "),this.visitNode(t.selectQuery)):(this.append(" ("),this.compileList([...t.columns,...t.constraints??[]]),this.append(")"),t.onCommit&&(this.append(" on commit "),this.append(t.onCommit)),t.endModifiers&&t.endModifiers.length>0&&(this.append(" "),this.compileList(t.endModifiers," ")))}visitColumnDefinition(t){t.ifNotExists&&this.append("if not exists "),this.visitNode(t.column),this.append(" "),this.visitNode(t.dataType),t.unsigned&&this.append(" unsigned"),t.frontModifiers&&t.frontModifiers.length>0&&(this.append(" "),this.compileList(t.frontModifiers," ")),t.generated&&(this.append(" "),this.visitNode(t.generated)),t.identity&&this.append(" identity"),t.defaultTo&&(this.append(" "),this.visitNode(t.defaultTo)),t.notNull&&this.append(" not null"),t.unique&&this.append(" unique"),t.nullsNotDistinct&&this.append(" nulls not distinct"),t.primaryKey&&this.append(" primary key"),t.autoIncrement&&(this.append(" "),this.append(this.getAutoIncrement())),t.references&&(this.append(" "),this.visitNode(t.references)),t.check&&(this.append(" "),this.visitNode(t.check)),t.endModifiers&&t.endModifiers.length>0&&(this.append(" "),this.compileList(t.endModifiers," "))}getAutoIncrement(){return"auto_increment"}visitReferences(t){this.append("references "),this.visitNode(t.table),this.append(" ("),this.compileList(t.columns),this.append(")"),t.onDelete&&(this.append(" on delete "),this.append(t.onDelete)),t.onUpdate&&(this.append(" on update "),this.append(t.onUpdate))}visitDropTable(t){this.append("drop table "),t.ifExists&&this.append("if exists "),this.visitNode(t.table),t.cascade&&this.append(" cascade")}visitDataType(t){this.append(t.dataType)}visitOrderBy(t){this.append("order by "),this.compileList(t.items)}visitOrderByItem(t){this.visitNode(t.orderBy),t.collation&&(this.append(" "),this.visitNode(t.collation)),t.direction&&(this.append(" "),this.visitNode(t.direction)),t.nulls&&(this.append(" nulls "),this.append(t.nulls))}visitGroupBy(t){this.append("group by "),this.compileList(t.items)}visitGroupByItem(t){this.visitNode(t.groupBy)}visitUpdateQuery(t){const r=this.parentNode!==void 0&&!Kr.is(this.parentNode)&&!Le.is(this.parentNode)&&!hi.is(this.parentNode);if(this.parentNode===void 0&&t.explain&&(this.visitNode(t.explain),this.append(" ")),r&&this.append("("),t.with&&(this.visitNode(t.with),this.append(" ")),this.append("update "),t.top&&(this.visitNode(t.top),this.append(" ")),t.table&&(this.visitNode(t.table),this.append(" ")),this.append("set "),t.updates&&this.compileList(t.updates),t.output&&(this.append(" "),this.visitNode(t.output)),t.from&&(this.append(" "),this.visitNode(t.from)),t.joins){if(!t.from)throw new Error("Joins in an update query are only supported as a part of a PostgreSQL 'update set from join' query. If you want to create a MySQL 'update join set' query, see https://kysely.dev/docs/examples/update/my-sql-joins");this.append(" "),this.compileList(t.joins," ")}t.where&&(this.append(" "),this.visitNode(t.where)),t.orderBy&&(this.append(" "),this.visitNode(t.orderBy)),t.limit&&(this.append(" "),this.visitNode(t.limit)),t.returning&&(this.append(" "),this.visitNode(t.returning)),r&&this.append(")"),t.endModifiers?.length&&(this.append(" "),this.compileList(t.endModifiers," "))}visitColumnUpdate(t){this.visitNode(t.column),this.append(" = "),this.visitNode(t.value)}visitLimit(t){this.append("limit "),this.visitNode(t.limit)}visitOffset(t){this.append("offset "),this.visitNode(t.offset)}visitOnConflict(t){this.append("on conflict"),t.columns?(this.append(" ("),this.compileList(t.columns),this.append(")")):t.constraint?(this.append(" on constraint "),this.visitNode(t.constraint)):t.indexExpression&&(this.append(" ("),this.visitNode(t.indexExpression),this.append(")")),t.indexWhere&&(this.append(" "),this.visitNode(t.indexWhere)),t.doNothing===!0?this.append(" do nothing"):t.updates&&(this.append(" do update set "),this.compileList(t.updates),t.updateWhere&&(this.append(" "),this.visitNode(t.updateWhere)))}visitOnDuplicateKey(t){this.append("on duplicate key update "),this.compileList(t.updates)}visitCreateIndex(t){this.append("create "),t.unique&&this.append("unique "),this.append("index "),t.ifNotExists&&this.append("if not exists "),this.visitNode(t.name),t.table&&(this.append(" on "),this.visitNode(t.table)),t.using&&(this.append(" using "),this.visitNode(t.using)),t.columns&&(this.append(" ("),this.compileList(t.columns),this.append(")")),t.nullsNotDistinct&&this.append(" nulls not distinct"),t.where&&(this.append(" "),this.visitNode(t.where))}visitDropIndex(t){this.append("drop index "),t.ifExists&&this.append("if exists "),this.visitNode(t.name),t.table&&(this.append(" on "),this.visitNode(t.table)),t.cascade&&this.append(" cascade")}visitCreateSchema(t){this.append("create schema "),t.ifNotExists&&this.append("if not exists "),this.visitNode(t.schema)}visitDropSchema(t){this.append("drop schema "),t.ifExists&&this.append("if exists "),this.visitNode(t.schema),t.cascade&&this.append(" cascade")}visitPrimaryKeyConstraint(t){t.name&&(this.append("constraint "),this.visitNode(t.name),this.append(" ")),this.append("primary key ("),this.compileList(t.columns),this.append(")"),this.buildDeferrable(t)}buildDeferrable(t){t.deferrable!==void 0&&(t.deferrable?this.append(" deferrable"):this.append(" not deferrable")),t.initiallyDeferred!==void 0&&(t.initiallyDeferred?this.append(" initially deferred"):this.append(" initially immediate"))}visitUniqueConstraint(t){t.name&&(this.append("constraint "),this.visitNode(t.name),this.append(" ")),this.append("unique"),t.nullsNotDistinct&&this.append(" nulls not distinct"),this.append(" ("),this.compileList(t.columns),this.append(")"),this.buildDeferrable(t)}visitCheckConstraint(t){t.name&&(this.append("constraint "),this.visitNode(t.name),this.append(" ")),this.append("check ("),this.visitNode(t.expression),this.append(")")}visitForeignKeyConstraint(t){t.name&&(this.append("constraint "),this.visitNode(t.name),this.append(" ")),this.append("foreign key ("),this.compileList(t.columns),this.append(") "),this.visitNode(t.references),t.onDelete&&(this.append(" on delete "),this.append(t.onDelete)),t.onUpdate&&(this.append(" on update "),this.append(t.onUpdate)),this.buildDeferrable(t)}visitList(t){this.compileList(t.items)}visitWith(t){this.append("with "),t.recursive&&this.append("recursive "),this.compileList(t.expressions)}visitCommonTableExpression(t){this.visitNode(t.name),this.append(" as "),_a(t.materialized)&&(t.materialized||this.append("not "),this.append("materialized ")),this.visitNode(t.expression)}visitCommonTableExpressionName(t){this.visitNode(t.table),t.columns&&(this.append("("),this.compileList(t.columns),this.append(")"))}visitAlterTable(t){this.append("alter table "),this.visitNode(t.table),this.append(" "),t.renameTo&&(this.append("rename to "),this.visitNode(t.renameTo)),t.setSchema&&(this.append("set schema "),this.visitNode(t.setSchema)),t.addConstraint&&this.visitNode(t.addConstraint),t.dropConstraint&&this.visitNode(t.dropConstraint),t.renameConstraint&&this.visitNode(t.renameConstraint),t.columnAlterations&&this.compileColumnAlterations(t.columnAlterations),t.addIndex&&this.visitNode(t.addIndex),t.dropIndex&&this.visitNode(t.dropIndex)}visitAddColumn(t){this.append("add column "),this.visitNode(t.column)}visitRenameColumn(t){this.append("rename column "),this.visitNode(t.column),this.append(" to "),this.visitNode(t.renameTo)}visitDropColumn(t){this.append("drop column "),this.visitNode(t.column)}visitAlterColumn(t){this.append("alter column "),this.visitNode(t.column),this.append(" "),t.dataType&&(this.announcesNewColumnDataType()&&this.append("type "),this.visitNode(t.dataType),t.dataTypeExpression&&(this.append("using "),this.visitNode(t.dataTypeExpression))),t.setDefault&&(this.append("set default "),this.visitNode(t.setDefault)),t.dropDefault&&this.append("drop default"),t.setNotNull&&this.append("set not null"),t.dropNotNull&&this.append("drop not null")}visitModifyColumn(t){this.append("modify column "),this.visitNode(t.column)}visitAddConstraint(t){this.append("add "),this.visitNode(t.constraint)}visitDropConstraint(t){this.append("drop constraint "),t.ifExists&&this.append("if exists "),this.visitNode(t.constraintName),t.modifier==="cascade"?this.append(" cascade"):t.modifier==="restrict"&&this.append(" restrict")}visitRenameConstraint(t){this.append("rename constraint "),this.visitNode(t.oldName),this.append(" to "),this.visitNode(t.newName)}visitSetOperation(t){this.append(t.operator),this.append(" "),t.all&&this.append("all "),this.visitNode(t.expression)}visitCreateView(t){this.append("create "),t.orReplace&&this.append("or replace "),t.materialized&&this.append("materialized "),t.temporary&&this.append("temporary "),this.append("view "),t.ifNotExists&&this.append("if not exists "),this.visitNode(t.name),this.append(" "),t.columns&&(this.append("("),this.compileList(t.columns),this.append(") ")),t.as&&(this.append("as "),this.visitNode(t.as))}visitRefreshMaterializedView(t){this.append("refresh materialized view "),t.concurrently&&this.append("concurrently "),this.visitNode(t.name),t.withNoData?this.append(" with no data"):this.append(" with data")}visitDropView(t){this.append("drop "),t.materialized&&this.append("materialized "),this.append("view "),t.ifExists&&this.append("if exists "),this.visitNode(t.name),t.cascade&&this.append(" cascade")}visitGenerated(t){this.append("generated "),t.always&&this.append("always "),t.byDefault&&this.append("by default "),this.append("as "),t.identity&&this.append("identity"),t.expression&&(this.append("("),this.visitNode(t.expression),this.append(")")),t.stored&&this.append(" stored")}visitDefaultValue(t){this.append("default "),this.visitNode(t.defaultValue)}visitSelectModifier(t){t.rawModifier?this.visitNode(t.rawModifier):this.append(OC[t.modifier]),t.of&&(this.append(" of "),this.compileList(t.of,", "))}visitCreateType(t){this.append("create type "),this.visitNode(t.name),t.enum&&(this.append(" as enum "),this.visitNode(t.enum))}visitDropType(t){this.append("drop type "),t.ifExists&&this.append("if exists "),this.visitNode(t.name)}visitExplain(t){this.append("explain"),(t.options||t.format)&&(this.append(" "),this.append(this.getLeftExplainOptionsWrapper()),t.options&&(this.visitNode(t.options),t.format&&this.append(this.getExplainOptionsDelimiter())),t.format&&(this.append("format"),this.append(this.getExplainOptionAssignment()),this.append(t.format)),this.append(this.getRightExplainOptionsWrapper()))}visitDefaultInsertValue(t){this.append("default")}visitAggregateFunction(t){this.append(t.func),this.append("("),t.distinct&&this.append("distinct "),this.compileList(t.aggregated),t.orderBy&&(this.append(" "),this.visitNode(t.orderBy)),this.append(")"),t.withinGroup&&(this.append(" within group ("),this.visitNode(t.withinGroup),this.append(")")),t.filter&&(this.append(" filter("),this.visitNode(t.filter),this.append(")")),t.over&&(this.append(" "),this.visitNode(t.over))}visitOver(t){this.append("over("),t.partitionBy&&(this.visitNode(t.partitionBy),t.orderBy&&this.append(" ")),t.orderBy&&this.visitNode(t.orderBy),this.append(")")}visitPartitionBy(t){this.append("partition by "),this.compileList(t.items)}visitPartitionByItem(t){this.visitNode(t.partitionBy)}visitBinaryOperation(t){this.visitNode(t.leftOperand),this.append(" "),this.visitNode(t.operator),this.append(" "),this.visitNode(t.rightOperand)}visitUnaryOperation(t){this.visitNode(t.operator),this.isMinusOperator(t.operator)||this.append(" "),this.visitNode(t.operand)}isMinusOperator(t){return Ln.is(t)&&t.operator==="-"}visitUsing(t){this.append("using "),this.compileList(t.tables)}visitFunction(t){this.append(t.func),this.append("("),this.compileList(t.arguments),this.append(")")}visitCase(t){this.append("case"),t.value&&(this.append(" "),this.visitNode(t.value)),t.when&&(this.append(" "),this.compileList(t.when," ")),t.else&&(this.append(" else "),this.visitNode(t.else)),this.append(" end"),t.isStatement&&this.append(" case")}visitWhen(t){this.append("when "),this.visitNode(t.condition),t.result&&(this.append(" then "),this.visitNode(t.result))}visitJSONReference(t){this.visitNode(t.reference),this.visitNode(t.traversal)}visitJSONPath(t){t.inOperator&&this.visitNode(t.inOperator),this.append("'$");for(const r of t.pathLegs)this.visitNode(r);this.append("'")}visitJSONPathLeg(t){const r=t.type==="ArrayLocation";this.append(r?"[":"."),this.append(String(t.value)),r&&this.append("]")}visitJSONOperatorChain(t){for(let r=0,i=t.values.length;r<i;r++)r===i-1?this.visitNode(t.operator):this.append("->"),this.visitNode(t.values[r])}visitMergeQuery(t){t.with&&(this.visitNode(t.with),this.append(" ")),this.append("merge "),t.top&&(this.visitNode(t.top),this.append(" ")),this.append("into "),this.visitNode(t.into),t.using&&(this.append(" "),this.visitNode(t.using)),t.whens&&(this.append(" "),this.compileList(t.whens," ")),t.returning&&(this.append(" "),this.visitNode(t.returning)),t.output&&(this.append(" "),this.visitNode(t.output)),t.endModifiers?.length&&(this.append(" "),this.compileList(t.endModifiers," "))}visitMatched(t){t.not&&this.append("not "),this.append("matched"),t.bySource&&this.append(" by source")}visitAddIndex(t){this.append("add "),t.unique&&this.append("unique "),this.append("index "),this.visitNode(t.name),t.columns&&(this.append(" ("),this.compileList(t.columns),this.append(")")),t.using&&(this.append(" using "),this.visitNode(t.using))}visitCast(t){this.append("cast("),this.visitNode(t.expression),this.append(" as "),this.visitNode(t.dataType),this.append(")")}visitFetch(t){this.append("fetch next "),this.visitNode(t.rowCount),this.append(` rows ${t.modifier}`)}visitOutput(t){this.append("output "),this.compileList(t.selections)}visitTop(t){this.append(`top(${t.expression})`),t.modifiers&&this.append(` ${t.modifiers}`)}visitOrAction(t){this.append(t.action)}visitCollate(t){this.append("collate "),this.visitNode(t.collation)}append(t){this.#e+=t}appendValue(t){this.addParameter(t),this.append(this.getCurrentParameterPlaceholder())}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getCurrentParameterPlaceholder(){return"$"+this.numParameters}getLeftExplainOptionsWrapper(){return"("}getExplainOptionAssignment(){return" "}getExplainOptionsDelimiter(){return", "}getRightExplainOptionsWrapper(){return")"}sanitizeIdentifier(t){const r=this.getLeftIdentifierWrapper(),i=this.getRightIdentifierWrapper();let n="";for(const o of t)n+=o,o===r?n+=r:o===i&&(n+=i);return n}sanitizeStringLiteral(t){return t.replace(xC,"''")}addParameter(t){this.#t.push(t)}appendImmediateValue(t){if(mt(t))this.appendStringLiteral(t);else if(io(t)||_a(t)||od(t))this.append(t.toString());else if(id(t))this.append("null");else if(fk(t))this.appendImmediateValue(t.toISOString());else throw new Error(`invalid immediate value ${t}`)}appendStringLiteral(t){this.append("'"),this.append(this.sanitizeStringLiteral(t)),this.append("'")}sortSelectModifiers(t){return t.sort((r,i)=>r.modifier&&i.modifier?Wg[r.modifier]-Wg[i.modifier]:1),p(t)}compileColumnAlterations(t){this.compileList(t)}announcesNewColumnDataType(){return!0}}const OC=p({ForKeyShare:"for key share",ForNoKeyUpdate:"for no key update",ForUpdate:"for update",ForShare:"for share",NoWait:"nowait",SkipLocked:"skip locked",Distinct:"distinct"}),Wg=p({ForKeyShare:1,ForNoKeyUpdate:1,ForUpdate:1,ForShare:1,NoWait:2,SkipLocked:2,Distinct:0}),DC=p({InnerJoin:"inner join",LeftJoin:"left join",RightJoin:"right join",FullJoin:"full join",CrossJoin:"cross join",LateralInnerJoin:"inner join lateral",LateralLeftJoin:"left join lateral",LateralCrossJoin:"cross join lateral",OuterApply:"outer apply",CrossApply:"cross apply",Using:"using"}),rr=p({raw(e,t=[]){return p({sql:e,query:Le.createWithSql(e),parameters:p(t),queryId:ce()})}});class ld{get supportsCreateIfNotExists(){return!0}get supportsTransactionalDdl(){return!1}get supportsReturning(){return!1}get supportsOutput(){return!1}}function Zr(e,t){return Le.createWithChildren([Le.createWithSql(`${e} `),ve.create(t)])}class RC{#e;#t=new CC;#r;#n;constructor(t){this.#e=p({...t})}async init(){this.#r=St(this.#e.database)?await this.#e.database():this.#e.database,this.#n=new UC(this.#r),this.#e.onCreateConnection&&await this.#e.onCreateConnection(this.#n)}async acquireConnection(){return await this.#t.lock(),this.#n}async beginTransaction(t){await t.executeQuery(rr.raw("begin"))}async commitTransaction(t){await t.executeQuery(rr.raw("commit"))}async rollbackTransaction(t){await t.executeQuery(rr.raw("rollback"))}async savepoint(t,r,i){await t.executeQuery(i(Zr("savepoint",r),ce()))}async rollbackToSavepoint(t,r,i){await t.executeQuery(i(Zr("rollback to",r),ce()))}async releaseSavepoint(t,r,i){await t.executeQuery(i(Zr("release",r),ce()))}async releaseConnection(){this.#t.unlock()}async destroy(){this.#r?.close()}}class UC{#e;constructor(t){this.#e=t}executeQuery(t){const{sql:r,parameters:i}=t,n=this.#e.prepare(r);if(n.reader)return Promise.resolve({rows:n.all(i)});const{changes:o,lastInsertRowid:a}=n.run(i);return Promise.resolve({numAffectedRows:o!=null?BigInt(o):void 0,insertId:a!=null?BigInt(a):void 0,rows:[]})}async*streamQuery(t,r){const{sql:i,parameters:n,query:o}=t,a=this.#e.prepare(i);if(Ee.is(o)){const s=a.iterate(n);for(const c of s)yield{rows:[c]}}else throw new Error("Sqlite driver only supports streaming of select queries")}}class CC{#e;#t;async lock(){for(;this.#e;)await this.#e;this.#e=new Promise(t=>{this.#t=t})}unlock(){const t=this.#t;this.#e=void 0,this.#t=void 0,t?.()}}const PC=/"/g;class LC extends dd{visitOrAction(t){this.append("or "),this.append(t.action)}getCurrentParameterPlaceholder(){return"?"}getLeftExplainOptionsWrapper(){return""}getRightExplainOptionsWrapper(){return""}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getAutoIncrement(){return"autoincrement"}sanitizeIdentifier(t){return t.replace(PC,'""')}visitDefaultInsertValue(t){this.append("null")}}const As="kysely_migration",fd="kysely_migration_lock";p({__noMigrations__:!0});class zC{#e;constructor(t){this.#e=t}async getSchemas(){return[]}async getTables(t={withInternalKyselyTables:!1}){return await this.#r(t)}async getMetadata(t){return{tables:await this.getTables(t)}}#t(t,r){let i=t.selectFrom("sqlite_master").where("type","in",["table","view"]).where("name","not like","sqlite_%").select(["name","sql","type"]).orderBy("name");return r.withInternalKyselyTables||(i=i.where("name","!=",As).where("name","!=",fd)),i}async#r(t){const r=await this.#t(this.#e,t).execute(),i=await this.#e.with("table_list",o=>this.#t(o,t)).selectFrom(["table_list as tl",Ae`pragma_table_info(tl.name)`.as("p")]).select(["tl.name as table","p.cid","p.name","p.type","p.notnull","p.dflt_value","p.pk"]).orderBy("tl.name").orderBy("p.cid").execute(),n={};for(const o of i)n[o.table]??=[],n[o.table].push(o);return r.map(({name:o,sql:a,type:s})=>{let c=a?.split(/[\(\),]/)?.find(d=>d.toLowerCase().includes("autoincrement"))?.trimStart()?.split(/\s+/)?.[0]?.replace(/["`]/g,"");const u=n[o]??[];if(!c){const d=u.filter(l=>l.pk>0);d.length===1&&d[0].type.toLowerCase()==="integer"&&(c=d[0].name)}return{name:o,isView:s==="view",columns:u.map(d=>({name:d.name,dataType:d.type,isNullable:!d.notnull,isAutoIncrementing:d.name===c,hasDefaultValue:d.dflt_value!=null,comment:void 0}))}})}}class jC extends ld{get supportsTransactionalDdl(){return!1}get supportsReturning(){return!0}async acquireMigrationLock(t,r){}async releaseMigrationLock(t,r){}}class Gk{#e;constructor(t){this.#e=p({...t})}createDriver(){return new RC(this.#e)}createQueryCompiler(){return new LC}createAdapter(){return new jC}createIntrospector(t){return new zC(t)}}const MC=/"/g;class qC extends dd{sanitizeIdentifier(t){return t.replace(MC,'""')}}class WC{#e;constructor(t){this.#e=t}async getSchemas(){return(await this.#e.selectFrom("pg_catalog.pg_namespace").select("nspname").$castTo().execute()).map(r=>({name:r.nspname}))}async getTables(t={withInternalKyselyTables:!1}){let r=this.#e.selectFrom("pg_catalog.pg_attribute as a").innerJoin("pg_catalog.pg_class as c","a.attrelid","c.oid").innerJoin("pg_catalog.pg_namespace as ns","c.relnamespace","ns.oid").innerJoin("pg_catalog.pg_type as typ","a.atttypid","typ.oid").innerJoin("pg_catalog.pg_namespace as dtns","typ.typnamespace","dtns.oid").select(["a.attname as column","a.attnotnull as not_null","a.atthasdef as has_default","c.relname as table","c.relkind as table_type","ns.nspname as schema","typ.typname as type","dtns.nspname as type_schema",Ae`col_description(a.attrelid, a.attnum)`.as("column_description"),Ae`pg_get_serial_sequence(quote_ident(ns.nspname) || '.' || quote_ident(c.relname), a.attname)`.as("auto_incrementing")]).where("c.relkind","in",["r","v","p"]).where("ns.nspname","!~","^pg_").where("ns.nspname","!=","information_schema").where("ns.nspname","!=","crdb_internal").where(Ae`has_schema_privilege(ns.nspname, 'USAGE')`).where("a.attnum",">=",0).where("a.attisdropped","!=",!0).orderBy("ns.nspname").orderBy("c.relname").orderBy("a.attnum").$castTo();t.withInternalKyselyTables||(r=r.where("c.relname","!=",As).where("c.relname","!=",fd));const i=await r.execute();return this.#t(i)}async getMetadata(t){return{tables:await this.getTables(t)}}#t(t){return t.reduce((r,i)=>{let n=r.find(o=>o.name===i.table&&o.schema===i.schema);return n||(n=p({name:i.table,isView:i.table_type==="v",schema:i.schema,columns:[]}),r.push(n)),n.columns.push(p({name:i.column,dataType:i.type,dataTypeSchema:i.type_schema,isNullable:!i.not_null,isAutoIncrementing:i.auto_incrementing!==null,hasDefaultValue:i.has_default,comment:i.column_description??void 0})),r},[])}}const FC=BigInt("3853314791062309107");class BC extends ld{get supportsTransactionalDdl(){return!0}get supportsReturning(){return!0}async acquireMigrationLock(t,r){await Ae`select pg_advisory_xact_lock(${Ae.lit(FC)})`.execute(t)}async releaseMigrationLock(t,r){}}function tm(e,t){if(VC(e)&&t.stack){const r=t.stack.split(`
`).slice(1).join(`
`);return e.stack+=`
${r}`,e}return e}function VC(e){return zt(e)&&mt(e.stack)}const Qk=Symbol();class KC{#e;#t=new WeakMap;#r;constructor(t){this.#e=p({...t})}async init(){this.#r=St(this.#e.pool)?await this.#e.pool():this.#e.pool}async acquireConnection(){const t=await this.#n();let r=this.#t.get(t);return r||(r=new HC(t),this.#t.set(t,r),this.#e?.onCreateConnection&&await this.#e.onCreateConnection(r)),this.#e?.onReserveConnection&&await this.#e.onReserveConnection(r),r}async#n(){return new Promise((t,r)=>{this.#r.getConnection(async(i,n)=>{i?r(i):t(n)})})}async beginTransaction(t,r){if(r.isolationLevel||r.accessMode){const i=[];r.isolationLevel&&i.push(`isolation level ${r.isolationLevel}`),r.accessMode&&i.push(r.accessMode);const n=`set transaction ${i.join(", ")}`;await t.executeQuery(rr.raw(n))}await t.executeQuery(rr.raw("begin"))}async commitTransaction(t){await t.executeQuery(rr.raw("commit"))}async rollbackTransaction(t){await t.executeQuery(rr.raw("rollback"))}async savepoint(t,r,i){await t.executeQuery(i(Zr("savepoint",r),ce()))}async rollbackToSavepoint(t,r,i){await t.executeQuery(i(Zr("rollback to",r),ce()))}async releaseSavepoint(t,r,i){await t.executeQuery(i(Zr("release savepoint",r),ce()))}async releaseConnection(t){t[Qk]()}async destroy(){return new Promise((t,r)=>{this.#r.end(i=>{i?r(i):t()})})}}function JC(e){return zt(e)&&"insertId"in e&&"affectedRows"in e}class HC{#e;constructor(t){this.#e=t}async executeQuery(t){try{const r=await this.#t(t);if(JC(r)){const{insertId:i,affectedRows:n,changedRows:o}=r;return{insertId:i!=null&&i.toString()!=="0"?BigInt(i):void 0,numAffectedRows:n!=null?BigInt(n):void 0,numChangedRows:o!=null?BigInt(o):void 0,rows:[]}}else if(Array.isArray(r))return{rows:r};return{rows:[]}}catch(r){throw tm(r,new Error)}}#t(t){return new Promise((r,i)=>{this.#e.query(t.sql,t.parameters,(n,o)=>{n?i(n):r(o)})})}async*streamQuery(t,r){const i=this.#e.query(t.sql,t.parameters).stream({objectMode:!0});try{for await(const n of i)yield{rows:[n]}}catch(n){if(n&&typeof n=="object"&&"code"in n&&n.code==="ERR_STREAM_PREMATURE_CLOSE")return;throw n}}[Qk](){this.#e.release()}}const ZC=/`/g;class GC extends dd{getCurrentParameterPlaceholder(){return"?"}getLeftExplainOptionsWrapper(){return""}getExplainOptionAssignment(){return"="}getExplainOptionsDelimiter(){return" "}getRightExplainOptionsWrapper(){return""}getLeftIdentifierWrapper(){return"`"}getRightIdentifierWrapper(){return"`"}sanitizeIdentifier(t){return t.replace(ZC,"``")}visitCreateIndex(t){this.append("create "),t.unique&&this.append("unique "),this.append("index "),t.ifNotExists&&this.append("if not exists "),this.visitNode(t.name),t.using&&(this.append(" using "),this.visitNode(t.using)),t.table&&(this.append(" on "),this.visitNode(t.table)),t.columns&&(this.append(" ("),this.compileList(t.columns),this.append(")")),t.where&&(this.append(" "),this.visitNode(t.where))}}class QC{#e;constructor(t){this.#e=t}async getSchemas(){return(await this.#e.selectFrom("information_schema.schemata").select("schema_name").$castTo().execute()).map(r=>({name:r.SCHEMA_NAME}))}async getTables(t={withInternalKyselyTables:!1}){let r=this.#e.selectFrom("information_schema.columns as columns").innerJoin("information_schema.tables as tables",n=>n.onRef("columns.TABLE_CATALOG","=","tables.TABLE_CATALOG").onRef("columns.TABLE_SCHEMA","=","tables.TABLE_SCHEMA").onRef("columns.TABLE_NAME","=","tables.TABLE_NAME")).select(["columns.COLUMN_NAME","columns.COLUMN_DEFAULT","columns.TABLE_NAME","columns.TABLE_SCHEMA","tables.TABLE_TYPE","columns.IS_NULLABLE","columns.DATA_TYPE","columns.EXTRA","columns.COLUMN_COMMENT"]).where("columns.TABLE_SCHEMA","=",Ae`database()`).orderBy("columns.TABLE_NAME").orderBy("columns.ORDINAL_POSITION").$castTo();t.withInternalKyselyTables||(r=r.where("columns.TABLE_NAME","!=",As).where("columns.TABLE_NAME","!=",fd));const i=await r.execute();return this.#t(i)}async getMetadata(t){return{tables:await this.getTables(t)}}#t(t){return t.reduce((r,i)=>{let n=r.find(o=>o.name===i.TABLE_NAME);return n||(n=p({name:i.TABLE_NAME,isView:i.TABLE_TYPE==="VIEW",schema:i.TABLE_SCHEMA,columns:[]}),r.push(n)),n.columns.push(p({name:i.COLUMN_NAME,dataType:i.DATA_TYPE,isNullable:i.IS_NULLABLE==="YES",isAutoIncrementing:i.EXTRA.toLowerCase().includes("auto_increment"),hasDefaultValue:i.COLUMN_DEFAULT!==null,comment:i.COLUMN_COMMENT===""?void 0:i.COLUMN_COMMENT})),r},[])}}const Fg="ea586330-2c93-47c8-908d-981d9d270f9d",YC=3600;class XC extends ld{get supportsTransactionalDdl(){return!1}get supportsReturning(){return!1}async acquireMigrationLock(t,r){await Ae`select get_lock(${Ae.lit(Fg)}, ${Ae.lit(YC)})`.execute(t)}async releaseMigrationLock(t,r){await Ae`select release_lock(${Ae.lit(Fg)})`.execute(t)}}class Yk{#e;constructor(t){this.#e=t}createDriver(){return new KC(this.#e)}createQueryCompiler(){return new GC}createAdapter(){return new XC}createIntrospector(t){return new QC(t)}}const Xk=Symbol();class eP{#e;#t=new WeakMap;#r;constructor(t){this.#e=p({...t})}async init(){this.#r=St(this.#e.pool)?await this.#e.pool():this.#e.pool}async acquireConnection(){const t=await this.#r.connect();let r=this.#t.get(t);return r||(r=new tP(t,{cursor:this.#e.cursor??null}),this.#t.set(t,r),this.#e.onCreateConnection&&await this.#e.onCreateConnection(r)),this.#e.onReserveConnection&&await this.#e.onReserveConnection(r),r}async beginTransaction(t,r){if(r.isolationLevel||r.accessMode){let i="start transaction";r.isolationLevel&&(i+=` isolation level ${r.isolationLevel}`),r.accessMode&&(i+=` ${r.accessMode}`),await t.executeQuery(rr.raw(i))}else await t.executeQuery(rr.raw("begin"))}async commitTransaction(t){await t.executeQuery(rr.raw("commit"))}async rollbackTransaction(t){await t.executeQuery(rr.raw("rollback"))}async savepoint(t,r,i){await t.executeQuery(i(Zr("savepoint",r),ce()))}async rollbackToSavepoint(t,r,i){await t.executeQuery(i(Zr("rollback to",r),ce()))}async releaseSavepoint(t,r,i){await t.executeQuery(i(Zr("release",r),ce()))}async releaseConnection(t){t[Xk]()}async destroy(){if(this.#r){const t=this.#r;this.#r=void 0,await t.end()}}}class tP{#e;#t;constructor(t,r){this.#e=t,this.#t=r}async executeQuery(t){try{const{command:r,rowCount:i,rows:n}=await this.#e.query(t.sql,[...t.parameters]);return{numAffectedRows:r==="INSERT"||r==="UPDATE"||r==="DELETE"||r==="MERGE"?BigInt(i):void 0,rows:n??[]}}catch(r){throw tm(r,new Error)}}async*streamQuery(t,r){if(!this.#t.cursor)throw new Error("'cursor' is not present in your postgres dialect config. It's required to make streaming work in postgres.");if(!Number.isInteger(r)||r<=0)throw new Error("chunkSize must be a positive integer");const i=this.#e.query(new this.#t.cursor(t.sql,t.parameters.slice()));try{for(;;){const n=await i.read(r);if(n.length===0)break;yield{rows:n}}}finally{await i.close()}}[Xk](){this.#e.release()}}class eN{#e;constructor(t){this.#e=t}createDriver(){return new eP(this.#e)}createQueryCompiler(){return new qC}createAdapter(){return new BC}createIntrospector(t){return new WC(t)}}class rP extends ld{get supportsCreateIfNotExists(){return!1}get supportsTransactionalDdl(){return!0}get supportsOutput(){return!0}async acquireMigrationLock(t){await Ae`exec sp_getapplock @DbPrincipal = ${Ae.lit("dbo")}, @Resource = ${Ae.lit(As)}, @LockMode = ${Ae.lit("Exclusive")}`.execute(t)}async releaseMigrationLock(){}}const tN=Symbol(),rN=Symbol(),nN=Symbol();class nP{#e;#t;constructor(t){this.#e=p({...t});const{tarn:r,tedious:i,validateConnections:n}=this.#e,{validateConnections:o,...a}=r.options;this.#t=new r.Pool({...a,create:async()=>{const s=await i.connectionFactory();return await new iP(s,i).connect()},destroy:async s=>{await s[rN]()},validate:n===!1||o===!1?void 0:s=>s[nN]()})}async init(){}async acquireConnection(){return await this.#t.acquire().promise}async beginTransaction(t,r){await t.beginTransaction(r)}async commitTransaction(t){await t.commitTransaction()}async rollbackTransaction(t){await t.rollbackTransaction()}async savepoint(t,r){await t.savepoint(r)}async rollbackToSavepoint(t,r){await t.rollbackTransaction(r)}async releaseConnection(t){(this.#e.resetConnectionsOnRelease||this.#e.tedious.resetConnectionOnRelease)&&await t[tN](),this.#t.release(t)}async destroy(){await this.#t.destroy()}}class iP{#e;#t;#r;constructor(t,r){this.#e=t,this.#t=!1,this.#r=r}async beginTransaction(t){const{isolationLevel:r}=t;await new Promise((i,n)=>this.#e.beginTransaction(o=>{o?n(o):i(void 0)},r?Ik(8):void 0,r?this.#n(r):void 0))}async commitTransaction(){await new Promise((t,r)=>this.#e.commitTransaction(i=>{i?r(i):t(void 0)}))}async connect(){const{promise:t,reject:r,resolve:i}=new aa;this.#e.connect(o=>{if(o)return r(o);i()}),this.#e.on("error",o=>{o instanceof Error&&"code"in o&&o.code==="ESOCKET"&&(this.#t=!0),console.error(o),r(o)});function n(){r(new Error("The connection ended without ever completing the connection"))}return this.#e.once("end",n),await t,this.#e.off("end",n),this}async executeQuery(t){try{const r=new aa,i=new Yd({compiledQuery:t,tedious:this.#r,onDone:r});this.#e.execSql(i.request);const{rowCount:n,rows:o}=await r.promise;return{numAffectedRows:n!==void 0?BigInt(n):void 0,rows:o}}catch(r){throw tm(r,new Error)}}async rollbackTransaction(t){await new Promise((r,i)=>this.#e.rollbackTransaction(n=>{n?i(n):r(void 0)},t))}async savepoint(t){await new Promise((r,i)=>this.#e.saveTransaction(n=>{n?i(n):r(void 0)},t))}async*streamQuery(t,r){if(!Number.isInteger(r)||r<=0)throw new Error("chunkSize must be a positive integer");const i=new Yd({compiledQuery:t,streamChunkSize:r,tedious:this.#r});this.#e.execSql(i.request);try{for(;;){const n=await i.readChunk();if(n.length===0||(yield{rows:n},n.length<r))break}}finally{await this.#i(i)}}#n(t){const{ISOLATION_LEVEL:r}=this.#r,n={"read committed":r.READ_COMMITTED,"read uncommitted":r.READ_UNCOMMITTED,"repeatable read":r.REPEATABLE_READ,serializable:r.SERIALIZABLE,snapshot:r.SNAPSHOT}[t];if(n===void 0)throw new Error(`Unknown isolation level: ${t}`);return n}#i(t){return new Promise(r=>{t.request.once("requestCompleted",r),this.#e.cancel()||(t.request.off("requestCompleted",r),r())})}[rN](){return"closed"in this.#e&&this.#e.closed?Promise.resolve():new Promise(t=>{this.#e.once("end",t),this.#e.close()})}async[tN](){await new Promise((t,r)=>{this.#e.reset(i=>{if(i)return r(i);t()})})}async[nN](){if(this.#t||this.#a())return!1;try{const t=new aa,r=new Yd({compiledQuery:rr.raw("select 1"),onDone:t,tedious:this.#r});return this.#e.execSql(r.request),await t.promise,!0}catch{return!1}}#a(){return"closed"in this.#e&&!!this.#e.closed}}class Yd{#e;#t;#r;#n;#i;#a;constructor(t){const{compiledQuery:r,onDone:i,streamChunkSize:n,tedious:o}=t;if(this.#t=[],this.#r=n,this.#n={},this.#i=o,i){const a="onDone";this.#n[a]=(s,c)=>{if(s!=="chunkReady"){if(delete this.#n[a],s==="error")return i.reject(c);i.resolve({rowCount:this.#a,rows:this.#t})}}}this.#e=new this.#i.Request(r.sql,(a,s)=>{if(a)return Object.values(this.#n).forEach(c=>c("error",a instanceof AggregateError?a.errors:a));this.#a=s}),this.#s(r.parameters),this.#o()}get request(){return this.#e}readChunk(){const t=this.readChunk.name;return new Promise((r,i)=>{this.#n[t]=(n,o)=>{if(delete this.#n[t],n==="error")return i(o);r(this.#t.splice(0,this.#r))},this.#e.resume()})}#s(t){for(let r=0;r<t.length;r++){const i=t[r];this.#e.addParameter(String(r+1),this.#c(i),i)}}#o(){const t=this.#r?()=>{this.#r<=this.#t.length&&(this.#e.pause(),Object.values(this.#n).forEach(i=>i("chunkReady")))}:()=>{},r=i=>{const n={};for(const o of i)n[o.metadata.colName]=o.value;this.#t.push(n),t()};this.#e.on("row",r),this.#e.once("requestCompleted",()=>{Object.values(this.#n).forEach(i=>i("completed")),this.#e.off("row",r)})}#c(t){return id(t)||Hr(t)||mt(t)?this.#i.TYPES.NVarChar:od(t)||io(t)&&t%1===0?t<-2147483648||t>2147483647?this.#i.TYPES.BigInt:this.#i.TYPES.Int:io(t)?this.#i.TYPES.Float:_a(t)?this.#i.TYPES.Bit:fk(t)?this.#i.TYPES.DateTime:KR(t)?this.#i.TYPES.VarBinary:this.#i.TYPES.NVarChar}}class oP{#e;constructor(t){this.#e=t}async getSchemas(){return await this.#e.selectFrom("sys.schemas").select("name").execute()}async getTables(t={withInternalKyselyTables:!1}){const r=await this.#e.selectFrom("sys.tables as tables").leftJoin("sys.schemas as table_schemas","table_schemas.schema_id","tables.schema_id").innerJoin("sys.columns as columns","columns.object_id","tables.object_id").innerJoin("sys.types as types","types.user_type_id","columns.user_type_id").leftJoin("sys.schemas as type_schemas","type_schemas.schema_id","types.schema_id").leftJoin("sys.extended_properties as comments",n=>n.onRef("comments.major_id","=","tables.object_id").onRef("comments.minor_id","=","columns.column_id").on("comments.name","=","MS_Description")).$if(!t.withInternalKyselyTables,n=>n.where("tables.name","!=",As).where("tables.name","!=",fd)).select(["tables.name as table_name",n=>n.ref("tables.type").$castTo().as("table_type"),"table_schemas.name as table_schema_name","columns.default_object_id as column_default_object_id","columns.generated_always_type_desc as column_generated_always_type","columns.is_computed as column_is_computed","columns.is_identity as column_is_identity","columns.is_nullable as column_is_nullable","columns.is_rowguidcol as column_is_rowguidcol","columns.name as column_name","types.is_nullable as type_is_nullable","types.name as type_name","type_schemas.name as type_schema_name","comments.value as column_comment"]).unionAll(this.#e.selectFrom("sys.views as views").leftJoin("sys.schemas as view_schemas","view_schemas.schema_id","views.schema_id").innerJoin("sys.columns as columns","columns.object_id","views.object_id").innerJoin("sys.types as types","types.user_type_id","columns.user_type_id").leftJoin("sys.schemas as type_schemas","type_schemas.schema_id","types.schema_id").leftJoin("sys.extended_properties as comments",n=>n.onRef("comments.major_id","=","views.object_id").onRef("comments.minor_id","=","columns.column_id").on("comments.name","=","MS_Description")).select(["views.name as table_name","views.type as table_type","view_schemas.name as table_schema_name","columns.default_object_id as column_default_object_id","columns.generated_always_type_desc as column_generated_always_type","columns.is_computed as column_is_computed","columns.is_identity as column_is_identity","columns.is_nullable as column_is_nullable","columns.is_rowguidcol as column_is_rowguidcol","columns.name as column_name","types.is_nullable as type_is_nullable","types.name as type_name","type_schemas.name as type_schema_name","comments.value as column_comment"])).orderBy("table_schema_name").orderBy("table_name").orderBy("column_name").execute(),i={};for(const n of r){const o=`${n.table_schema_name}.${n.table_name}`;(i[o]=i[o]||p({columns:[],isView:n.table_type==="V ",name:n.table_name,schema:n.table_schema_name??void 0})).columns.push(p({dataType:n.type_name,dataTypeSchema:n.type_schema_name??void 0,hasDefaultValue:n.column_default_object_id>0||n.column_generated_always_type!=="NOT_APPLICABLE"||n.column_is_identity||n.column_is_computed||n.column_is_rowguidcol,isAutoIncrementing:n.column_is_identity,isNullable:n.column_is_nullable&&n.type_is_nullable,name:n.column_name,comment:n.column_comment??void 0}))}return Object.values(i)}async getMetadata(t){return{tables:await this.getTables(t)}}}const aP=/^[a-z0-9_]$/i;class sP extends dd{getCurrentParameterPlaceholder(){return`@${this.numParameters}`}visitOffset(t){super.visitOffset(t),this.append(" rows")}compileColumnAlterations(t){const r={};for(const n of t)r[n.kind]||(r[n.kind]=[]),r[n.kind].push(n);let i=!0;r.AddColumnNode&&(this.append("add "),this.compileList(r.AddColumnNode),i=!1),r.AlterColumnNode&&(i||this.append(", "),this.compileList(r.AlterColumnNode)),r.DropColumnNode&&(i||this.append(", "),this.append("drop column "),this.compileList(r.DropColumnNode)),r.ModifyColumnNode&&(i||this.append(", "),this.compileList(r.ModifyColumnNode)),r.RenameColumnNode&&(i||this.append(", "),this.compileList(r.RenameColumnNode))}visitAddColumn(t){this.visitNode(t.column)}visitDropColumn(t){this.visitNode(t.column)}visitMergeQuery(t){super.visitMergeQuery(t),this.append(";")}visitCollate(t){this.append("collate ");const{name:r}=t.collation;for(const i of r)if(!aP.test(i))throw new Error(`Invalid collation: ${r}`);this.append(r)}announcesNewColumnDataType(){return!1}}class cP{#e;constructor(t){this.#e=t}createDriver(){return new nP(this.#e)}createQueryCompiler(){return new sP}createAdapter(){return new rP}createIntrospector(t){return new oP(t)}}function rm(e){if(!e)return null;if("dialect"in e)return rm(e.dialect);if("createDriver"in e){if(e instanceof Gk)return"sqlite";if(e instanceof Yk)return"mysql";if(e instanceof eN)return"postgres";if(e instanceof cP)return"mssql"}return"aggregate"in e?"sqlite":"getConnection"in e?"mysql":"connect"in e?"postgres":"fileControl"in e||"open"in e&&"close"in e&&"prepare"in e?"sqlite":null}const uP=async e=>{const t=e.database;if(!t)return{kysely:null,databaseType:null,transaction:void 0};if("db"in t)return{kysely:t.db,databaseType:t.type,transaction:t.transaction};if("dialect"in t)return{kysely:new Jr({dialect:t.dialect}),databaseType:t.type,transaction:t.transaction};let r;const i=rm(t);if("createDriver"in t&&(r=t),"aggregate"in t&&!("createSession"in t)&&(r=new Gk({database:t})),"getConnection"in t&&(r=new Yk(t)),"connect"in t&&(r=new eN({pool:t})),"fileControl"in t){const{BunSqliteDialect:n}=await Wi(async()=>{const{BunSqliteDialect:o}=await import("./bun-sqlite-dialect-DaKWH3r2.js");return{BunSqliteDialect:o}},__vite__mapDeps([13,1,2,3,4,5,6,7,8,9,10,11]),import.meta.url);r=new n({database:t})}if("createSession"in t&&typeof window>"u"){let n;try{({DatabaseSync:n}=await import("node:sqlite"))}catch(o){if(o!==null&&typeof o=="object"&&"code"in o&&o.code!=="ERR_UNKNOWN_BUILTIN_MODULE")throw o}if(n&&t instanceof n){const{NodeSqliteDialect:o}=await Wi(async()=>{const{NodeSqliteDialect:a}=await import("./node-sqlite-dialect-C8f5Xdyd.js");return{NodeSqliteDialect:a}},__vite__mapDeps([14,1,2,3,4,5,6,7,8,9,10,11]),import.meta.url);r=new o({database:t})}}return{kysely:r?new Jr({dialect:r}):null,databaseType:i,transaction:void 0}},Oo=({usePlural:e,schema:t})=>i=>{if(e&&i.charAt(i.length-1)==="s"){const o=i.slice(0,-1);let a=t[o]?o:void 0;if(a||(a=Object.entries(t).find(([s,c])=>c.modelName===o)?.[0]),a)return a}let n=t[i]?i:void 0;if(n||(n=Object.entries(t).find(([o,a])=>a.modelName===i)?.[0]),!n)throw new Y(`Model "${i}" not found in schema`);return n},nm=({schema:e,usePlural:t})=>{const r=Oo({schema:e,usePlural:t});return({field:n,model:o})=>{if(n==="id"||n==="_id")return"id";const a=r(o);let s=e[a]?.fields[n];if(!s){const c=Object.entries(e[a].fields).find(([u,d])=>d.fieldName===n);c&&(s=c[1],n=c[0])}if(!s)throw new Y(`Field ${n} not found in model ${a}`);return n}},iN=({usePlural:e,schema:t,disableIdGeneration:r,options:i,customIdGenerator:n,supportsUUIDs:o})=>{const a=Oo({usePlural:e,schema:t});return({customModelName:c,forceAllowId:u})=>{const d=i.advanced?.database?.useNumberId||i.advanced?.database?.generateId==="serial",l=i.advanced?.database?.generateId==="uuid",f=r||d&&!u?!1:l?!o:!0,h=a(c??"id");return{type:d?"number":"string",required:!!f,...f?{defaultValue(){if(r)return;const g=i.advanced?.database?.generateId;if(!(g===!1||d))return typeof g=="function"?g({model:h}):n?n({model:h}):g==="uuid"?crypto.randomUUID():pa()}}:{},transform:{input:g=>{if(g){if(d){const m=Number(g);return isNaN(m)?void 0:m}if(l){if(f&&!u)return g;if(r||o)return;if(u&&typeof g=="string"){if(/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(g))return g;{const m=new Error().stack?.split(`
`).filter((v,b)=>b!==1).join(`
`).replace("Error:","");ie.warn("[Adapter Factory] - Invalid UUID value for field `id` provided when `forceAllowId` is true. Generating a new UUID.",m)}}return typeof g!="string"&&!o?crypto.randomUUID():void 0}return g}},output:g=>{if(g)return String(g)}}}}},dP=({usePlural:e,schema:t,options:r,customIdGenerator:i,disableIdGeneration:n})=>{const o=Oo({usePlural:e,schema:t}),a=nm({usePlural:e,schema:t}),s=iN({usePlural:e,schema:t,options:r,customIdGenerator:i,disableIdGeneration:n});return({model:u,field:d})=>{const l=o(u),f=a({field:d,model:l}),h=t[l].fields;h.id=s({customModelName:l});const g=h[f];if(!g)throw new Y(`Field ${d} not found in model ${u}`);return g}},oN=({schema:e,usePlural:t})=>{const r=Oo({schema:e,usePlural:t}),i=nm({schema:e,usePlural:t});function n({model:o,field:a}){const s=r(o),c=i({model:s,field:a});return e[s]?.fields[c]?.fieldName||c}return n},aN=({usePlural:e,schema:t})=>{const r=Oo({schema:t,usePlural:e});return n=>{const o=r(n);return t&&t[o]&&t[o].modelName!==n?e?`${t[o].modelName}s`:t[o].modelName:e?`${n}s`:n}};function lP(e,t,r){return r==="update"?e===void 0&&t.onUpdate!==void 0?typeof t.onUpdate=="function"?t.onUpdate():t.onUpdate:e:r==="create"&&(e===void 0||t.required===!0&&e===null)&&t.defaultValue!==void 0?typeof t.defaultValue=="function"?t.defaultValue():t.defaultValue:e}let Ms=[],yt=-1;const fP=e=>t=>t(e),Bg=({adapter:e,config:t})=>r=>{const i=Math.random().toString(36).substring(2,15),n={...t,supportsBooleans:t.supportsBooleans??!0,supportsDates:t.supportsDates??!0,supportsJSON:t.supportsJSON??!1,adapterName:t.adapterName??t.adapterId,supportsNumericIds:t.supportsNumericIds??!0,supportsUUIDs:t.supportsUUIDs??!1,supportsArrays:t.supportsArrays??!1,transaction:t.transaction??!1,disableTransformInput:t.disableTransformInput??!1,disableTransformOutput:t.disableTransformOutput??!1,disableTransformJoin:t.disableTransformJoin??!1};if((r.advanced?.database?.useNumberId===!0||r.advanced?.database?.generateId==="serial")&&n.supportsNumericIds===!1)throw new Y(`[${n.adapterName}] Your database or database adapter does not support numeric ids. Please disable "useNumberId" in your config.`);const o=Cn(r),a=(...w)=>{if(n.debugLogs===!0||typeof n.debugLogs=="object"){const _=wa({level:"info"});if(typeof n.debugLogs=="object"&&"isRunningAdapterTests"in n.debugLogs){n.debugLogs.isRunningAdapterTests&&(w.shift(),Ms.push({instance:i,args:w}));return}if(typeof n.debugLogs=="object"&&n.debugLogs.logCondition&&!n.debugLogs.logCondition?.())return;if(typeof w[0]=="object"&&"method"in w[0]){const S=w.shift().method;if(typeof n.debugLogs=="object"){if(S==="create"&&!n.debugLogs.create)return;if(S==="update"&&!n.debugLogs.update)return;if(S==="updateMany"&&!n.debugLogs.updateMany)return;if(S==="findOne"&&!n.debugLogs.findOne)return;if(S==="findMany"&&!n.debugLogs.findMany)return;if(S==="delete"&&!n.debugLogs.delete)return;if(S==="deleteMany"&&!n.debugLogs.deleteMany)return;if(S==="count"&&!n.debugLogs.count)return}_.info(`[${n.adapterName}]`,...w)}else _.info(`[${n.adapterName}]`,...w)}},s=wa(r.logger),c=Oo({usePlural:n.usePlural,schema:o}),u=nm({usePlural:n.usePlural,schema:o}),d=aN({usePlural:n.usePlural,schema:o}),l=oN({schema:o,usePlural:n.usePlural}),f=iN({schema:o,options:r,usePlural:n.usePlural,disableIdGeneration:n.disableIdGeneration,customIdGenerator:n.customIdGenerator,supportsUUIDs:n.supportsUUIDs}),h=dP({schema:o,options:r,usePlural:n.usePlural,disableIdGeneration:n.disableIdGeneration,customIdGenerator:n.customIdGenerator}),g=async(w,_,S,E)=>{const k={},U=o[_].fields,P=n.mapKeysTransformInput??{},T=r.advanced?.database?.useNumberId||r.advanced?.database?.generateId==="serial";U.id=f({customModelName:_,forceAllowId:E&&"id"in w});for(const A in U){let O=w[A];const R=U[A],W=P[A]||U[A].fieldName||A;if(O===void 0&&(R.defaultValue===void 0&&!R.transform?.input&&!(S==="update"&&R.onUpdate)||S==="update"&&!R.onUpdate))continue;if(R&&R.type==="date"&&!(O instanceof Date)&&typeof O=="string")try{O=new Date(O)}catch{s.error("[Adapter Factory] Failed to convert string to date",{value:O,field:A})}let z=lP(O,R,S);R.transform?.input&&(z=await R.transform.input(z)),R.references?.field==="id"&&T?Array.isArray(z)?z=z.map(C=>C!==null?Number(C):null):z=z!==null?Number(z):null:n.supportsJSON===!1&&typeof z=="object"&&R.type==="json"||n.supportsArrays===!1&&Array.isArray(z)&&(R.type==="string[]"||R.type==="number[]")?z=JSON.stringify(z):n.supportsDates===!1&&z instanceof Date&&R.type==="date"?z=z.toISOString():n.supportsBooleans===!1&&typeof z=="boolean"&&(z=z?1:0),n.customTransformInput&&(z=n.customTransformInput({data:z,action:S,field:W,fieldAttributes:R,model:d(_),schema:o,options:r})),z!==void 0&&(k[W]=z)}return k},m=async(w,_,S=[],E)=>{const k=async(T,A,O=[])=>{if(!T)return null;const R=n.mapKeysTransformOutput??{},W={},z=o[c(A)].fields,C=Object.entries(R).find(([B,Z])=>Z==="id")?.[0];z[C??"id"]={type:r.advanced?.database?.useNumberId||r.advanced?.database?.generateId==="serial"?"number":"string"};for(const B in z){if(O.length&&!O.includes(B))continue;const Z=z[B];if(Z){const se=Z.fieldName||B;let ue=T[Object.entries(R).find(([Fn,hn])=>hn===se)?.[0]||se];Z.transform?.output&&(ue=await Z.transform.output(ue));const Qe=R[B]||B;se==="id"||Z.references?.field==="id"?typeof ue<"u"&&ue!==null&&(ue=String(ue)):n.supportsJSON===!1&&typeof ue=="string"&&Z.type==="json"||n.supportsArrays===!1&&typeof ue=="string"&&(Z.type==="string[]"||Z.type==="number[]")?ue=it(ue):n.supportsDates===!1&&typeof ue=="string"&&Z.type==="date"?ue=new Date(ue):n.supportsBooleans===!1&&typeof ue=="number"&&Z.type==="boolean"&&(ue=ue===1),n.customTransformOutput&&(ue=n.customTransformOutput({data:ue,field:Qe,fieldAttributes:Z,select:O,model:d(A),schema:o,options:r})),W[Qe]=ue}}return W};if(!E||Object.keys(E).length===0)return await k(w,_,S);_=c(_);const U=await k(w,_,S),P=Object.entries(E).map(([T,A])=>({modelName:d(T),defaultModelName:c(T),joinConfig:A}));if(!w)return null;for(const{modelName:T,defaultModelName:A,joinConfig:O}of P){let R=await(async()=>r.experimental?.joins?w[T]:await I({baseModel:_,baseData:U,joinModel:T,specificJoinConfig:O}))();R==null&&(R=O.relation==="one-to-one"?null:[]),O.relation==="one-to-many"&&!Array.isArray(R)&&(R=[R]);const W=[];if(Array.isArray(R))for(const z of R){const C=await k(z,T,[]);W.push(C)}else{const z=await k(R,T,[]);W.push(z)}U[A]=(O.relation==="one-to-one"?W[0]:W)??null}return U},v=({model:w,where:_,action:S})=>{if(!_)return;const E=n.mapKeysTransformInput??{};return _.map(k=>{const{field:U,value:P,operator:T="eq",connector:A="AND"}=k;if(T==="in"&&!Array.isArray(P))throw new Y("Value must be an array");let O=P;const R=c(w),W=u({field:U,model:w}),z=E[W]||l({field:W,model:R}),C=h({field:W,model:R}),B=r.advanced?.database?.useNumberId||r.advanced?.database?.generateId==="serial";if((W==="id"||C.references?.field==="id")&&B&&(Array.isArray(P)?O=P.map(Number):O=Number(P)),C.type==="date"&&P instanceof Date&&!n.supportsDates&&(O=P.toISOString()),C.type==="boolean"&&typeof P=="boolean"&&!n.supportsBooleans&&(O=P?1:0),C.type==="json"&&typeof P=="object"&&!n.supportsJSON)try{O=JSON.stringify(P)}catch(Z){throw new Error(`Failed to stringify JSON value for field ${z}`,{cause:Z})}return n.customTransformInput&&(O=n.customTransformInput({data:O,fieldAttributes:C,field:z,model:d(w),schema:o,options:r,action:S})),{operator:T,connector:A,field:z,value:O}})},b=(w,_,S)=>{if(!_||Object.keys(_).length===0)return;const E={};for(const[k,U]of Object.entries(_)){if(!U)continue;const P=c(k),T=c(w);let A=Object.entries(o[P].fields).filter(([ue,Qe])=>Qe.references&&c(Qe.references.model)===T),O=!0;if(A.length||(A=Object.entries(o[T].fields).filter(([ue,Qe])=>Qe.references&&c(Qe.references.model)===P),O=!1),A.length){if(A.length>1)throw new Y(`Multiple foreign keys found for model ${k} and base model ${w} while performing join operation. Only one foreign key is supported.`)}else throw new Y(`No foreign key found for model ${k} and base model ${w} while performing join operation.`);const[R,W]=A[0];if(!W.references)throw new Y(`No references found for foreign key ${R} on model ${k} while performing join operation.`);let z,C,B;O?(B=W.references.field,z=l({model:w,field:B}),C=l({model:k,field:R})):(B=R,z=l({model:w,field:B}),C=l({model:k,field:W.references.field})),S&&!S.includes(B)&&S.push(B);const Z=C==="id"?!0:W.unique??!1;let se=r.advanced?.database?.defaultFindManyLimit??100;Z?se=1:typeof U=="object"&&typeof U.limit=="number"&&(se=U.limit),E[d(k)]={on:{from:z,to:C},limit:se,relation:Z?"one-to-one":"one-to-many"}}return{join:E,select:S}},I=async({baseModel:w,baseData:_,joinModel:S,specificJoinConfig:E})=>{if(!_)return _;const k=d(S),U=E.on.to,P=_[u({field:E.on.from,model:w})];if(P==null)return E.relation==="one-to-one"?null:[];let T;const A=v({model:k,where:[{field:U,value:P,operator:"eq",connector:"AND"}],action:"findOne"});try{if(E.relation==="one-to-one")T=await x.findOne({model:k,where:A});else{const O=E.limit??r.advanced?.database?.defaultFindManyLimit??100;T=await x.findMany({model:k,where:A,limit:O})}}catch(O){throw s.error(`Failed to query fallback join for model ${k}:`,{where:A,limit:E.limit}),console.error(O),O}return T},x=e({options:r,schema:o,debugLog:a,getFieldName:l,getModelName:d,getDefaultModelName:c,getDefaultFieldName:u,getFieldAttributes:h,transformInput:g,transformOutput:m,transformWhereClause:v});let N=null;const y={transaction:async w=>(N||(n.transaction?(s.debug(`[${n.adapterName}] - Using provided transaction implementation.`),N=n.transaction):N=fP(y)),N(w)),create:async({data:w,model:_,select:S,forceAllowId:E=!1})=>{yt++;const k=yt,U=d(_);if(_=c(_),"id"in w&&typeof w.id<"u"&&!E){s.warn(`[${n.adapterName}] - You are trying to create a record with an id. This is not allowed as we handle id generation for you, unless you pass in the \`forceAllowId\` parameter. The id will be ignored.`);const O=new Error().stack?.split(`
`).filter((R,W)=>W!==1).join(`
`).replace("Error:","Create method with `id` being called at:");console.log(O),w.id=void 0}a({method:"create"},`${De(k)} ${Re(1,4)}`,`${Ue("create")} ${Ye("Unsafe Input")}:`,{model:U,data:w});let P=w;n.disableTransformInput||(P=await g(w,_,"create",E)),a({method:"create"},`${De(k)} ${Re(2,4)}`,`${Ue("create")} ${Ye("Parsed Input")}:`,{model:U,data:P});const T=await x.create({data:P,model:U});a({method:"create"},`${De(k)} ${Re(3,4)}`,`${Ue("create")} ${Ye("DB Result")}:`,{model:U,res:T});let A=T;return n.disableTransformOutput||(A=await m(T,_,S,void 0)),a({method:"create"},`${De(k)} ${Re(4,4)}`,`${Ue("create")} ${Ye("Parsed Result")}:`,{model:U,data:A}),A},update:async({model:w,where:_,update:S})=>{yt++;const E=yt;w=c(w);const k=d(w),U=v({model:w,where:_,action:"update"});a({method:"update"},`${De(E)} ${Re(1,4)}`,`${Ue("update")} ${Ye("Unsafe Input")}:`,{model:k,data:S});let P=S;n.disableTransformInput||(P=await g(S,w,"update")),a({method:"update"},`${De(E)} ${Re(2,4)}`,`${Ue("update")} ${Ye("Parsed Input")}:`,{model:k,data:P});const T=await x.update({model:k,where:U,update:P});a({method:"update"},`${De(E)} ${Re(3,4)}`,`${Ue("update")} ${Ye("DB Result")}:`,{model:k,data:T});let A=T;return n.disableTransformOutput||(A=await m(T,w,void 0,void 0)),a({method:"update"},`${De(E)} ${Re(4,4)}`,`${Ue("update")} ${Ye("Parsed Result")}:`,{model:k,data:A}),A},updateMany:async({model:w,where:_,update:S})=>{yt++;const E=yt,k=d(w),U=v({model:w,where:_,action:"updateMany"});w=c(w),a({method:"updateMany"},`${De(E)} ${Re(1,4)}`,`${Ue("updateMany")} ${Ye("Unsafe Input")}:`,{model:k,data:S});let P=S;n.disableTransformInput||(P=await g(S,w,"update")),a({method:"updateMany"},`${De(E)} ${Re(2,4)}`,`${Ue("updateMany")} ${Ye("Parsed Input")}:`,{model:k,data:P});const T=await x.updateMany({model:k,where:U,update:P});return a({method:"updateMany"},`${De(E)} ${Re(3,4)}`,`${Ue("updateMany")} ${Ye("DB Result")}:`,{model:k,data:T}),a({method:"updateMany"},`${De(E)} ${Re(4,4)}`,`${Ue("updateMany")} ${Ye("Parsed Result")}:`,{model:k,data:T}),T},findOne:async({model:w,where:_,select:S,join:E})=>{yt++;const k=yt,U=d(w),P=v({model:w,where:_,action:"findOne"});w=c(w);let T,A=!0;if(n.disableTransformJoin)T=E;else{const W=b(w,E,S);W&&(T=W.join,S=W.select),!r.experimental?.joins&&T&&Object.keys(T).length>0&&(A=!1)}a({method:"findOne"},`${De(k)} ${Re(1,3)}`,`${Ue("findOne")}:`,{model:U,where:P,select:S,join:T});const O=await x.findOne({model:U,where:P,select:S,join:A?T:void 0});a({method:"findOne"},`${De(k)} ${Re(2,3)}`,`${Ue("findOne")} ${Ye("DB Result")}:`,{model:U,data:O});let R=O;return n.disableTransformOutput||(R=await m(O,w,S,T)),a({method:"findOne"},`${De(k)} ${Re(3,3)}`,`${Ue("findOne")} ${Ye("Parsed Result")}:`,{model:U,data:R}),R},findMany:async({model:w,where:_,limit:S,sortBy:E,offset:k,join:U})=>{yt++;const P=yt,T=S??r.advanced?.database?.defaultFindManyLimit??100,A=d(w),O=v({model:w,where:_,action:"findMany"});w=c(w);let R,W=!0;if(n.disableTransformJoin)R=U;else{const B=b(w,U,void 0);B&&(R=B.join),!r.experimental?.joins&&R&&Object.keys(R).length>0&&(W=!1)}a({method:"findMany"},`${De(P)} ${Re(1,3)}`,`${Ue("findMany")}:`,{model:A,where:O,limit:T,sortBy:E,offset:k,join:R});const z=await x.findMany({model:A,where:O,limit:T,sortBy:E,offset:k,join:W?R:void 0});a({method:"findMany"},`${De(P)} ${Re(2,3)}`,`${Ue("findMany")} ${Ye("DB Result")}:`,{model:A,data:z});let C=z;return n.disableTransformOutput||(C=await Promise.all(z.map(async B=>await m(B,w,void 0,R)))),a({method:"findMany"},`${De(P)} ${Re(3,3)}`,`${Ue("findMany")} ${Ye("Parsed Result")}:`,{model:A,data:C}),C},delete:async({model:w,where:_})=>{yt++;const S=yt,E=d(w),k=v({model:w,where:_,action:"delete"});w=c(w),a({method:"delete"},`${De(S)} ${Re(1,2)}`,`${Ue("delete")}:`,{model:E,where:k}),await x.delete({model:E,where:k}),a({method:"delete"},`${De(S)} ${Re(2,2)}`,`${Ue("delete")} ${Ye("DB Result")}:`,{model:E})},deleteMany:async({model:w,where:_})=>{yt++;const S=yt,E=d(w),k=v({model:w,where:_,action:"deleteMany"});w=c(w),a({method:"deleteMany"},`${De(S)} ${Re(1,2)}`,`${Ue("deleteMany")} ${Ye("DeleteMany")}:`,{model:E,where:k});const U=await x.deleteMany({model:E,where:k});return a({method:"deleteMany"},`${De(S)} ${Re(2,2)}`,`${Ue("deleteMany")} ${Ye("DB Result")}:`,{model:E,data:U}),U},count:async({model:w,where:_})=>{yt++;const S=yt,E=d(w),k=v({model:w,where:_,action:"count"});w=c(w),a({method:"count"},`${De(S)} ${Re(1,2)}`,`${Ue("count")}:`,{model:E,where:k});const U=await x.count({model:E,where:k});return a({method:"count"},`${De(S)} ${Re(2,2)}`,`${Ue("count")}:`,{model:E,data:U}),U},createSchema:x.createSchema?async(w,_)=>{const S=Cn(r);return r.secondaryStorage&&!r.session?.storeSessionInDatabase&&delete S.session,r.rateLimit&&r.rateLimit.storage==="database"&&(typeof r.rateLimit.enabled>"u"||r.rateLimit.enabled===!0)&&(S.ratelimit={modelName:r.rateLimit.modelName??"ratelimit",fields:{key:{type:"string",unique:!0,required:!0,fieldName:r.rateLimit.fields?.key??"key"},count:{type:"number",required:!0,fieldName:r.rateLimit.fields?.count??"count"},lastRequest:{type:"number",required:!0,bigint:!0,defaultValue:()=>Date.now(),fieldName:r.rateLimit.fields?.lastRequest??"lastRequest"}}}),x.createSchema({file:_,tables:S})}:void 0,options:{adapterConfig:n,...x.options??{}},id:n.adapterId,...n.debugLogs?.isRunningAdapterTests?{adapterTestDebugLogs:{resetDebugLogs(){Ms=Ms.filter(w=>w.instance!==i)},printDebugLogs(){const w="".repeat(80),_=Ms.filter(E=>E.instance===i);if(_.length===0)return;const S=_.reverse().map(E=>(E.args[0]=`
${E.args[0]}`,[...E.args,`
`])).reduce((E,k)=>[...k,...E],[`
${w}`]);console.log(...S)}}}:{}};return y};function De(e){return $S()<8?`#${e}`:`${et.fg.magenta}#${e}${et.reset}`}function Re(e,t){return`${et.bg.black}${et.fg.yellow}[${e}/${t}]${et.reset}`}function Ue(e){return`${et.bright}${e}${et.reset}`}function Ye(e){return`${et.dim}(${e})${et.reset}`}const hP={postgres:{string:["character varying","varchar","text","uuid"],number:["int4","integer","bigint","smallint","numeric","real","double precision"],boolean:["bool","boolean"],date:["timestamptz","timestamp","date"],json:["json","jsonb"]},mysql:{string:["varchar","text","uuid"],number:["integer","int","bigint","smallint","decimal","float","double"],boolean:["boolean","tinyint"],date:["timestamp","datetime","date"],json:["json"]},sqlite:{string:["TEXT"],number:["INTEGER","REAL"],boolean:["INTEGER","BOOLEAN"],date:["DATE","INTEGER"],json:["TEXT"]},mssql:{string:["varchar","nvarchar","uniqueidentifier"],number:["int","bigint","smallint","decimal","float","double"],boolean:["bit","smallint"],date:["datetime2","date","datetime"],json:["varchar","nvarchar"]}};function sN(e,t,r){function i(o){return o.toLowerCase().split("(")[0].trim()}if(t==="string[]"||t==="number[]")return e.toLowerCase().includes("json");const n=hP[r];return(Array.isArray(t)?n.string.map(o=>o.toLowerCase()):n[t].map(o=>o.toLowerCase())).includes(i(e))}async function pP(e){try{const t=await Ae`SHOW search_path`.execute(e);if(t.rows[0]?.search_path)return t.rows[0].search_path.split(",").map(r=>r.trim()).map(r=>r.replace(/^["']|["']$/g,"")).filter(r=>!r.startsWith("$"))[0]||"public"}catch{}return"public"}async function cN(e){const t=lk(e),r=wa(e.logger);let{kysely:i,databaseType:n}=await uP(e);n||(r.warn("Could not determine database type, defaulting to sqlite. Please provide a type in the database options to avoid this."),n="sqlite"),i||(r.error("Only kysely adapter is supported for migrations. You can use `generate` command to generate the schema, if you're using a different adapter."),process.exit(1));let o="public";if(n==="postgres"){o=await pP(i),r.debug(`PostgreSQL migration: Using schema '${o}' (from search_path)`);try{(await Ae`
				SELECT schema_name 
				FROM information_schema.schemata 
				WHERE schema_name = ${o}
			`.execute(i)).rows[0]||r.warn(`Schema '${o}' does not exist. Tables will be inspected from available schemas. Consider creating the schema first or checking your database configuration.`)}catch(N){r.debug(`Could not verify schema existence: ${N instanceof Error?N.message:String(N)}`)}}const a=await i.introspection.getTables();let s=a;if(n==="postgres")try{const N=await Ae`
				SELECT table_name 
				FROM information_schema.tables 
				WHERE table_schema = ${o}
				AND table_type = 'BASE TABLE'
			`.execute(i),y=new Set(N.rows.map(w=>w.table_name));s=a.filter(w=>w.schema===o&&y.has(w.name)),r.debug(`Found ${s.length} table(s) in schema '${o}': ${s.map(w=>w.name).join(", ")||"(none)"}`)}catch(N){r.warn(`Could not filter tables by schema. Using all discovered tables. Error: ${N instanceof Error?N.message:String(N)}`)}const c=[],u=[];for(const[N,y]of Object.entries(t)){const w=s.find(S=>S.name===N);if(!w){const S=c.findIndex(U=>U.table===N),E={table:N,fields:y.fields,order:y.order||1/0},k=c.findIndex(U=>(U.order||1/0)>E.order);k===-1?S===-1?c.push(E):c[S].fields={...c[S].fields,...y.fields}:c.splice(k,0,E);continue}const _={};for(const[S,E]of Object.entries(y.fields)){const k=w.columns.find(U=>U.name===S);if(!k){_[S]=E;continue}sN(k.dataType,E.type,n)||r.warn(`Field ${S} in table ${N} has a different type in the database. Expected ${E.type} but got ${k.dataType}.`)}Object.keys(_).length>0&&u.push({table:N,fields:_,order:y.order||1/0})}const d=[],l=e.advanced?.database?.generateId==="uuid",f=e.advanced?.database?.useNumberId||e.advanced?.database?.generateId==="serial";function h(N,y){const w=N.type,_=n||"sqlite",S={string:{sqlite:"text",postgres:"text",mysql:N.unique?"varchar(255)":N.references?"varchar(36)":N.sortable||N.index?"varchar(255)":"text",mssql:N.unique||N.sortable?"varchar(255)":N.references?"varchar(36)":"varchar(8000)"},boolean:{sqlite:"integer",postgres:"boolean",mysql:"boolean",mssql:"smallint"},number:{sqlite:N.bigint?"bigint":"integer",postgres:N.bigint?"bigint":"integer",mysql:N.bigint?"bigint":"integer",mssql:N.bigint?"bigint":"integer"},date:{sqlite:"date",postgres:"timestamptz",mysql:"timestamp(3)",mssql:Ae`datetime2(3)`},json:{sqlite:"text",postgres:"jsonb",mysql:"json",mssql:"varchar(8000)"},id:{postgres:f?Ae`integer GENERATED BY DEFAULT AS IDENTITY`:l?"uuid":"text",mysql:f?"integer":"varchar(36)",mssql:f?"integer":"varchar(36)",sqlite:f?"integer":"text"},foreignKeyId:{postgres:f?"integer":l?"uuid":"text",mysql:f?"integer":"varchar(36)",mssql:f?"integer":"varchar(36)",sqlite:f?"integer":"text"},"string[]":{sqlite:"text",postgres:"jsonb",mysql:"json",mssql:"varchar(8000)"},"number[]":{sqlite:"text",postgres:"jsonb",mysql:"json",mssql:"varchar(8000)"}};if(y==="id"||N.references?.field==="id")return y==="id"?S.id[_]:S.foreignKeyId[_];if(Array.isArray(w))return"text";if(!(w in S))throw new Error(`Unsupported field type '${String(w)}' for field '${y}'. Allowed types are: string, number, boolean, date, string[], number[]. If you need to store structured data, store it as a JSON string (type: "string") or split it into primitive fields. See https://better-auth.com/docs/advanced/schema#additional-fields`);return S[w][_]}const g=aN({schema:Cn(e),usePlural:!1}),m=oN({schema:Cn(e),usePlural:!1});function v(N,y){try{return`${g(N)}.${m({model:N,field:y})}`}catch{return`${N}.${y}`}}if(u.length)for(const N of u)for(const[y,w]of Object.entries(N.fields)){const _=h(w,y),S=i.schema.alterTable(N.table);if(w.index){const k=i.schema.alterTable(N.table).addIndex(`${N.table}_${y}_idx`);d.push(k)}const E=S.addColumn(y,_,k=>(k=w.required!==!1?k.notNull():k,w.references&&(k=k.references(v(w.references.model,w.references.field)).onDelete(w.references.onDelete||"cascade")),w.unique&&(k=k.unique()),w.type==="date"&&typeof w.defaultValue=="function"&&(n==="postgres"||n==="mysql"||n==="mssql")&&(n==="mysql"?k=k.defaultTo(Ae`CURRENT_TIMESTAMP(3)`):k=k.defaultTo(Ae`CURRENT_TIMESTAMP`)),k));d.push(E)}const b=[];if(e.advanced?.database?.useNumberId&&r.warn("`useNumberId` is deprecated. Please use `generateId` with `serial` instead."),c.length)for(const N of c){const y=h({type:f?"number":"string"},"id");let w=i.schema.createTable(N.table).addColumn("id",y,_=>f?n==="postgres"||n==="sqlite"?_.primaryKey().notNull():n==="mssql"?_.identity().primaryKey().notNull():_.autoIncrement().primaryKey().notNull():l&&n==="postgres"?_.primaryKey().defaultTo(Ae`pg_catalog.gen_random_uuid()`).notNull():_.primaryKey().notNull());for(const[_,S]of Object.entries(N.fields)){const E=h(S,_);if(w=w.addColumn(_,E,k=>(k=S.required!==!1?k.notNull():k,S.references&&(k=k.references(v(S.references.model,S.references.field)).onDelete(S.references.onDelete||"cascade")),S.unique&&(k=k.unique()),S.type==="date"&&typeof S.defaultValue=="function"&&(n==="postgres"||n==="mysql"||n==="mssql")&&(n==="mysql"?k=k.defaultTo(Ae`CURRENT_TIMESTAMP(3)`):k=k.defaultTo(Ae`CURRENT_TIMESTAMP`)),k)),S.index){const k=i.schema.createIndex(`${N.table}_${_}_${S.unique?"uidx":"idx"}`).on(N.table).columns([_]);b.push(S.unique?k.unique():k)}}d.push(w)}if(b.length)for(const N of b)d.push(N);async function I(){for(const N of d)await N.execute()}async function x(){return d.map(N=>N.compile().sql).join(`;

`)+";"}return{toBeCreated:c,toBeAdded:u,runMigrations:I,compileMigrations:x}}var uN=jR({convertFromDB:()=>BR,convertToDB:()=>FR,createFieldAttribute:()=>WR,createInternalAdapter:()=>Mp,getAdapter:()=>uk,getBaseAdapter:()=>ck,getMigrations:()=>cN,getSchema:()=>lk,getWithHooks:()=>dk,matchType:()=>sN,mergeSchema:()=>tR,parseAccountInput:()=>eR,parseAccountOutput:()=>VS,parseAdditionalUserInput:()=>XD,parseInputData:()=>ks,parseSessionInput:()=>KS,parseSessionOutput:()=>Xt,parseUserInput:()=>Up,parseUserOutput:()=>ht,toZodSchema:()=>VR});qR(uN,AD);const dN=()=>me("/get-session",{method:"GET",operationId:"getSession",query:aR,requireHeaders:!0,metadata:{openapi:{operationId:"getSession",description:"Get the current session",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",nullable:!0,properties:{session:{$ref:"#/components/schemas/Session"},user:{$ref:"#/components/schemas/User"}},required:["session","user"]}}}}}}}},async e=>{try{const t=await e.getSignedCookie(e.context.authCookies.sessionToken.name,e.context.secret);if(!t)return null;const r=HS(e,e.context.authCookies.sessionData.name);let i=null;if(r){const d=e.context.options.session?.cookieCache?.strategy||"compact";if(d==="jwe"){const l=await rw(r,e.context.secret,"better-auth-session");if(l&&l.session&&l.user)i={session:{session:l.session,user:l.user,updatedAt:l.updatedAt,version:l.version},expiresAt:l.exp?l.exp*1e3:Date.now()};else return er(e,e.context.authCookies.sessionData),e.json(null)}else if(d==="jwt"){const l=await oT(r,e.context.secret);if(l&&l.session&&l.user)i={session:{session:l.session,user:l.user,updatedAt:l.updatedAt,version:l.version},expiresAt:l.exp?l.exp*1e3:Date.now()};else return er(e,e.context.authCookies.sessionData),e.json(null)}else{const l=it(gR.decode(rd.decode(r)));if(l)if(await YS("SHA-256","base64urlnopad").verify(e.context.secret,JSON.stringify({...l.session,expiresAt:l.expiresAt}),l.signature))i=l;else return er(e,e.context.authCookies.sessionData),e.json(null)}}const n=await e.getSignedCookie(e.context.authCookies.dontRememberToken.name,e.context.secret);if(i?.session&&e.context.options.session?.cookieCache?.enabled&&!e.query?.disableCookieCache){const d=i.session,l=e.context.options.session?.cookieCache?.version;let f="1";if(l){if(typeof l=="string")f=l;else if(typeof l=="function"){const h=l(d.session,d.user);f=h instanceof Promise?await h:h}}if((d.version||"1")!==f)er(e,e.context.authCookies.sessionData);else{const h=new Date(d.session.expiresAt);if(i.expiresAt<Date.now()||h<new Date)er(e,e.context.authCookies.sessionData);else{const g=e.context.sessionConfig.cookieRefreshCache;if(g===!1){e.context.session=d;const b=Xt(e.context.options,{...d.session,expiresAt:new Date(d.session.expiresAt),createdAt:new Date(d.session.createdAt),updatedAt:new Date(d.session.updatedAt)}),I=ht(e.context.options,{...d.user,createdAt:new Date(d.user.createdAt),updatedAt:new Date(d.user.updatedAt)});return e.json({session:b,user:I})}if(i.expiresAt-Date.now()<g.updateAge*1e3){const b=no(e.context.options.session?.cookieCache?.maxAge||300,"sec"),I={session:{...d.session,expiresAt:b},user:d.user,updatedAt:Date.now()};await Ul(e,I,!1);const x=Xt(e.context.options,{...I.session,expiresAt:new Date(I.session.expiresAt),createdAt:new Date(I.session.createdAt),updatedAt:new Date(I.session.updatedAt)}),N=ht(e.context.options,{...I.user,createdAt:new Date(I.user.createdAt),updatedAt:new Date(I.user.updatedAt)});return e.context.session={session:x,user:N},e.json({session:x,user:N})}const m=Xt(e.context.options,{...d.session,expiresAt:new Date(d.session.expiresAt),createdAt:new Date(d.session.createdAt),updatedAt:new Date(d.session.updatedAt)}),v=ht(e.context.options,{...d.user,createdAt:new Date(d.user.createdAt),updatedAt:new Date(d.user.updatedAt)});return e.context.session={session:m,user:v},e.json({session:m,user:v})}}}const o=await e.context.internalAdapter.findSession(t);if(e.context.session=o,!o||o.session.expiresAt<new Date)return ba(e),o&&await e.context.internalAdapter.deleteSession(o.session.token),e.json(null);if(n||e.query?.disableRefresh){const d=Xt(e.context.options,o.session),l=ht(e.context.options,o.user);return e.json({session:d,user:l})}const a=e.context.sessionConfig.expiresIn,s=e.context.sessionConfig.updateAge;if(o.session.expiresAt.valueOf()-a*1e3+s*1e3<=Date.now()&&(!e.query?.disableRefresh||!e.context.options.session?.disableSessionRefresh)){const d=await e.context.internalAdapter.updateSession(o.session.token,{expiresAt:no(e.context.sessionConfig.expiresIn,"sec"),updatedAt:new Date});if(!d)return ba(e),e.json(null,{status:401});const l=(d.expiresAt.valueOf()-Date.now())/1e3;await tr(e,{session:d,user:o.user},!1,{maxAge:l});const f=Xt(e.context.options,d),h=ht(e.context.options,o.user);return e.json({session:f,user:h})}await Ul(e,o,!!n);const c=Xt(e.context.options,o.session),u=ht(e.context.options,o.user);return e.json({session:c,user:u})}catch(t){throw e.context.logger.error("INTERNAL_SERVER_ERROR",t),new D("INTERNAL_SERVER_ERROR",{message:G.FAILED_TO_GET_SESSION})}}),xr=async(e,t)=>{if(e.context.session)return e.context.session;const r=await dN()({...e,asResponse:!1,headers:e.headers,returnHeaders:!1,returnStatus:!1,query:{...t,...e.query}}).catch(i=>null);return e.context.session=r,r},Is=ln(async e=>{const t=await xr(e);if(!t?.session)throw new D("UNAUTHORIZED");return{session:t}}),Wn=ln(async e=>{const t=await xr(e,{disableCookieCache:!0});if(!t?.session)throw new D("UNAUTHORIZED");return{session:t}});ln(async e=>{const t=await xr(e);if(!t?.session&&(e.request||e.headers))throw new D("UNAUTHORIZED");return{session:t}});const mP=ln(async e=>{const t=await xr(e);if(!t?.session)throw new D("UNAUTHORIZED");if(e.context.sessionConfig.freshAge===0)return{session:t};const r=e.context.sessionConfig.freshAge,i=new Date(t.session.updatedAt||t.session.createdAt).getTime();if(!(Date.now()-i<r*1e3))throw new D("FORBIDDEN",{message:"Session is not fresh"});return{session:t}}),gP=()=>me("/list-sessions",{method:"GET",operationId:"listUserSessions",use:[Is],requireHeaders:!0,metadata:{openapi:{operationId:"listUserSessions",description:"List all active sessions for the user",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"array",items:{$ref:"#/components/schemas/Session"}}}}}}}}},async e=>{try{const t=(await e.context.internalAdapter.listSessions(e.context.session.user.id)).filter(r=>r.expiresAt>new Date);return e.json(t.map(r=>Xt(e.context.options,r)))}catch(t){throw e.context.logger.error(t),e.error("INTERNAL_SERVER_ERROR")}}),yP=me("/revoke-session",{method:"POST",body:le({token:M().meta({description:"The token to revoke"})}),use:[Wn],requireHeaders:!0,metadata:{openapi:{description:"Revoke a single session",requestBody:{content:{"application/json":{schema:{type:"object",properties:{token:{type:"string",description:"The token to revoke"}},required:["token"]}}}},responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean",description:"Indicates if the session was revoked successfully"}},required:["status"]}}}}}}}},async e=>{const t=e.body.token;if((await e.context.internalAdapter.findSession(t))?.session.userId===e.context.session.user.id)try{await e.context.internalAdapter.deleteSession(t)}catch(r){throw e.context.logger.error(r&&typeof r=="object"&&"name"in r?r.name:"",r),new D("INTERNAL_SERVER_ERROR")}return e.json({status:!0})}),wP=me("/revoke-sessions",{method:"POST",use:[Wn],requireHeaders:!0,metadata:{openapi:{description:"Revoke all sessions for the user",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean",description:"Indicates if all sessions were revoked successfully"}},required:["status"]}}}}}}}},async e=>{try{await e.context.internalAdapter.deleteSessions(e.context.session.user.id)}catch(t){throw e.context.logger.error(t&&typeof t=="object"&&"name"in t?t.name:"",t),new D("INTERNAL_SERVER_ERROR")}return e.json({status:!0})}),vP=me("/revoke-other-sessions",{method:"POST",requireHeaders:!0,use:[Wn],metadata:{openapi:{description:"Revoke all other sessions for the user except the current one",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean",description:"Indicates if all other sessions were revoked successfully"}},required:["status"]}}}}}}}},async e=>{const t=e.context.session;if(!t.user)throw new D("UNAUTHORIZED");const r=(await e.context.internalAdapter.listSessions(t.user.id)).filter(i=>i.expiresAt>new Date).filter(i=>i.token!==e.context.session.session.token);return await Promise.all(r.map(i=>e.context.internalAdapter.deleteSession(i.token))),e.json({status:!0})});function Bl(e,t){return e&&(t.options.account?.encryptOAuthTokens?PS({key:t.secret,data:e}):e)}function bt(e,t){return t.options.account?.encryptOAuthTokens&&e?CS({key:t.secret,data:e}):e}function lN(e){const t=r=>{const i=new Date;return new Date(i.getTime()+r*1e3)};return{tokenType:e.token_type,accessToken:e.access_token,refreshToken:e.refresh_token,accessTokenExpiresAt:e.expires_in?t(e.expires_in):void 0,refreshTokenExpiresAt:e.refresh_token_expires_in?t(e.refresh_token_expires_in):void 0,scopes:e?.scope?typeof e.scope=="string"?e.scope.split(" "):e.scope:[],idToken:e.id_token,raw:e}}async function fN(e){const t=new TextEncoder().encode(e),r=await crypto.subtle.digest("SHA-256",t);return rd.encode(new Uint8Array(r),{padding:!1})}async function $e({id:e,options:t,authorizationEndpoint:r,state:i,codeVerifier:n,scopes:o,claims:a,redirectURI:s,duration:c,prompt:u,accessType:d,responseType:l,display:f,loginHint:h,hd:g,responseMode:m,additionalParams:v,scopeJoiner:b}){const I=new URL(t.authorizationEndpoint||r);I.searchParams.set("response_type",l||"code");const x=Array.isArray(t.clientId)?t.clientId[0]:t.clientId;if(I.searchParams.set("client_id",x),I.searchParams.set("state",i),o&&I.searchParams.set("scope",o.join(b||" ")),I.searchParams.set("redirect_uri",t.redirectURI||s),c&&I.searchParams.set("duration",c),f&&I.searchParams.set("display",f),h&&I.searchParams.set("login_hint",h),u&&I.searchParams.set("prompt",u),g&&I.searchParams.set("hd",g),d&&I.searchParams.set("access_type",d),m&&I.searchParams.set("response_mode",m),n){const N=await fN(n);I.searchParams.set("code_challenge_method","S256"),I.searchParams.set("code_challenge",N)}if(a){const N=a.reduce((y,w)=>(y[w]=null,y),{});I.searchParams.set("claims",JSON.stringify({id_token:{email:null,email_verified:null,...N}}))}return v&&Object.entries(v).forEach(([N,y])=>{I.searchParams.set(N,y)}),I}var bP=Object.defineProperty,_P=Object.defineProperties,SP=Object.getOwnPropertyDescriptors,Vg=Object.getOwnPropertySymbols,kP=Object.prototype.hasOwnProperty,NP=Object.prototype.propertyIsEnumerable,Kg=(e,t,r)=>t in e?bP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Vn=(e,t)=>{for(var r in t||(t={}))kP.call(t,r)&&Kg(e,r,t[r]);if(Vg)for(var r of Vg(t))NP.call(t,r)&&Kg(e,r,t[r]);return e},Kn=(e,t)=>_P(e,SP(t)),$P=class extends Error{constructor(e,t,r){super(t||e.toString(),{cause:r}),this.status=e,this.statusText=t,this.error=r,Error.captureStackTrace(this,this.constructor)}},EP=async(e,t)=>{var r,i,n,o,a,s;let c=t||{};const u={onRequest:[t?.onRequest],onResponse:[t?.onResponse],onSuccess:[t?.onSuccess],onError:[t?.onError],onRetry:[t?.onRetry]};if(!t||!t?.plugins)return{url:e,options:c,hooks:u};for(const d of t?.plugins||[]){if(d.init){const l=await((r=d.init)==null?void 0:r.call(d,e.toString(),t));c=l.options||c,e=l.url}u.onRequest.push((i=d.hooks)==null?void 0:i.onRequest),u.onResponse.push((n=d.hooks)==null?void 0:n.onResponse),u.onSuccess.push((o=d.hooks)==null?void 0:o.onSuccess),u.onError.push((a=d.hooks)==null?void 0:a.onError),u.onRetry.push((s=d.hooks)==null?void 0:s.onRetry)}return{url:e,options:c,hooks:u}},Jg=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(){return this.options.delay}},AP=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(e){return Math.min(this.options.maxDelay,this.options.baseDelay*2**e)}};function IP(e){if(typeof e=="number")return new Jg({type:"linear",attempts:e,delay:1e3});switch(e.type){case"linear":return new Jg(e);case"exponential":return new AP(e);default:throw new Error("Invalid retry strategy")}}var TP=async e=>{const t={},r=async i=>typeof i=="function"?await i():i;if(e?.auth){if(e.auth.type==="Bearer"){const i=await r(e.auth.token);if(!i)return t;t.authorization=`Bearer ${i}`}else if(e.auth.type==="Basic"){const[i,n]=await Promise.all([r(e.auth.username),r(e.auth.password)]);if(!i||!n)return t;t.authorization=`Basic ${btoa(`${i}:${n}`)}`}else if(e.auth.type==="Custom"){const[i,n]=await Promise.all([r(e.auth.prefix),r(e.auth.value)]);if(!n)return t;t.authorization=`${i??""} ${n}`}}return t},xP=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function OP(e){const t=e.headers.get("content-type"),r=new Set(["image/svg","application/xml","application/xhtml","application/html"]);if(!t)return"json";const i=t.split(";").shift()||"";return xP.test(i)?"json":r.has(i)||i.startsWith("text/")?"text":"blob"}function DP(e){try{return JSON.parse(e),!0}catch{return!1}}function Vl(e){if(e===void 0)return!1;const t=typeof e;return t==="string"||t==="number"||t==="boolean"||t===null?!0:t!=="object"?!1:Array.isArray(e)?!0:e.buffer?!1:e.constructor&&e.constructor.name==="Object"||typeof e.toJSON=="function"}function Hg(e){try{return JSON.parse(e)}catch{return e}}function Zg(e){return typeof e=="function"}function RP(e){if(e?.customFetchImpl)return e.customFetchImpl;if(typeof globalThis<"u"&&Zg(globalThis.fetch))return globalThis.fetch;if(typeof window<"u"&&Zg(window.fetch))return window.fetch;throw new Error("No fetch implementation found")}async function UP(e){const t=new Headers(e?.headers),r=await TP(e);for(const[i,n]of Object.entries(r||{}))t.set(i,n);if(!t.has("content-type")){const i=CP(e?.body);i&&t.set("content-type",i)}return t}function CP(e){return Vl(e)?"application/json":null}function PP(e){if(!e?.body)return null;const t=new Headers(e?.headers);if(Vl(e.body)&&!t.has("content-type")){for(const[r,i]of Object.entries(e?.body))i instanceof Date&&(e.body[r]=i.toISOString());return JSON.stringify(e.body)}return t.has("content-type")&&t.get("content-type")==="application/x-www-form-urlencoded"&&Vl(e.body)?new URLSearchParams(e.body).toString():e.body}function LP(e,t){var r;if(t?.method)return t.method.toUpperCase();if(e.startsWith("@")){const i=(r=e.split("@")[1])==null?void 0:r.split("/")[0];return pN.includes(i)?i.toUpperCase():t?.body?"POST":"GET"}return t?.body?"POST":"GET"}function zP(e,t){let r;return!e?.signal&&e?.timeout&&(r=setTimeout(()=>t?.abort(),e?.timeout)),{abortTimeout:r,clearTimeout:()=>{r&&clearTimeout(r)}}}var jP=class hN extends Error{constructor(t,r){super(r||JSON.stringify(t,null,2)),this.issues=t,Object.setPrototypeOf(this,hN.prototype)}};async function MP(e,t){const r=await e["~standard"].validate(t);if(r.issues)throw new jP(r.issues);return r.value}var pN=["get","post","put","patch","delete"];function qP(e,t){const{baseURL:r,params:i,query:n}=t||{query:{},params:{},baseURL:""};let o=e.startsWith("http")?e.split("/").slice(0,3).join("/"):r||"";if(e.startsWith("@")){const l=e.toString().split("@")[1].split("/")[0];pN.includes(l)&&(e=e.replace(`@${l}/`,"/"))}o.endsWith("/")||(o+="/");let[a,s]=e.replace(o,"").split("?");const c=new URLSearchParams(s);for(const[l,f]of Object.entries(n||{})){if(f==null)continue;let h;if(typeof f=="string")h=f;else if(Array.isArray(f)){for(const g of f)c.append(l,g);continue}else h=JSON.stringify(f);c.set(l,h)}if(i)if(Array.isArray(i)){const l=a.split("/").filter(f=>f.startsWith(":"));for(const[f,h]of l.entries()){const g=i[f];a=a.replace(h,g)}}else for(const[l,f]of Object.entries(i))a=a.replace(`:${l}`,String(f));a=a.split("/").map(encodeURIComponent).join("/"),a.startsWith("/")&&(a=a.slice(1));let u=c.toString();return u=u.length>0?`?${u}`.replace(/\+/g,"%20"):"",o.startsWith("http")?new URL(`${a}${u}`,o):`${o}${a}${u}`}var oe=async(e,t)=>{var r,i,n,o,a,s,c,u;const{hooks:d,url:l,options:f}=await EP(e,t),h=RP(f),g=new AbortController,m=(r=f.signal)!=null?r:g.signal,v=qP(l,f),b=PP(f),I=await UP(f),x=LP(l,f);let N=Kn(Vn({},f),{url:v,headers:I,body:b,method:x,signal:m});for(const T of d.onRequest)if(T){const A=await T(N);typeof A=="object"&&A!==null&&(N=A)}("pipeTo"in N&&typeof N.pipeTo=="function"||typeof((i=t?.body)==null?void 0:i.pipe)=="function")&&("duplex"in N||(N.duplex="half"));const{clearTimeout:y}=zP(f,g);let w=await h(N.url,N);y();const _={response:w,request:N};for(const T of d.onResponse)if(T){const A=await T(Kn(Vn({},_),{response:(n=t?.hookOptions)!=null&&n.cloneResponse?w.clone():w}));A instanceof Response?w=A:typeof A=="object"&&A!==null&&(w=A.response)}if(w.ok){if(!(N.method!=="HEAD"))return{data:"",error:null};const A=OP(w),O={data:null,response:w,request:N};if(A==="json"||A==="text"){const R=await w.text(),W=(o=N.jsonParser)!=null?o:Hg;O.data=await W(R)}else O.data=await w[A]();N?.output&&N.output&&!N.disableValidation&&(O.data=await MP(N.output,O.data));for(const R of d.onSuccess)R&&await R(Kn(Vn({},O),{response:(a=t?.hookOptions)!=null&&a.cloneResponse?w.clone():w}));return t?.throw?O.data:{data:O.data,error:null}}const S=(s=t?.jsonParser)!=null?s:Hg,E=await w.text(),k=DP(E),U=k?await S(E):null,P={response:w,responseText:E,request:N,error:Kn(Vn({},U),{status:w.status,statusText:w.statusText})};for(const T of d.onError)T&&await T(Kn(Vn({},P),{response:(c=t?.hookOptions)!=null&&c.cloneResponse?w.clone():w}));if(t?.retry){const T=IP(t.retry),A=(u=t.retryAttempt)!=null?u:0;if(await T.shouldAttemptRetry(A,w)){for(const R of d.onRetry)R&&await R(_);const O=T.getDelay(A);return await new Promise(R=>setTimeout(R,O)),await oe(e,Kn(Vn({},t),{retryAttempt:A+1}))}}if(t?.throw)throw new $P(w.status,w.statusText,k?U:E);return{data:null,error:Kn(Vn({},U),{status:w.status,statusText:w.statusText})}};function WP({refreshToken:e,options:t,authentication:r,extraParams:i,resource:n}){const o=new URLSearchParams,a={"content-type":"application/x-www-form-urlencoded",accept:"application/json"};if(o.set("grant_type","refresh_token"),o.set("refresh_token",e),r==="basic"){const s=Array.isArray(t.clientId)?t.clientId[0]:t.clientId;s?a.authorization="Basic "+an.encode(`${s}:${t.clientSecret??""}`):a.authorization="Basic "+an.encode(`:${t.clientSecret??""}`)}else{const s=Array.isArray(t.clientId)?t.clientId[0]:t.clientId;o.set("client_id",s),t.clientSecret&&o.set("client_secret",t.clientSecret)}if(n)if(typeof n=="string")o.append("resource",n);else for(const s of n)o.append("resource",s);if(i)for(const[s,c]of Object.entries(i))o.set(s,c);return{body:o,headers:a}}async function he({refreshToken:e,options:t,tokenEndpoint:r,authentication:i,extraParams:n}){const{body:o,headers:a}=WP({refreshToken:e,options:t,authentication:i,extraParams:n}),{data:s,error:c}=await oe(r,{method:"POST",body:o,headers:a});if(c)throw c;const u={accessToken:s.access_token,refreshToken:s.refresh_token,tokenType:s.token_type,scopes:s.scope?.split(" "),idToken:s.id_token};if(s.expires_in){const d=new Date;u.accessTokenExpiresAt=new Date(d.getTime()+s.expires_in*1e3)}return u}function FP({code:e,codeVerifier:t,redirectURI:r,options:i,authentication:n,deviceId:o,headers:a,additionalParams:s={},resource:c}){const u=new URLSearchParams,d={"content-type":"application/x-www-form-urlencoded",accept:"application/json",...a};if(u.set("grant_type","authorization_code"),u.set("code",e),t&&u.set("code_verifier",t),i.clientKey&&u.set("client_key",i.clientKey),o&&u.set("device_id",o),u.set("redirect_uri",i.redirectURI||r),c)if(typeof c=="string")u.append("resource",c);else for(const l of c)u.append("resource",l);if(n==="basic"){const l=Array.isArray(i.clientId)?i.clientId[0]:i.clientId;d.authorization=`Basic ${an.encode(`${l}:${i.clientSecret??""}`)}`}else{const l=Array.isArray(i.clientId)?i.clientId[0]:i.clientId;u.set("client_id",l),i.clientSecret&&u.set("client_secret",i.clientSecret)}for(const[l,f]of Object.entries(s))u.has(l)||u.append(l,f);return{body:u,headers:d}}async function pe({code:e,codeVerifier:t,redirectURI:r,options:i,tokenEndpoint:n,authentication:o,deviceId:a,headers:s,additionalParams:c={},resource:u}){const{body:d,headers:l}=FP({code:e,codeVerifier:t,redirectURI:r,options:i,authentication:o,deviceId:a,headers:s,additionalParams:c,resource:u}),{data:f,error:h}=await oe(n,{method:"POST",body:d,headers:l});if(h)throw h;return lN(f)}const BP=e=>{const t="https://appleid.apple.com/auth/token";return{id:"apple",name:"Apple",async createAuthorizationURL({state:r,scopes:i,redirectURI:n}){const o=e.disableDefaultScope?[]:["email","name"];return e.scope&&o.push(...e.scope),i&&o.push(...i),await $e({id:"apple",options:e,authorizationEndpoint:"https://appleid.apple.com/auth/authorize",scopes:o,state:r,redirectURI:n,responseMode:"form_post",responseType:"code id_token"})},validateAuthorizationCode:async({code:r,codeVerifier:i,redirectURI:n})=>pe({code:r,codeVerifier:i,redirectURI:n,options:e,tokenEndpoint:t}),async verifyIdToken(r,i){if(e.disableIdTokenSignIn)return!1;if(e.verifyIdToken)return e.verifyIdToken(r,i);const{kid:n,alg:o}=df(r);if(!n||!o)return!1;const{payload:a}=await ho(r,await VP(n),{algorithms:[o],issuer:"https://appleid.apple.com",audience:e.audience&&e.audience.length?e.audience:e.appBundleIdentifier?e.appBundleIdentifier:e.clientId,maxTokenAge:"1h"});return["email_verified","is_private_email"].forEach(s=>{a[s]!==void 0&&(a[s]=!!a[s])}),i&&a.nonce!==i?!1:!!a},refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async r=>he({refreshToken:r,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://appleid.apple.com/auth/token"}),async getUserInfo(r){if(e.getUserInfo)return e.getUserInfo(r);if(!r.idToken)return null;const i=dn(r.idToken);if(!i)return null;const n=r.user?`${r.user.name?.firstName} ${r.user.name?.lastName}`:i.name||i.email,o=typeof i.email_verified=="boolean"?i.email_verified:i.email_verified==="true",a={...i,name:n},s=await e.mapProfileToUser?.(a);return{user:{id:i.sub,name:a.name,emailVerified:o,email:i.email,...s},data:a}},options:e}},VP=async e=>{const{data:t}=await oe("https://appleid.apple.com/auth/keys");if(!t?.keys)throw new D("BAD_REQUEST",{message:"Keys not found"});const r=t.keys.find(i=>i.kid===e);if(!r)throw new Error(`JWK with kid ${e} not found`);return await $a(r,r.alg)},KP=e=>({id:"atlassian",name:"Atlassian",async createAuthorizationURL({state:t,scopes:r,codeVerifier:i,redirectURI:n}){if(!e.clientId||!e.clientSecret)throw ie.error("Client Id and Secret are required for Atlassian"),new Y("CLIENT_ID_AND_SECRET_REQUIRED");if(!i)throw new Y("codeVerifier is required for Atlassian");const o=e.disableDefaultScope?[]:["read:jira-user","offline_access"];return e.scope&&o.push(...e.scope),r&&o.push(...r),$e({id:"atlassian",options:e,authorizationEndpoint:"https://auth.atlassian.com/authorize",scopes:o,state:t,codeVerifier:i,redirectURI:n,additionalParams:{audience:"api.atlassian.com"},prompt:e.prompt})},validateAuthorizationCode:async({code:t,codeVerifier:r,redirectURI:i})=>pe({code:t,codeVerifier:r,redirectURI:i,options:e,tokenEndpoint:"https://auth.atlassian.com/oauth/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>he({refreshToken:t,options:{clientId:e.clientId,clientSecret:e.clientSecret},tokenEndpoint:"https://auth.atlassian.com/oauth/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);if(!t.accessToken)return null;try{const{data:r}=await oe("https://api.atlassian.com/me",{headers:{Authorization:`Bearer ${t.accessToken}`}});if(!r)return null;const i=await e.mapProfileToUser?.(r);return{user:{id:r.account_id,name:r.name,email:r.email,image:r.picture,emailVerified:!1,...i},data:r}}catch(r){return ie.error("Failed to fetch user info from Figma:",r),null}},options:e}),JP=e=>{if(!e.domain||!e.region||!e.userPoolId)throw ie.error("Domain, region and userPoolId are required for Amazon Cognito. Make sure to provide them in the options."),new Y("DOMAIN_AND_REGION_REQUIRED");const t=e.domain.replace(/^https?:\/\//,""),r=`https://${t}/oauth2/authorize`,i=`https://${t}/oauth2/token`,n=`https://${t}/oauth2/userinfo`;return{id:"cognito",name:"Cognito",async createAuthorizationURL({state:o,scopes:a,codeVerifier:s,redirectURI:c}){if(!e.clientId)throw ie.error("ClientId is required for Amazon Cognito. Make sure to provide them in the options."),new Y("CLIENT_ID_AND_SECRET_REQUIRED");if(e.requireClientSecret&&!e.clientSecret)throw ie.error("Client Secret is required when requireClientSecret is true. Make sure to provide it in the options."),new Y("CLIENT_SECRET_REQUIRED");const u=e.disableDefaultScope?[]:["openid","profile","email"];e.scope&&u.push(...e.scope),a&&u.push(...a);const d=await $e({id:"cognito",options:{...e},authorizationEndpoint:r,scopes:u,state:o,codeVerifier:s,redirectURI:c,prompt:e.prompt}),l=d.searchParams.get("scope");if(l){d.searchParams.delete("scope");const f=encodeURIComponent(l),h=d.toString(),g=h.includes("?")?"&":"?";return new URL(`${h}${g}scope=${f}`)}return d},validateAuthorizationCode:async({code:o,codeVerifier:a,redirectURI:s})=>pe({code:o,codeVerifier:a,redirectURI:s,options:e,tokenEndpoint:i}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async o=>he({refreshToken:o,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:i}),async verifyIdToken(o,a){if(e.disableIdTokenSignIn)return!1;if(e.verifyIdToken)return e.verifyIdToken(o,a);try{const{kid:s,alg:c}=df(o);if(!s||!c)return!1;const u=await HP(s,e.region,e.userPoolId),d=`https://cognito-idp.${e.region}.amazonaws.com/${e.userPoolId}`,{payload:l}=await ho(o,u,{algorithms:[c],issuer:d,audience:e.clientId,maxTokenAge:"1h"});return!(a&&l.nonce!==a)}catch(s){return ie.error("Failed to verify ID token:",s),!1}},async getUserInfo(o){if(e.getUserInfo)return e.getUserInfo(o);if(o.idToken)try{const a=dn(o.idToken);if(!a)return null;const s=a.name||a.given_name||a.username||a.email,c={...a,name:s},u=await e.mapProfileToUser?.(c);return{user:{id:a.sub,name:c.name,email:a.email,image:a.picture,emailVerified:a.email_verified,...u},data:c}}catch(a){ie.error("Failed to decode ID token:",a)}if(o.accessToken)try{const{data:a}=await oe(n,{headers:{Authorization:`Bearer ${o.accessToken}`}});if(a){const s=await e.mapProfileToUser?.(a);return{user:{id:a.sub,name:a.name||a.given_name||a.username,email:a.email,image:a.picture,emailVerified:a.email_verified,...s},data:a}}}catch(a){ie.error("Failed to fetch user info from Cognito:",a)}return null},options:e}},HP=async(e,t,r)=>{const i=`https://cognito-idp.${t}.amazonaws.com/${r}/.well-known/jwks.json`;try{const{data:n}=await oe(i);if(!n?.keys)throw new D("BAD_REQUEST",{message:"Keys not found"});const o=n.keys.find(a=>a.kid===e);if(!o)throw new Error(`JWK with kid ${e} not found`);return await $a(o,o.alg)}catch(n){throw ie.error("Failed to fetch Cognito public key:",n),n}},ZP=e=>({id:"discord",name:"Discord",createAuthorizationURL({state:t,scopes:r,redirectURI:i}){const n=e.disableDefaultScope?[]:["identify","email"];r&&n.push(...r),e.scope&&n.push(...e.scope);const o=n.includes("bot")&&e.permissions!==void 0?`&permissions=${e.permissions}`:"";return new URL(`https://discord.com/api/oauth2/authorize?scope=${n.join("+")}&response_type=code&client_id=${e.clientId}&redirect_uri=${encodeURIComponent(e.redirectURI||i)}&state=${t}&prompt=${e.prompt||"none"}${o}`)},validateAuthorizationCode:async({code:t,redirectURI:r})=>pe({code:t,redirectURI:r,options:e,tokenEndpoint:"https://discord.com/api/oauth2/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>he({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://discord.com/api/oauth2/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:r,error:i}=await oe("https://discord.com/api/users/@me",{headers:{authorization:`Bearer ${t.accessToken}`}});if(i)return null;if(r.avatar===null)r.image_url=`https://cdn.discordapp.com/embed/avatars/${r.discriminator==="0"?Number(BigInt(r.id)>>BigInt(22))%6:parseInt(r.discriminator)%5}.png`;else{const o=r.avatar.startsWith("a_")?"gif":"png";r.image_url=`https://cdn.discordapp.com/avatars/${r.id}/${r.avatar}.${o}`}const n=await e.mapProfileToUser?.(r);return{user:{id:r.id,name:r.global_name||r.username||"",email:r.email,emailVerified:r.verified,image:r.image_url,...n},data:r}},options:e}),GP=e=>{const t="https://api.dropboxapi.com/oauth2/token";return{id:"dropbox",name:"Dropbox",createAuthorizationURL:async({state:r,scopes:i,codeVerifier:n,redirectURI:o})=>{const a=e.disableDefaultScope?[]:["account_info.read"];e.scope&&a.push(...e.scope),i&&a.push(...i);const s={};return e.accessType&&(s.token_access_type=e.accessType),await $e({id:"dropbox",options:e,authorizationEndpoint:"https://www.dropbox.com/oauth2/authorize",scopes:a,state:r,redirectURI:o,codeVerifier:n,additionalParams:s})},validateAuthorizationCode:async({code:r,codeVerifier:i,redirectURI:n})=>await pe({code:r,codeVerifier:i,redirectURI:n,options:e,tokenEndpoint:t}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async r=>he({refreshToken:r,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://api.dropbox.com/oauth2/token"}),async getUserInfo(r){if(e.getUserInfo)return e.getUserInfo(r);const{data:i,error:n}=await oe("https://api.dropboxapi.com/2/users/get_current_account",{method:"POST",headers:{Authorization:`Bearer ${r.accessToken}`}});if(n)return null;const o=await e.mapProfileToUser?.(i);return{user:{id:i.account_id,name:i.name?.display_name,email:i.email,emailVerified:i.email_verified||!1,image:i.profile_photo_url,...o},data:i}},options:e}},QP=e=>({id:"facebook",name:"Facebook",async createAuthorizationURL({state:t,scopes:r,redirectURI:i,loginHint:n}){const o=e.disableDefaultScope?[]:["email","public_profile"];return e.scope&&o.push(...e.scope),r&&o.push(...r),await $e({id:"facebook",options:e,authorizationEndpoint:"https://www.facebook.com/v21.0/dialog/oauth",scopes:o,state:t,redirectURI:i,loginHint:n,additionalParams:e.configId?{config_id:e.configId}:{}})},validateAuthorizationCode:async({code:t,redirectURI:r})=>pe({code:t,redirectURI:r,options:e,tokenEndpoint:"https://graph.facebook.com/oauth/access_token"}),async verifyIdToken(t,r){if(e.disableIdTokenSignIn)return!1;if(e.verifyIdToken)return e.verifyIdToken(t,r);if(t.split(".").length===3)try{const{payload:i}=await ho(t,iT(new URL("https://limited.facebook.com/.well-known/oauth/openid/jwks/")),{algorithms:["RS256"],audience:e.clientId,issuer:"https://www.facebook.com"});return r&&i.nonce!==r?!1:!!i}catch{return!1}return!0},refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>he({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://graph.facebook.com/v18.0/oauth/access_token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);if(t.idToken&&t.idToken.split(".").length===3){const o=dn(t.idToken),a={id:o.sub,name:o.name,email:o.email,picture:{data:{url:o.picture,height:100,width:100,is_silhouette:!1}}},s=await e.mapProfileToUser?.({...a,email_verified:!1});return{user:{...a,emailVerified:!1,...s},data:o}}const{data:r,error:i}=await oe("https://graph.facebook.com/me?fields="+["id","name","email","picture",...e?.fields||[]].join(","),{auth:{type:"Bearer",token:t.accessToken}});if(i)return null;const n=await e.mapProfileToUser?.(r);return{user:{id:r.id,name:r.name,email:r.email,image:r.picture.data.url,emailVerified:r.email_verified,...n},data:r}},options:e}),YP=e=>({id:"figma",name:"Figma",async createAuthorizationURL({state:t,scopes:r,codeVerifier:i,redirectURI:n}){if(!e.clientId||!e.clientSecret)throw ie.error("Client Id and Client Secret are required for Figma. Make sure to provide them in the options."),new Y("CLIENT_ID_AND_SECRET_REQUIRED");if(!i)throw new Y("codeVerifier is required for Figma");const o=e.disableDefaultScope?[]:["current_user:read"];return e.scope&&o.push(...e.scope),r&&o.push(...r),await $e({id:"figma",options:e,authorizationEndpoint:"https://www.figma.com/oauth",scopes:o,state:t,codeVerifier:i,redirectURI:n})},validateAuthorizationCode:async({code:t,codeVerifier:r,redirectURI:i})=>pe({code:t,codeVerifier:r,redirectURI:i,options:e,tokenEndpoint:"https://api.figma.com/v1/oauth/token",authentication:"basic"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>he({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://api.figma.com/v1/oauth/token",authentication:"basic"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);try{const{data:r}=await oe("https://api.figma.com/v1/me",{headers:{Authorization:`Bearer ${t.accessToken}`}});if(!r)return ie.error("Failed to fetch user from Figma"),null;const i=await e.mapProfileToUser?.(r);return{user:{id:r.id,name:r.handle,email:r.email,image:r.img_url,emailVerified:!1,...i},data:r}}catch(r){return ie.error("Failed to fetch user info from Figma:",r),null}},options:e}),XP=e=>{const t="https://github.com/login/oauth/access_token";return{id:"github",name:"GitHub",createAuthorizationURL({state:r,scopes:i,loginHint:n,codeVerifier:o,redirectURI:a}){const s=e.disableDefaultScope?[]:["read:user","user:email"];return e.scope&&s.push(...e.scope),i&&s.push(...i),$e({id:"github",options:e,authorizationEndpoint:"https://github.com/login/oauth/authorize",scopes:s,state:r,codeVerifier:o,redirectURI:a,loginHint:n,prompt:e.prompt})},validateAuthorizationCode:async({code:r,codeVerifier:i,redirectURI:n})=>pe({code:r,codeVerifier:i,redirectURI:n,options:e,tokenEndpoint:t}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async r=>he({refreshToken:r,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://github.com/login/oauth/access_token"}),async getUserInfo(r){if(e.getUserInfo)return e.getUserInfo(r);const{data:i,error:n}=await oe("https://api.github.com/user",{headers:{"User-Agent":"better-auth",authorization:`Bearer ${r.accessToken}`}});if(n)return null;const{data:o}=await oe("https://api.github.com/user/emails",{headers:{Authorization:`Bearer ${r.accessToken}`,"User-Agent":"better-auth"}});!i.email&&o&&(i.email=(o.find(c=>c.primary)??o[0])?.email);const a=o?.find(c=>c.email===i.email)?.verified??!1,s=await e.mapProfileToUser?.(i);return{user:{id:i.id,name:i.name||i.login,email:i.email,image:i.avatar_url,emailVerified:a,...s},data:i}},options:e}},Xd=(e="")=>e.split("://").map(t=>t.replace(/\/{2,}/g,"/")).join("://"),eL=e=>{const t=e||"https://gitlab.com";return{authorizationEndpoint:Xd(`${t}/oauth/authorize`),tokenEndpoint:Xd(`${t}/oauth/token`),userinfoEndpoint:Xd(`${t}/api/v4/user`)}},tL=e=>{const{authorizationEndpoint:t,tokenEndpoint:r,userinfoEndpoint:i}=eL(e.issuer),n="gitlab";return{id:n,name:"Gitlab",createAuthorizationURL:async({state:o,scopes:a,codeVerifier:s,loginHint:c,redirectURI:u})=>{const d=e.disableDefaultScope?[]:["read_user"];return e.scope&&d.push(...e.scope),a&&d.push(...a),await $e({id:n,options:e,authorizationEndpoint:t,scopes:d,state:o,redirectURI:u,codeVerifier:s,loginHint:c})},validateAuthorizationCode:async({code:o,redirectURI:a,codeVerifier:s})=>pe({code:o,redirectURI:a,options:e,codeVerifier:s,tokenEndpoint:r}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async o=>he({refreshToken:o,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:r}),async getUserInfo(o){if(e.getUserInfo)return e.getUserInfo(o);const{data:a,error:s}=await oe(i,{headers:{authorization:`Bearer ${o.accessToken}`}});if(s||a.state!=="active"||a.locked)return null;const c=await e.mapProfileToUser?.(a);return{user:{id:a.id,name:a.name??a.username,email:a.email,image:a.avatar_url,emailVerified:a.email_verified??!1,...c},data:a}},options:e}},rL=e=>({id:"google",name:"Google",async createAuthorizationURL({state:t,scopes:r,codeVerifier:i,redirectURI:n,loginHint:o,display:a}){if(!e.clientId||!e.clientSecret)throw ie.error("Client Id and Client Secret is required for Google. Make sure to provide them in the options."),new Y("CLIENT_ID_AND_SECRET_REQUIRED");if(!i)throw new Y("codeVerifier is required for Google");const s=e.disableDefaultScope?[]:["email","profile","openid"];return e.scope&&s.push(...e.scope),r&&s.push(...r),await $e({id:"google",options:e,authorizationEndpoint:"https://accounts.google.com/o/oauth2/auth",scopes:s,state:t,codeVerifier:i,redirectURI:n,prompt:e.prompt,accessType:e.accessType,display:a||e.display,loginHint:o,hd:e.hd,additionalParams:{include_granted_scopes:"true"}})},validateAuthorizationCode:async({code:t,codeVerifier:r,redirectURI:i})=>pe({code:t,codeVerifier:r,redirectURI:i,options:e,tokenEndpoint:"https://oauth2.googleapis.com/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>he({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://www.googleapis.com/oauth2/v4/token"}),async verifyIdToken(t,r){if(e.disableIdTokenSignIn)return!1;if(e.verifyIdToken)return e.verifyIdToken(t,r);const{kid:i,alg:n}=df(t);if(!i||!n)return!1;const{payload:o}=await ho(t,await nL(i),{algorithms:[n],issuer:["https://accounts.google.com","accounts.google.com"],audience:e.clientId,maxTokenAge:"1h"});return!(r&&o.nonce!==r)},async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);if(!t.idToken)return null;const r=dn(t.idToken),i=await e.mapProfileToUser?.(r);return{user:{id:r.sub,name:r.name,email:r.email,image:r.picture,emailVerified:r.email_verified,...i},data:r}},options:e}),nL=async e=>{const{data:t}=await oe("https://www.googleapis.com/oauth2/v3/certs");if(!t?.keys)throw new D("BAD_REQUEST",{message:"Keys not found"});const r=t.keys.find(i=>i.kid===e);if(!r)throw new Error(`JWK with kid ${e} not found`);return await $a(r,r.alg)},iL=e=>({id:"huggingface",name:"Hugging Face",createAuthorizationURL({state:t,scopes:r,codeVerifier:i,redirectURI:n}){const o=e.disableDefaultScope?[]:["openid","profile","email"];return e.scope&&o.push(...e.scope),r&&o.push(...r),$e({id:"huggingface",options:e,authorizationEndpoint:"https://huggingface.co/oauth/authorize",scopes:o,state:t,codeVerifier:i,redirectURI:n})},validateAuthorizationCode:async({code:t,codeVerifier:r,redirectURI:i})=>pe({code:t,codeVerifier:r,redirectURI:i,options:e,tokenEndpoint:"https://huggingface.co/oauth/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>he({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://huggingface.co/oauth/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:r,error:i}=await oe("https://huggingface.co/oauth/userinfo",{method:"GET",headers:{Authorization:`Bearer ${t.accessToken}`}});if(i)return null;const n=await e.mapProfileToUser?.(r);return{user:{id:r.sub,name:r.name||r.preferred_username,email:r.email,image:r.picture,emailVerified:r.email_verified??!1,...n},data:r}},options:e}),oL=e=>({id:"kakao",name:"Kakao",createAuthorizationURL({state:t,scopes:r,redirectURI:i}){const n=e.disableDefaultScope?[]:["account_email","profile_image","profile_nickname"];return e.scope&&n.push(...e.scope),r&&n.push(...r),$e({id:"kakao",options:e,authorizationEndpoint:"https://kauth.kakao.com/oauth/authorize",scopes:n,state:t,redirectURI:i})},validateAuthorizationCode:async({code:t,redirectURI:r})=>pe({code:t,redirectURI:r,options:e,tokenEndpoint:"https://kauth.kakao.com/oauth/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>he({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://kauth.kakao.com/oauth/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:r,error:i}=await oe("https://kapi.kakao.com/v2/user/me",{headers:{Authorization:`Bearer ${t.accessToken}`}});if(i||!r)return null;const n=await e.mapProfileToUser?.(r),o=r.kakao_account||{},a=o.profile||{};return{user:{id:String(r.id),name:a.nickname||o.name||void 0,email:o.email,image:a.profile_image_url||a.thumbnail_image_url,emailVerified:!!o.is_email_valid&&!!o.is_email_verified,...n},data:r}},options:e}),aL=e=>({id:"kick",name:"Kick",createAuthorizationURL({state:t,scopes:r,redirectURI:i,codeVerifier:n}){const o=e.disableDefaultScope?[]:["user:read"];return e.scope&&o.push(...e.scope),r&&o.push(...r),$e({id:"kick",redirectURI:i,options:e,authorizationEndpoint:"https://id.kick.com/oauth/authorize",scopes:o,codeVerifier:n,state:t})},async validateAuthorizationCode({code:t,redirectURI:r,codeVerifier:i}){return pe({code:t,redirectURI:r,options:e,tokenEndpoint:"https://id.kick.com/oauth/token",codeVerifier:i})},refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>he({refreshToken:t,options:{clientId:e.clientId,clientSecret:e.clientSecret},tokenEndpoint:"https://id.kick.com/oauth/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:r,error:i}=await oe("https://api.kick.com/public/v1/users",{method:"GET",headers:{Authorization:`Bearer ${t.accessToken}`}});if(i)return null;const n=r.data[0],o=await e.mapProfileToUser?.(n);return{user:{id:n.user_id,name:n.name,email:n.email,image:n.profile_picture,emailVerified:!1,...o},data:n}},options:e}),sL=e=>{const t="https://access.line.me/oauth2/v2.1/authorize",r="https://api.line.me/oauth2/v2.1/token",i="https://api.line.me/oauth2/v2.1/userinfo",n="https://api.line.me/oauth2/v2.1/verify";return{id:"line",name:"LINE",async createAuthorizationURL({state:o,scopes:a,codeVerifier:s,redirectURI:c,loginHint:u}){const d=e.disableDefaultScope?[]:["openid","profile","email"];return e.scope&&d.push(...e.scope),a&&d.push(...a),await $e({id:"line",options:e,authorizationEndpoint:t,scopes:d,state:o,codeVerifier:s,redirectURI:c,loginHint:u})},validateAuthorizationCode:async({code:o,codeVerifier:a,redirectURI:s})=>pe({code:o,codeVerifier:a,redirectURI:s,options:e,tokenEndpoint:r}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async o=>he({refreshToken:o,options:{clientId:e.clientId,clientSecret:e.clientSecret},tokenEndpoint:r}),async verifyIdToken(o,a){if(e.disableIdTokenSignIn)return!1;if(e.verifyIdToken)return e.verifyIdToken(o,a);const s=new URLSearchParams;s.set("id_token",o),s.set("client_id",e.clientId),a&&s.set("nonce",a);const{data:c,error:u}=await oe(n,{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded"},body:s});return!(u||!c||c.aud!==e.clientId||c.nonce&&c.nonce!==a)},async getUserInfo(o){if(e.getUserInfo)return e.getUserInfo(o);let a=null;if(o.idToken)try{a=dn(o.idToken)}catch{}if(!a){const{data:l}=await oe(i,{headers:{authorization:`Bearer ${o.accessToken}`}});a=l||null}if(!a)return null;const s=await e.mapProfileToUser?.(a),c=a.sub||a.userId,u=a.name||a.displayName,d=a.picture||a.pictureUrl||void 0;return{user:{id:c,name:u,email:a.email,image:d,emailVerified:!1,...s},data:a}},options:e}},cL=e=>{const t="https://api.linear.app/oauth/token";return{id:"linear",name:"Linear",createAuthorizationURL({state:r,scopes:i,loginHint:n,redirectURI:o}){const a=e.disableDefaultScope?[]:["read"];return e.scope&&a.push(...e.scope),i&&a.push(...i),$e({id:"linear",options:e,authorizationEndpoint:"https://linear.app/oauth/authorize",scopes:a,state:r,redirectURI:o,loginHint:n})},validateAuthorizationCode:async({code:r,redirectURI:i})=>pe({code:r,redirectURI:i,options:e,tokenEndpoint:t}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async r=>he({refreshToken:r,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:t}),async getUserInfo(r){if(e.getUserInfo)return e.getUserInfo(r);const{data:i,error:n}=await oe("https://api.linear.app/graphql",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r.accessToken}`},body:JSON.stringify({query:`
							query {
								viewer {
									id
									name
									email
									avatarUrl
									active
									createdAt
									updatedAt
								}
							}
						`})});if(n||!i?.data?.viewer)return null;const o=i.data.viewer,a=await e.mapProfileToUser?.(o);return{user:{id:i.data.viewer.id,name:i.data.viewer.name,email:i.data.viewer.email,image:i.data.viewer.avatarUrl,emailVerified:!1,...a},data:o}},options:e}},uL=e=>{const t="https://www.linkedin.com/oauth/v2/authorization",r="https://www.linkedin.com/oauth/v2/accessToken";return{id:"linkedin",name:"Linkedin",createAuthorizationURL:async({state:i,scopes:n,redirectURI:o,loginHint:a})=>{const s=e.disableDefaultScope?[]:["profile","email","openid"];return e.scope&&s.push(...e.scope),n&&s.push(...n),await $e({id:"linkedin",options:e,authorizationEndpoint:t,scopes:s,state:i,loginHint:a,redirectURI:o})},validateAuthorizationCode:async({code:i,redirectURI:n})=>await pe({code:i,redirectURI:n,options:e,tokenEndpoint:r}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async i=>he({refreshToken:i,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:r}),async getUserInfo(i){if(e.getUserInfo)return e.getUserInfo(i);const{data:n,error:o}=await oe("https://api.linkedin.com/v2/userinfo",{method:"GET",headers:{Authorization:`Bearer ${i.accessToken}`}});if(o)return null;const a=await e.mapProfileToUser?.(n);return{user:{id:n.sub,name:n.name,email:n.email,emailVerified:n.email_verified||!1,image:n.picture,...a},data:n}},options:e}},dL=e=>{const t=e.tenantId||"common",r=e.authority||"https://login.microsoftonline.com",i=`${r}/${t}/oauth2/v2.0/authorize`,n=`${r}/${t}/oauth2/v2.0/token`;return{id:"microsoft",name:"Microsoft EntraID",createAuthorizationURL(o){const a=e.disableDefaultScope?[]:["openid","profile","email","User.Read","offline_access"];return e.scope&&a.push(...e.scope),o.scopes&&a.push(...o.scopes),$e({id:"microsoft",options:e,authorizationEndpoint:i,state:o.state,codeVerifier:o.codeVerifier,scopes:a,redirectURI:o.redirectURI,prompt:e.prompt,loginHint:o.loginHint})},validateAuthorizationCode({code:o,codeVerifier:a,redirectURI:s}){return pe({code:o,codeVerifier:a,redirectURI:s,options:e,tokenEndpoint:n})},async getUserInfo(o){if(e.getUserInfo)return e.getUserInfo(o);if(!o.idToken)return null;const a=dn(o.idToken),s=e.profilePhotoSize||48;await oe(`https://graph.microsoft.com/v1.0/me/photos/${s}x${s}/$value`,{headers:{Authorization:`Bearer ${o.accessToken}`},async onResponse(d){if(!(e.disableProfilePhoto||!d.response.ok))try{const l=await d.response.clone().arrayBuffer();a.picture=`data:image/jpeg;base64, ${an.encode(l)}`}catch(l){ie.error(l&&typeof l=="object"&&"name"in l?l.name:"",l)}}});const c=await e.mapProfileToUser?.(a),u=a.email_verified!==void 0?a.email_verified:!!(a.email&&(a.verified_primary_email?.includes(a.email)||a.verified_secondary_email?.includes(a.email)));return{user:{id:a.sub,name:a.name,email:a.email,image:a.picture,emailVerified:u,...c},data:a}},refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async o=>{const a=e.disableDefaultScope?[]:["openid","profile","email","User.Read","offline_access"];return e.scope&&a.push(...e.scope),he({refreshToken:o,options:{clientId:e.clientId,clientSecret:e.clientSecret},extraParams:{scope:a.join(" ")},tokenEndpoint:n})},options:e}},lL=e=>({id:"naver",name:"Naver",createAuthorizationURL({state:t,scopes:r,redirectURI:i}){const n=e.disableDefaultScope?[]:["profile","email"];return e.scope&&n.push(...e.scope),r&&n.push(...r),$e({id:"naver",options:e,authorizationEndpoint:"https://nid.naver.com/oauth2.0/authorize",scopes:n,state:t,redirectURI:i})},validateAuthorizationCode:async({code:t,redirectURI:r})=>pe({code:t,redirectURI:r,options:e,tokenEndpoint:"https://nid.naver.com/oauth2.0/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>he({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://nid.naver.com/oauth2.0/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:r,error:i}=await oe("https://openapi.naver.com/v1/nid/me",{headers:{Authorization:`Bearer ${t.accessToken}`}});if(i||!r||r.resultcode!=="00")return null;const n=await e.mapProfileToUser?.(r),o=r.response||{};return{user:{id:o.id,name:o.name||o.nickname,email:o.email,image:o.profile_image,emailVerified:!1,...n},data:r}},options:e}),fL=e=>{const t="https://api.notion.com/v1/oauth/token";return{id:"notion",name:"Notion",createAuthorizationURL({state:r,scopes:i,loginHint:n,redirectURI:o}){const a=e.disableDefaultScope?[]:[];return e.scope&&a.push(...e.scope),i&&a.push(...i),$e({id:"notion",options:e,authorizationEndpoint:"https://api.notion.com/v1/oauth/authorize",scopes:a,state:r,redirectURI:o,loginHint:n,additionalParams:{owner:"user"}})},validateAuthorizationCode:async({code:r,redirectURI:i})=>pe({code:r,redirectURI:i,options:e,tokenEndpoint:t,authentication:"basic"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async r=>he({refreshToken:r,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:t}),async getUserInfo(r){if(e.getUserInfo)return e.getUserInfo(r);const{data:i,error:n}=await oe("https://api.notion.com/v1/users/me",{headers:{Authorization:`Bearer ${r.accessToken}`,"Notion-Version":"2022-06-28"}});if(n||!i)return null;const o=i.bot?.owner?.user;if(!o)return null;const a=await e.mapProfileToUser?.(o);return{user:{id:o.id,name:o.name||"Notion User",email:o.person?.email||null,image:o.avatar_url,emailVerified:!1,...a},data:o}},options:e}},hL=e=>{const t=e.issuer||"https://idp.paybin.io",r=`${t}/oauth2/authorize`,i=`${t}/oauth2/token`;return{id:"paybin",name:"Paybin",async createAuthorizationURL({state:n,scopes:o,codeVerifier:a,redirectURI:s,loginHint:c}){if(!e.clientId||!e.clientSecret)throw ie.error("Client Id and Client Secret is required for Paybin. Make sure to provide them in the options."),new Y("CLIENT_ID_AND_SECRET_REQUIRED");if(!a)throw new Y("codeVerifier is required for Paybin");const u=e.disableDefaultScope?[]:["openid","email","profile"];return e.scope&&u.push(...e.scope),o&&u.push(...o),await $e({id:"paybin",options:e,authorizationEndpoint:r,scopes:u,state:n,codeVerifier:a,redirectURI:s,prompt:e.prompt,loginHint:c})},validateAuthorizationCode:async({code:n,codeVerifier:o,redirectURI:a})=>pe({code:n,codeVerifier:o,redirectURI:a,options:e,tokenEndpoint:i}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async n=>he({refreshToken:n,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:i}),async getUserInfo(n){if(e.getUserInfo)return e.getUserInfo(n);if(!n.idToken)return null;const o=dn(n.idToken),a=await e.mapProfileToUser?.(o);return{user:{id:o.sub,name:o.name||o.preferred_username||(o.email?o.email.split("@")[0]:"User")||"User",email:o.email,image:o.picture,emailVerified:o.email_verified||!1,...a},data:o}},options:e}},pL=e=>{const t=(e.environment||"sandbox")==="sandbox",r=t?"https://www.sandbox.paypal.com/signin/authorize":"https://www.paypal.com/signin/authorize",i=t?"https://api-m.sandbox.paypal.com/v1/oauth2/token":"https://api-m.paypal.com/v1/oauth2/token",n=t?"https://api-m.sandbox.paypal.com/v1/identity/oauth2/userinfo":"https://api-m.paypal.com/v1/identity/oauth2/userinfo";return{id:"paypal",name:"PayPal",async createAuthorizationURL({state:o,codeVerifier:a,redirectURI:s}){if(!e.clientId||!e.clientSecret)throw ie.error("Client Id and Client Secret is required for PayPal. Make sure to provide them in the options."),new Y("CLIENT_ID_AND_SECRET_REQUIRED");return await $e({id:"paypal",options:e,authorizationEndpoint:r,scopes:[],state:o,codeVerifier:a,redirectURI:s,prompt:e.prompt})},validateAuthorizationCode:async({code:o,redirectURI:a})=>{const s=an.encode(`${e.clientId}:${e.clientSecret}`);try{const c=await oe(i,{method:"POST",headers:{Authorization:`Basic ${s}`,Accept:"application/json","Accept-Language":"en_US","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"authorization_code",code:o,redirect_uri:a}).toString()});if(!c.data)throw new Y("FAILED_TO_GET_ACCESS_TOKEN");const u=c.data;return{accessToken:u.access_token,refreshToken:u.refresh_token,accessTokenExpiresAt:u.expires_in?new Date(Date.now()+u.expires_in*1e3):void 0,idToken:u.id_token}}catch(c){throw ie.error("PayPal token exchange failed:",c),new Y("FAILED_TO_GET_ACCESS_TOKEN")}},refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async o=>{const a=an.encode(`${e.clientId}:${e.clientSecret}`);try{const s=await oe(i,{method:"POST",headers:{Authorization:`Basic ${a}`,Accept:"application/json","Accept-Language":"en_US","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"refresh_token",refresh_token:o}).toString()});if(!s.data)throw new Y("FAILED_TO_REFRESH_ACCESS_TOKEN");const c=s.data;return{accessToken:c.access_token,refreshToken:c.refresh_token,accessTokenExpiresAt:c.expires_in?new Date(Date.now()+c.expires_in*1e3):void 0}}catch(s){throw ie.error("PayPal token refresh failed:",s),new Y("FAILED_TO_REFRESH_ACCESS_TOKEN")}},async verifyIdToken(o,a){if(e.disableIdTokenSignIn)return!1;if(e.verifyIdToken)return e.verifyIdToken(o,a);try{return!!dn(o).sub}catch(s){return ie.error("Failed to verify PayPal ID token:",s),!1}},async getUserInfo(o){if(e.getUserInfo)return e.getUserInfo(o);if(!o.accessToken)return ie.error("Access token is required to fetch PayPal user info"),null;try{const a=await oe(`${n}?schema=paypalv1.1`,{headers:{Authorization:`Bearer ${o.accessToken}`,Accept:"application/json"}});if(!a.data)return ie.error("Failed to fetch user info from PayPal"),null;const s=a.data,c=await e.mapProfileToUser?.(s);return{user:{id:s.user_id,name:s.name,email:s.email,image:s.picture,emailVerified:s.email_verified,...c},data:s}}catch(a){return ie.error("Failed to fetch user info from PayPal:",a),null}},options:e}},mL=e=>({id:"polar",name:"Polar",createAuthorizationURL({state:t,scopes:r,codeVerifier:i,redirectURI:n}){const o=e.disableDefaultScope?[]:["openid","profile","email"];return e.scope&&o.push(...e.scope),r&&o.push(...r),$e({id:"polar",options:e,authorizationEndpoint:"https://polar.sh/oauth2/authorize",scopes:o,state:t,codeVerifier:i,redirectURI:n,prompt:e.prompt})},validateAuthorizationCode:async({code:t,codeVerifier:r,redirectURI:i})=>pe({code:t,codeVerifier:r,redirectURI:i,options:e,tokenEndpoint:"https://api.polar.sh/v1/oauth2/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>he({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://api.polar.sh/v1/oauth2/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:r,error:i}=await oe("https://api.polar.sh/v1/oauth2/userinfo",{headers:{Authorization:`Bearer ${t.accessToken}`}});if(i)return null;const n=await e.mapProfileToUser?.(r);return{user:{id:r.id,name:r.public_name||r.username,email:r.email,image:r.avatar_url,emailVerified:r.email_verified??!1,...n},data:r}},options:e}),gL=e=>({id:"reddit",name:"Reddit",createAuthorizationURL({state:t,scopes:r,redirectURI:i}){const n=e.disableDefaultScope?[]:["identity"];return e.scope&&n.push(...e.scope),r&&n.push(...r),$e({id:"reddit",options:e,authorizationEndpoint:"https://www.reddit.com/api/v1/authorize",scopes:n,state:t,redirectURI:i,duration:e.duration})},validateAuthorizationCode:async({code:t,redirectURI:r})=>{const i=new URLSearchParams({grant_type:"authorization_code",code:t,redirect_uri:e.redirectURI||r}),{data:n,error:o}=await oe("https://www.reddit.com/api/v1/access_token",{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded",accept:"text/plain","user-agent":"better-auth",Authorization:`Basic ${an.encode(`${e.clientId}:${e.clientSecret}`)}`},body:i.toString()});if(o)throw o;return lN(n)},refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>he({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},authentication:"basic",tokenEndpoint:"https://www.reddit.com/api/v1/access_token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:r,error:i}=await oe("https://oauth.reddit.com/api/v1/me",{headers:{Authorization:`Bearer ${t.accessToken}`,"User-Agent":"better-auth"}});if(i)return null;const n=await e.mapProfileToUser?.(r);return{user:{id:r.id,name:r.name,email:r.oauth_client_id,emailVerified:r.has_verified_email,image:r.icon_img?.split("?")[0],...n},data:r}},options:e}),yL=e=>({id:"roblox",name:"Roblox",createAuthorizationURL({state:t,scopes:r,redirectURI:i}){const n=e.disableDefaultScope?[]:["openid","profile"];return e.scope&&n.push(...e.scope),r&&n.push(...r),new URL(`https://apis.roblox.com/oauth/v1/authorize?scope=${n.join("+")}&response_type=code&client_id=${e.clientId}&redirect_uri=${encodeURIComponent(e.redirectURI||i)}&state=${t}&prompt=${e.prompt||"select_account consent"}`)},validateAuthorizationCode:async({code:t,redirectURI:r})=>pe({code:t,redirectURI:e.redirectURI||r,options:e,tokenEndpoint:"https://apis.roblox.com/oauth/v1/token",authentication:"post"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>he({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://apis.roblox.com/oauth/v1/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:r,error:i}=await oe("https://apis.roblox.com/oauth/v1/userinfo",{headers:{authorization:`Bearer ${t.accessToken}`}});if(i)return null;const n=await e.mapProfileToUser?.(r);return{user:{id:r.sub,name:r.nickname||r.preferred_username||"",image:r.picture,email:r.preferred_username||null,emailVerified:!1,...n},data:{...r}}},options:e}),wL=e=>{const t=(e.environment??"production")==="sandbox",r=e.loginUrl?`https://${e.loginUrl}/services/oauth2/authorize`:t?"https://test.salesforce.com/services/oauth2/authorize":"https://login.salesforce.com/services/oauth2/authorize",i=e.loginUrl?`https://${e.loginUrl}/services/oauth2/token`:t?"https://test.salesforce.com/services/oauth2/token":"https://login.salesforce.com/services/oauth2/token",n=e.loginUrl?`https://${e.loginUrl}/services/oauth2/userinfo`:t?"https://test.salesforce.com/services/oauth2/userinfo":"https://login.salesforce.com/services/oauth2/userinfo";return{id:"salesforce",name:"Salesforce",async createAuthorizationURL({state:o,scopes:a,codeVerifier:s,redirectURI:c}){if(!e.clientId||!e.clientSecret)throw ie.error("Client Id and Client Secret are required for Salesforce. Make sure to provide them in the options."),new Y("CLIENT_ID_AND_SECRET_REQUIRED");if(!s)throw new Y("codeVerifier is required for Salesforce");const u=e.disableDefaultScope?[]:["openid","email","profile"];return e.scope&&u.push(...e.scope),a&&u.push(...a),$e({id:"salesforce",options:e,authorizationEndpoint:r,scopes:u,state:o,codeVerifier:s,redirectURI:e.redirectURI||c})},validateAuthorizationCode:async({code:o,codeVerifier:a,redirectURI:s})=>pe({code:o,codeVerifier:a,redirectURI:e.redirectURI||s,options:e,tokenEndpoint:i}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async o=>he({refreshToken:o,options:{clientId:e.clientId,clientSecret:e.clientSecret},tokenEndpoint:i}),async getUserInfo(o){if(e.getUserInfo)return e.getUserInfo(o);try{const{data:a}=await oe(n,{headers:{Authorization:`Bearer ${o.accessToken}`}});if(!a)return ie.error("Failed to fetch user info from Salesforce"),null;const s=await e.mapProfileToUser?.(a);return{user:{id:a.user_id,name:a.name,email:a.email,image:a.photos?.picture||a.photos?.thumbnail,emailVerified:a.email_verified??!1,...s},data:a}}catch(a){return ie.error("Failed to fetch user info from Salesforce:",a),null}},options:e}},vL=e=>({id:"slack",name:"Slack",createAuthorizationURL({state:t,scopes:r,redirectURI:i}){const n=e.disableDefaultScope?[]:["openid","profile","email"];r&&n.push(...r),e.scope&&n.push(...e.scope);const o=new URL("https://slack.com/openid/connect/authorize");return o.searchParams.set("scope",n.join(" ")),o.searchParams.set("response_type","code"),o.searchParams.set("client_id",e.clientId),o.searchParams.set("redirect_uri",e.redirectURI||i),o.searchParams.set("state",t),o},validateAuthorizationCode:async({code:t,redirectURI:r})=>pe({code:t,redirectURI:r,options:e,tokenEndpoint:"https://slack.com/api/openid.connect.token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>he({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://slack.com/api/openid.connect.token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:r,error:i}=await oe("https://slack.com/api/openid.connect.userInfo",{headers:{authorization:`Bearer ${t.accessToken}`}});if(i)return null;const n=await e.mapProfileToUser?.(r);return{user:{id:r["https://slack.com/user_id"],name:r.name||"",email:r.email,emailVerified:r.email_verified,image:r.picture||r["https://slack.com/user_image_512"],...n},data:r}},options:e}),bL=e=>({id:"spotify",name:"Spotify",createAuthorizationURL({state:t,scopes:r,codeVerifier:i,redirectURI:n}){const o=e.disableDefaultScope?[]:["user-read-email"];return e.scope&&o.push(...e.scope),r&&o.push(...r),$e({id:"spotify",options:e,authorizationEndpoint:"https://accounts.spotify.com/authorize",scopes:o,state:t,codeVerifier:i,redirectURI:n})},validateAuthorizationCode:async({code:t,codeVerifier:r,redirectURI:i})=>pe({code:t,codeVerifier:r,redirectURI:i,options:e,tokenEndpoint:"https://accounts.spotify.com/api/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>he({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://accounts.spotify.com/api/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:r,error:i}=await oe("https://api.spotify.com/v1/me",{method:"GET",headers:{Authorization:`Bearer ${t.accessToken}`}});if(i)return null;const n=await e.mapProfileToUser?.(r);return{user:{id:r.id,name:r.display_name,email:r.email,image:r.images[0]?.url,emailVerified:!1,...n},data:r}},options:e}),_L=e=>({id:"tiktok",name:"TikTok",createAuthorizationURL({state:t,scopes:r,redirectURI:i}){const n=e.disableDefaultScope?[]:["user.info.profile"];return e.scope&&n.push(...e.scope),r&&n.push(...r),new URL(`https://www.tiktok.com/v2/auth/authorize?scope=${n.join(",")}&response_type=code&client_key=${e.clientKey}&redirect_uri=${encodeURIComponent(e.redirectURI||i)}&state=${t}`)},validateAuthorizationCode:async({code:t,redirectURI:r})=>pe({code:t,redirectURI:e.redirectURI||r,options:{clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://open.tiktokapis.com/v2/oauth/token/"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>he({refreshToken:t,options:{clientSecret:e.clientSecret},tokenEndpoint:"https://open.tiktokapis.com/v2/oauth/token/",authentication:"post",extraParams:{client_key:e.clientKey}}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:r,error:i}=await oe(`https://open.tiktokapis.com/v2/user/info/?fields=${["open_id","avatar_large_url","display_name","username"].join(",")}`,{headers:{authorization:`Bearer ${t.accessToken}`}});return i?null:{user:{email:r.data.user.email||r.data.user.username,id:r.data.user.open_id,name:r.data.user.display_name||r.data.user.username,image:r.data.user.avatar_large_url,emailVerified:!1},data:r}},options:e}),SL=e=>({id:"twitch",name:"Twitch",createAuthorizationURL({state:t,scopes:r,redirectURI:i}){const n=e.disableDefaultScope?[]:["user:read:email","openid"];return e.scope&&n.push(...e.scope),r&&n.push(...r),$e({id:"twitch",redirectURI:i,options:e,authorizationEndpoint:"https://id.twitch.tv/oauth2/authorize",scopes:n,state:t,claims:e.claims||["email","email_verified","preferred_username","picture"]})},validateAuthorizationCode:async({code:t,redirectURI:r})=>pe({code:t,redirectURI:r,options:e,tokenEndpoint:"https://id.twitch.tv/oauth2/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>he({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://id.twitch.tv/oauth2/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const r=t.idToken;if(!r)return ie.error("No idToken found in token"),null;const i=dn(r),n=await e.mapProfileToUser?.(i);return{user:{id:i.sub,name:i.preferred_username,email:i.email,image:i.picture,emailVerified:i.email_verified,...n},data:i}},options:e}),kL=e=>({id:"twitter",name:"Twitter",createAuthorizationURL(t){const r=e.disableDefaultScope?[]:["users.read","tweet.read","offline.access","users.email"];return e.scope&&r.push(...e.scope),t.scopes&&r.push(...t.scopes),$e({id:"twitter",options:e,authorizationEndpoint:"https://x.com/i/oauth2/authorize",scopes:r,state:t.state,codeVerifier:t.codeVerifier,redirectURI:t.redirectURI})},validateAuthorizationCode:async({code:t,codeVerifier:r,redirectURI:i})=>pe({code:t,codeVerifier:r,authentication:"basic",redirectURI:i,options:e,tokenEndpoint:"https://api.x.com/2/oauth2/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>he({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},authentication:"basic",tokenEndpoint:"https://api.x.com/2/oauth2/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:r,error:i}=await oe("https://api.x.com/2/users/me?user.fields=profile_image_url",{method:"GET",headers:{Authorization:`Bearer ${t.accessToken}`}});if(i)return null;const{data:n,error:o}=await oe("https://api.x.com/2/users/me?user.fields=confirmed_email",{method:"GET",headers:{Authorization:`Bearer ${t.accessToken}`}});let a=!1;!o&&n?.data?.confirmed_email&&(r.data.email=n.data.confirmed_email,a=!0);const s=await e.mapProfileToUser?.(r);return{user:{id:r.data.id,name:r.data.name,email:r.data.email||r.data.username||null,image:r.data.profile_image_url,emailVerified:a,...s},data:r}},options:e}),NL=e=>({id:"vercel",name:"Vercel",createAuthorizationURL({state:t,scopes:r,codeVerifier:i,redirectURI:n}){if(!i)throw new Y("codeVerifier is required for Vercel");let o;return(e.scope!==void 0||r!==void 0)&&(o=[],e.scope&&o.push(...e.scope),r&&o.push(...r)),$e({id:"vercel",options:e,authorizationEndpoint:"https://vercel.com/oauth/authorize",scopes:o,state:t,codeVerifier:i,redirectURI:n})},validateAuthorizationCode:async({code:t,codeVerifier:r,redirectURI:i})=>pe({code:t,codeVerifier:r,redirectURI:i,options:e,tokenEndpoint:"https://api.vercel.com/login/oauth/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:r,error:i}=await oe("https://api.vercel.com/login/oauth/userinfo",{headers:{Authorization:`Bearer ${t.accessToken}`}});if(i||!r)return null;const n=await e.mapProfileToUser?.(r);return{user:{id:r.sub,name:r.name??r.preferred_username,email:r.email,image:r.picture,emailVerified:r.email_verified??!1,...n},data:r}},options:e}),$L=e=>({id:"vk",name:"VK",async createAuthorizationURL({state:t,scopes:r,codeVerifier:i,redirectURI:n}){const o=e.disableDefaultScope?[]:["email","phone"];return e.scope&&o.push(...e.scope),r&&o.push(...r),$e({id:"vk",options:e,authorizationEndpoint:"https://id.vk.com/authorize",scopes:o,state:t,redirectURI:n,codeVerifier:i})},validateAuthorizationCode:async({code:t,codeVerifier:r,redirectURI:i,deviceId:n})=>pe({code:t,codeVerifier:r,redirectURI:e.redirectURI||i,options:e,deviceId:n,tokenEndpoint:"https://id.vk.com/oauth2/auth"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>he({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://id.vk.com/oauth2/auth"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);if(!t.accessToken)return null;const r=new URLSearchParams({access_token:t.accessToken,client_id:e.clientId}).toString(),{data:i,error:n}=await oe("https://id.vk.com/oauth2/user_info",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:r});if(n)return null;const o=await e.mapProfileToUser?.(i);return!i.user.email&&!o?.email?null:{user:{id:i.user.user_id,first_name:i.user.first_name,last_name:i.user.last_name,email:i.user.email,image:i.user.avatar,emailVerified:!1,birthday:i.user.birthday,sex:i.user.sex,name:`${i.user.first_name} ${i.user.last_name}`,...o},data:i}},options:e}),EL=e=>{const t={pkce:!0,...e};return{id:"zoom",name:"Zoom",createAuthorizationURL:async({state:r,redirectURI:i,codeVerifier:n})=>{const o=new URLSearchParams({response_type:"code",redirect_uri:t.redirectURI?t.redirectURI:i,client_id:t.clientId,state:r});if(t.pkce){const s=await fN(n);o.set("code_challenge_method","S256"),o.set("code_challenge",s)}const a=new URL("https://zoom.us/oauth/authorize");return a.search=o.toString(),a},validateAuthorizationCode:async({code:r,redirectURI:i,codeVerifier:n})=>pe({code:r,redirectURI:t.redirectURI||i,codeVerifier:n,options:t,tokenEndpoint:"https://zoom.us/oauth/token",authentication:"post"}),refreshAccessToken:t.refreshAccessToken?t.refreshAccessToken:async r=>he({refreshToken:r,options:{clientId:t.clientId,clientKey:t.clientKey,clientSecret:t.clientSecret},tokenEndpoint:"https://zoom.us/oauth/token"}),async getUserInfo(r){if(t.getUserInfo)return t.getUserInfo(r);const{data:i,error:n}=await oe("https://api.zoom.us/v2/users/me",{headers:{authorization:`Bearer ${r.accessToken}`}});if(n)return null;const o=await t.mapProfileToUser?.(i);return{user:{id:i.id,name:i.display_name,image:i.pic_url,email:i.email,emailVerified:!!i.verified,...o},data:{...i}}}}},mN={apple:BP,atlassian:KP,cognito:JP,discord:ZP,facebook:QP,figma:YP,github:XP,microsoft:dL,google:rL,huggingface:iL,slack:vL,spotify:bL,twitch:SL,twitter:kL,dropbox:GP,kick:aL,linear:cL,linkedin:uL,gitlab:tL,tiktok:_L,reddit:gL,roblox:yL,salesforce:wL,vk:$L,zoom:EL,notion:fL,kakao:oL,naver:lL,line:sL,paybin:hL,paypal:pL,polar:mL,vercel:NL},AL=Object.keys(mN),gN=No(AL).or(M()),IL=me("/list-accounts",{method:"GET",use:[Is],metadata:{openapi:{operationId:"listUserAccounts",description:"List all accounts linked to the user",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"array",items:{type:"object",properties:{id:{type:"string"},providerId:{type:"string"},createdAt:{type:"string",format:"date-time"},updatedAt:{type:"string",format:"date-time"},accountId:{type:"string"},userId:{type:"string"},scopes:{type:"array",items:{type:"string"}}},required:["id","providerId","createdAt","updatedAt","accountId","userId","scopes"]}}}}}}}}},async e=>{const t=e.context.session,r=await e.context.internalAdapter.findAccounts(t.user.id);return e.json(r.map(i=>{const{scope:n,...o}=VS(e.context.options,i);return{...o,scopes:n?.split(",")||[]}}))}),TL=me("/link-social",{method:"POST",requireHeaders:!0,body:le({callbackURL:M().meta({description:"The URL to redirect to after the user has signed in"}).optional(),provider:gN,idToken:le({token:M(),nonce:M().optional(),accessToken:M().optional(),refreshToken:M().optional(),scopes:Ar(M()).optional()}).optional(),requestSignUp:Bt().optional(),scopes:Ar(M()).meta({description:"Additional scopes to request from the provider"}).optional(),errorCallbackURL:M().meta({description:"The URL to redirect to if there is an error during the link process"}).optional(),disableRedirect:Bt().meta({description:"Disable automatic redirection to the provider. Useful for handling the redirection yourself"}).optional(),additionalData:qn(M(),rn()).optional()}),use:[Is],metadata:{openapi:{description:"Link a social account to the user",operationId:"linkSocialAccount",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{url:{type:"string",description:"The authorization URL to redirect the user to"},redirect:{type:"boolean",description:"Indicates if the user should be redirected to the authorization URL"},status:{type:"boolean"}},required:["redirect"]}}}}}}}},async e=>{const t=e.context.session,r=e.context.socialProviders.find(o=>o.id===e.body.provider);if(!r)throw e.context.logger.error("Provider not found. Make sure to add the provider in your auth config",{provider:e.body.provider}),new D("NOT_FOUND",{message:G.PROVIDER_NOT_FOUND});if(e.body.idToken){if(!r.verifyIdToken)throw e.context.logger.error("Provider does not support id token verification",{provider:e.body.provider}),new D("NOT_FOUND",{message:G.ID_TOKEN_NOT_SUPPORTED});const{token:o,nonce:a}=e.body.idToken;if(!await r.verifyIdToken(o,a))throw e.context.logger.error("Invalid id token",{provider:e.body.provider}),new D("UNAUTHORIZED",{message:G.INVALID_TOKEN});const s=await r.getUserInfo({idToken:o,accessToken:e.body.idToken.accessToken,refreshToken:e.body.idToken.refreshToken});if(!s||!s?.user)throw e.context.logger.error("Failed to get user info",{provider:e.body.provider}),new D("UNAUTHORIZED",{message:G.FAILED_TO_GET_USER_INFO});const c=String(s.user.id);if(!s.user.email)throw e.context.logger.error("User email not found",{provider:e.body.provider}),new D("UNAUTHORIZED",{message:G.USER_EMAIL_NOT_FOUND});if((await e.context.internalAdapter.findAccounts(t.user.id)).find(u=>u.providerId===r.id&&u.accountId===c))return e.json({url:"",status:!0,redirect:!1});if(!e.context.options.account?.accountLinking?.trustedProviders?.includes(r.id)&&!s.user.emailVerified||e.context.options.account?.accountLinking?.enabled===!1)throw new D("UNAUTHORIZED",{message:"Account not linked - linking not allowed"});if(s.user.email!==t.user.email&&e.context.options.account?.accountLinking?.allowDifferentEmails!==!0)throw new D("UNAUTHORIZED",{message:"Account not linked - different emails not allowed"});try{await e.context.internalAdapter.createAccount({userId:t.user.id,providerId:r.id,accountId:c,accessToken:e.body.idToken.accessToken,idToken:o,refreshToken:e.body.idToken.refreshToken,scope:e.body.idToken.scopes?.join(",")})}catch{throw new D("EXPECTATION_FAILED",{message:"Account not linked - unable to create account"})}if(e.context.options.account?.accountLinking?.updateUserInfoOnLink===!0)try{await e.context.internalAdapter.updateUser(t.user.id,{name:s.user?.name,image:s.user?.image})}catch(u){console.warn("Could not update user - "+u.toString())}return e.json({url:"",status:!0,redirect:!1})}const i=await ek(e,{userId:t.user.id,email:t.user.email},e.body.additionalData),n=await r.createAuthorizationURL({state:i.state,codeVerifier:i.codeVerifier,redirectURI:`${e.context.baseURL}/callback/${r.id}`,scopes:e.body.scopes});return e.body.disableRedirect||e.setHeader("Location",n.toString()),e.json({url:n.toString(),redirect:!e.body.disableRedirect})}),xL=me("/unlink-account",{method:"POST",body:le({providerId:M(),accountId:M().optional()}),use:[mP],metadata:{openapi:{description:"Unlink an account",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean"}}}}}}}}}},async e=>{const{providerId:t,accountId:r}=e.body,i=await e.context.internalAdapter.findAccounts(e.context.session.user.id);if(i.length===1&&!e.context.options.account?.accountLinking?.allowUnlinkingAll)throw new D("BAD_REQUEST",{message:G.FAILED_TO_UNLINK_LAST_ACCOUNT});const n=i.find(o=>r?o.accountId===r&&o.providerId===t:o.providerId===t);if(!n)throw new D("BAD_REQUEST",{message:G.ACCOUNT_NOT_FOUND});return await e.context.internalAdapter.deleteAccount(n.id),e.json({status:!0})}),yN=me("/get-access-token",{method:"POST",body:le({providerId:M().meta({description:"The provider ID for the OAuth provider"}),accountId:M().meta({description:"The account ID associated with the refresh token"}).optional(),userId:M().meta({description:"The user ID associated with the account"}).optional()}),metadata:{openapi:{description:"Get a valid access token, doing a refresh if needed",responses:{200:{description:"A Valid access token",content:{"application/json":{schema:{type:"object",properties:{tokenType:{type:"string"},idToken:{type:"string"},accessToken:{type:"string"},accessTokenExpiresAt:{type:"string",format:"date-time"}}}}}},400:{description:"Invalid refresh token or provider configuration"}}}}},async e=>{const{providerId:t,accountId:r,userId:i}=e.body||{},n=e.request,o=await xr(e);if(n&&!o)throw e.error("UNAUTHORIZED");const a=o?.user?.id||i;if(!a)throw e.error("UNAUTHORIZED");if(!e.context.socialProviders.find(d=>d.id===t))throw new D("BAD_REQUEST",{message:`Provider ${t} is not supported.`});const s=await Pp(e);let c;if(s&&t===s.providerId&&(!r||s.id===r)?c=s:c=(await e.context.internalAdapter.findAccounts(a)).find(d=>r?d.id===r&&d.providerId===t:d.providerId===t),!c)throw new D("BAD_REQUEST",{message:"Account not found"});const u=e.context.socialProviders.find(d=>d.id===t);if(!u)throw new D("BAD_REQUEST",{message:`Provider ${t} not found.`});try{let d=null;const l=c.accessTokenExpiresAt&&new Date(c.accessTokenExpiresAt).getTime()-Date.now()<5e3;if(c.refreshToken&&l&&u.refreshAccessToken){const g=await Bl(c.refreshToken,e.context);d=await u.refreshAccessToken(g);const m={accessToken:await bt(d.accessToken,e.context),accessTokenExpiresAt:d.accessTokenExpiresAt,refreshToken:await bt(d.refreshToken,e.context),refreshTokenExpiresAt:d.refreshTokenExpiresAt};let v=null;c.id&&(v=await e.context.internalAdapter.updateAccount(c.id,m)),e.context.options.account?.storeAccountCookie&&await wc(e,{...c,...v??m})}const f=(()=>{if(d?.accessTokenExpiresAt)return typeof d.accessTokenExpiresAt=="string"?new Date(d.accessTokenExpiresAt):d.accessTokenExpiresAt;if(c.accessTokenExpiresAt)return typeof c.accessTokenExpiresAt=="string"?new Date(c.accessTokenExpiresAt):c.accessTokenExpiresAt})(),h={accessToken:d?.accessToken??await Bl(c.accessToken??"",e.context),accessTokenExpiresAt:f,scopes:c.scope?.split(",")??[],idToken:d?.idToken??c.idToken??void 0};return e.json(h)}catch(d){throw new D("BAD_REQUEST",{message:"Failed to get a valid access token",cause:d})}}),OL=me("/refresh-token",{method:"POST",body:le({providerId:M().meta({description:"The provider ID for the OAuth provider"}),accountId:M().meta({description:"The account ID associated with the refresh token"}).optional(),userId:M().meta({description:"The user ID associated with the account"}).optional()}),metadata:{openapi:{description:"Refresh the access token using a refresh token",responses:{200:{description:"Access token refreshed successfully",content:{"application/json":{schema:{type:"object",properties:{tokenType:{type:"string"},idToken:{type:"string"},accessToken:{type:"string"},refreshToken:{type:"string"},accessTokenExpiresAt:{type:"string",format:"date-time"},refreshTokenExpiresAt:{type:"string",format:"date-time"}}}}}},400:{description:"Invalid refresh token or provider configuration"}}}}},async e=>{const{providerId:t,accountId:r,userId:i}=e.body,n=e.request,o=await xr(e);if(n&&!o)throw e.error("UNAUTHORIZED");const a=o?.user?.id||i;if(!a)throw new D("BAD_REQUEST",{message:"Either userId or session is required"});const s=e.context.socialProviders.find(l=>l.id===t);if(!s)throw new D("BAD_REQUEST",{message:`Provider ${t} not found.`});if(!s.refreshAccessToken)throw new D("BAD_REQUEST",{message:`Provider ${t} does not support token refreshing.`});let c;const u=await Pp(e);if(u&&(!t||t===u?.providerId)?c=u:c=(await e.context.internalAdapter.findAccounts(a)).find(l=>r?l.id===r&&l.providerId===t:l.providerId===t),!c)throw new D("BAD_REQUEST",{message:"Account not found"});let d;if(u&&t===u.providerId?d=u.refreshToken??void 0:d=c.refreshToken??void 0,!d)throw new D("BAD_REQUEST",{message:"Refresh token not found"});try{const l=await Bl(d,e.context),f=await s.refreshAccessToken(l);if(c.id){const h={...c||{},accessToken:await bt(f.accessToken,e.context),refreshToken:await bt(f.refreshToken,e.context),accessTokenExpiresAt:f.accessTokenExpiresAt,refreshTokenExpiresAt:f.refreshTokenExpiresAt,scope:f.scopes?.join(",")||c.scope,idToken:f.idToken||c.idToken};await e.context.internalAdapter.updateAccount(c.id,h)}return u&&t===u.providerId&&e.context.options.account?.storeAccountCookie&&await wc(e,{...u,accessToken:await bt(f.accessToken,e.context),refreshToken:await bt(f.refreshToken,e.context),accessTokenExpiresAt:f.accessTokenExpiresAt,refreshTokenExpiresAt:f.refreshTokenExpiresAt,scope:f.scopes?.join(",")||u.scope,idToken:f.idToken||u.idToken}),e.json({accessToken:f.accessToken,refreshToken:f.refreshToken,accessTokenExpiresAt:f.accessTokenExpiresAt,refreshTokenExpiresAt:f.refreshTokenExpiresAt,scope:f.scopes?.join(",")||c.scope,idToken:f.idToken||c.idToken,providerId:c.providerId,accountId:c.accountId})}catch(l){throw new D("BAD_REQUEST",{message:"Failed to refresh access token",cause:l})}}),DL=on(le({accountId:M().meta({description:"The provider given account id for which to get the account info"}).optional()})),RL=me("/account-info",{method:"GET",use:[Is],metadata:{openapi:{description:"Get the account info provided by the provider",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{user:{type:"object",properties:{id:{type:"string"},name:{type:"string"},email:{type:"string"},image:{type:"string"},emailVerified:{type:"boolean"}},required:["id","emailVerified"]},data:{type:"object",properties:{},additionalProperties:!0}},required:["user","data"],additionalProperties:!1}}}}}}},query:DL},async e=>{const t=e.query?.accountId;let r;if(t){const a=await e.context.internalAdapter.findAccount(t);a&&(r=a)}else if(e.context.options.account?.storeAccountCookie){const a=await Pp(e);a&&(r=a)}if(!r||r.userId!==e.context.session.user.id)throw new D("BAD_REQUEST",{message:"Account not found"});const i=e.context.socialProviders.find(a=>a.id===r.providerId);if(!i)throw new D("INTERNAL_SERVER_ERROR",{message:`Provider account provider is ${r.providerId} but it is not configured`});const n=await yN({...e,method:"POST",body:{accountId:r.id,providerId:r.providerId},returnHeaders:!1,returnStatus:!1});if(!n.accessToken)throw new D("BAD_REQUEST",{message:"Access token not found"});const o=await i.getUserInfo({...n,accessToken:n.accessToken});return e.json(o)});async function Nr(e,t,r,i=3600,n){return await Qy({email:t.toLowerCase(),updateTo:r,...n},e,i)}async function Gg(e,t){if(!e.context.options.emailVerification?.sendVerificationEmail)throw e.context.logger.error("Verification email isn't enabled."),new D("BAD_REQUEST",{message:"Verification email isn't enabled"});const r=await Nr(e.context.secret,t.email,void 0,e.context.options.emailVerification?.expiresIn),i=e.body.callbackURL?encodeURIComponent(e.body.callbackURL):encodeURIComponent("/"),n=`${e.context.baseURL}/verify-email?token=${r}&callbackURL=${i}`;await e.context.runInBackgroundOrAwait(e.context.options.emailVerification.sendVerificationEmail({user:t,url:n,token:r},e.request))}const UL=me("/send-verification-email",{method:"POST",operationId:"sendVerificationEmail",body:le({email:Ur().meta({description:"The email to send the verification email to"}),callbackURL:M().meta({description:"The URL to use for email verification callback"}).optional()}),metadata:{openapi:{operationId:"sendVerificationEmail",description:"Send a verification email to the user",requestBody:{content:{"application/json":{schema:{type:"object",properties:{email:{type:"string",description:"The email to send the verification email to",example:"user@example.com"},callbackURL:{type:"string",description:"The URL to use for email verification callback",example:"https://example.com/callback",nullable:!0}},required:["email"]}}}},responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean",description:"Indicates if the email was sent successfully",example:!0}}}}}},400:{description:"Bad Request",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",description:"Error message",example:"Verification email isn't enabled"}}}}}}}}}},async e=>{if(!e.context.options.emailVerification?.sendVerificationEmail)throw e.context.logger.error("Verification email isn't enabled."),new D("BAD_REQUEST",{message:"Verification email isn't enabled"});const{email:t}=e.body,r=await xr(e);if(!r){const i=await e.context.internalAdapter.findUserByEmail(t);return i?(await Gg(e,i.user),e.json({status:!0})):(await Nr(e.context.secret,t,void 0,e.context.options.emailVerification?.expiresIn),e.json({status:!0}))}if(r?.user.email!==t)throw new D("BAD_REQUEST",{message:G.EMAIL_MISMATCH});if(r?.user.emailVerified)throw new D("BAD_REQUEST",{message:G.EMAIL_ALREADY_VERIFIED});return await Gg(e,r.user),e.json({status:!0})}),CL=me("/verify-email",{method:"GET",operationId:"verifyEmail",query:le({token:M().meta({description:"The token to verify the email"}),callbackURL:M().meta({description:"The URL to redirect to after email verification"}).optional()}),use:[jp(e=>e.query.callbackURL)],metadata:{openapi:{description:"Verify the email of the user",parameters:[{name:"token",in:"query",description:"The token to verify the email",required:!0,schema:{type:"string"}},{name:"callbackURL",in:"query",description:"The URL to redirect to after email verification",required:!1,schema:{type:"string"}}],responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{user:{type:"object",$ref:"#/components/schemas/User"},status:{type:"boolean",description:"Indicates if the email was verified successfully"}},required:["user","status"]}}}}}}}},async e=>{function t(s){throw e.query.callbackURL?e.query.callbackURL.includes("?")?e.redirect(`${e.query.callbackURL}&error=${s}`):e.redirect(`${e.query.callbackURL}?error=${s}`):new D("UNAUTHORIZED",{message:s})}const{token:r}=e.query;let i;try{i=await ho(r,new TextEncoder().encode(e.context.secret),{algorithms:["HS256"]})}catch(s){return s instanceof ll?t("token_expired"):t("invalid_token")}const n=le({email:Ur(),updateTo:M().optional(),requestType:M().optional()}).parse(i.payload),o=await e.context.internalAdapter.findUserByEmail(n.email);if(!o)return t("user_not_found");if(n.updateTo){const s=await xr(e);if(s&&s.user.email!==n.email)return t("unauthorized");switch(n.requestType){case"change-email-confirmation":{const c=await Nr(e.context.secret,n.email,n.updateTo,e.context.options.emailVerification?.expiresIn,{requestType:"change-email-verification"}),u=e.query.callbackURL?encodeURIComponent(e.query.callbackURL):encodeURIComponent("/"),d=`${e.context.baseURL}/verify-email?token=${c}&callbackURL=${u}`;if(e.context.options.emailVerification?.sendVerificationEmail&&await e.context.runInBackgroundOrAwait(e.context.options.emailVerification.sendVerificationEmail({user:{...o.user,email:n.updateTo},url:d,token:c},e.request)),e.query.callbackURL)throw e.redirect(e.query.callbackURL);return e.json({status:!0})}case"change-email-verification":{let c=s;if(!c){const d=await e.context.internalAdapter.createSession(o.user.id);if(!d)throw new D("INTERNAL_SERVER_ERROR",{message:G.FAILED_TO_CREATE_SESSION});c={session:d,user:o.user}}e.context.options.emailVerification?.onEmailVerification&&await e.context.options.emailVerification.onEmailVerification(o.user,e.request);const u=await e.context.internalAdapter.updateUserByEmail(n.email,{email:n.updateTo,emailVerified:!0});if(e.context.options.emailVerification?.afterEmailVerification&&await e.context.options.emailVerification.afterEmailVerification(u,e.request),await tr(e,{session:c.session,user:{...c.user,email:n.updateTo,emailVerified:!0}}),e.query.callbackURL)throw e.redirect(e.query.callbackURL);return e.json({status:!0,user:ht(e.context.options,u)})}default:{let c=s;if(!c){const f=await e.context.internalAdapter.createSession(o.user.id);if(!f)throw new D("INTERNAL_SERVER_ERROR",{message:G.FAILED_TO_CREATE_SESSION});c={session:f,user:o.user}}const u=await e.context.internalAdapter.updateUserByEmail(n.email,{email:n.updateTo,emailVerified:!1}),d=await Nr(e.context.secret,n.updateTo),l=e.query.callbackURL?encodeURIComponent(e.query.callbackURL):encodeURIComponent("/");if(e.context.options.emailVerification?.sendVerificationEmail&&await e.context.runInBackgroundOrAwait(e.context.options.emailVerification.sendVerificationEmail({user:u,url:`${e.context.baseURL}/verify-email?token=${d}&callbackURL=${l}`,token:d},e.request)),await tr(e,{session:c.session,user:{...c.user,email:n.updateTo,emailVerified:!1}}),e.query.callbackURL)throw e.redirect(e.query.callbackURL);return e.json({status:!0,user:ht(e.context.options,u)})}}}if(o.user.emailVerified){if(e.query.callbackURL)throw e.redirect(e.query.callbackURL);return e.json({status:!0,user:null})}e.context.options.emailVerification?.beforeEmailVerification&&await e.context.options.emailVerification.beforeEmailVerification(o.user,e.request),e.context.options.emailVerification?.onEmailVerification&&await e.context.options.emailVerification.onEmailVerification(o.user,e.request);const a=await e.context.internalAdapter.updateUserByEmail(n.email,{emailVerified:!0});if(e.context.options.emailVerification?.afterEmailVerification&&await e.context.options.emailVerification.afterEmailVerification(a,e.request),e.context.options.emailVerification?.autoSignInAfterVerification){const s=await xr(e);if(!s||s.user.email!==n.email){const c=await e.context.internalAdapter.createSession(o.user.id);if(!c)throw new D("INTERNAL_SERVER_ERROR",{message:"Failed to create session"});await tr(e,{session:c,user:{...o.user,emailVerified:!0}})}else await tr(e,{session:s.session,user:{...s.user,emailVerified:!0}})}if(e.query.callbackURL)throw e.redirect(e.query.callbackURL);return e.json({status:!0,user:null})});async function wN(e,t){const{userInfo:r,account:i,callbackURL:n,disableSignUp:o,overrideUserInfo:a}=t,s=await e.context.internalAdapter.findOAuthUser(r.email.toLowerCase(),i.accountId,i.providerId).catch(l=>{ie.error(`Better auth was unable to query your database.
Error: `,l);const f=e.context.options.onAPIError?.errorURL||`${e.context.baseURL}/error`;throw e.redirect(`${f}?error=internal_server_error`)});let c=s?.user;const u=!c;if(s){const l=s.linkedAccount??s.accounts.find(f=>f.providerId===i.providerId&&f.accountId===i.accountId);if(l){const f=e.context.options.account?.updateAccountOnSignIn!==!1?Object.fromEntries(Object.entries({idToken:i.idToken,accessToken:await bt(i.accessToken,e.context),refreshToken:await bt(i.refreshToken,e.context),accessTokenExpiresAt:i.accessTokenExpiresAt,refreshTokenExpiresAt:i.refreshTokenExpiresAt,scope:i.scope}).filter(([h,g])=>g!==void 0)):{};e.context.options.account?.storeAccountCookie&&await wc(e,{...l,...f}),Object.keys(f).length>0&&await e.context.internalAdapter.updateAccount(l.id,f),r.emailVerified&&!s.user.emailVerified&&r.email.toLowerCase()===s.user.email&&await e.context.internalAdapter.updateUser(s.user.id,{emailVerified:!0})}else{const f=e.context.options.account?.accountLinking?.trustedProviders;if(!(t.isTrustedProvider||f?.includes(i.providerId))&&!r.emailVerified||e.context.options.account?.accountLinking?.enabled===!1)return Tp()&&ie.warn(`User already exist but account isn't linked to ${i.providerId}. To read more about how account linking works in Better Auth see https://www.better-auth.com/docs/concepts/users-accounts#account-linking.`),{error:"account not linked",data:null};try{await e.context.internalAdapter.linkAccount({providerId:i.providerId,accountId:r.id.toString(),userId:s.user.id,accessToken:await bt(i.accessToken,e.context),refreshToken:await bt(i.refreshToken,e.context),idToken:i.idToken,accessTokenExpiresAt:i.accessTokenExpiresAt,refreshTokenExpiresAt:i.refreshTokenExpiresAt,scope:i.scope})}catch(h){return ie.error("Unable to link account",h),{error:"unable to link account",data:null}}r.emailVerified&&!s.user.emailVerified&&r.email.toLowerCase()===s.user.email&&await e.context.internalAdapter.updateUser(s.user.id,{emailVerified:!0})}if(a){const{id:f,...h}=r;c=await e.context.internalAdapter.updateUser(s.user.id,{...h,email:r.email.toLowerCase(),emailVerified:r.email.toLowerCase()===s.user.email&&s.user.emailVerified||r.emailVerified})}}else{if(o)return{error:"signup disabled",data:null,isRegister:!1};try{const{id:l,...f}=r,h={accessToken:await bt(i.accessToken,e.context),refreshToken:await bt(i.refreshToken,e.context),idToken:i.idToken,accessTokenExpiresAt:i.accessTokenExpiresAt,refreshTokenExpiresAt:i.refreshTokenExpiresAt,scope:i.scope,providerId:i.providerId,accountId:r.id.toString()},{user:g,account:m}=await e.context.internalAdapter.createOAuthUser({...f,email:r.email.toLowerCase()},h);if(c=g,e.context.options.account?.storeAccountCookie&&await wc(e,m),!r.emailVerified&&c&&e.context.options.emailVerification?.sendOnSignUp&&e.context.options.emailVerification?.sendVerificationEmail){const v=await Nr(e.context.secret,c.email,void 0,e.context.options.emailVerification?.expiresIn),b=`${e.context.baseURL}/verify-email?token=${v}&callbackURL=${n}`;await e.context.runInBackgroundOrAwait(e.context.options.emailVerification.sendVerificationEmail({user:c,url:b,token:v},e.request))}}catch(l){return ie.error(l),l instanceof D?{error:l.message,data:null,isRegister:!1}:{error:"unable to create user",data:null,isRegister:!1}}}if(!c)return{error:"unable to create user",data:null,isRegister:!1};const d=await e.context.internalAdapter.createSession(c.id);return d?{data:{session:d,user:c},error:null,isRegister:u}:{error:"unable to create session",data:null,isRegister:!1}}const Jn=le({code:M().optional(),error:M().optional(),device_id:M().optional(),error_description:M().optional(),state:M().optional(),user:M().optional()}),PL=me("/callback/:id",{method:["GET","POST"],operationId:"handleOAuthCallback",body:Jn.optional(),query:Jn.optional(),metadata:{...Lp,allowedMediaTypes:["application/x-www-form-urlencoded","application/json"]}},async e=>{let t;const r=e.context.options.onAPIError?.errorURL||`${e.context.baseURL}/error`;if(e.method==="POST"){const _=e.body?Jn.parse(e.body):{},S=e.query?Jn.parse(e.query):{},E=Jn.parse({..._,...S}),k=new URLSearchParams;for(const[P,T]of Object.entries(E))T!=null&&k.set(P,String(T));const U=`${e.context.baseURL}/callback/${e.params.id}?${k.toString()}`;throw e.redirect(U)}try{if(e.method==="GET")t=Jn.parse(e.query);else if(e.method==="POST")t=Jn.parse(e.body);else throw new Error("Unsupported method")}catch(_){throw e.context.logger.error("INVALID_CALLBACK_REQUEST",_),e.redirect(`${r}?error=invalid_callback_request`)}const{code:i,error:n,state:o,error_description:a,device_id:s}=t;if(!o){e.context.logger.error("State not found",n);const _=`${r}${r.includes("?")?"&":"?"}state=state_not_found`;throw e.redirect(_)}const{codeVerifier:c,callbackURL:u,link:d,errorURL:l,newUserURL:f,requestSignUp:h}=await wR(e);function g(_,S){const E=l??r,k=new URLSearchParams({error:_});S&&k.set("error_description",S);const U=`${E}${E.includes("?")?"&":"?"}${k.toString()}`;throw e.redirect(U)}if(n&&g(n,a),!i)throw e.context.logger.error("Code not found"),g("no_code");const m=e.context.socialProviders.find(_=>_.id===e.params.id);if(!m)throw e.context.logger.error("Oauth provider with id",e.params.id,"not found"),g("oauth_provider_not_found");let v;try{v=await m.validateAuthorizationCode({code:i,codeVerifier:c,deviceId:s,redirectURI:`${e.context.baseURL}/callback/${m.id}`})}catch(_){throw e.context.logger.error("",_),g("invalid_code")}const b=await m.getUserInfo({...v,user:e.body?.user?it(e.body.user):void 0}).then(_=>_?.user);if(!b)return e.context.logger.error("Unable to get user info"),g("unable_to_get_user_info");if(!u)throw e.context.logger.error("No callback URL found"),g("no_callback_url");if(d){if(!e.context.options.account?.accountLinking?.trustedProviders?.includes(m.id)&&!b.emailVerified||e.context.options.account?.accountLinking?.enabled===!1)return e.context.logger.error("Unable to link account - untrusted provider"),g("unable_to_link_account");if(b.email!==d.email&&e.context.options.account?.accountLinking?.allowDifferentEmails!==!0)return g("email_doesn't_match");const _=await e.context.internalAdapter.findAccount(String(b.id));if(_){if(_.userId.toString()!==d.userId.toString())return g("account_already_linked_to_different_user");const E=Object.fromEntries(Object.entries({accessToken:await bt(v.accessToken,e.context),refreshToken:await bt(v.refreshToken,e.context),idToken:v.idToken,accessTokenExpiresAt:v.accessTokenExpiresAt,refreshTokenExpiresAt:v.refreshTokenExpiresAt,scope:v.scopes?.join(",")}).filter(([k,U])=>U!==void 0));await e.context.internalAdapter.updateAccount(_.id,E)}else if(!await e.context.internalAdapter.createAccount({userId:d.userId,providerId:m.id,accountId:String(b.id),...v,accessToken:await bt(v.accessToken,e.context),refreshToken:await bt(v.refreshToken,e.context),scope:v.scopes?.join(",")}))return g("unable_to_link_account");let S;try{S=u.toString()}catch{S=u}throw e.redirect(S)}if(!b.email)return e.context.logger.error("Provider did not return email. This could be due to misconfiguration in the provider settings."),g("email_not_found");const I={providerId:m.id,accountId:String(b.id),...v,scope:v.scopes?.join(",")},x=await wN(e,{userInfo:{...b,id:String(b.id),email:b.email,name:b.name||b.email},account:I,callbackURL:u,disableSignUp:m.disableImplicitSignUp&&!h||m.options?.disableSignUp,overrideUserInfo:m.options?.overrideUserInfoOnSignIn});if(x.error)return e.context.logger.error(x.error.split(" ").join("_")),g(x.error.split(" ").join("_"));const{session:N,user:y}=x.data;await tr(e,{session:N,user:y});let w;try{w=(x.isRegister&&f||u).toString()}catch{w=x.isRegister&&f||u}throw e.redirect(w)});function vN(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/&(?!amp;|lt;|gt;|quot;|#39;|#x[0-9a-fA-F]+;|#[0-9]+;)/g,"&amp;")}const LL=(e,t="Unknown",r=null)=>{const i=e.onAPIError?.customizeDefaultErrorPage;return`<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Error</title>
    <style>
      * {
        box-sizing: border-box;
      }
      body {
        font-family: ${i?.font?.defaultFamily||"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif"};
        background: ${i?.colors?.background||"var(--background)"};
        color: var(--foreground);
        margin: 0;
      }
      :root,
      :host {
        --spacing: 0.25rem;
        --container-md: 28rem;
        --text-sm: ${i?.size?.textSm||"0.875rem"};
        --text-sm--line-height: calc(1.25 / 0.875);
        --text-2xl: ${i?.size?.text2xl||"1.5rem"};
        --text-2xl--line-height: calc(2 / 1.5);
        --text-4xl: ${i?.size?.text4xl||"2.25rem"};
        --text-4xl--line-height: calc(2.5 / 2.25);
        --text-6xl: ${i?.size?.text6xl||"3rem"};
        --text-6xl--line-height: 1;
        --font-weight-medium: 500;
        --font-weight-semibold: 600;
        --font-weight-bold: 700;
        --default-transition-duration: 150ms;
        --default-transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
        --radius: ${i?.size?.radiusSm||"0.625rem"};
        --default-mono-font-family: ${i?.font?.monoFamily||"var(--font-geist-mono)"};
        --primary: ${i?.colors?.primary||"black"};
        --primary-foreground: ${i?.colors?.primaryForeground||"white"};
        --background: ${i?.colors?.background||"white"};
        --foreground: ${i?.colors?.foreground||"oklch(0.271 0 0)"};
        --border: ${i?.colors?.border||"oklch(0.89 0 0)"};
        --destructive: ${i?.colors?.destructive||"oklch(0.55 0.15 25.723)"};
        --muted-foreground: ${i?.colors?.mutedForeground||"oklch(0.545 0 0)"};
        --corner-border: ${i?.colors?.cornerBorder||"#404040"};
      }

      button, .btn {
        cursor: pointer;
        background: none;
        border: none;
        color: inherit;
        font: inherit;
        transition: all var(--default-transition-duration)
          var(--default-transition-timing-function);
      }
      button:hover, .btn:hover {
        opacity: 0.8;
      }

      @media (prefers-color-scheme: dark) {
        :root,
        :host {
          --primary: ${i?.colors?.primary||"white"};
          --primary-foreground: ${i?.colors?.primaryForeground||"black"};
          --background: ${i?.colors?.background||"oklch(0.15 0 0)"};
          --foreground: ${i?.colors?.foreground||"oklch(0.98 0 0)"};
          --border: ${i?.colors?.border||"oklch(0.27 0 0)"};
          --destructive: ${i?.colors?.destructive||"oklch(0.65 0.15 25.723)"};
          --muted-foreground: ${i?.colors?.mutedForeground||"oklch(0.65 0 0)"};
          --corner-border: ${i?.colors?.cornerBorder||"#a0a0a0"};
        }
      }
      @media (max-width: 640px) {
        :root, :host {
          --text-6xl: 2.5rem;
          --text-2xl: 1.25rem;
          --text-sm: 0.8125rem;
        }
      }
      @media (max-width: 480px) {
        :root, :host {
          --text-6xl: 2rem;
          --text-2xl: 1.125rem;
        }
      }
    </style>
  </head>
  <body style="width: 100vw; min-height: 100vh; overflow-x: hidden; overflow-y: auto;">
    <div
        style="
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 1.5rem;
            position: relative;
            width: 100%;
            min-height: 100vh;
            padding: 1rem;
        "
        >
${i?.disableBackgroundGrid?"":`
      <div
        style="
          position: absolute;
          inset: 0;
          background-image: linear-gradient(to right, ${i?.colors?.gridColor||"var(--border)"} 1px, transparent 1px),
            linear-gradient(to bottom, ${i?.colors?.gridColor||"var(--border)"} 1px, transparent 1px);
          background-size: 40px 40px;
          opacity: 0.6;
          pointer-events: none;
          width: 100vw;
          height: 100vh;
        "
      ></div>
      <div
        style="
          position: absolute;
          inset: 0;
          display: flex;
          align-items: center;
          justify-content: center;
          background: ${i?.colors?.background||"var(--background)"};
          mask-image: radial-gradient(ellipse at center, transparent 20%, black);
          -webkit-mask-image: radial-gradient(ellipse at center, transparent 20%, black);
          pointer-events: none;
        "
      ></div>
`}

<div
  style="
    position: relative;
    z-index: 10;
    border: 2px solid var(--border);
    background: ${i?.colors?.cardBackground||"var(--background)"};
    padding: 1.5rem;
    max-width: 42rem;
    width: 100%;
  "
>
    ${i?.disableCornerDecorations?"":`
        <!-- Corner decorations -->
        <div
          style="
            position: absolute;
            top: -2px;
            left: -2px;
            width: 2rem;
            height: 2rem;
            border-top: 4px solid var(--corner-border);
            border-left: 4px solid var(--corner-border);
          "
        ></div>
        <div
          style="
            position: absolute;
            top: -2px;
            right: -2px;
            width: 2rem;
            height: 2rem;
            border-top: 4px solid var(--corner-border);
            border-right: 4px solid var(--corner-border);
          "
        ></div>
  
        <div
          style="
            position: absolute;
            bottom: -2px;
            left: -2px;
            width: 2rem;
            height: 2rem;
            border-bottom: 4px solid var(--corner-border);
            border-left: 4px solid var(--corner-border);
          "
        ></div>
        <div
          style="
            position: absolute;
            bottom: -2px;
            right: -2px;
            width: 2rem;
            height: 2rem;
            border-bottom: 4px solid var(--corner-border);
            border-right: 4px solid var(--corner-border);
          "
        ></div>`}

        <div style="text-align: center; margin-bottom: 1.5rem;">
          <div style="margin-bottom: 1.5rem;">
            <div
              style="
                display: inline-block;
                border: 2px solid ${i?.disableTitleBorder?"transparent":i?.colors?.titleBorder||"var(--destructive)"};
                padding: 0.375rem 1rem;
              "
            >
              <h1
                style="
                  font-size: var(--text-6xl);
                  font-weight: var(--font-weight-semibold);
                  color: ${i?.colors?.titleColor||"var(--foreground)"};
                  letter-spacing: -0.02em;
                  margin: 0;
                "
              >
                ERROR
              </h1>
            </div>
            <div
              style="
                height: 2px;
                background-color: var(--border);
                width: calc(100% + 3rem);
                margin-left: -1.5rem;
                margin-top: 1.5rem;
              "
            ></div>
          </div>

          <h2
            style="
              font-size: var(--text-2xl);
              font-weight: var(--font-weight-semibold);
              color: var(--foreground);
              margin: 0 0 1rem;
            "
          >
            Something went wrong
          </h2>

          <div
            style="
                display: inline-flex;
                align-items: center;
                gap: 0.5rem;
                border: 2px solid var(--border);
                background-color: var(--muted);
                padding: 0.375rem 0.75rem;
                margin: 0 0 1rem;
                flex-wrap: wrap;
                justify-content: center;
            "
            >
            <span
                style="
                font-size: 0.75rem;
                color: var(--muted-foreground);
                font-weight: var(--font-weight-semibold);
                "
            >
                CODE:
            </span>
            <span
                style="
                font-size: var(--text-sm);
                font-family: var(--default-mono-font-family, monospace);
                color: var(--foreground);
                word-break: break-all;
                "
            >
                ${vN(t)}
            </span>
            </div>

          <p
            style="
              color: var(--muted-foreground);
              max-width: 28rem;
              margin: 0 auto;
              font-size: var(--text-sm);
              line-height: 1.5;
              text-wrap: pretty;
            "
          >
            ${r||`We encountered an unexpected error. Please try again or return to the home page. If you're a developer, you can find more information about the error <a href='https://better-auth.com/docs/errors/${encodeURIComponent(t)}' target='_blank' rel="noopener noreferrer" style='color: var(--foreground); text-decoration: underline;'>here</a>.`}
          </p>
        </div>

        <div
          style="
            display: flex;
            gap: 0.75rem;
            margin-top: 1.5rem;
            justify-content: center;
            flex-wrap: wrap;
          "
        >
          <a
            href="/"
            style="
              text-decoration: none;
            "
          >
            <div
              style="
                border: 2px solid var(--border);
                background: var(--primary);
                color: var(--primary-foreground);
                padding: 0.5rem 1rem;
                border-radius: 0;
                white-space: nowrap;
              "
              class="btn"
            >
              Go Home
            </div>
          </a>
          <a
            href="https://better-auth.com/docs/errors/${encodeURIComponent(t)}?askai=${encodeURIComponent(`What does the error code ${t} mean?`)}"
            target="_blank"
            rel="noopener noreferrer"
            style="
              text-decoration: none;
            "
          >
            <div
              style="
                border: 2px solid var(--border);
                background: transparent;
                color: var(--foreground);
                padding: 0.5rem 1rem;
                border-radius: 0;
                white-space: nowrap;
              "
              class="btn"
            >
              Ask AI
            </div>
          </a>
        </div>
      </div>
    </div>
  </body>
</html>`},zL=me("/error",{method:"GET",metadata:{...Lp,openapi:{description:"Displays an error page",responses:{200:{description:"Success",content:{"text/html":{schema:{type:"string",description:"The HTML content of the error page"}}}}}}}},async e=>{const t=new URL(e.request?.url||""),r=t.searchParams.get("error")||"UNKNOWN",i=t.searchParams.get("error_description")||null,n=/^[\'A-Za-z0-9_-]+$/.test(r)?r:"UNKNOWN",o=i?vN(i):null,a=new URLSearchParams;a.set("error",n),i&&a.set("error_description",i);const s=e.context.options,c=s.onAPIError?.errorURL;return c?new Response(null,{status:302,headers:{Location:`${c}${c.includes("?")?"&":"?"}${a.toString()}`}}):ed&&!s.onAPIError?.customizeDefaultErrorPage?new Response(null,{status:302,headers:{Location:`/?${a.toString()}`}}):new Response(LL(e.context.options,n,o),{headers:{"Content-Type":"text/html"}})}),jL=me("/ok",{method:"GET",metadata:{...Lp,openapi:{description:"Check if the API is working",responses:{200:{description:"API is working",content:{"application/json":{schema:{type:"object",properties:{ok:{type:"boolean",description:"Indicates if the API is working"}},required:["ok"]}}}}}}}},async e=>e.json({ok:!0}));async function ML(e,t){const r=(await e.context.internalAdapter.findAccounts(t.userId))?.find(n=>n.providerId==="credential"),i=r?.password;return!r||!i?!1:await e.context.password.verify({hash:i,password:t.password})}async function qL(e,t){const r=(await t.context.internalAdapter.findAccounts(e))?.find(n=>n.providerId==="credential"),i=r?.password;if(!r||!i||!t.body.password)throw new D("BAD_REQUEST",{message:"No password credential found"});if(!await t.context.password.verify({hash:i,password:t.body.password}))throw new D("BAD_REQUEST",{message:"Invalid password"});return!0}function Qg(e,t,r){const i=t?new URL(t,e.baseURL):new URL(`${e.baseURL}/error`);return r&&Object.entries(r).forEach(([n,o])=>i.searchParams.set(n,o)),i.href}function WL(e,t,r){const i=new URL(t,e.baseURL);return r&&Object.entries(r).forEach(([n,o])=>i.searchParams.set(n,o)),i.href}const FL=me("/request-password-reset",{method:"POST",body:le({email:Ur().meta({description:"The email address of the user to send a password reset email to"}),redirectTo:M().meta({description:"The URL to redirect the user to reset their password. If the token isn't valid or expired, it'll be redirected with a query parameter `?error=INVALID_TOKEN`. If the token is valid, it'll be redirected with a query parameter `?token=VALID_TOKEN"}).optional()}),metadata:{openapi:{operationId:"requestPasswordReset",description:"Send a password reset email to the user",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean"},message:{type:"string"}}}}}}}}}},async e=>{if(!e.context.options.emailAndPassword?.sendResetPassword)throw e.context.logger.error("Reset password isn't enabled.Please pass an emailAndPassword.sendResetPassword function in your auth config!"),new D("BAD_REQUEST",{message:"Reset password isn't enabled"});const{email:t,redirectTo:r}=e.body,i=await e.context.internalAdapter.findUserByEmail(t,{includeAccounts:!0});if(!i)return pa(24),await e.context.internalAdapter.findVerificationValue("dummy-verification-token"),e.context.logger.error("Reset Password: User not found",{email:t}),e.json({status:!0,message:"If this email exists in our system, check your email for the reset link"});const n=no(e.context.options.emailAndPassword.resetPasswordTokenExpiresIn||3600*1,"sec"),o=pa(24);await e.context.internalAdapter.createVerificationValue({value:i.user.id,identifier:`reset-password:${o}`,expiresAt:n});const a=r?encodeURIComponent(r):"",s=`${e.context.baseURL}/reset-password/${o}?callbackURL=${a}`;return await e.context.runInBackgroundOrAwait(e.context.options.emailAndPassword.sendResetPassword({user:i.user,url:s,token:o},e.request)),e.json({status:!0,message:"If this email exists in our system, check your email for the reset link"})}),BL=me("/reset-password/:token",{method:"GET",operationId:"forgetPasswordCallback",query:le({callbackURL:M().meta({description:"The URL to redirect the user to reset their password"})}),use:[jp(e=>e.query.callbackURL)],metadata:{openapi:{operationId:"resetPasswordCallback",description:"Redirects the user to the callback URL with the token",parameters:[{name:"token",in:"path",required:!0,description:"The token to reset the password",schema:{type:"string"}},{name:"callbackURL",in:"query",required:!0,description:"The URL to redirect the user to reset their password",schema:{type:"string"}}],responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{token:{type:"string"}}}}}}}}}},async e=>{const{token:t}=e.params,{callbackURL:r}=e.query;if(!t||!r)throw e.redirect(Qg(e.context,r,{error:"INVALID_TOKEN"}));const i=await e.context.internalAdapter.findVerificationValue(`reset-password:${t}`);throw!i||i.expiresAt<new Date?e.redirect(Qg(e.context,r,{error:"INVALID_TOKEN"})):e.redirect(WL(e.context,r,{token:t}))}),VL=me("/reset-password",{method:"POST",operationId:"resetPassword",query:le({token:M().optional()}).optional(),body:le({newPassword:M().meta({description:"The new password to set"}),token:M().meta({description:"The token to reset the password"}).optional()}),metadata:{openapi:{operationId:"resetPassword",description:"Reset the password for a user",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean"}}}}}}}}}},async e=>{const t=e.body.token||e.query?.token;if(!t)throw new D("BAD_REQUEST",{message:G.INVALID_TOKEN});const{newPassword:r}=e.body,i=e.context.password?.config.minPasswordLength,n=e.context.password?.config.maxPasswordLength;if(r.length<i)throw new D("BAD_REQUEST",{message:G.PASSWORD_TOO_SHORT});if(r.length>n)throw new D("BAD_REQUEST",{message:G.PASSWORD_TOO_LONG});const o=`reset-password:${t}`,a=await e.context.internalAdapter.findVerificationValue(o);if(!a||a.expiresAt<new Date)throw new D("BAD_REQUEST",{message:G.INVALID_TOKEN});const s=a.value,c=await e.context.password.hash(r);if((await e.context.internalAdapter.findAccounts(s)).find(u=>u.providerId==="credential")?await e.context.internalAdapter.updatePassword(s,c):await e.context.internalAdapter.createAccount({userId:s,providerId:"credential",password:c,accountId:s}),await e.context.internalAdapter.deleteVerificationValue(a.id),e.context.options.emailAndPassword?.onPasswordReset){const u=await e.context.internalAdapter.findUserById(s);u&&await e.context.options.emailAndPassword.onPasswordReset({user:u},e.request)}return e.context.options.emailAndPassword?.revokeSessionsOnPasswordReset&&await e.context.internalAdapter.deleteSessions(s),e.json({status:!0})}),KL=me("/verify-password",{method:"POST",body:le({password:M().meta({description:"The password to verify"})}),metadata:{scope:"server",openapi:{operationId:"verifyPassword",description:"Verify the current user's password",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean"}}}}}}}}},use:[Wn]},async e=>{const{password:t}=e.body,r=e.context.session;if(!await ML(e,{password:t,userId:r.user.id}))throw new D("BAD_REQUEST",{message:G.INVALID_PASSWORD});return e.json({status:!0})}),JL=le({callbackURL:M().meta({description:"Callback URL to redirect to after the user has signed in"}).optional(),newUserCallbackURL:M().optional(),errorCallbackURL:M().meta({description:"Callback URL to redirect to if an error happens"}).optional(),provider:gN,disableRedirect:Bt().meta({description:"Disable automatic redirection to the provider. Useful for handling the redirection yourself"}).optional(),idToken:on(le({token:M().meta({description:"ID token from the provider"}),nonce:M().meta({description:"Nonce used to generate the token"}).optional(),accessToken:M().meta({description:"Access token from the provider"}).optional(),refreshToken:M().meta({description:"Refresh token from the provider"}).optional(),expiresAt:tn().meta({description:"Expiry date of the token"}).optional()})),scopes:Ar(M()).meta({description:"Array of scopes to request from the provider. This will override the default scopes passed."}).optional(),requestSignUp:Bt().meta({description:"Explicitly request sign-up. Useful when disableImplicitSignUp is true for this provider"}).optional(),loginHint:M().meta({description:"The login hint to use for the authorization code request"}).optional(),additionalData:qn(M(),rn()).optional().meta({description:"Additional data to be passed through the OAuth flow"})}),HL=()=>me("/sign-in/social",{method:"POST",operationId:"socialSignIn",body:JL,metadata:{$Infer:{body:{},returned:{}},openapi:{description:"Sign in with a social provider",operationId:"socialSignIn",responses:{200:{description:"Success - Returns either session details or redirect URL",content:{"application/json":{schema:{type:"object",description:"Session response when idToken is provided",properties:{token:{type:"string"},user:{type:"object",$ref:"#/components/schemas/User"},url:{type:"string"},redirect:{type:"boolean",enum:[!1]}},required:["redirect","token","user"]}}}}}}}},async e=>{const t=e.context.socialProviders.find(o=>o.id===e.body.provider);if(!t)throw e.context.logger.error("Provider not found. Make sure to add the provider in your auth config",{provider:e.body.provider}),new D("NOT_FOUND",{message:G.PROVIDER_NOT_FOUND});if(e.body.idToken){if(!t.verifyIdToken)throw e.context.logger.error("Provider does not support id token verification",{provider:e.body.provider}),new D("NOT_FOUND",{message:G.ID_TOKEN_NOT_SUPPORTED});const{token:o,nonce:a}=e.body.idToken;if(!await t.verifyIdToken(o,a))throw e.context.logger.error("Invalid id token",{provider:e.body.provider}),new D("UNAUTHORIZED",{message:G.INVALID_TOKEN});const s=await t.getUserInfo({idToken:o,accessToken:e.body.idToken.accessToken,refreshToken:e.body.idToken.refreshToken});if(!s||!s?.user)throw e.context.logger.error("Failed to get user info",{provider:e.body.provider}),new D("UNAUTHORIZED",{message:G.FAILED_TO_GET_USER_INFO});if(!s.user.email)throw e.context.logger.error("User email not found",{provider:e.body.provider}),new D("UNAUTHORIZED",{message:G.USER_EMAIL_NOT_FOUND});const c=await wN(e,{userInfo:{...s.user,email:s.user.email,id:String(s.user.id),name:s.user.name||"",image:s.user.image,emailVerified:s.user.emailVerified||!1},account:{providerId:t.id,accountId:String(s.user.id),accessToken:e.body.idToken.accessToken},callbackURL:e.body.callbackURL,disableSignUp:t.disableImplicitSignUp&&!e.body.requestSignUp||t.disableSignUp});if(c.error)throw new D("UNAUTHORIZED",{message:c.error});return await tr(e,c.data),e.json({redirect:!1,token:c.data.session.token,url:void 0,user:ht(e.context.options,c.data.user)})}const{codeVerifier:r,state:i}=await ek(e,void 0,e.body.additionalData),n=await t.createAuthorizationURL({state:i,codeVerifier:r,redirectURI:`${e.context.baseURL}/callback/${t.id}`,scopes:e.body.scopes,loginHint:e.body.loginHint});return e.body.disableRedirect||e.setHeader("Location",n.toString()),e.json({url:n.toString(),redirect:!e.body.disableRedirect})}),ZL=()=>me("/sign-in/email",{method:"POST",operationId:"signInEmail",use:[ak],body:le({email:M().meta({description:"Email of the user"}),password:M().meta({description:"Password of the user"}),callbackURL:M().meta({description:"Callback URL to use as a redirect for email verification"}).optional(),rememberMe:Bt().meta({description:"If this is false, the session will not be remembered. Default is `true`."}).default(!0).optional()}),metadata:{allowedMediaTypes:["application/x-www-form-urlencoded","application/json"],$Infer:{body:{},returned:{}},openapi:{operationId:"signInEmail",description:"Sign in with email and password",responses:{200:{description:"Success - Returns either session details or redirect URL",content:{"application/json":{schema:{type:"object",description:"Session response when idToken is provided",properties:{redirect:{type:"boolean",enum:[!1]},token:{type:"string",description:"Session token"},url:{type:"string",nullable:!0},user:{type:"object",$ref:"#/components/schemas/User"}},required:["redirect","token","user"]}}}}}}}},async e=>{if(!e.context.options?.emailAndPassword?.enabled)throw e.context.logger.error("Email and password is not enabled. Make sure to enable it in the options on you `auth.ts` file. Check `https://better-auth.com/docs/authentication/email-password` for more!"),new D("BAD_REQUEST",{message:"Email and password is not enabled"});const{email:t,password:r}=e.body;if(!Ur().safeParse(t).success)throw new D("BAD_REQUEST",{message:G.INVALID_EMAIL});const i=await e.context.internalAdapter.findUserByEmail(t,{includeAccounts:!0});if(!i)throw await e.context.password.hash(r),e.context.logger.error("User not found",{email:t}),new D("UNAUTHORIZED",{message:G.INVALID_EMAIL_OR_PASSWORD});const n=i.accounts.find(s=>s.providerId==="credential");if(!n)throw await e.context.password.hash(r),e.context.logger.error("Credential account not found",{email:t}),new D("UNAUTHORIZED",{message:G.INVALID_EMAIL_OR_PASSWORD});const o=n?.password;if(!o)throw await e.context.password.hash(r),e.context.logger.error("Password not found",{email:t}),new D("UNAUTHORIZED",{message:G.INVALID_EMAIL_OR_PASSWORD});if(!await e.context.password.verify({hash:o,password:r}))throw e.context.logger.error("Invalid password"),new D("UNAUTHORIZED",{message:G.INVALID_EMAIL_OR_PASSWORD});if(e.context.options?.emailAndPassword?.requireEmailVerification&&!i.user.emailVerified){if(!e.context.options?.emailVerification?.sendVerificationEmail)throw new D("FORBIDDEN",{message:G.EMAIL_NOT_VERIFIED});if(e.context.options?.emailVerification?.sendOnSignIn){const s=await Nr(e.context.secret,i.user.email,void 0,e.context.options.emailVerification?.expiresIn),c=e.body.callbackURL?encodeURIComponent(e.body.callbackURL):encodeURIComponent("/"),u=`${e.context.baseURL}/verify-email?token=${s}&callbackURL=${c}`;await e.context.runInBackgroundOrAwait(e.context.options.emailVerification.sendVerificationEmail({user:i.user,url:u,token:s},e.request))}throw new D("FORBIDDEN",{message:G.EMAIL_NOT_VERIFIED})}const a=await e.context.internalAdapter.createSession(i.user.id,e.body.rememberMe===!1);if(!a)throw e.context.logger.error("Failed to create session"),new D("UNAUTHORIZED",{message:G.FAILED_TO_CREATE_SESSION});return await tr(e,{session:a,user:i.user},e.body.rememberMe===!1),e.body.callbackURL&&e.setHeader("Location",e.body.callbackURL),e.json({redirect:!!e.body.callbackURL,token:a.token,url:e.body.callbackURL,user:ht(e.context.options,i.user)})}),GL=me("/sign-out",{method:"POST",operationId:"signOut",requireHeaders:!0,metadata:{openapi:{operationId:"signOut",description:"Sign out the current user",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean"}}}}}}}}}},async e=>{const t=await e.getSignedCookie(e.context.authCookies.sessionToken.name,e.context.secret);if(t)try{await e.context.internalAdapter.deleteSession(t)}catch(r){e.context.logger.error("Failed to delete session from database",r)}return ba(e),e.json({success:!0})}),QL=le({name:M(),email:Ur(),password:M().nonempty(),image:M().optional(),callbackURL:M().optional(),rememberMe:Bt().optional()}).and(qn(M(),rn())),YL=()=>me("/sign-up/email",{method:"POST",operationId:"signUpWithEmailAndPassword",use:[ak],body:QL,metadata:{allowedMediaTypes:["application/x-www-form-urlencoded","application/json"],$Infer:{body:{},returned:{}},openapi:{operationId:"signUpWithEmailAndPassword",description:"Sign up a user using email and password",requestBody:{content:{"application/json":{schema:{type:"object",properties:{name:{type:"string",description:"The name of the user"},email:{type:"string",description:"The email of the user"},password:{type:"string",description:"The password of the user"},image:{type:"string",description:"The profile image URL of the user"},callbackURL:{type:"string",description:"The URL to use for email verification callback"},rememberMe:{type:"boolean",description:"If this is false, the session will not be remembered. Default is `true`."}},required:["name","email","password"]}}}},responses:{200:{description:"Successfully created user",content:{"application/json":{schema:{type:"object",properties:{token:{type:"string",nullable:!0,description:"Authentication token for the session"},user:{type:"object",properties:{id:{type:"string",description:"The unique identifier of the user"},email:{type:"string",format:"email",description:"The email address of the user"},name:{type:"string",description:"The name of the user"},image:{type:"string",format:"uri",nullable:!0,description:"The profile image URL of the user"},emailVerified:{type:"boolean",description:"Whether the email has been verified"},createdAt:{type:"string",format:"date-time",description:"When the user was created"},updatedAt:{type:"string",format:"date-time",description:"When the user was last updated"}},required:["id","email","name","emailVerified","createdAt","updatedAt"]}},required:["user"]}}}},422:{description:"Unprocessable Entity. User already exists or failed to create user.",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}}}}}}}}}},async e=>_y(e.context.adapter,async()=>{if(!e.context.options.emailAndPassword?.enabled||e.context.options.emailAndPassword?.disableSignUp)throw new D("BAD_REQUEST",{message:"Email and password sign up is not enabled"});const t=e.body,{name:r,email:i,password:n,image:o,callbackURL:a,rememberMe:s,...c}=t;if(!Ur().safeParse(i).success)throw new D("BAD_REQUEST",{message:G.INVALID_EMAIL});if(!n||typeof n!="string")throw new D("BAD_REQUEST",{message:G.INVALID_PASSWORD});const u=e.context.password.config.minPasswordLength;if(n.length<u)throw e.context.logger.error("Password is too short"),new D("BAD_REQUEST",{message:G.PASSWORD_TOO_SHORT});const d=e.context.password.config.maxPasswordLength;if(n.length>d)throw e.context.logger.error("Password is too long"),new D("BAD_REQUEST",{message:G.PASSWORD_TOO_LONG});if((await e.context.internalAdapter.findUserByEmail(i))?.user)throw e.context.logger.info(`Sign-up attempt for existing email: ${i}`),new D("UNPROCESSABLE_ENTITY",{message:G.USER_ALREADY_EXISTS_USE_ANOTHER_EMAIL});const l=await e.context.password.hash(n);let f;try{const g=Up(e.context.options,c,"create");if(f=await e.context.internalAdapter.createUser({email:i.toLowerCase(),name:r,image:o,...g,emailVerified:!1}),!f)throw new D("BAD_REQUEST",{message:G.FAILED_TO_CREATE_USER})}catch(g){throw Tp()&&e.context.logger.error("Failed to create user",g),g instanceof D?g:(e.context.logger?.error("Failed to create user",g),new D("UNPROCESSABLE_ENTITY",{message:G.FAILED_TO_CREATE_USER}))}if(!f)throw new D("UNPROCESSABLE_ENTITY",{message:G.FAILED_TO_CREATE_USER});if(await e.context.internalAdapter.linkAccount({userId:f.id,providerId:"credential",accountId:f.id,password:l}),e.context.options.emailVerification?.sendOnSignUp||e.context.options.emailAndPassword.requireEmailVerification){const g=await Nr(e.context.secret,f.email,void 0,e.context.options.emailVerification?.expiresIn),m=t.callbackURL?encodeURIComponent(t.callbackURL):encodeURIComponent("/"),v=`${e.context.baseURL}/verify-email?token=${g}&callbackURL=${m}`;e.context.options.emailVerification?.sendVerificationEmail&&await e.context.runInBackgroundOrAwait(e.context.options.emailVerification.sendVerificationEmail({user:f,url:v,token:g},e.request))}if(e.context.options.emailAndPassword.autoSignIn===!1||e.context.options.emailAndPassword.requireEmailVerification)return e.json({token:null,user:ht(e.context.options,f)});const h=await e.context.internalAdapter.createSession(f.id,s===!1);if(!h)throw new D("BAD_REQUEST",{message:G.FAILED_TO_CREATE_SESSION});return await tr(e,{session:h,user:f},s===!1),e.json({token:h.token,user:ht(e.context.options,f)})})),XL=qn(M().meta({description:"Field name must be a string"}),rn()),e1=()=>me("/update-user",{method:"POST",operationId:"updateUser",body:XL,use:[Is],metadata:{$Infer:{body:{}},openapi:{operationId:"updateUser",description:"Update the current user",requestBody:{content:{"application/json":{schema:{type:"object",properties:{name:{type:"string",description:"The name of the user"},image:{type:"string",description:"The image of the user",nullable:!0}}}}}},responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{user:{type:"object",$ref:"#/components/schemas/User"}}}}}}}}}},async e=>{const t=e.body;if(typeof t!="object"||Array.isArray(t))throw new D("BAD_REQUEST",{message:"Body must be an object"});if(t.email)throw new D("BAD_REQUEST",{message:G.EMAIL_CAN_NOT_BE_UPDATED});const{name:r,image:i,...n}=t,o=e.context.session,a=Up(e.context.options,n,"update");if(i===void 0&&r===void 0&&Object.keys(a).length===0)throw new D("BAD_REQUEST",{message:"No fields to update"});const s=await e.context.internalAdapter.updateUser(o.user.id,{name:r,image:i,...a})??{...o.user,...r!==void 0&&{name:r},...i!==void 0&&{image:i},...a};return await tr(e,{session:o.session,user:s}),e.json({status:!0})}),t1=me("/change-password",{method:"POST",operationId:"changePassword",body:le({newPassword:M().meta({description:"The new password to set"}),currentPassword:M().meta({description:"The current password is required"}),revokeOtherSessions:Bt().meta({description:"Must be a boolean value"}).optional()}),use:[Wn],metadata:{openapi:{operationId:"changePassword",description:"Change the password of the user",responses:{200:{description:"Password successfully changed",content:{"application/json":{schema:{type:"object",properties:{token:{type:"string",nullable:!0,description:"New session token if other sessions were revoked"},user:{type:"object",properties:{id:{type:"string",description:"The unique identifier of the user"},email:{type:"string",format:"email",description:"The email address of the user"},name:{type:"string",description:"The name of the user"},image:{type:"string",format:"uri",nullable:!0,description:"The profile image URL of the user"},emailVerified:{type:"boolean",description:"Whether the email has been verified"},createdAt:{type:"string",format:"date-time",description:"When the user was created"},updatedAt:{type:"string",format:"date-time",description:"When the user was last updated"}},required:["id","email","name","emailVerified","createdAt","updatedAt"]}},required:["user"]}}}}}}}},async e=>{const{newPassword:t,currentPassword:r,revokeOtherSessions:i}=e.body,n=e.context.session,o=e.context.password.config.minPasswordLength;if(t.length<o)throw e.context.logger.error("Password is too short"),new D("BAD_REQUEST",{message:G.PASSWORD_TOO_SHORT});const a=e.context.password.config.maxPasswordLength;if(t.length>a)throw e.context.logger.error("Password is too long"),new D("BAD_REQUEST",{message:G.PASSWORD_TOO_LONG});const s=(await e.context.internalAdapter.findAccounts(n.user.id)).find(d=>d.providerId==="credential"&&d.password);if(!s||!s.password)throw new D("BAD_REQUEST",{message:G.CREDENTIAL_ACCOUNT_NOT_FOUND});const c=await e.context.password.hash(t);if(!await e.context.password.verify({hash:s.password,password:r}))throw new D("BAD_REQUEST",{message:G.INVALID_PASSWORD});await e.context.internalAdapter.updateAccount(s.id,{password:c});let u=null;if(i){await e.context.internalAdapter.deleteSessions(n.user.id);const d=await e.context.internalAdapter.createSession(n.user.id);if(!d)throw new D("INTERNAL_SERVER_ERROR",{message:G.FAILED_TO_GET_SESSION});await tr(e,{session:d,user:n.user}),u=d.token}return e.json({token:u,user:ht(e.context.options,n.user)})}),r1=me({method:"POST",body:le({newPassword:M().meta({description:"The new password to set is required"})}),use:[Wn]},async e=>{const{newPassword:t}=e.body,r=e.context.session,i=e.context.password.config.minPasswordLength;if(t.length<i)throw e.context.logger.error("Password is too short"),new D("BAD_REQUEST",{message:G.PASSWORD_TOO_SHORT});const n=e.context.password.config.maxPasswordLength;if(t.length>n)throw e.context.logger.error("Password is too long"),new D("BAD_REQUEST",{message:G.PASSWORD_TOO_LONG});const o=(await e.context.internalAdapter.findAccounts(r.user.id)).find(s=>s.providerId==="credential"&&s.password),a=await e.context.password.hash(t);if(!o)return await e.context.internalAdapter.linkAccount({userId:r.user.id,providerId:"credential",accountId:r.user.id,password:a}),e.json({status:!0});throw new D("BAD_REQUEST",{message:"user already has a password"})}),n1=me("/delete-user",{method:"POST",use:[Wn],body:le({callbackURL:M().meta({description:"The callback URL to redirect to after the user is deleted"}).optional(),password:M().meta({description:"The password of the user is required to delete the user"}).optional(),token:M().meta({description:"The token to delete the user is required"}).optional()}),metadata:{openapi:{operationId:"deleteUser",description:"Delete the user",requestBody:{content:{"application/json":{schema:{type:"object",properties:{callbackURL:{type:"string",description:"The callback URL to redirect to after the user is deleted"},password:{type:"string",description:"The user's password. Required if session is not fresh"},token:{type:"string",description:"The deletion verification token"}}}}}},responses:{200:{description:"User deletion processed successfully",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",description:"Indicates if the operation was successful"},message:{type:"string",enum:["User deleted","Verification email sent"],description:"Status message of the deletion process"}},required:["success","message"]}}}}}}}},async e=>{if(!e.context.options.user?.deleteUser?.enabled)throw e.context.logger.error("Delete user is disabled. Enable it in the options"),new D("NOT_FOUND");const t=e.context.session;if(e.body.password){const n=(await e.context.internalAdapter.findAccounts(t.user.id)).find(o=>o.providerId==="credential"&&o.password);if(!n||!n.password)throw new D("BAD_REQUEST",{message:G.CREDENTIAL_ACCOUNT_NOT_FOUND});if(!await e.context.password.verify({hash:n.password,password:e.body.password}))throw new D("BAD_REQUEST",{message:G.INVALID_PASSWORD})}if(e.body.token)return await bN({...e,query:{token:e.body.token}}),e.json({success:!0,message:"User deleted"});if(e.context.options.user.deleteUser?.sendDeleteAccountVerification){const n=ul(32,"0-9","a-z");await e.context.internalAdapter.createVerificationValue({value:t.user.id,identifier:`delete-account-${n}`,expiresAt:new Date(Date.now()+(e.context.options.user.deleteUser?.deleteTokenExpiresIn||3600*24)*1e3)});const o=`${e.context.baseURL}/delete-user/callback?token=${n}&callbackURL=${e.body.callbackURL||"/"}`;return await e.context.runInBackgroundOrAwait(e.context.options.user.deleteUser.sendDeleteAccountVerification({user:t.user,url:o,token:n},e.request)),e.json({success:!0,message:"Verification email sent"})}if(!e.body.password&&e.context.sessionConfig.freshAge!==0){const n=new Date(t.session.createdAt).getTime(),o=e.context.sessionConfig.freshAge*1e3;if(Date.now()-n>o*1e3)throw new D("BAD_REQUEST",{message:G.SESSION_EXPIRED})}const r=e.context.options.user.deleteUser?.beforeDelete;r&&await r(t.user,e.request),await e.context.internalAdapter.deleteUser(t.user.id),await e.context.internalAdapter.deleteSessions(t.user.id),ba(e);const i=e.context.options.user.deleteUser?.afterDelete;return i&&await i(t.user,e.request),e.json({success:!0,message:"User deleted"})}),bN=me("/delete-user/callback",{method:"GET",query:le({token:M().meta({description:"The token to verify the deletion request"}),callbackURL:M().meta({description:"The URL to redirect to after deletion"}).optional()}),use:[jp(e=>e.query.callbackURL)],metadata:{openapi:{description:"Callback to complete user deletion with verification token",responses:{200:{description:"User successfully deleted",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",description:"Indicates if the deletion was successful"},message:{type:"string",enum:["User deleted"],description:"Confirmation message"}},required:["success","message"]}}}}}}}},async e=>{if(!e.context.options.user?.deleteUser?.enabled)throw e.context.logger.error("Delete user is disabled. Enable it in the options"),new D("NOT_FOUND");const t=await xr(e);if(!t)throw new D("NOT_FOUND",{message:G.FAILED_TO_GET_USER_INFO});const r=await e.context.internalAdapter.findVerificationValue(`delete-account-${e.query.token}`);if(!r||r.expiresAt<new Date)throw new D("NOT_FOUND",{message:G.INVALID_TOKEN});if(r.value!==t.user.id)throw new D("NOT_FOUND",{message:G.INVALID_TOKEN});const i=e.context.options.user.deleteUser?.beforeDelete;i&&await i(t.user,e.request),await e.context.internalAdapter.deleteUser(t.user.id),await e.context.internalAdapter.deleteSessions(t.user.id),await e.context.internalAdapter.deleteAccounts(t.user.id),await e.context.internalAdapter.deleteVerificationValue(r.id),ba(e);const n=e.context.options.user.deleteUser?.afterDelete;if(n&&await n(t.user,e.request),e.query.callbackURL)throw e.redirect(e.query.callbackURL||"/");return e.json({success:!0,message:"User deleted"})}),i1=me("/change-email",{method:"POST",body:le({newEmail:Ur().meta({description:"The new email address to set must be a valid email address"}),callbackURL:M().meta({description:"The URL to redirect to after email verification"}).optional()}),use:[Wn],metadata:{openapi:{operationId:"changeEmail",responses:{200:{description:"Email change request processed successfully",content:{"application/json":{schema:{type:"object",properties:{user:{type:"object",$ref:"#/components/schemas/User"},status:{type:"boolean",description:"Indicates if the request was successful"},message:{type:"string",enum:["Email updated","Verification email sent"],description:"Status message of the email change process",nullable:!0}},required:["status"]}}}},422:{description:"Unprocessable Entity. Email already exists",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}}}}}}}}}},async e=>{if(!e.context.options.user?.changeEmail?.enabled)throw e.context.logger.error("Change email is disabled."),new D("BAD_REQUEST",{message:"Change email is disabled"});const t=e.body.newEmail.toLowerCase();if(t===e.context.session.user.email)throw e.context.logger.error("Email is the same"),new D("BAD_REQUEST",{message:"Email is the same"});if(await e.context.internalAdapter.findUserByEmail(t))throw e.context.logger.error("Email already exists"),new D("UNPROCESSABLE_ENTITY",{message:G.USER_ALREADY_EXISTS_USE_ANOTHER_EMAIL});if(e.context.session.user.emailVerified!==!0&&e.context.options.user.changeEmail.updateEmailWithoutVerification){if(await e.context.internalAdapter.updateUserByEmail(e.context.session.user.email,{email:t}),await tr(e,{session:e.context.session.session,user:{...e.context.session.user,email:t}}),e.context.options.emailVerification?.sendVerificationEmail){const n=await Nr(e.context.secret,t,void 0,e.context.options.emailVerification?.expiresIn),o=`${e.context.baseURL}/verify-email?token=${n}&callbackURL=${e.body.callbackURL||"/"}`;await e.context.runInBackgroundOrAwait(e.context.options.emailVerification.sendVerificationEmail({user:{...e.context.session.user,email:t},url:o,token:n},e.request))}return e.json({status:!0})}if(e.context.session.user.emailVerified&&(e.context.options.user.changeEmail.sendChangeEmailConfirmation||e.context.options.user.changeEmail.sendChangeEmailVerification)){const n=await Nr(e.context.secret,e.context.session.user.email,t,e.context.options.emailVerification?.expiresIn,{requestType:"change-email-confirmation"}),o=`${e.context.baseURL}/verify-email?token=${n}&callbackURL=${e.body.callbackURL||"/"}`,a=e.context.options.user.changeEmail.sendChangeEmailConfirmation||e.context.options.user.changeEmail.sendChangeEmailVerification;return a&&await e.context.runInBackgroundOrAwait(a({user:e.context.session.user,newEmail:t,url:o,token:n},e.request)),e.json({status:!0})}if(!e.context.options.emailVerification?.sendVerificationEmail)throw e.context.logger.error("Verification email isn't enabled."),new D("BAD_REQUEST",{message:"Verification email isn't enabled"});const r=await Nr(e.context.secret,e.context.session.user.email,t,e.context.options.emailVerification?.expiresIn,{requestType:"change-email-verification"}),i=`${e.context.baseURL}/verify-email?token=${r}&callbackURL=${e.body.callbackURL||"/"}`;return await e.context.runInBackgroundOrAwait(e.context.options.emailVerification.sendVerificationEmail({user:{...e.context.session.user,email:t},url:i,token:r},e.request)),e.json({status:!0})});function el(e){if(e===null||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);return t!==null&&t!==Object.prototype&&Object.getPrototypeOf(t)!==null||Symbol.iterator in e?!1:Symbol.toStringTag in e?Object.prototype.toString.call(e)==="[object Module]":!0}function Kl(e,t,r=".",i){if(!el(t))return Kl(e,{},r,i);const n=Object.assign({},t);for(const o in e){if(o==="__proto__"||o==="constructor")continue;const a=e[o];a!=null&&(i&&i(n,o,a,r)||(Array.isArray(a)&&Array.isArray(n[o])?n[o]=[...a,...n[o]]:el(a)&&el(n[o])?n[o]=Kl(a,n[o],(r?`${r}.`:"")+o.toString(),i):n[o]=a))}return n}function _N(e){return(...t)=>t.reduce((r,i)=>Kl(r,i,"",e),{})}const SN=_N(),kN=_N((e,t,r)=>{if(Array.isArray(e[t])&&Array.isArray(r))return e[t]=r,!0}),Jl=new WeakMap;function o1(e,t){const r={};for(const[i,n]of Object.entries(e))r[i]=async o=>{const a=async()=>{const s=await t;let c={...o,context:{...s,returned:void 0,responseHeaders:void 0,session:null},path:n.path,headers:o?.headers?new Headers(o?.headers):void 0};return tc(c,async()=>{const{beforeHooks:u,afterHooks:d}=c1(s),l=await a1(c,u);if("context"in l&&l.context&&typeof l.context=="object"){const{headers:g,...m}=l.context;g&&g.forEach((v,b)=>{c.headers.set(b,v)}),c=kN(m,c)}else if(l)return o?.asResponse?oi(l,{headers:o?.headers}):o?.returnHeaders?{headers:o?.headers,response:l}:l;c.asResponse=!1,c.returnHeaders=!0,c.returnStatus=!0;const f=await tc(c,()=>n(c)).catch(g=>{if(g instanceof D)return{response:g,status:g.statusCode,headers:g.headers?new Headers(g.headers):null};throw g});if(f&&f instanceof Response)return f;c.context.returned=f.response,c.context.responseHeaders=f.headers;const h=await s1(c,d);if(h.response&&(f.response=h.response),f.response instanceof D&&td(s.logger.level,"debug")&&(f.response.stack=f.response.errorStack),f.response instanceof D&&!o?.asResponse)throw f.response;return o?.asResponse?oi(f.response,{headers:f.headers,status:f.status}):o?.returnHeaders?o?.returnStatus?{headers:f.headers,response:f.response,status:f.status}:{headers:f.headers,response:f.response}:o?.returnStatus?{response:f.response,status:f.status}:f.response})};return await EA()?a():AA(new WeakMap,a)},r[i].path=n.path,r[i].options=n.options;return r}async function a1(e,t){let r={};for(const i of t){let n=!1;try{n=i.matcher(e)}catch(o){const a=Jl.get(i.handler)??"unknown";throw e.context.logger.error(`An error occurred during ${a} hook matcher execution:`,o),new D("INTERNAL_SERVER_ERROR",{message:"An error occurred during hook matcher execution. Check the logs for more details."})}if(n){const o=await i.handler({...e,returnHeaders:!1}).catch(a=>{throw a instanceof D&&td(e.context.logger.level,"debug")&&(a.stack=a.errorStack),a});if(o&&typeof o=="object"){if("context"in o&&typeof o.context=="object"){const{headers:a,...s}=o.context;a instanceof Headers&&(r.headers?a.forEach((c,u)=>{r.headers?.set(u,c)}):r.headers=a),r=kN(s,r);continue}return o}}}return{context:r}}async function s1(e,t){for(const r of t)if(r.matcher(e)){const i=await r.handler(e).catch(n=>{if(n instanceof D)return td(e.context.logger.level,"debug")&&(n.stack=n.errorStack),{response:n,headers:n.headers?new Headers(n.headers):null};throw n});i.headers&&i.headers.forEach((n,o)=>{e.context.responseHeaders?o.toLowerCase()==="set-cookie"?e.context.responseHeaders.append(o,n):e.context.responseHeaders.set(o,n):e.context.responseHeaders=new Headers({[o]:n})}),i.response&&(e.context.returned=i.response)}return{response:e.context.returned,headers:e.context.responseHeaders}}function c1(e){const t=e.options.plugins||[],r=[],i=[],n=e.options.hooks?.before;n&&(Jl.set(n,"user"),r.push({matcher:()=>!0,handler:n}));const o=e.options.hooks?.after;o&&(Jl.set(o,"user"),i.push({matcher:()=>!0,handler:o}));const a=t.filter(c=>c.hooks?.before).map(c=>c.hooks?.before).flat(),s=t.filter(c=>c.hooks?.after).map(c=>c.hooks?.after).flat();return a.length&&r.push(...a),s.length&&i.push(...s),{beforeHooks:r,afterHooks:i}}function u1(e,t){const r=new Map;e.plugins?.forEach(n=>{if(n.endpoints){for(const[o,a]of Object.entries(n.endpoints))if(a&&"path"in a&&typeof a.path=="string"){const s=a.path;let c=[];a.options&&"method"in a.options&&(Array.isArray(a.options.method)?c=a.options.method:typeof a.options.method=="string"&&(c=[a.options.method])),c.length===0&&(c=["*"]),r.has(s)||r.set(s,[]),r.get(s).push({pluginId:n.id,endpointKey:o,methods:c})}}});const i=[];for(const[n,o]of r.entries())if(o.length>1){const a=new Map;let s=!1;for(const c of o)for(const u of c.methods)a.has(u)||a.set(u,[]),a.get(u).push(c.pluginId),a.get(u).length>1&&(s=!0),(u==="*"&&o.length>1||u!=="*"&&a.has("*"))&&(s=!0);if(s){const c=[...new Set(o.map(d=>d.pluginId))],u=[];for(const[d,l]of a.entries())(l.length>1||d==="*"&&o.length>1||d!=="*"&&a.has("*"))&&u.push(d);i.push({path:n,plugins:c,conflictingMethods:u})}}if(i.length>0){const n=i.map(o=>`  - "${o.path}" [${o.conflictingMethods.join(", ")}] used by plugins: ${o.plugins.join(", ")}`).join(`
`);t.error(`Endpoint path conflicts detected! Multiple plugins are trying to use the same endpoint paths with conflicting HTTP methods:
${n}

To resolve this, you can:
	1. Use only one of the conflicting plugins
	2. Configure the plugins to use different paths (if supported)
	3. Ensure plugins use different HTTP methods for the same path
`)}}function NN(e,t){const r=t.plugins?.reduce((n,o)=>({...n,...o.endpoints}),{})??{},i=t.plugins?.map(n=>n.middlewares?.map(o=>{const a=(async s=>{const c=await e;return o.middleware({...s,context:{...c,...s.context}})});return a.options=o.middleware.options,{path:o.path,middleware:a}})).filter(n=>n!==void 0).flat()||[];return{api:o1({signInSocial:HL(),callbackOAuth:PL,getSession:dN(),signOut:GL,signUpEmail:YL(),signInEmail:ZL(),resetPassword:VL,verifyPassword:KL,verifyEmail:CL,sendVerificationEmail:UL,changeEmail:i1,changePassword:t1,setPassword:r1,updateUser:e1(),deleteUser:n1,requestPasswordReset:FL,requestPasswordResetCallback:BL,listSessions:gP(),revokeSession:yP,revokeSessions:wP,revokeOtherSessions:vP,linkSocialAccount:TL,listUserAccounts:IL,deleteUserCallback:bN,unlinkAccount:xL,refreshToken:OL,getAccessToken:yN,accountInfo:RL,...r,ok:jL,error:zL},e),middlewares:i}}const d1=(e,t)=>{const{api:r,middlewares:i}=NN(e,t),n=new URL(e.baseURL).pathname;return YD(r,{routerContext:e,openapi:{disabled:!0},basePath:n,routerMiddleware:[{path:"/**",middleware:AR},...i],allowedMediaTypes:["application/json"],skipTrailingSlashes:t.advanced?.skipTrailingSlashes??!1,async onRequest(o){const a=e.options.disabledPaths||[],s=new URL(o.url).pathname.replace(/\/+$/,"")||"/",c=n==="/"?s:s.startsWith(n)?s.slice(n.length).replace(/\/+$/,"")||"/":s;if(a.includes(c))return new Response("Not Found",{status:404});let u=o;for(const l of e.options.plugins||[])if(l.onRequest){const f=await l.onRequest(u,e);if(f&&"response"in f)return f.response;f&&"request"in f&&(u=f.request)}const d=await UR(u,e);return d||u},async onResponse(o){for(const a of e.options.plugins||[])if(a.onResponse){const s=await a.onResponse(o,e);if(s)return s.response}return o},onError(o){if(o instanceof D&&o.status==="FOUND")return;if(t.onAPIError?.throw)throw o;if(t.onAPIError?.onError){t.onAPIError.onError(o,e);return}const a=t.logger?.level,s=a==="error"||a==="warn"||a==="debug"?ie:void 0;if(t.logger?.disabled!==!0){if(o&&typeof o=="object"&&"message"in o&&typeof o.message=="string"&&(o.message.includes("no column")||o.message.includes("column")||o.message.includes("relation")||o.message.includes("table")||o.message.includes("does not exist"))){e.logger?.error(o.message);return}o instanceof D?(o.status==="INTERNAL_SERVER_ERROR"&&e.logger.error(o.status,o),s?.error(o.message)):e.logger?.error(o&&typeof o=="object"&&"name"in o?o.name:"",o)}}})},$N="better-auth-secret-12345678901234567890";function EN(e){return!!e&&(typeof e=="object"||typeof e=="function")&&typeof e.then=="function"}async function l1(e){let t=e.options;const r=t.plugins||[];let i=e;const n=[];for(const o of r)if(o.init){const a=o.init(i);let s;if(EN(a)?s=await a:s=a,typeof s=="object"){if(s.options){const{databaseHooks:c,...u}=s.options;c&&n.push(c),t=SN(t,u)}s.context&&(i={...i,...s.context})}}return n.push(t.databaseHooks),i.internalAdapter=Mp(i.adapter,{options:t,logger:i.logger,hooks:n.filter(o=>o!==void 0),generateId:i.generateId}),i.options=t,{context:i}}function f1(e){const t=[];return e.advanced?.crossSubDomainCookies?.enabled,t}async function AN(e,t){const r=zp(e.baseURL,e.basePath),i=r?[new URL(r).origin]:[];if(e.trustedOrigins&&(Array.isArray(e.trustedOrigins)&&i.push(...e.trustedOrigins),typeof e.trustedOrigins=="function")){const o=await e.trustedOrigins(t);i.push(...o)}const n=Se.BETTER_AUTH_TRUSTED_ORIGINS;return n&&i.push(...n.split(",")),i.filter(o=>!!o)}function h1(e,t){return{database:t?.database,adapter:t?.adapter,emailVerification:{sendVerificationEmail:!!e.emailVerification?.sendVerificationEmail,sendOnSignUp:!!e.emailVerification?.sendOnSignUp,sendOnSignIn:!!e.emailVerification?.sendOnSignIn,autoSignInAfterVerification:!!e.emailVerification?.autoSignInAfterVerification,expiresIn:e.emailVerification?.expiresIn,onEmailVerification:!!e.emailVerification?.onEmailVerification,afterEmailVerification:!!e.emailVerification?.afterEmailVerification},emailAndPassword:{enabled:!!e.emailAndPassword?.enabled,disableSignUp:!!e.emailAndPassword?.disableSignUp,requireEmailVerification:!!e.emailAndPassword?.requireEmailVerification,maxPasswordLength:e.emailAndPassword?.maxPasswordLength,minPasswordLength:e.emailAndPassword?.minPasswordLength,sendResetPassword:!!e.emailAndPassword?.sendResetPassword,resetPasswordTokenExpiresIn:e.emailAndPassword?.resetPasswordTokenExpiresIn,onPasswordReset:!!e.emailAndPassword?.onPasswordReset,password:{hash:!!e.emailAndPassword?.password?.hash,verify:!!e.emailAndPassword?.password?.verify},autoSignIn:!!e.emailAndPassword?.autoSignIn,revokeSessionsOnPasswordReset:!!e.emailAndPassword?.revokeSessionsOnPasswordReset},socialProviders:Object.keys(e.socialProviders||{}).map(r=>{const i=e.socialProviders?.[r];return i?{id:r,mapProfileToUser:!!i.mapProfileToUser,disableDefaultScope:!!i.disableDefaultScope,disableIdTokenSignIn:!!i.disableIdTokenSignIn,disableImplicitSignUp:i.disableImplicitSignUp,disableSignUp:i.disableSignUp,getUserInfo:!!i.getUserInfo,overrideUserInfoOnSignIn:!!i.overrideUserInfoOnSignIn,prompt:i.prompt,verifyIdToken:!!i.verifyIdToken,scope:i.scope,refreshAccessToken:!!i.refreshAccessToken}:{}}),plugins:e.plugins?.map(r=>r.id.toString()),user:{modelName:e.user?.modelName,fields:e.user?.fields,additionalFields:e.user?.additionalFields,changeEmail:{enabled:e.user?.changeEmail?.enabled,sendChangeEmailVerification:!!e.user?.changeEmail?.sendChangeEmailVerification}},verification:{modelName:e.verification?.modelName,disableCleanup:e.verification?.disableCleanup,fields:e.verification?.fields},session:{modelName:e.session?.modelName,additionalFields:e.session?.additionalFields,cookieCache:{enabled:e.session?.cookieCache?.enabled,maxAge:e.session?.cookieCache?.maxAge,strategy:e.session?.cookieCache?.strategy},disableSessionRefresh:e.session?.disableSessionRefresh,expiresIn:e.session?.expiresIn,fields:e.session?.fields,freshAge:e.session?.freshAge,preserveSessionInDatabase:e.session?.preserveSessionInDatabase,storeSessionInDatabase:e.session?.storeSessionInDatabase,updateAge:e.session?.updateAge},account:{modelName:e.account?.modelName,fields:e.account?.fields,encryptOAuthTokens:e.account?.encryptOAuthTokens,updateAccountOnSignIn:e.account?.updateAccountOnSignIn,accountLinking:{enabled:e.account?.accountLinking?.enabled,trustedProviders:e.account?.accountLinking?.trustedProviders,updateUserInfoOnLink:e.account?.accountLinking?.updateUserInfoOnLink,allowUnlinkingAll:e.account?.accountLinking?.allowUnlinkingAll}},hooks:{after:!!e.hooks?.after,before:!!e.hooks?.before},secondaryStorage:!!e.secondaryStorage,advanced:{cookiePrefix:!!e.advanced?.cookiePrefix,cookies:!!e.advanced?.cookies,crossSubDomainCookies:{domain:!!e.advanced?.crossSubDomainCookies?.domain,enabled:e.advanced?.crossSubDomainCookies?.enabled,additionalCookies:e.advanced?.crossSubDomainCookies?.additionalCookies},database:{useNumberId:!!e.advanced?.database?.useNumberId||e.advanced?.database?.generateId==="serial",generateId:e.advanced?.database?.generateId,defaultFindManyLimit:e.advanced?.database?.defaultFindManyLimit},useSecureCookies:e.advanced?.useSecureCookies,ipAddress:{disableIpTracking:e.advanced?.ipAddress?.disableIpTracking,ipAddressHeaders:e.advanced?.ipAddress?.ipAddressHeaders},disableCSRFCheck:e.advanced?.disableCSRFCheck,cookieAttributes:{expires:e.advanced?.defaultCookieAttributes?.expires,secure:e.advanced?.defaultCookieAttributes?.secure,sameSite:e.advanced?.defaultCookieAttributes?.sameSite,domain:!!e.advanced?.defaultCookieAttributes?.domain,path:e.advanced?.defaultCookieAttributes?.path,httpOnly:e.advanced?.defaultCookieAttributes?.httpOnly}},trustedOrigins:e.trustedOrigins?.length,rateLimit:{storage:e.rateLimit?.storage,modelName:e.rateLimit?.modelName,window:e.rateLimit?.window,customStorage:!!e.rateLimit?.customStorage,enabled:e.rateLimit?.enabled,max:e.rateLimit?.max},onAPIError:{errorURL:e.onAPIError?.errorURL,onError:!!e.onAPIError?.onError,throw:e.onAPIError?.throw},logger:{disabled:e.logger?.disabled,level:e.logger?.level,log:!!e.logger?.log},databaseHooks:{user:{create:{after:!!e.databaseHooks?.user?.create?.after,before:!!e.databaseHooks?.user?.create?.before},update:{after:!!e.databaseHooks?.user?.update?.after,before:!!e.databaseHooks?.user?.update?.before}},session:{create:{after:!!e.databaseHooks?.session?.create?.after,before:!!e.databaseHooks?.session?.create?.before},update:{after:!!e.databaseHooks?.session?.update?.after,before:!!e.databaseHooks?.session?.update?.before}},account:{create:{after:!!e.databaseHooks?.account?.create?.after,before:!!e.databaseHooks?.account?.create?.before},update:{after:!!e.databaseHooks?.account?.update?.after,before:!!e.databaseHooks?.account?.update?.before}},verification:{create:{after:!!e.databaseHooks?.verification?.create?.after,before:!!e.databaseHooks?.verification?.create?.before},update:{after:!!e.databaseHooks?.verification?.update?.after,before:!!e.databaseHooks?.verification?.update?.before}}}}}let In;async function IN(){if(In)return In;try{const e=typeof process<"u"&&typeof process.cwd=="function"?process.cwd():"";if(!e)return;const t=o=>Function("mm","return import(mm)")(o),[{default:r},{default:i}]=await Promise.all([t("fs/promises"),t("path")]),n=await r.readFile(i.join(e,"package.json"),"utf-8");return In=JSON.parse(n),In}catch{}}async function TN(e){if(In)return In.dependencies?.[e]||In.devDependencies?.[e]||In.peerDependencies?.[e];try{const t=typeof process<"u"&&typeof process.cwd=="function"?process.cwd():"";if(!t)throw new Error("no-cwd");const r=s=>Function("mm","return import(mm)")(s),[{default:i},{default:n}]=await Promise.all([r("fs/promises"),r("path")]),o=n.join(t,"node_modules",e,"package.json"),a=await i.readFile(o,"utf-8");return JSON.parse(a).version||await Yg(e)||void 0}catch{}return await Yg(e)}async function Yg(e){const t=await IN();if(t)return{...t.dependencies,...t.devDependencies,...t.peerDependencies}[e]}async function p1(){return(await IN())?.name}const m1={pg:"postgresql",mysql:"mysql",mariadb:"mariadb",sqlite3:"sqlite","better-sqlite3":"sqlite","@prisma/client":"prisma",mongoose:"mongodb",mongodb:"mongodb","drizzle-orm":"drizzle"};async function g1(){for(const[e,t]of Object.entries(m1)){const r=await TN(e);if(r)return{name:t,version:r}}}const y1={next:"next",nuxt:"nuxt","@remix-run/server-runtime":"remix",astro:"astro","@sveltejs/kit":"sveltekit","solid-start":"solid-start","tanstack-start":"tanstack-start",hono:"hono",express:"express",elysia:"elysia",expo:"expo"};async function w1(){for(const[e,t]of Object.entries(y1)){const r=await TN(e);if(r)return{name:t,version:r}}}function v1(){const e=Se.npm_config_user_agent;if(!e)return;const t=e.split(" ")[0],r=t.lastIndexOf("/"),i=t.substring(0,r);return{name:i==="npminstall"?"cnpm":i,version:t.substring(r+1)}}const so=e=>Function("mm","return import(mm)")(e);function mi(){const e=(...t)=>t.some(r=>!!Se[r]);return e("CF_PAGES","CF_PAGES_URL","CF_ACCOUNT_ID")||typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"?"cloudflare":e("VERCEL","VERCEL_URL","VERCEL_ENV")?"vercel":e("NETLIFY","NETLIFY_URL")?"netlify":e("RENDER","RENDER_URL","RENDER_INTERNAL_HOSTNAME","RENDER_SERVICE_ID")?"render":e("AWS_LAMBDA_FUNCTION_NAME","AWS_EXECUTION_ENV","LAMBDA_TASK_ROOT")?"aws":e("GOOGLE_CLOUD_FUNCTION_NAME","GOOGLE_CLOUD_PROJECT","GCP_PROJECT","K_SERVICE")?"gcp":e("AZURE_FUNCTION_NAME","FUNCTIONS_WORKER_RUNTIME","WEBSITE_INSTANCE_ID","WEBSITE_SITE_NAME")?"azure":e("DENO_DEPLOYMENT_ID","DENO_REGION")?"deno-deploy":e("FLY_APP_NAME","FLY_REGION","FLY_ALLOC_ID")?"fly-io":e("RAILWAY_STATIC_URL","RAILWAY_ENVIRONMENT_NAME")?"railway":e("DYNO","HEROKU_APP_NAME")?"heroku":e("DO_DEPLOYMENT_ID","DO_APP_NAME","DIGITALOCEAN")?"digitalocean":e("KOYEB","KOYEB_DEPLOYMENT_ID","KOYEB_APP_NAME")?"koyeb":null}async function b1(){try{if(mi()==="cloudflare")return"cloudflare";const e=await so("os"),t=e.cpus();return{deploymentVendor:mi(),systemPlatform:e.platform(),systemRelease:e.release(),systemArchitecture:e.arch(),cpuCount:t.length,cpuModel:t.length?t[0].model:null,cpuSpeed:t.length?t[0].speed:null,memory:e.totalmem(),isWSL:await k1(),isDocker:await xN(),isTTY:typeof process<"u"&&process.stdout?process.stdout.isTTY:null}}catch{return{systemPlatform:null,systemRelease:null,systemArchitecture:null,cpuCount:null,cpuModel:null,cpuSpeed:null,memory:null,isWSL:null,isDocker:null,isTTY:null}}}let tl;async function _1(){if(mi()==="cloudflare")return!1;try{return(await so("fs")).statSync("/.dockerenv"),!0}catch{return!1}}async function S1(){if(mi()==="cloudflare")return!1;try{return(await so("fs")).readFileSync("/proc/self/cgroup","utf8").includes("docker")}catch{return!1}}async function xN(){return mi()==="cloudflare"?!1:(tl===void 0&&(tl=await _1()||await S1()),tl)}async function k1(){try{if(mi()==="cloudflare"||typeof process>"u"||process?.platform!=="linux")return!1;const e=await so("fs");return(await so("os")).release().toLowerCase().includes("microsoft")?!await Xg():e.readFileSync("/proc/version","utf8").toLowerCase().includes("microsoft")?!await Xg():!1}catch{return!1}}let rl;const N1=async()=>{if(mi()==="cloudflare")return!1;try{return(await so("fs")).statSync("/run/.containerenv"),!0}catch{return!1}};async function Xg(){return rl===void 0&&(rl=await N1()||await xN()),rl}function $1(){return Se.CI!=="false"&&("BUILD_ID"in Se||"BUILD_NUMBER"in Se||"CI"in Se||"CI_APP_ID"in Se||"CI_BUILD_ID"in Se||"CI_BUILD_NUMBER"in Se||"CI_NAME"in Se||"CONTINUOUS_INTEGRATION"in Se||"RUN_ID"in Se)}function E1(){return typeof Deno<"u"?{name:"deno",version:Deno?.version?.deno??null}:typeof Bun<"u"?{name:"bun",version:Bun?.version??null}:typeof process<"u"&&process?.versions?.node?{name:"node",version:process.versions.node??null}:{name:"edge",version:null}}function A1(){return ge("NODE_ENV")==="production"?"production":$1()?"ci":_s()?"test":"development"}async function ey(e){const t=await xp("SHA-256").digest(e);return an.encode(t)}const I1=e=>nf("a-z","A-Z","0-9")(e);let yn=null;async function ty(e){if(yn)return yn;const t=await p1();return t?(yn=await ey(e?e+t:t),yn):e?(yn=await ey(e),yn):(yn=I1(32),yn)}async function T1(e,t){const r=e.telemetry?.debug||eg("BETTER_AUTH_TELEMETRY_DEBUG",!1),i=D0.BETTER_AUTH_TELEMETRY_ENDPOINT,n=async c=>{t?.customTrack?await t.customTrack(c).catch(ie.error):r?ie.info("telemetry event",JSON.stringify(c,null,2)):await oe(i,{method:"POST",body:c}).catch(ie.error)},a=await(async()=>{const c=e.telemetry?.enabled!==void 0?e.telemetry.enabled:!1;return(eg("BETTER_AUTH_TELEMETRY",!1)||c)&&(t?.skipTestCheck||!_s())})();let s;return a&&(s=await ty(e.baseURL),n({type:"init",payload:{config:h1(e,t),runtime:E1(),database:await g1(),framework:await w1(),environment:A1(),systemInfo:await b1(),packageManager:v1()},anonymousId:s})),{publish:async c=>{a&&(s||(s=await ty(e.baseURL)),await n({type:c.type,payload:c.payload,anonymousId:s}))}}}function x1(e){const t=new Set(e).size;return t===0?0:Math.log2(Math.pow(t,e.length))}function O1(e,t){const r=e===$N;if(!_s()){if(r&&ed)throw new Y("You are using the default secret. Please set `BETTER_AUTH_SECRET` in your environment variables or pass `secret` in your auth config.");e.length<32&&t.warn("[better-auth] Warning: your BETTER_AUTH_SECRET should be at least 32 characters long for adequate security. Generate one with `npx @better-auth/cli secret` or `openssl rand -base64 32`."),x1(e)<120&&t.warn("[better-auth] Warning: your BETTER_AUTH_SECRET appears low-entropy. Use a randomly generated secret for production.")}}async function D1(e,t,r){t.database||(t=SN(t,{session:{cookieCache:{enabled:!0,strategy:"jwe",refreshCache:!0}},account:{storeStateStrategy:"cookie",storeAccountCookie:!0}}));const i=t.plugins||[],n=f1(t),o=wa(t.logger),a=zp(t.baseURL,t.basePath);a||o.warn("[better-auth] Base URL could not be determined. Please set a valid base URL using the baseURL config option or the BETTER_AUTH_BASE_URL environment variable. Without this, callbacks and redirects may not work correctly.");const s=t.secret||Se.BETTER_AUTH_SECRET||Se.AUTH_SECRET||$N;O1(s,o),t={...t,secret:s,baseURL:a?new URL(a).origin:"",basePath:t.basePath||"/api/auth",plugins:i.concat(n)},u1(t,o);const c=yR(t),u=Cn(t),d=Object.entries(t.socialProviders||{}).map(([m,v])=>{if(v==null||v.enabled===!1)return null;v.clientId||o.warn(`Social provider ${m} is missing clientId or clientSecret`);const b=mN[m](v);return b.disableImplicitSignUp=v.disableImplicitSignUp,b}).filter(m=>m!==null),l=({model:m,size:v})=>typeof t.advanced?.generateId=="function"?t.advanced.generateId({model:m,size:v}):typeof t?.advanced?.database?.generateId=="function"?t.advanced.database.generateId({model:m,size:v}):pa(v),{publish:f}=await T1(t,{adapter:e.id,database:typeof t.database=="function"?"adapter":r(t.database)}),h=l1({appName:t.appName||"Better Auth",baseURL:a||"",version:kA(),socialProviders:d,options:t,oauthConfig:{storeStateStrategy:t.account?.storeStateStrategy||(t.database?"database":"cookie"),skipStateCookieCheck:!!t.account?.skipStateCookieCheck},tables:u,trustedOrigins:await AN(t),isTrustedOrigin(m,v){return this.trustedOrigins.some(b=>nk(m,b,v))},sessionConfig:{updateAge:t.session?.updateAge!==void 0?t.session.updateAge:1440*60,expiresIn:t.session?.expiresIn||3600*24*7,freshAge:t.session?.freshAge===void 0?3600*24:t.session.freshAge,cookieRefreshCache:(()=>{const m=t.session?.cookieCache?.refreshCache,v=t.session?.cookieCache?.maxAge||300;return(t.database||t.secondaryStorage)&&m?(o.warn("[better-auth] `session.cookieCache.refreshCache` is enabled while `database` or `secondaryStorage` is configured. `refreshCache` is meant for stateless (DB-less) setups. Disabling `refreshCache`  remove it from your config to silence this warning."),!1):m===!1||m===void 0?!1:m===!0?{enabled:!0,updateAge:Math.floor(v*.2)}:{enabled:!0,updateAge:m.updateAge!==void 0?m.updateAge:Math.floor(v*.2)}})()},secret:s,rateLimit:{...t.rateLimit,enabled:t.rateLimit?.enabled??ed,window:t.rateLimit?.window||10,max:t.rateLimit?.max||100,storage:t.rateLimit?.storage||(t.secondaryStorage?"secondary-storage":"memory")},authCookies:c,logger:o,generateId:l,session:null,secondaryStorage:t.secondaryStorage,password:{hash:t.emailAndPassword?.password?.hash||F0,verify:t.emailAndPassword?.password?.verify||B0,config:{minPasswordLength:t.emailAndPassword?.minPasswordLength||8,maxPasswordLength:t.emailAndPassword?.maxPasswordLength||128},checkPassword:qL},setNewSession(m){this.newSession=m},newSession:null,adapter:e,internalAdapter:Mp(e,{options:t,logger:o,hooks:t.databaseHooks?[t.databaseHooks]:[]}),createAuthCookie:XS(t),async runMigrations(){throw new Y("runMigrations will be set by the specific init implementation")},publishTelemetry:f,skipCSRFCheck:!!t.advanced?.disableCSRFCheck,skipOriginCheck:t.advanced?.disableOriginCheck!==void 0?t.advanced.disableOriginCheck:!!_s(),runInBackground:t.advanced?.backgroundTasks?.handler??(m=>{m.catch(()=>{})}),async runInBackgroundOrAwait(m){try{t.advanced?.backgroundTasks?.handler?m instanceof Promise&&t.advanced.backgroundTasks.handler(m.catch(v=>{o.error("Failed to run background task:",v)})):await m}catch(v){o.error("Failed to run background task:",v)}},getPlugin:m=>t.plugins.find(v=>v.id===m)??null});let g;return EN(h)?{context:g}=await h:{context:g}=h,typeof g.options.emailVerification?.onEmailVerification=="function"&&(g.options.emailVerification.onEmailVerification=nw(g.options.emailVerification.onEmailVerification,"Use `afterEmailVerification` instead. This will be removed in 1.5",g.logger)),g}const R1=async e=>{const t=await uk(e),i=await D1(t,e,n=>rm(n)||"unknown");return i.runMigrations=async function(){if(!e.database||"updateMany"in e.database)throw new Y("Database is not provided or it's an adapter. Migrations are only supported with a database instance.");const{runMigrations:n}=await cN(e);await n()},i},U1=(e,t)=>{const r=t(e),{api:i}=NN(r,e);return{handler:async n=>{const o=await r,a=o.options.basePath||"/api/auth";if(!o.options.baseURL){const c=zp(void 0,a,n,void 0,o.options.advanced?.trustedProxyHeaders);if(c)o.baseURL=c,o.options.baseURL=vc(o.baseURL)||void 0;else throw new Y("Could not get base URL from request. Please provide a valid base URL.")}o.trustedOrigins=await AN(o.options,n);const{handler:s}=d1(o,e);return TA(o.adapter,()=>s(n))},api:i,options:e,$context:r,$ERROR_CODES:{...e.plugins?.reduce((n,o)=>o.$ERROR_CODES?{...n,...o.$ERROR_CODES}:n,{}),...G}}},C1=e=>U1(e,R1),P1=(e,t)=>{let r=null;const i=a=>({getFieldName:s,options:c})=>{function u(h){const g=t.schema||a._.fullSchema;if(!g)throw new Y("Drizzle adapter failed to initialize. Schema not found. Please provide a schema object in the adapter options object.");const m=g[h];if(!m)throw new Y(`[# Drizzle Adapter]: The model "${h}" was not found in the schema object. Please pass the schema directly to the adapter options.`);return m}const d=async(h,g,m,v)=>{if(t.provider!=="mysql")return(await g.returning())[0];await g.execute();const b=u(h),I=g.config?.values;if(v?.length){const x=l(v.map(N=>m[N.field]!==void 0?{...N,value:m[N.field]}:N),h);return(await a.select().from(b).where(...x))[0]}else if(I&&I[0]?.id?.value){let x=I[0]?.id?.value;return x||(x=(await a.select({id:We`LAST_INSERT_ID()`}).from(b).orderBy(pd(b.id)).limit(1))[0].id),(await a.select().from(b).where(K(b.id,x)).limit(1).execute())[0]}else{if(m.id)return(await a.select().from(b).where(K(b.id,m.id)).limit(1).execute())[0];if(!("id"in b))throw new Y(`The model "${h}" does not have an "id" field. Please use the "id" field as your primary key.`);return(await a.select().from(b).orderBy(pd(b.id)).limit(1).execute())[0]}};function l(h,g){const m=u(g);if(!h)return[];if(h.length===1){const y=h[0];if(!y)return[];const w=s({model:g,field:y.field});if(!m[w])throw new Y(`The field "${y.field}" does not exist in the schema for the model "${g}". Please update your schema.`);if(y.operator==="in"){if(!Array.isArray(y.value))throw new Y(`The value for the field "${y.field}" must be an array when using the "in" operator.`);return[Ho(m[w],y.value)]}if(y.operator==="not_in"){if(!Array.isArray(y.value))throw new Y(`The value for the field "${y.field}" must be an array when using the "not_in" operator.`);return[md(m[w],y.value)]}return y.operator==="contains"?[Cr(m[w],`%${y.value}%`)]:y.operator==="starts_with"?[Cr(m[w],`${y.value}%`)]:y.operator==="ends_with"?[Cr(m[w],`%${y.value}`)]:y.operator==="lt"?[gd(m[w],y.value)]:y.operator==="lte"?[yd(m[w],y.value)]:y.operator==="ne"?[wd(m[w],y.value)]:y.operator==="gt"?[Zo(m[w],y.value)]:y.operator==="gte"?[vd(m[w],y.value)]:[K(m[w],y.value)]}const v=h.filter(y=>y.connector==="AND"||!y.connector),b=h.filter(y=>y.connector==="OR"),I=rt(...v.map(y=>{const w=s({model:g,field:y.field});if(y.operator==="in"){if(!Array.isArray(y.value))throw new Y(`The value for the field "${y.field}" must be an array when using the "in" operator.`);return Ho(m[w],y.value)}if(y.operator==="not_in"){if(!Array.isArray(y.value))throw new Y(`The value for the field "${y.field}" must be an array when using the "not_in" operator.`);return md(m[w],y.value)}return y.operator==="contains"?Cr(m[w],`%${y.value}%`):y.operator==="starts_with"?Cr(m[w],`${y.value}%`):y.operator==="ends_with"?Cr(m[w],`%${y.value}`):y.operator==="lt"?gd(m[w],y.value):y.operator==="lte"?yd(m[w],y.value):y.operator==="gt"?Zo(m[w],y.value):y.operator==="gte"?vd(m[w],y.value):y.operator==="ne"?wd(m[w],y.value):K(m[w],y.value)})),x=FN(...b.map(y=>{const w=s({model:g,field:y.field});if(y.operator==="in"){if(!Array.isArray(y.value))throw new Y(`The value for the field "${y.field}" must be an array when using the "in" operator.`);return Ho(m[w],y.value)}if(y.operator==="not_in"){if(!Array.isArray(y.value))throw new Y(`The value for the field "${y.field}" must be an array when using the "not_in" operator.`);return md(m[w],y.value)}return y.operator==="contains"?Cr(m[w],`%${y.value}%`):y.operator==="starts_with"?Cr(m[w],`${y.value}%`):y.operator==="ends_with"?Cr(m[w],`%${y.value}`):y.operator==="lt"?gd(m[w],y.value):y.operator==="lte"?yd(m[w],y.value):y.operator==="gt"?Zo(m[w],y.value):y.operator==="gte"?vd(m[w],y.value):y.operator==="ne"?wd(m[w],y.value):K(m[w],y.value)})),N=[];return v.length&&N.push(I),b.length&&N.push(x),N}function f(h,g,m){if(!h)throw new Y("Drizzle adapter failed to initialize. Drizzle Schema not found. Please provide a schema object in the adapter options object.");for(const v in m)if(!h[v])throw new Y(`The field "${v}" does not exist in the "${g}" Drizzle schema. Please update your drizzle schema or re-generate using "npx @better-auth/cli@latest generate".`)}return{async create({model:h,data:g}){const m=u(h);return f(m,h,g),await d(h,a.insert(m).values(g),g)},async findOne({model:h,where:g,join:m}){const v=u(h),b=l(g,h);if(c.experimental?.joins)if(!a.query||!a.query[h])ie.error(`[# Drizzle Adapter]: The model "${h}" was not found in the query object. Please update your Drizzle schema to include relations or re-generate using "npx @better-auth/cli@latest generate".`),ie.info("Falling back to regular query");else{let x;const N=[];if(m){x={};const w=Object.entries(m);for(const[_,S]of w){const E=S.limit??c.advanced?.database?.defaultFindManyLimit??100,k=S.relation==="one-to-one",U=k||t.usePlural?"":"s";x[`${_}${U}`]=k?!0:{limit:E},k||N.push(`${_}${U}`)}}const y=await a.query[h].findFirst({where:b[0],with:x});if(y)for(const w of N){const _=t.usePlural?w:w.slice(0,-1);y[_]=y[w],w!==_&&delete y[w]}return y}const I=await a.select().from(v).where(...b);return I.length?I[0]:null},async findMany({model:h,where:g,sortBy:m,limit:v,offset:b,join:I}){const x=u(h),N=g?l(g,h):[],y=m?.direction==="desc"?pd:WN;if(c.experimental?.joins)if(!a.query[h])ie.error(`[# Drizzle Adapter]: The model "${h}" was not found in the query object. Please update your Drizzle schema to include relations or re-generate using "npx @better-auth/cli@latest generate".`),ie.info("Falling back to regular query");else{let E;const k=[];if(I){E={};const T=Object.entries(I);for(const[A,O]of T){const R=O.relation==="one-to-one",W=O.limit??c.advanced?.database?.defaultFindManyLimit??100,z=R||t.usePlural?"":"s";E[`${A}${z}`]=R?!0:{limit:W},R||k.push(`${A}${z}`)}}let U;m?.field&&(U=[y(x[s({model:h,field:m?.field})])]);const P=await a.query[h].findMany({where:N[0],with:E,limit:v??100,offset:b??0,orderBy:U});if(P)for(const T of P)for(const A of k){const O=t.usePlural?A:A.slice(0,-1);O!==A&&(T[O]=T[A],delete T[A])}return P}let w=a.select().from(x);const _=v,S=b;return typeof _<"u"&&(w=w.limit(_)),typeof S<"u"&&(w=w.offset(S)),m?.field&&(w=w.orderBy(y(x[s({model:h,field:m?.field})]))),await w.where(...N)},async count({model:h,where:g}){const m=u(h),v=g?l(g,h):[];return(await a.select({count:qN()}).from(m).where(...v))[0].count},async update({model:h,where:g,update:m}){const v=u(h),b=l(g,h);return await d(h,a.update(v).set(m).where(...b),m,g)},async updateMany({model:h,where:g,update:m}){const v=u(h),b=l(g,h);return await a.update(v).set(m).where(...b)},async delete({model:h,where:g}){const m=u(h),v=l(g,h);return await a.delete(m).where(...v)},async deleteMany({model:h,where:g}){const m=u(h),v=l(g,h),b=await a.delete(m).where(...v);let I=0;return b&&"rowCount"in b?I=b.rowCount:Array.isArray(b)?I=b.length:b&&("affectedRows"in b||"rowsAffected"in b||"changes"in b)&&(I=b.affectedRows??b.rowsAffected??b.changes),typeof I!="number"&&ie.error("[Drizzle Adapter] The result of the deleteMany operation is not a number. This is likely a bug in the adapter. Please report this issue to the Better Auth team.",{res:b,model:h,where:g}),I},options:t}};let n=null;n={config:{adapterId:"drizzle",adapterName:"Drizzle Adapter",usePlural:t.usePlural??!1,debugLogs:t.debugLogs??!1,supportsUUIDs:t.provider==="pg",supportsJSON:t.provider==="pg",supportsArrays:t.provider==="pg",transaction:t.transaction??!1?a=>e.transaction(s=>a(Bg({config:n.config,adapter:i(s)})(r))):!1},adapter:i(e)};const o=Bg(n);return a=>(r=a,o(a))},L1=()=>({id:"next-cookies",hooks:{after:[{matcher(e){return!0},handler:ln(async e=>{const t=e.context.responseHeaders;if(!("_flag"in e&&e._flag==="router")&&t instanceof Headers){const r=t?.get("set-cookie");if(!r)return;const i=pR(r),{cookies:n}=await Wi(async()=>{const{cookies:a}=await Promise.resolve().then(()=>u$);return{cookies:a}},void 0,import.meta.url);let o;try{o=await n()}catch(a){if(a instanceof Error&&a.message.startsWith("`cookies` was called outside a request scope."))return;throw a}i.forEach((a,s)=>{if(!s)return;const c={sameSite:a.samesite,secure:a.secure,maxAge:a["max-age"],httpOnly:a.httponly,domain:a.domain,path:a.path};try{o.set(s,decodeURIComponent(a.value),c)}catch{}});return}})}]}}),z1=[{title:"[]",description:`



 `},{title:"[]",description:`

`},{title:"[]",description:`
10
!`}],j1=[{title:"[]",description:`




`},{title:"[]",description:`
24
1


5





SNS


1





5km 1km`},{title:"[]",description:`


3


- 
- 
- 2
- 
- 
- 
- 
- 
- 
- 
- 
- 


`}],M1=[{title:"[]",description:`1


5()`},{title:"[]",description:`  1



- 
- 
- 
- `},{title:"[]",description:`XXX
XXX
XXX
XXX
XXX
XXX
XXX
XXX
 



  




`},{title:"[]",description:`




`}],q1=async e=>{try{return(await yy(ur.select().from(Je).where(K(Je.userId,e)).limit(1),ur.select().from(He).where(K(He.userId,e)).limit(1),ur.select().from(Ze).where(K(Ze.userId,e)).limit(1))).length>0?{type:"ok",data:void 0}:(await ur.insert(Je).values(j1.map(r=>({userId:e,...r}))),await ur.insert(He).values(z1.map(r=>({userId:e,...r}))),await ur.insert(Ze).values(M1.map(r=>({userId:e,...r}))),{type:"ok",data:void 0})}catch(t){return console.error(t),{type:"error",error:{type:"unknown",message:""}}}};var qs={};const W1=C1({database:P1(ur,{provider:"mysql",schema:wy}),socialProviders:{google:{clientId:qs.GOOGLE_CLIENT_ID??"",clientSecret:qs.GOOGLE_CLIENT_SECRET??""}},hooks:{after:ln(async e=>{const t=e.context.newSession;t&&await q1(t.user.id)})},user:{fields:{emailVerified:"emailVerifiedTemp"}},session:{fields:{token:"sessionToken",expiresAt:"expires"}},account:{fields:{providerId:"provider",accountId:"providerAccountId",refreshToken:"refresh_token",accessToken:"access_token",accessTokenExpiresAt:"refreshTokenExpiresAt",idToken:"id_token"}},verification:{fields:{value:"token",expiresAt:"expires"}},plugins:[L1()],secret:qs.BETTER_AUTH_SECRET,baseURL:qs.BETTER_AUTH_URL}),im=async()=>{const e=await W1.api.getSession({headers:await Bi()});if(!e?.user)return console.info("user not logged in"),hd("/login");const{email:t}=e.user;if(!t)return console.error("user email not found"),hd("/login");const r=await ur.query.user.findFirst({columns:{id:!0},where:(i,{eq:n})=>n(i.email,t)});return r||(console.error("user not found in db"),hd("/login"))},om=async({transaction:e,userId:t,itemType:r,itemId:i,historyCreatedAt:n})=>{let o=0;if(r==="powerup"){const[h]=await e.select({count:We`COUNT(*)`}).from(wr).innerJoin(He,K(wr.powerupId,He.id)).where(n?rt(K(He.userId,t),We`DATE(${wr.createdAt}) = DATE(${n})`):K(He.userId,t));o=h?.count??0}else if(r==="quest"){const[h]=await e.select({count:We`COUNT(*)`}).from(yr).innerJoin(Je,K(yr.questId,Je.id)).where(n?rt(K(Je.userId,t),We`DATE(${yr.createdAt}) = DATE(${n})`):K(Je.userId,t));o=h?.count??0}else if(r==="villain"){const[h]=await e.select({count:We`COUNT(*)`}).from(vr).innerJoin(Ze,K(vr.villainId,Ze.id)).where(n?rt(K(Ze.userId,t),We`DATE(${vr.createdAt}) = DATE(${n})`):K(Ze.userId,t));o=h?.count??0}else if(r==="epicwin"){const[h]=await e.select({count:We`COUNT(*)`}).from(Hn).innerJoin(Gt,K(Hn.epicwinId,Gt.id)).where(n?rt(K(Gt.userId,t),We`DATE(${Hn.createdAt}) = DATE(${n})`):K(Gt.userId,t));o=h?.count??0}const a=await e.select({id:tt.id}).from(Qt).innerJoin(tt,K(Qt.id,tt.missionId)).where(rt(n?We`DATE(${Qt.deadline}) = DATE(${n})`:Zo(Qt.deadline,new Date),K(Qt.userId,t),K(tt.completed,!0),K(tt.itemType,r),K(tt.conditionType,"any"))),s=a.length,c=Math.max(0,s-o);c>0&&await e.update(tt).set({completed:!1}).where(Ho(tt.id,a.slice(0,c).map(h=>h.id)));let u=0;if(r==="powerup"){const[h]=await e.select({count:We`COUNT(*)`}).from(wr).innerJoin(He,K(wr.powerupId,He.id)).where(n?rt(K(He.id,i),K(He.userId,t),We`DATE(${wr.createdAt}) = DATE(${n})`):rt(K(He.id,i),K(He.userId,t)));u=h?.count??0}else if(r==="quest"){const[h]=await e.select({count:We`COUNT(*)`}).from(yr).innerJoin(Je,K(yr.questId,Je.id)).where(n?rt(K(Je.id,i),K(Je.userId,t),We`DATE(${yr.createdAt}) = DATE(${n})`):rt(K(Je.id,i),K(Je.userId,t)));u=h?.count??0}else if(r==="villain"){const[h]=await e.select({count:We`COUNT(*)`}).from(vr).innerJoin(Ze,K(vr.villainId,Ze.id)).where(n?rt(K(Ze.id,i),K(Ze.userId,t),We`DATE(${vr.createdAt}) = DATE(${n})`):rt(K(Ze.id,i),K(Ze.userId,t)));u=h?.count??0}else if(r==="epicwin"){const[h]=await e.select({count:We`COUNT(*)`}).from(Hn).innerJoin(Gt,K(Hn.epicwinId,Gt.id)).where(n?rt(K(Gt.id,i),K(Gt.userId,t),We`DATE(${Hn.createdAt}) = DATE(${n})`):rt(K(Gt.id,i),K(Gt.userId,t)));u=h?.count??0}const d=await e.select({id:tt.id}).from(Qt).innerJoin(tt,K(Qt.id,tt.missionId)).where(rt(n?We`DATE(${Qt.deadline}) = DATE(${n})`:Zo(Qt.deadline,new Date),K(Qt.userId,t),K(tt.completed,!0),K(tt.itemType,r),K(tt.conditionType,"specific"),K(tt.itemId,i))),l=d.length,f=Math.max(0,l-u);f>0&&await e.update(tt).set({completed:!1}).where(Ho(tt.id,d.slice(0,f).map(h=>h.id)))},F1=async(e,t)=>{const r=await im();if(!Ql(t))return{type:"error",error:{type:"forbidden",message:""}};try{return await ur.transaction(async i=>{const n=await i.query.powerupHistories.findFirst({where:K(wr.id,e)});if(!n){i.rollback();return}const o=await i.query.powerups.findFirst({where:rt(K(He.id,n.powerupId),K(He.userId,r.id))});if(!o){i.rollback();return}await i.delete(wr).where(K(wr.id,e)),await i.update(He).set({count:We`${He.count} - 1`}).where(K(He.id,o.id)),await om({transaction:i,userId:r.id,itemType:"powerup",itemId:o.id,historyCreatedAt:n.createdAt})}),Fi("/"),Fi(`/history/${t.toISOString().split("T")[0]}`),{type:"ok",data:void 0}}catch(i){return console.error(i),{type:"error",error:{type:"unknown",message:"unknown error"}}}},B1=async(e,t)=>{const r=await im();if(!Ql(t))return{type:"error",error:{type:"forbidden",message:""}};try{return await ur.transaction(async i=>{const n=await i.query.questHistories.findFirst({where:K(yr.id,e)});if(!n){i.rollback();return}const o=await i.query.quests.findFirst({where:rt(K(Je.id,n.questId),K(Je.userId,r.id))});if(!o){i.rollback();return}await i.delete(yr).where(K(yr.id,e)),await i.update(Je).set({count:We`${Je.count} - 1`}).where(K(Je.id,o.id)),await om({transaction:i,userId:r.id,itemType:"quest",itemId:o.id,historyCreatedAt:n.createdAt})}),Fi("/"),Fi(`/history/${t.toISOString().split("T")[0]}`),{type:"ok",data:void 0}}catch(i){return console.error(i),{type:"error",error:{type:"unknown",message:"unknown error"}}}},V1=async(e,t)=>{const r=await im();if(!Ql(t))return{type:"error",error:{type:"forbidden",message:""}};try{return await ur.transaction(async i=>{const n=await i.query.villainHistories.findFirst({where:K(vr.id,e)});if(!n){i.rollback();return}const o=await i.query.villains.findFirst({where:rt(K(Ze.id,n.villainId),K(Ze.userId,r.id))});if(!o){i.rollback();return}await i.delete(vr).where(K(vr.id,e)),await i.update(Ze).set({count:We`${Ze.count} - 1`}).where(K(Ze.id,o.id)),await om({transaction:i,userId:r.id,itemType:"villain",itemId:o.id,historyCreatedAt:n.createdAt})}),Fi("/"),Fi(`/history/${t.toISOString().split("T")[0]}`),{type:"ok",data:void 0}}catch(i){return console.error(i),{type:"error",error:{type:"unknown",message:"unknown error"}}}},Hl=({history:e,isEditable:t,targetDate:r})=>{const[i,n]=Ts.useState(!1),[o,a]=Ts.useTransition(),{add:s}=LN(),c=Ts.useRef(null);Ts.useEffect(()=>{const d=l=>{l.stopPropagation(),c.current&&!c.current.contains(l.target)&&n(!1)};return document.addEventListener("mousedown",d),document.addEventListener("touchstart",d),()=>{document.removeEventListener("mousedown",d),document.removeEventListener("touchstart",d)}},[]);const u=d=>{d.stopPropagation(),a(async()=>{let l;e.type==="quest"?l=await B1(e.id,r):e.type==="powerup"?l=await F1(e.id,r):e.type==="villain"&&(l=await V1(e.id,r)),l?.type==="ok"?(s({message:""}),n(!1)):s({message:l?.error.message||""})})};return ar.jsxs("div",{className:Do({position:"relative"}),children:[ar.jsxs(ZN.button,{layout:!0,initial:!1,animate:{x:i?-40:0},transition:{type:"spring",stiffness:300,damping:30},onClick:d=>{d.stopPropagation(),n(!0)},className:JN(HN({borderWidth:2,borderColor:"interactive.border"}),Do({display:"flex",alignItems:"center",gap:"8px",padding:"4px",backgroundColor:"interactive.background",cursor:"pointer",width:"[100%]"})),children:[ar.jsx(KN,{itemType:e.type,completed:!0,size:18}),ar.jsx("div",{className:Do({flex:"1"}),children:ar.jsx("p",{className:Do({textStyle:"Body.secondary",textAlign:"left"}),children:e.title})}),t&&ar.jsx(jN,{size:20})]}),i&&ar.jsx("div",{ref:c,className:Do({position:"absolute",right:0,top:0,height:"[100%]",display:"flex",alignItems:"center",paddingRight:"8px"}),children:ar.jsx(zN,{onClick:u,disabled:o,size:"md",active:!0,children:ar.jsx(MN,{size:24})})})]})};try{Hl.displayName="EntityHistoryItem",Hl.__docgenInfo={description:"",displayName:"EntityHistoryItem",props:{history:{defaultValue:null,description:"",name:"history",required:!0,type:{name:"{ id: string; type: EntityType; title: string; createdAt: Date; }"}},isEditable:{defaultValue:null,description:"",name:"isEditable",required:!0,type:{name:"boolean"}},targetDate:{defaultValue:null,description:"",name:"targetDate",required:!0,type:{name:"Date"}}}}}catch{}const K1={component:Hl,args:{history:{id:"1",type:"quest",title:"",createdAt:new Date("2025-12-13T12:00:00")},isEditable:!0,targetDate:new Date("2025-12-13")},tags:["autodocs"],decorators:[e=>ar.jsx("div",{style:{maxWidth:"400px",padding:"16px"},children:ar.jsx(e,{})})]},Bo={},Vo={args:{isEditable:!1}},Ko={args:{history:{id:"2",type:"powerup",title:"",createdAt:new Date("2025-12-13T12:00:00")}}},Jo={args:{history:{id:"3",type:"villain",title:"",createdAt:new Date("2025-12-13T12:00:00")}}};Bo.parameters={...Bo.parameters,docs:{...Bo.parameters?.docs,source:{originalSource:"{} satisfies Story",...Bo.parameters?.docs?.source}}};Vo.parameters={...Vo.parameters,docs:{...Vo.parameters?.docs,source:{originalSource:`{
  args: {
    isEditable: false
  }
} satisfies Story`,...Vo.parameters?.docs?.source}}};Ko.parameters={...Ko.parameters,docs:{...Ko.parameters?.docs,source:{originalSource:`{
  args: {
    history: {
      id: '2',
      type: 'powerup' as const,
      title: '',
      createdAt: new Date('2025-12-13T12:00:00')
    }
  }
} satisfies Story`,...Ko.parameters?.docs?.source}}};Jo.parameters={...Jo.parameters,docs:{...Jo.parameters?.docs,source:{originalSource:`{
  args: {
    history: {
      id: '3',
      type: 'villain' as const,
      title: '',
      createdAt: new Date('2025-12-13T12:00:00')
    }
  }
} satisfies Story`,...Jo.parameters?.docs?.source}}};const J1=["QuestEditable","QuestReadOnly","Powerup","Villain"],sz=Object.freeze(Object.defineProperty({__proto__:null,Powerup:Ko,QuestEditable:Bo,QuestReadOnly:Vo,Villain:Jo,__namedExportsOrder:J1,default:K1},Symbol.toStringTag,{value:"Module"}));export{rr as C,dd as D,uP as a,As as b,Bg as c,fd as d,sz as e,rm as g,ie as l,Ae as s};
